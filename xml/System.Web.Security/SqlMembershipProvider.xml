<Type Name="SqlMembershipProvider" FullName="System.Web.Security.SqlMembershipProvider">
  <Metadata><Meta Name="ms.openlocfilehash" Value="c63fd3cd89cd5550a0f6cddf2b63884357e14074" /><Meta Name="ms.sourcegitcommit" Value="0084afad1b3b1cb2c8ad2c142ae3597d08bad4a7" /><Meta Name="ms.translationtype" Value="MT" /><Meta Name="ms.contentlocale" Value="ja-JP" /><Meta Name="ms.lasthandoff" Value="10/31/2019" /><Meta Name="ms.locfileid" Value="73395352" /></Metadata><TypeSignature Language="C#" Value="public class SqlMembershipProvider : System.Web.Security.MembershipProvider" />
  <TypeSignature Language="ILAsm" Value=".class public auto ansi beforefieldinit SqlMembershipProvider extends System.Web.Security.MembershipProvider" />
  <TypeSignature Language="DocId" Value="T:System.Web.Security.SqlMembershipProvider" />
  <TypeSignature Language="VB.NET" Value="Public Class SqlMembershipProvider&#xA;Inherits MembershipProvider" />
  <TypeSignature Language="C++ CLI" Value="public ref class SqlMembershipProvider : System::Web::Security::MembershipProvider" />
  <TypeSignature Language="F#" Value="type SqlMembershipProvider = class&#xA;    inherit MembershipProvider" />
  <AssemblyInfo>
    <AssemblyName>System.Web</AssemblyName>
    <AssemblyVersion>2.0.0.0</AssemblyVersion>
    <AssemblyVersion>4.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <Base>
    <BaseTypeName>System.Web.Security.MembershipProvider</BaseTypeName>
  </Base>
  <Interfaces />
  <Docs>
    <summary>SQL Server データベース内での ASP.NET アプリケーションのメンバーシップ情報のストレージを管理します。</summary>
    <remarks>
      <format type="text/markdown"><![CDATA[  
  
## Remarks  
 このクラスは、SQL Server データベースを使用して ASP.NET アプリケーションのメンバーシップサービスを提供するために、<xref:System.Web.Security.Membership> クラスと <xref:System.Web.Security.MembershipUser> クラスによって使用されます。 SQL Server を指定せずに <xref:System.Web.Security.SqlMembershipProvider> を使用することはできません。 既定のインスタンス名とユーザーインスタンスが有効になっているコンピューター SQL Server Express インストールされている場合、<xref:System.Web.Security.SqlMembershipProvider> オブジェクトによって、アプリケーションの最初の実行時に、アプリケーションの `App_Data` ディレクトリに `aspnetdb` というデータベースが作成されます。  
  
 データベースを手動で作成するには、`%systemroot%\Microsoft.NET\Framework\ versionNumber` フォルダーにある `Aspnet_regsql.exe` 実行可能ファイルを実行し、`-A m` オプション (`aspnet_regsql.exe -A m`など) を指定します。 作成されたデータベースは Aspnetdb.mdf と呼ばれます。 または、`Aspnet_regsql.exe` を実行して、GUI 構成モードをプルし、すべての ASP.NET 機能を構成します。  
  
 メンバーシッププロバイダーが統合セキュリティを使用する接続文字列で構成されている場合、ASP.NET アプリケーションのプロセスアカウントは、SQL Server データベースに接続する権限を持っている必要があります。  
  
 Machine.config ファイルは、ローカルコンピューター上の既定の SQL Server Express インスタンスに接続する `AspNetSqlMembershipProvider` という名前の既定の <xref:System.Web.Security.SqlMembershipProvider> インスタンスを定義します。 既定のインスタンス名を使用して SQL Server Express をインストールした場合は、プロバイダーのこのインスタンスを使用できます。また、ASP.NET アプリケーションの web.config ファイルで独自のインスタンスを定義することもできます。  
  
 `passwordCompatMode` 属性を <xref:System.Web.Configuration.MembershipPasswordCompatibilityMode.Framework40>に設定した場合、アプリケーションは ASP.NET 4 で追加されたハッシュおよび暗号化のメンバーシップオプションを使用できます。 ただし、`passwordCompatMode` 属性が <xref:System.Web.Configuration.MembershipPasswordCompatibilityMode.Framework20>に設定されている場合は、ASP.NET 2.0、ASP.NET 3.5、および ASP.NET 3.5 SP1 のハッシュおよび暗号化のメンバーシップオプションのみを使用できます。 既定値は <xref:System.Web.Configuration.MembershipPasswordCompatibilityMode.Framework20> です。 詳細については、「<xref:System.Web.Configuration.MembershipPasswordCompatibilityMode>」を参照してください。  
  
   
  
## Examples  
 次のコード例は、<xref:System.Web.Security.SqlMembershipProvider>を使用するように構成された ASP.NET アプリケーションの web.config ファイルを示しています。  
  
```  
<configuration>  
  <connectionStrings>  
    <add name="SqlServices" connectionString="Data Source=localhost;Integrated Security=SSPI;Initial Catalog=aspnetdb;" />  
  </connectionStrings>  
  <system.web>  
    <authentication mode="Forms" >  
      <forms loginUrl="login.aspx"  
        name=".ASPXFORMSAUTH" />  
    </authentication>  
    <authorization>  
      <deny users="?" />  
    </authorization>  
    <membership defaultProvider="SqlProvider"  
      userIsOnlineTimeWindow="15">  
      <providers>  
        <add   
          name="SqlProvider"   
          type="System.Web.Security.SqlMembershipProvider"   
          connectionStringName="SqlServices"  
          applicationName="MyApplication"  
          enablePasswordRetrieval="false"  
          enablePasswordReset="true"  
          requiresQuestionAndAnswer="true"  
          requiresUniqueEmail="false"  
          passwordFormat="Hashed"  
          maxInvalidPasswordAttempts="5"  
          passwordAttemptWindow="10" />  
      </providers>  
    </membership>  
  </system.web>  
</configuration>  
```  
  
 ]]></format>
    </remarks>
    <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)">ASP.NET メンバーシップの概要</related>
  </Docs>
  <Members>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public SqlMembershipProvider ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.SqlMembershipProvider.#ctor" />
      <MemberSignature Language="VB.NET" Value="Public Sub New ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; SqlMembershipProvider();" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <Parameters />
      <Docs>
        <summary><see cref="T:System.Web.Security.SqlMembershipProvider" /> クラスの新しいインスタンスを初期化します。</summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <xref:System.Web.Security.SqlMembershipProvider.%23ctor%2A> コンストラクターは、アプリケーションの構成で指定されているように、<xref:System.Web.Security.SqlMembershipProvider> クラスのインスタンスを作成するために ASP.NET によって呼び出されます。 このコンストラクターは、コードから使用するためのものではありません。  
  
 ]]></format>
        </remarks>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)">ASP.NET メンバーシップの概要</related>
      </Docs>
    </Member>
    <Member MemberName="ApplicationName">
      <MemberSignature Language="C#" Value="public override string ApplicationName { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string ApplicationName" />
      <MemberSignature Language="DocId" Value="P:System.Web.Security.SqlMembershipProvider.ApplicationName" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Property ApplicationName As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual property System::String ^ ApplicationName { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberSignature Language="F#" Value="member this.ApplicationName : string with get, set" Usage="System.Web.Security.SqlMembershipProvider.ApplicationName" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>get: System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>メンバーシップ情報を格納および取得するアプリケーションの名前を取得または設定します。</summary>
        <value>メンバーシップ情報を格納および取得するアプリケーションの名前。 既定値は、現在の <see cref="P:System.Web.HttpRequest.ApplicationPath" /> の <see cref="P:System.Web.HttpContext.Request" /> プロパティ値です。</value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <xref:System.Web.Security.SqlMembershipProvider.ApplicationName%2A> は、ユーザー情報をグループ化するために <xref:System.Web.Security.SqlMembershipProvider> によって使用されます。 アプリケーション名を使用してユーザー情報を修飾することにより、複数のアプリケーションの情報を1つのデータベースに格納できます。重複するユーザー名の間で競合が発生することはありません。 また、複数の ASP.NET アプリケーションで同じユーザーデータベースを使用するには、<xref:System.Web.Security.SqlMembershipProvider.ApplicationName%2A> プロパティで同じ値を指定します。 <xref:System.Web.Security.SqlMembershipProvider.ApplicationName%2A> プロパティは、プログラムで設定することも、`applicationName` 属性を使用して、Web アプリケーションの構成ファイルで宣言によって設定することもできます。  
  
 Web アプリケーションの構成ファイルの `applicationName` 属性に値が指定されていない場合は、アプリケーションに対して行われた最初の要求の <xref:System.Web.HttpRequest.ApplicationPath%2A> プロパティ値が使用されます。  
  
> [!CAUTION]
>  <xref:System.Web.HttpApplication> オブジェクトによって処理されるすべての要求に対して1つの既定のメンバーシッププロバイダーインスタンスが使用されるため、複数の要求を同時に実行し、<xref:System.Web.Security.SqlMembershipProvider.ApplicationName%2A> プロパティ値を設定することができます。 <xref:System.Web.Security.SqlMembershipProvider.ApplicationName%2A> プロパティは、複数の書き込みに対してスレッドセーフではありません。また、<xref:System.Web.Security.SqlMembershipProvider.ApplicationName%2A> プロパティ値を変更すると、アプリケーションの複数のユーザーに対して予期しない動作が発生する可能性があります。 必要な場合を除き、ユーザーが <xref:System.Web.Security.SqlMembershipProvider.ApplicationName%2A> プロパティを設定できるように、コードを記述しないことをお勧めします。 <xref:System.Web.Security.SqlMembershipProvider.ApplicationName%2A> プロパティを設定する必要があるアプリケーションの例として、複数のアプリケーションのメンバーシップデータを管理する管理アプリケーションがあります。 このようなアプリケーションは、Web アプリケーションではなく、シングルユーザーアプリケーションである必要があります。  
  
   
  
## Examples  
 ASP.NET アプリケーションの web.config ファイルの `system.web` セクションの[membership](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/1b9hw62f(v%3dvs.100))要素のコード例を次に示します。 これにより、アプリケーションの <xref:System.Web.Security.SqlMembershipProvider> インスタンスが指定され、<xref:System.Web.Security.SqlMembershipProvider.ApplicationName%2A> が `MyApplication`に設定されます。  
  
```  
<membership defaultProvider="SqlProvider" userIsOnlineTimeWindow="20">  
  <providers>  
    <add name="SqlProvider"  
      type="System.Web.Security.SqlMembershipProvider"  
      connectionStringName="SqlServices"  
      enablePasswordRetrieval="true"  
      enablePasswordReset="false"  
      requiresQuestionAndAnswer="true"  
      passwordFormat="Encrypted"  
      applicationName="MyApplication" />  
  </providers>  
</membership>  
```  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><see cref="P:System.Web.Security.SqlMembershipProvider.ApplicationName" /> プロパティを空の文字列または <see langword="null" /> に設定しようとしました。</exception>
        <exception cref="T:System.Configuration.Provider.ProviderException"><see cref="P:System.Web.Security.SqlMembershipProvider.ApplicationName" /> プロパティに対し、256 文字より長い文字列を設定しようとしました。</exception>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)">ASP.NET メンバーシップの概要</related>
      </Docs>
    </Member>
    <Member MemberName="ChangePassword">
      <MemberSignature Language="C#" Value="public override bool ChangePassword (string username, string oldPassword, string newPassword);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance bool ChangePassword(string username, string oldPassword, string newPassword) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.SqlMembershipProvider.ChangePassword(System.String,System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function ChangePassword (username As String, oldPassword As String, newPassword As String) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override bool ChangePassword(System::String ^ username, System::String ^ oldPassword, System::String ^ newPassword);" />
      <MemberSignature Language="F#" Value="override this.ChangePassword : string * string * string -&gt; bool" Usage="sqlMembershipProvider.ChangePassword (username, oldPassword, newPassword)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="username" Type="System.String" />
        <Parameter Name="oldPassword" Type="System.String" />
        <Parameter Name="newPassword" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="username">パスワードを更新するユーザー。</param>
        <param name="oldPassword">指定したユーザーの現在のパスワード。</param>
        <param name="newPassword">指定したユーザーの新しいパスワード。</param>
        <summary>ユーザーのパスワードを変更します。</summary>
        <returns>パスワードが正常に更新された場合は <see langword="true" />。 指定した現在のパスワードが無効だったり、ユーザーがロックされていたり、ユーザーがデータベースに存在していない場合は <see langword="false" />。</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 このメソッドは、ASP.NET アプリケーションの構成ファイル (Web.config) で指定された SQL Server データベース内のユーザーのパスワードを更新するために、<xref:System.Web.Security.Membership> クラスによって呼び出されます。  
  
 パスワードの最大文字数は128文字です。  
  
 <xref:System.Web.Security.SqlMembershipProvider.ChangePassword%2A> メソッドに間違ったパスワードを指定した場合、無効なパスワードの試行を追跡する内部カウンターは1つずつ増加します。 これにより、ユーザーがロックアウトされ、<xref:System.Web.Security.SqlMembershipProvider.UnlockUser%2A> メソッドの呼び出しによってロックの状態がクリアされるまで、ユーザーがログオンできなくなる可能性があります。 正しいパスワードが指定されていて、ユーザーが現在ロックアウトされていない場合、無効なパスワードとパスワードの解答の試行を追跡する内部カウンターは0にリセットされます。 詳細については、「<xref:System.Web.Security.SqlMembershipProvider.MaxInvalidPasswordAttempts%2A> と <xref:System.Web.Security.SqlMembershipProvider.PasswordAttemptWindow%2A> のプロパティ」を参照してください。  
  
 最初に <xref:System.Web.Security.Membership> クラスの <xref:System.Web.Security.Membership.Provider%2A> プロパティを使用して <xref:System.Web.Security.SqlMembershipProvider> インスタンスへの参照を取得することで、<xref:System.Web.Security.SqlMembershipProvider.ChangePassword%2A> メソッドを直接呼び出すことができます。 <xref:System.Web.Security.Membership.Provider%2A> プロパティは、アプリケーションの web.config ファイルで指定された `defaultProvider` を公開します。 <xref:System.Web.Security.Membership.Providers%2A> プロパティを使用して参照されている既定のプロバイダーではない構成済みのプロバイダー。  
  
 <xref:System.Web.Security.MembershipUser.ChangePassword%2A> 方法を使用して、ユーザーのパスワードを変更することもできます。  
  
 先頭と末尾のスペースは、すべてのパラメーター値から削除されます。  
  
   
  
## Examples  
 次のコード例では、指定されたユーザーのパスワードを変更します。  
  
> [!NOTE]
>  この例では、<xref:System.Web.Security.Membership> クラスの <xref:System.Web.Security.Membership.Provider%2A> プロパティを使用して、web.config ファイルの `defaultProvider` として指定された <xref:System.Web.Security.SqlMembershipProvider> を呼び出します。 <xref:System.Web.Security.SqlMembershipProvider>型として既定のプロバイダーにアクセスする必要がある場合は、<xref:System.Web.Security.Membership> クラスの <xref:System.Web.Security.Membership.Provider%2A> プロパティをキャストできます。 特定のプロバイダーの種類として構成されている他のプロバイダーにアクセスするには、構成された名前で <xref:System.Web.Security.Membership> クラスの <xref:System.Web.Security.Membership.Providers%2A> プロパティを使用してアクセスし、特定のプロバイダーの種類としてキャストします。  
  
 [!code-aspx-csharp[System.Web.Security.SqlMembershipProvider#3](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.Security.SqlMembershipProvider/CS/ChangePasswordcs.aspx#3)]
 [!code-aspx-vb[System.Web.Security.SqlMembershipProvider#3](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.Security.SqlMembershipProvider/VB/ChangePasswordvb.aspx#3)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><paramref name="username" /> が空の文字列 ("") であるか、コンマを含んでいるか、または 256 文字を超えています。  
  
- または - 
 <paramref name="oldPassword" /> が空の文字列であるか、または 128 文字を超えています。  
  
- または - 
 <paramref name="newPassword" /> が空の文字列であるか、または 128 文字を超えています。  
  
- または - 
エンコードされた <paramref name="newPassword" /> の長さが 128 文字を超えています。  
  
- または - 
パスワード変更アクションが <see cref="E:System.Web.Security.Membership.ValidatingPassword" /> イベントのサブスクライバーによってキャンセルされ、かつ <see cref="P:System.Web.Security.ValidatePasswordEventArgs.FailureInformation" /> プロパティが <see langword="null" /> です。  
  
- または - 
<paramref name="newPassword" /> の長さが、<see cref="P:System.Web.Security.SqlMembershipProvider.MinRequiredPasswordLength" /> プロパティで指定されている必要なパスワード長に足りません。  
  
- または - 
<paramref name="newPassword" /> 内のアルファベット以外の文字数が <see cref="P:System.Web.Security.SqlMembershipProvider.MinRequiredNonAlphanumericCharacters" /> プロパティで指定されている、パスワードに最低限含む必要のあるアルファベット以外の文字の数に足りません。  
  
- または - 
 <paramref name="newPassword" /> が <see cref="P:System.Web.Security.SqlMembershipProvider.PasswordStrengthRegularExpression" /> プロパティで定義されている正規表現に違反しています。</exception>
        <exception cref="T:System.ArgumentNullException"><paramref name="username" /> が <see langword="null" /> です。  
  
- または - 
 <paramref name="oldPassword" /> は <see langword="null" />です。  
  
- または - 
 <paramref name="newPassword" /> が <see langword="null" /> です。</exception>
        <exception cref="T:System.Web.Security.MembershipPasswordException">データベースに <paramref name="username" /> が見つかりませんでした。</exception>
        <exception cref="T:System.Configuration.Provider.ProviderException">データベースに新しいパスワード値を設定しているときにエラーが発生しました。</exception>
        <exception cref="T:System.Exception">ハンドルされていない例外が発生しました。</exception>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)">ASP.NET メンバーシップの概要</related>
      </Docs>
    </Member>
    <Member MemberName="ChangePasswordQuestionAndAnswer">
      <MemberSignature Language="C#" Value="public override bool ChangePasswordQuestionAndAnswer (string username, string password, string newPasswordQuestion, string newPasswordAnswer);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance bool ChangePasswordQuestionAndAnswer(string username, string password, string newPasswordQuestion, string newPasswordAnswer) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.SqlMembershipProvider.ChangePasswordQuestionAndAnswer(System.String,System.String,System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function ChangePasswordQuestionAndAnswer (username As String, password As String, newPasswordQuestion As String, newPasswordAnswer As String) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override bool ChangePasswordQuestionAndAnswer(System::String ^ username, System::String ^ password, System::String ^ newPasswordQuestion, System::String ^ newPasswordAnswer);" />
      <MemberSignature Language="F#" Value="override this.ChangePasswordQuestionAndAnswer : string * string * string * string -&gt; bool" Usage="sqlMembershipProvider.ChangePasswordQuestionAndAnswer (username, password, newPasswordQuestion, newPasswordAnswer)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="username" Type="System.String" />
        <Parameter Name="password" Type="System.String" />
        <Parameter Name="newPasswordQuestion" Type="System.String" />
        <Parameter Name="newPasswordAnswer" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="username">パスワードの質問と回答を変更するユーザー。</param>
        <param name="password">指定したユーザーのパスワード。</param>
        <param name="newPasswordQuestion">指定したユーザーの新しいパスワードの質問。</param>
        <param name="newPasswordAnswer">指定したユーザーの新しいパスワードの回答。</param>
        <summary>SQL Server メンバーシップ データベースでユーザーのパスワードの質問と解答を更新します。</summary>
        <returns>更新が正常に実行された場合は <see langword="true" />、それ以外の場合は <see langword="false" />。 <paramref name="password" /> が無効であったり、ユーザーがロックされていたり、ユーザーがデータベースに存在していない場合にも <see langword="false" /> が返されます。</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 このメソッドは <xref:System.Web.Security.MembershipUser> クラスによって呼び出され、ASP.NET アプリケーションの構成ファイル (Web.config) で指定されている SQL Server データベース内のユーザーのパスワードの質問と回答を更新します。 パスワードの解答は、<xref:System.Web.Security.SqlMembershipProvider.PasswordFormat%2A> プロパティで指定された形式を使用して暗号化されます。  
  
 パスワードの質問と回答を要求すると、ユーザーのパスワードを取得またはリセットするときに、追加のセキュリティ層が提供されます。 ユーザー名を作成する場合、ユーザーは、忘れたパスワードを取得またはリセットするために後で使用できる質問と回答を指定できます。 <xref:System.Web.Security.SqlMembershipProvider.ChangePasswordQuestionAndAnswer%2A> メソッドは、メンバーシップユーザーのパスワードの質問と回答を更新します。  
  
 <xref:System.Web.Security.SqlMembershipProvider.ChangePasswordQuestionAndAnswer%2A> メソッドに間違ったパスワードを指定した場合、無効なパスワードの試行を追跡する内部カウンターは1つずつ増加します。 これにより、ユーザーがロックアウトされ、<xref:System.Web.Security.SqlMembershipProvider.UnlockUser%2A> メソッドを呼び出すことによってロックの状態がクリアされるまで、ユーザーがログオンできなくなる可能性があります。 正しいパスワードが指定されていて、ユーザーが現在ロックアウトされていない場合、無効なパスワードとパスワードの解答の試行を追跡する内部カウンターは0にリセットされます。 詳細については、「<xref:System.Web.Security.SqlMembershipProvider.MaxInvalidPasswordAttempts%2A> と <xref:System.Web.Security.SqlMembershipProvider.PasswordAttemptWindow%2A> のプロパティ」を参照してください。  
  
 パスワードの質問の最大文字数は256文字です。 パスワードの解答の最大長は128文字です。  
  
 詳細については、「<xref:System.Web.Security.SqlMembershipProvider.RequiresQuestionAndAnswer%2A>「<xref:System.Web.Security.SqlMembershipProvider.ResetPassword%2A>および「<xref:System.Web.Security.SqlMembershipProvider.GetPassword%2A>」を参照してください。  
  
 先頭と末尾のスペースは、すべてのパラメーター値から削除されます。  
  
   
  
## Examples  
 次のコード例では、ユーザーのパスワードの質問と解答を更新します。  
  
> [!NOTE]
>  この例では、<xref:System.Web.Security.Membership> クラスの <xref:System.Web.Security.Membership.Provider%2A> プロパティを使用して、web.config ファイルの `defaultProvider` として指定された <xref:System.Web.Security.SqlMembershipProvider> を呼び出します。 <xref:System.Web.Security.SqlMembershipProvider>型として既定のプロバイダーにアクセスする必要がある場合は、<xref:System.Web.Security.Membership> クラスの <xref:System.Web.Security.Membership.Provider%2A> プロパティをキャストできます。 特定のプロバイダーの種類として構成されている他のプロバイダーにアクセスするには、構成された名前で <xref:System.Web.Security.Membership> クラスの <xref:System.Web.Security.Membership.Providers%2A> プロパティを使用してアクセスし、特定のプロバイダーの種類としてキャストします。  
  
 [!code-aspx-csharp[System.Web.Security.SqlMembershipProvider#10](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.Security.SqlMembershipProvider/CS/ChangePasswordQuestioncs.aspx#10)]
 [!code-aspx-vb[System.Web.Security.SqlMembershipProvider#10](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.Security.SqlMembershipProvider/VB/ChangePasswordQuestionvb.aspx#10)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><paramref name="username" /> が空の文字列 ("") であるか、コンマを含んでいるか、または 256 文字を超えています。  
  
- または - 
 <paramref name="password" /> が空の文字列であるか、または 128 文字を超えています。  
  
- または - 
 <paramref name="newPasswordQuestion" /> が空の文字列であるか、または 256 文字を超えています。  
  
- または - 
 <paramref name="newPasswordAnswer" /> が空の文字列であるか、または 128 文字を超えています。  
  
- または - 
エンコードされた <paramref name="newPasswordAnswer" /> の長さが 128 文字を超えています。</exception>
        <exception cref="T:System.ArgumentNullException"><paramref name="username" /> が <see langword="null" /> です。  
  
- または - 
 <paramref name="password" /> は <see langword="null" />です。  
  
- または - 
 <paramref name="newPasswordQuestion" /> が <see langword="null" /> で、<see cref="P:System.Web.Security.SqlMembershipProvider.RequiresQuestionAndAnswer" /> が <see langword="true" /> です。  
  
- または - 
 <paramref name="newPasswordAnswer" /> が <see langword="null" /> で、<see cref="P:System.Web.Security.SqlMembershipProvider.RequiresQuestionAndAnswer" /> が <see langword="true" /> です。</exception>
        <exception cref="T:System.Configuration.Provider.ProviderException">データベースでパスワードの質問と解答を変更しているときにエラーが発生しました。</exception>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)">ASP.NET メンバーシップの概要</related>
      </Docs>
    </Member>
    <Member MemberName="CreateUser">
      <MemberSignature Language="C#" Value="public override System.Web.Security.MembershipUser CreateUser (string username, string password, string email, string passwordQuestion, string passwordAnswer, bool isApproved, object providerUserKey, out System.Web.Security.MembershipCreateStatus status);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance class System.Web.Security.MembershipUser CreateUser(string username, string password, string email, string passwordQuestion, string passwordAnswer, bool isApproved, object providerUserKey, [out] valuetype System.Web.Security.MembershipCreateStatus&amp; status) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.SqlMembershipProvider.CreateUser(System.String,System.String,System.String,System.String,System.String,System.Boolean,System.Object,System.Web.Security.MembershipCreateStatus@)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function CreateUser (username As String, password As String, email As String, passwordQuestion As String, passwordAnswer As String, isApproved As Boolean, providerUserKey As Object, ByRef status As MembershipCreateStatus) As MembershipUser" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override System::Web::Security::MembershipUser ^ CreateUser(System::String ^ username, System::String ^ password, System::String ^ email, System::String ^ passwordQuestion, System::String ^ passwordAnswer, bool isApproved, System::Object ^ providerUserKey, [Runtime::InteropServices::Out] System::Web::Security::MembershipCreateStatus % status);" />
      <MemberSignature Language="F#" Value="override this.CreateUser : string * string * string * string * string * bool * obj * MembershipCreateStatus -&gt; System.Web.Security.MembershipUser" Usage="sqlMembershipProvider.CreateUser (username, password, email, passwordQuestion, passwordAnswer, isApproved, providerUserKey, status)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Web.Security.MembershipUser</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="username" Type="System.String" />
        <Parameter Name="password" Type="System.String" />
        <Parameter Name="email" Type="System.String" />
        <Parameter Name="passwordQuestion" Type="System.String" />
        <Parameter Name="passwordAnswer" Type="System.String" />
        <Parameter Name="isApproved" Type="System.Boolean" />
        <Parameter Name="providerUserKey" Type="System.Object" />
        <Parameter Name="status" Type="System.Web.Security.MembershipCreateStatus" RefType="out" />
      </Parameters>
      <Docs>
        <param name="username">新しいユーザーのユーザー名。</param>
        <param name="password">新しいユーザーのパスワード。</param>
        <param name="email">新しいユーザーの電子メール アドレス。</param>
        <param name="passwordQuestion">新しいユーザーのパスワードの質問。</param>
        <param name="passwordAnswer">新しいユーザーのパスワードの解答。</param>
        <param name="isApproved">新しいユーザーを承認するかどうか。</param>
        <param name="providerUserKey">SQL Server データベース内のメンバーシップ ユーザーを一意に識別する <see cref="T:System.Guid" />。</param>
        <param name="status">ユーザーが正常に作成されたかどうかを示す <see cref="T:System.Web.Security.MembershipCreateStatus" /> 値の 1 つ。</param>
        <summary>SQL Server メンバーシップ データベースに新しいユーザーを追加します。</summary>
        <returns>新しく作成されたユーザーの <see cref="T:System.Web.Security.MembershipUser" /> オブジェクト。 ユーザーが作成されなかった場合、このメソッドは <see langword="null" /> を返します。</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 このメソッドは、ASP.NET アプリケーションの構成ファイルで指定された SQL Server データベースに新しいユーザーを作成するために、<xref:System.Web.Security.Membership> クラスによって呼び出されます。  
  
 新しいユーザーは、構成された <xref:System.Web.Security.SqlMembershipProvider.ApplicationName%2A>で識別されます。  
  
 <xref:System.Web.Security.SqlMembershipProvider.RequiresUniqueEmail%2A> プロパティが `true`に設定されていて、`email` パラメーターに `null` または空の文字列 ("") が指定されている場合、ユーザーの作成は失敗します。 また、<xref:System.Web.Security.SqlMembershipProvider.RequiresUniqueEmail%2A> プロパティが `true` に設定されていて、`email` パラメーターに指定された値が、構成された <xref:System.Web.Security.SqlMembershipProvider.ApplicationName%2A>のデータベース内の既存のユーザーの電子メールアドレスと重複している場合も、ユーザーの作成は失敗します。  
  
 ユーザー名の最大長は256文字です。 電子メールアドレスの最大長は256文字です。 パスワードがクリアテキストである場合、またはハッシュまたは暗号化された後のパスワードの最大長は128文字です。  
  
 ユーザーの作成が失敗するその他の条件は次のとおりです。  
  
-   `password` パラメーターが `null`か、またはトリミング後の空の文字列です。  
  
-   `password` パラメーターの長さが、<xref:System.Web.Security.SqlMembershipProvider.MinRequiredPasswordLength%2A> プロパティで指定された値未満です。  
  
-   `password` パラメーターのアルファベット以外の文字数が、<xref:System.Web.Security.SqlMembershipProvider.MinRequiredNonAlphanumericCharacters%2A> プロパティで指定された値未満です。  
  
-   `password` パラメーターが <xref:System.Web.Security.SqlMembershipProvider.PasswordStrengthRegularExpression%2A> プロパティの正規表現を満たしていません。  
  
-   カスタムパスワード検証コードは、<xref:System.Web.Security.MembershipProvider.ValidatingPassword> イベント中にユーザーの作成をキャンセルしました。  
  
-   <xref:System.Web.Security.SqlMembershipProvider.RequiresQuestionAndAnswer%2A> プロパティが `true`、`passwordAnswer` パラメーターが `null` か、またはトリミング後の空の文字列です。  
  
-   `passwordAnswer` パラメーターが空の文字列。  
  
-   `passwordAnswer` パラメーターが128文字を超えています。  
  
-   <xref:System.Web.Security.SqlMembershipProvider.RequiresQuestionAndAnswer%2A> プロパティが `true` であり、パスワードの質問が `null` か、またはトリミング後に空の文字列になっています。  
  
-   `passwordQuestion` パラメーターが空の文字列。  
  
-   `passwordQuestion` パラメーターが256文字を超えています。  
  
-   `providerUserKey` パラメーターが <xref:System.Guid?displayProperty=nameWithType>以外の型のオブジェクトに設定されています。  
  
-   `providerUserKey` パラメーターが、既存のユーザーキーと重複しています。  
  
-   `username` パラメーターが、既存のユーザー名と重複しています。  
  
 先頭と末尾のスペースは、すべての文字列パラメーター値から削除されます。  
  
   
  
## Examples  
 次のコード例では、フォーム認証と <xref:System.Web.Security.SqlMembershipProvider>を使用するように構成された ASP.NET アプリケーションの新しいユーザーを作成します。 ユーザーが正常に作成されていない場合は、ユーザーにメッセージが表示されます。 それ以外の場合、ユーザーはアプリケーションのサインインページにリダイレクトされます。  
  
> [!NOTE]
>  このサンプルでは、<xref:System.Web.Security.Membership> クラスを使用して、web.config ファイルの `defaultProvider` として指定された <xref:System.Web.Security.SqlMembershipProvider> を呼び出します。 <xref:System.Web.Security.SqlMembershipProvider>型として既定のプロバイダーにアクセスする必要がある場合は、<xref:System.Web.Security.Membership> クラスの <xref:System.Web.Security.Membership.Provider%2A> プロパティをキャストできます。 特定のプロバイダーの種類として構成されている他のプロバイダーにアクセスするには、構成された名前で <xref:System.Web.Security.Membership> クラスの <xref:System.Web.Security.Membership.Providers%2A> プロパティを使用してアクセスし、特定のプロバイダーの種類としてキャストします。  
  
 [!code-aspx-csharp[System.Web.Security.SqlMembershipProvider#2](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.Security.SqlMembershipProvider/CS/CreateUsercs.aspx#2)]
 [!code-aspx-vb[System.Web.Security.SqlMembershipProvider#2](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.Security.SqlMembershipProvider/VB/CreateUservb.aspx#2)]  
  
 ]]></format>
        </remarks>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)">ASP.NET メンバーシップの概要</related>
      </Docs>
    </Member>
    <Member MemberName="DeleteUser">
      <MemberSignature Language="C#" Value="public override bool DeleteUser (string username, bool deleteAllRelatedData);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance bool DeleteUser(string username, bool deleteAllRelatedData) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.SqlMembershipProvider.DeleteUser(System.String,System.Boolean)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function DeleteUser (username As String, deleteAllRelatedData As Boolean) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override bool DeleteUser(System::String ^ username, bool deleteAllRelatedData);" />
      <MemberSignature Language="F#" Value="override this.DeleteUser : string * bool -&gt; bool" Usage="sqlMembershipProvider.DeleteUser (username, deleteAllRelatedData)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="username" Type="System.String" />
        <Parameter Name="deleteAllRelatedData" Type="System.Boolean" />
      </Parameters>
      <Docs>
        <param name="username">削除するユーザーの名前。</param>
        <param name="deleteAllRelatedData">データベースからユーザーに関連するデータを削除するには <see langword="true" />。データベース内のユーザーに関連するデータをそのままにするには <see langword="false" />。</param>
        <summary>SQL Server メンバーシップ データベースからユーザーのメンバーシップ情報を削除します。</summary>
        <returns>ユーザーが削除された場合は <see langword="true" />。それ以外の場合は <see langword="false" />。 ユーザーがデータベース内に存在しない場合にも <see langword="false" /> 値が戻ります。</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 このメソッドは、ASP.NET アプリケーションの構成ファイルで指定されている SQL Server データベースからユーザーを削除するために、<xref:System.Web.Security.Membership> クラスによって呼び出されます。  
  
 削除されたユーザーは、構成された <xref:System.Web.Security.SqlMembershipProvider.ApplicationName%2A>からのみ削除されます。  
  
 `deleteAllRelatedData` が `true`に設定されている場合、<xref:System.Web.Security.Roles>、<xref:System.Web.HttpContext.Profile%2A>、または <xref:System.Web.UI.WebControls.WebParts.WebPart> パーソナル化機能のデータベースに格納されているすべてのユーザーデータも、構成されている <xref:System.Web.Security.SqlMembershipProvider.ApplicationName%2A>で削除されます。  
  
 メンバーシップユーザーがデータベース内に存在せず `deleteAllRelatedData` が `true`場合、関連するデータと、<xref:System.Web.Security.Roles>、<xref:System.Web.HttpContext.Profile%2A>、または <xref:System.Web.UI.WebControls.WebParts.WebPart> の個人用設定機能に格納されているユーザー情報は、「」で指定されているアプリケーションに対して引き続き削除されます。<xref:System.Web.Security.SqlMembershipProvider.ApplicationName%2A> プロパティです。 その結果、<xref:System.Web.Security.SqlMembershipProvider> オブジェクトが認証済みのユーザー情報の格納に使用されていない場合でも、<xref:System.Web.Security.SqlMembershipProvider.DeleteUser%2A> メソッドを使用して、ユーザーに関連する情報をすばやく削除できます。  
  
 `username` パラメーター値の先頭と末尾の空白はトリムされます。  
  
   
  
## Examples  
 次のコード例では、現在ログオンしているユーザーを削除します。  
  
> [!NOTE]
>  この例では、<xref:System.Web.Security.SqlMembershipProvider> を使用して、web.config ファイルの `defaultProvider` として指定された <xref:System.Web.Security.SqlMembershipProvider> を呼び出します。 <xref:System.Web.Security.SqlMembershipProvider>型として既定のプロバイダーにアクセスする必要がある場合は、<xref:System.Web.Security.Membership> クラスの <xref:System.Web.Security.Membership.Provider%2A> プロパティをキャストできます。 特定のプロバイダーの種類として構成されている他のプロバイダーにアクセスするには、構成された名前で <xref:System.Web.Security.Membership> クラスの <xref:System.Web.Security.Membership.Providers%2A> プロパティを使用してアクセスし、特定のプロバイダーの種類としてキャストします。  
  
 [!code-aspx-csharp[System.Web.Security.SqlMembershipProvider#6](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.Security.SqlMembershipProvider/CS/DeleteUsercs.aspx#6)]
 [!code-aspx-vb[System.Web.Security.SqlMembershipProvider#6](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.Security.SqlMembershipProvider/VB/DeleteUservb.aspx#6)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><paramref name="username" /> が空の文字列 ("") であるか、コンマを含んでいるか、または 256 文字を超えています。</exception>
        <exception cref="T:System.ArgumentNullException"><paramref name="username" /> は <see langword="null" />です。</exception>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)">ASP.NET メンバーシップの概要</related>
      </Docs>
    </Member>
    <Member MemberName="EnablePasswordReset">
      <MemberSignature Language="C#" Value="public override bool EnablePasswordReset { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool EnablePasswordReset" />
      <MemberSignature Language="DocId" Value="P:System.Web.Security.SqlMembershipProvider.EnablePasswordReset" />
      <MemberSignature Language="VB.NET" Value="Public Overrides ReadOnly Property EnablePasswordReset As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual property bool EnablePasswordReset { bool get(); };" />
      <MemberSignature Language="F#" Value="member this.EnablePasswordReset : bool" Usage="System.Web.Security.SqlMembershipProvider.EnablePasswordReset" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>get: System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>SQL Server メンバーシップ プロバイダーによってユーザーにパスワードのリセットが許可されているかどうかを示す値を取得します。</summary>
        <value>メンバーシップ プロバイダーがパスワードのリセットをサポートしている場合は <see langword="true" />、そうでない場合は <see langword="false" />。 既定値は、<see langword="true" /> です。</value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 パスワードリセットを使用すると、メンバーシッププロバイダーは、ユーザー名の現在のパスワードをランダムに生成された新しいパスワードに置き換えることができます。 これは、ユーザーがハッシュされたパスワード値を取得できないため、<xref:System.Web.Security.SqlMembershipProvider.PasswordFormat%2A> プロパティが <xref:System.Web.Security.MembershipPasswordFormat.Hashed>に設定されている場合に特に便利です。  
  
   
  
## Examples  
 ASP.NET アプリケーションの web.config ファイルの `system.web` セクションの[membership](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/1b9hw62f(v%3dvs.100))要素のコード例を次に示します。 これにより、アプリケーションの <xref:System.Web.Security.SqlMembershipProvider> インスタンスが指定され、パスワードのリセットが有効になります。  
  
```  
<membership defaultProvider="SqlProvider" userIsOnlineTimeWindow="20">  
  <providers>  
    <add name="SqlProvider"  
      type="System.Web.Security.SqlMembershipProvider"  
      connectionStringName="SqlServices"  
      enablePasswordRetrieval="false"  
      enablePasswordReset="true"  
      requiresQuestionAndAnswer="true"  
      passwordFormat="Hashed"  
      applicationName="MyApplication" />  
  </providers>  
</membership>  
```  
  
 ]]></format>
        </remarks>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)">ASP.NET メンバーシップの概要</related>
      </Docs>
    </Member>
    <Member MemberName="EnablePasswordRetrieval">
      <MemberSignature Language="C#" Value="public override bool EnablePasswordRetrieval { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool EnablePasswordRetrieval" />
      <MemberSignature Language="DocId" Value="P:System.Web.Security.SqlMembershipProvider.EnablePasswordRetrieval" />
      <MemberSignature Language="VB.NET" Value="Public Overrides ReadOnly Property EnablePasswordRetrieval As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual property bool EnablePasswordRetrieval { bool get(); };" />
      <MemberSignature Language="F#" Value="member this.EnablePasswordRetrieval : bool" Usage="System.Web.Security.SqlMembershipProvider.EnablePasswordRetrieval" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>get: System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>SQL Server メンバーシップ プロバイダーによってユーザーにパスワードの取得が許可されているかどうかを示す値を取得します。</summary>
        <value>メンバーシップ プロバイダーがパスワードの取得をサポートしている場合は <see langword="true" />。それ以外の場合は <see langword="false" />。 既定値は、<see langword="false" /> です。</value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <xref:System.Web.Security.SqlMembershipProvider.PasswordFormat%2A> プロパティが <xref:System.Web.Security.MembershipPasswordFormat.Hashed>に設定されている場合、ユーザーはデータベースから既存のパスワードを取得することはできません。 <xref:System.Web.Security.MembershipPasswordFormat.Hashed> パスワード形式では、パスワード値の一方向のエンコードが提供されます。 パスワードは、ランダムに生成された salt 値を使用してハッシュされ、認証のためにデータベースに格納されている値と比較されます。 ハッシュされた値をエンコードして元のパスワード値を取得することはできません。  
  
 <xref:System.Web.Security.SqlMembershipProvider.PasswordFormat%2A> プロパティが <xref:System.Web.Security.MembershipPasswordFormat.Hashed>に設定されていて、<xref:System.Web.Security.SqlMembershipProvider.EnablePasswordRetrieval%2A> が `true`に設定されている場合、プロバイダーが初期化されるときに <xref:System.Configuration.Provider.ProviderException> がスローされます。  
  
   
  
## Examples  
 ASP.NET アプリケーションの web.config ファイルの `system.web` セクションの[membership](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/1b9hw62f(v%3dvs.100))要素のコード例を次に示します。 これにより、アプリケーションの <xref:System.Web.Security.SqlMembershipProvider> インスタンスが指定され、パスワードの取得が有効になります。  
  
```  
<membership defaultProvider="SqlProvider" userIsOnlineTimeWindow="20">  
  <providers>  
    <add name="SqlProvider"  
      type="System.Web.Security.SqlMembershipProvider"  
      connectionStringName="SqlServices"  
      enablePasswordRetrieval="true"  
      enablePasswordReset="false"  
      requiresQuestionAndAnswer="false"  
      passwordFormat="Encrypted"  
      applicationName="MyApplication" />  
  </providers>  
</membership>  
```  
  
 ]]></format>
        </remarks>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)">ASP.NET メンバーシップの概要</related>
      </Docs>
    </Member>
    <Member MemberName="FindUsersByEmail">
      <MemberSignature Language="C#" Value="public override System.Web.Security.MembershipUserCollection FindUsersByEmail (string emailToMatch, int pageIndex, int pageSize, out int totalRecords);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance class System.Web.Security.MembershipUserCollection FindUsersByEmail(string emailToMatch, int32 pageIndex, int32 pageSize, [out] int32&amp; totalRecords) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.SqlMembershipProvider.FindUsersByEmail(System.String,System.Int32,System.Int32,System.Int32@)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function FindUsersByEmail (emailToMatch As String, pageIndex As Integer, pageSize As Integer, ByRef totalRecords As Integer) As MembershipUserCollection" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override System::Web::Security::MembershipUserCollection ^ FindUsersByEmail(System::String ^ emailToMatch, int pageIndex, int pageSize, [Runtime::InteropServices::Out] int % totalRecords);" />
      <MemberSignature Language="F#" Value="override this.FindUsersByEmail : string * int * int * int -&gt; System.Web.Security.MembershipUserCollection" Usage="sqlMembershipProvider.FindUsersByEmail (emailToMatch, pageIndex, pageSize, totalRecords)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Web.Security.MembershipUserCollection</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="emailToMatch" Type="System.String" />
        <Parameter Name="pageIndex" Type="System.Int32" />
        <Parameter Name="pageSize" Type="System.Int32" />
        <Parameter Name="totalRecords" Type="System.Int32" RefType="out" />
      </Parameters>
      <Docs>
        <param name="emailToMatch">検索対象の電子メール アドレス。</param>
        <param name="pageIndex">返される結果ページのインデックス。 <paramref name="pageIndex" /> は 0 から始まります。</param>
        <param name="pageSize">返される結果ページのサイズ。</param>
        <param name="totalRecords">一致したユーザーの合計数。</param>
        <summary>電子メール アドレス フィールドに指定の電子メール アドレスが格納されたメンバーシップ ユーザーのコレクションを返します。</summary>
        <returns><paramref name="pageSize" /> で指定されたページから始まる <paramref name="pageIndex" /><see cref="T:System.Web.Security.MembershipUserCollection" /> オブジェクトのページを格納している <see cref="T:System.Web.Security.MembershipUser" />。</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <xref:System.Web.Security.SqlMembershipProvider.FindUsersByEmail%2A> は、構成された <xref:System.Web.Security.SqlMembershipProvider.ApplicationName%2A>の指定した `emailToMatch` と一致する電子メールアドレスを持つメンバーシップユーザーの一覧を返します。  
  
 <xref:System.Web.Security.SqlMembershipProvider> は、LIKE 句を使用して、`emailToMatch` パラメーター値と一致するユーザー名を検索します。 SQL Server のワイルドカード文字をパラメーター値に含めることができます。 たとえば、`emailToMatch` パラメーターが "address@example.com" に設定されている場合は、電子メールアドレスが "address@example.com" のユーザーに関する情報が返されます (存在する場合)。 `emailToMatch` パラメーターが "%@example.com" に設定されている場合、電子メールアドレスが "address@example.com"、"address2@example.com"、"admin@example.com" などのユーザーに関する情報が返されます。  
  
 <xref:System.Web.Security.SqlMembershipProvider.FindUsersByEmail%2A> によって返される結果は、`pageIndex` パラメーターと `pageSize` パラメーターによって制限されます。 `pageSize` パラメーターは、<xref:System.Web.Security.MembershipUserCollection>で返す <xref:System.Web.Security.MembershipUser> オブジェクトの最大数を指定します。 `pageIndex` パラメーターは、返される結果のページを識別します。0は最初のページを示します。 `totalRecords` パラメーターは、構成された `applicationName`のメンバーシップユーザーの合計数に設定された `out` パラメーターです。 たとえば、構成された `applicationName`に13人のユーザーがいて、`pageIndex` 値が1で `pageSize` が5の場合、返される <xref:System.Web.Security.MembershipUserCollection> には 6 ~ 10 人のユーザーが返されます。 `totalRecords` パラメーターは13に設定されます。  
  
 `emailToMatch` パラメーター値の先頭と末尾の空白はトリムされます。  
  
   
  
## Examples  
 次のコード例では、<xref:System.Web.Security.SqlMembershipProvider.FindUsersByEmail%2A> メソッドを使用してメンバーシップユーザー情報を取得し、データのページに結果を表示します。  
  
> [!NOTE]
>  この例では、<xref:System.Web.Security.Membership> クラスを使用して、web.config ファイルの `defaultProvider` として指定された <xref:System.Web.Security.SqlMembershipProvider> を呼び出します。 <xref:System.Web.Security.SqlMembershipProvider>型として既定のプロバイダーにアクセスする必要がある場合は、<xref:System.Web.Security.Membership> クラスの <xref:System.Web.Security.Membership.Provider%2A> プロパティをキャストできます。 特定のプロバイダーの種類として構成されている他のプロバイダーにアクセスするには、構成された名前で <xref:System.Web.Security.Membership> クラスの <xref:System.Web.Security.Membership.Providers%2A> プロパティを使用してアクセスし、特定のプロバイダーの種類としてキャストします。  
  
 [!code-aspx-csharp[System.Web.Security.SqlMembershipProvider#13](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.Security.SqlMembershipProvider/CS/FindUsersByEmailcs.aspx#13)]
 [!code-aspx-vb[System.Web.Security.SqlMembershipProvider#13](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.Security.SqlMembershipProvider/VB/FindUsersByEmailvb.aspx#13)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><paramref name="emailToMatch" /> が 256 文字を超えています。  
  
- または - 
 <paramref name="pageIndex" /> が 0 未満です。  
  
- または - 
 <paramref name="pageSize" /> が 1 未満です。  
  
- または - 
 <paramref name="pageIndex" /> を <paramref name="pageSize" /> でかけて <paramref name="pageSize" /> を足して 1 を引いた値が <see cref="F:System.Int32.MaxValue" /> を超えています。</exception>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)">ASP.NET メンバーシップの概要</related>
      </Docs>
    </Member>
    <Member MemberName="FindUsersByName">
      <MemberSignature Language="C#" Value="public override System.Web.Security.MembershipUserCollection FindUsersByName (string usernameToMatch, int pageIndex, int pageSize, out int totalRecords);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance class System.Web.Security.MembershipUserCollection FindUsersByName(string usernameToMatch, int32 pageIndex, int32 pageSize, [out] int32&amp; totalRecords) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.SqlMembershipProvider.FindUsersByName(System.String,System.Int32,System.Int32,System.Int32@)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function FindUsersByName (usernameToMatch As String, pageIndex As Integer, pageSize As Integer, ByRef totalRecords As Integer) As MembershipUserCollection" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override System::Web::Security::MembershipUserCollection ^ FindUsersByName(System::String ^ usernameToMatch, int pageIndex, int pageSize, [Runtime::InteropServices::Out] int % totalRecords);" />
      <MemberSignature Language="F#" Value="override this.FindUsersByName : string * int * int * int -&gt; System.Web.Security.MembershipUserCollection" Usage="sqlMembershipProvider.FindUsersByName (usernameToMatch, pageIndex, pageSize, totalRecords)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Web.Security.MembershipUserCollection</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="usernameToMatch" Type="System.String" />
        <Parameter Name="pageIndex" Type="System.Int32" />
        <Parameter Name="pageSize" Type="System.Int32" />
        <Parameter Name="totalRecords" Type="System.Int32" RefType="out" />
      </Parameters>
      <Docs>
        <param name="usernameToMatch">検索するユーザー名。</param>
        <param name="pageIndex">返される結果ページのインデックス。 <paramref name="pageIndex" /> は 0 から始まります。</param>
        <param name="pageSize">取得する結果のページのサイズ。</param>
        <param name="totalRecords">このメソッドから制御が戻るとき、一致するユーザーの総数を格納します。</param>
        <summary>ユーザー名が指定内容と一致するメンバーシップ ユーザーのコレクションを取得します。</summary>
        <returns><paramref name="pageSize" /> で指定されたページから始まる <paramref name="pageIndex" /><see cref="T:System.Web.Security.MembershipUserCollection" /> オブジェクトのページを格納している <see cref="T:System.Web.Security.MembershipUser" />。</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <xref:System.Web.Security.SqlMembershipProvider.FindUsersByName%2A> は、構成された <xref:System.Web.Security.SqlMembershipProvider.ApplicationName%2A>に対して指定された `usernameToMatch` と一致するユーザー名を持つメンバーシップユーザーの一覧を返します。  
  
 <xref:System.Web.Security.SqlMembershipProvider> は、LIKE 句を使用して、`usernameToMatch` パラメーター値と一致するユーザー名を検索します。 パラメーター値には SQL Server ワイルドカード文字を含めることができます。 たとえば、`usernameToMatch` パラメーターが "user1" に設定されている場合、ユーザー名が "user1" であるユーザーのユーザー情報が返されます (存在する場合)。 `usernameToMatch` パラメーターが "user%" に設定されている場合は、ユーザー名が "user1"、"user2"、"user_admin" などのユーザーに関するユーザー情報が返されます。  
  
 <xref:System.Web.Security.SqlMembershipProvider.FindUsersByName%2A> によって返される結果は、`pageIndex` パラメーターと `pageSize` パラメーターによって制限されます。 `pageSize` パラメーターは、<xref:System.Web.Security.MembershipUserCollection>で返す <xref:System.Web.Security.MembershipUser> オブジェクトの最大数を指定します。 `pageIndex` パラメーターは、返される結果のページを識別します。0は最初のページを示します。 `totalRecords` パラメーターは、構成された `applicationName`のメンバーシップユーザーの合計数に設定された `out` パラメーターです。 たとえば、構成された `applicationName`に13人のユーザーがいて、`pageIndex` の値が1で `pageSize` が5の場合、返される <xref:System.Web.Security.MembershipUserCollection> には 6 ~ 10 番目のユーザーが返されます。 `totalRecords` パラメーターは13に設定されます。  
  
 `usernameToMatch` パラメーター値の先頭と末尾の空白はトリムされます。  
  
   
  
## Examples  
 次のコード例では、<xref:System.Web.Security.SqlMembershipProvider.FindUsersByName%2A> メソッドを使用してメンバーシップユーザー情報を取得し、データのページに結果を表示します。  
  
> [!NOTE]
>  この例では、SqlMembershipProvider を使用して、web.config ファイルの `defaultProvider` として指定された <xref:System.Web.Security.SqlMembershipProvider> を呼び出します。 <xref:System.Web.Security.SqlMembershipProvider>型として既定のプロバイダーにアクセスする必要がある場合は、<xref:System.Web.Security.Membership> クラスの <xref:System.Web.Security.Membership.Provider%2A> プロパティをキャストできます。 特定のプロバイダーの種類として構成されている他のプロバイダーにアクセスするには、構成された名前で <xref:System.Web.Security.Membership> クラスの <xref:System.Web.Security.Membership.Providers%2A> プロパティを使用してアクセスし、特定のプロバイダーの種類としてキャストします。  
  
 [!code-aspx-csharp[System.Web.Security.SqlMembershipProvider#12](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.Security.SqlMembershipProvider/CS/FindUsersByNamecs.aspx#12)]
 [!code-aspx-vb[System.Web.Security.SqlMembershipProvider#12](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.Security.SqlMembershipProvider/VB/FindUsersByNamevb.aspx#12)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><paramref name="usernameToMatch" /> が空の文字列 ("") であるか、または 256 文字を超えています。  
  
- または - 
 <paramref name="pageIndex" /> が 0 未満です。  
  
- または - 
 <paramref name="pageSize" /> が 1 未満です。  
  
- または - 
 <paramref name="pageIndex" /> を <paramref name="pageSize" /> でかけて <paramref name="pageSize" /> を足して 1 を引いた値が <see cref="F:System.Int32.MaxValue" /> を超えています。</exception>
        <exception cref="T:System.ArgumentNullException"><paramref name="usernameToMatch" /> は <see langword="null" />です。</exception>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)">ASP.NET メンバーシップの概要</related>
      </Docs>
    </Member>
    <Member MemberName="GeneratePassword">
      <MemberSignature Language="C#" Value="public virtual string GeneratePassword ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig newslot virtual instance string GeneratePassword() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.SqlMembershipProvider.GeneratePassword" />
      <MemberSignature Language="VB.NET" Value="Public Overridable Function GeneratePassword () As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual System::String ^ GeneratePassword();" />
      <MemberSignature Language="F#" Value="abstract member GeneratePassword : unit -&gt; string&#xA;override this.GeneratePassword : unit -&gt; string" Usage="sqlMembershipProvider.GeneratePassword " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>14 文字以上のランダム パスワードを生成します。</summary>
        <returns>14 文字以上のランダム パスワード。</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <xref:System.Web.Security.Membership> クラスは <xref:System.Web.Security.Membership.GeneratePassword%2A> メソッドを提供します。これにより、指定したサイズのパスワードが少なくとも指定したアルファベット以外の文字数で生成されます。 <xref:System.Web.Security.SqlMembershipProvider> の <xref:System.Web.Security.SqlMembershipProvider.GeneratePassword%2A> メソッドは、<xref:System.Web.Security.Membership> クラスの <xref:System.Web.Security.Membership.GeneratePassword%2A> メソッドを呼び出して、14文字以上のランダムなパスワードを取得します。 <xref:System.Web.Security.SqlMembershipProvider.MinRequiredPasswordLength%2A> プロパティが14を超える場合、返されるパスワードは <xref:System.Web.Security.SqlMembershipProvider.MinRequiredPasswordLength%2A> プロパティで指定された長さになります。  
  
 具体的には、<xref:System.Web.Security.Membership> クラスの <xref:System.Web.Security.Membership.Provider%2A> プロパティから <xref:System.Web.Security.SqlMembershipProvider> クラスを参照することによって、<xref:System.Web.Security.SqlMembershipProvider.GeneratePassword%2A> メソッドを呼び出すことができます。  
  
 生成されるパスワードには、英数字と次の句読点が含まれています: `!@#$%^&*()_-+=[{]};:<>|./?`。 生成されたパスワードには、表示されない、または印刷できない制御文字は含まれません。  
  
> [!NOTE]
>  <xref:System.Web.Security.SqlMembershipProvider.GeneratePassword%2A> メソッドによって作成されたランダムパスワードは、<xref:System.Web.Security.SqlMembershipProvider.PasswordStrengthRegularExpression%2A> プロパティに正規表現を渡すことは保証されていません。 ただし、ランダムなパスワードは、<xref:System.Web.Security.SqlMembershipProvider.MinRequiredPasswordLength%2A> および <xref:System.Web.Security.SqlMembershipProvider.MinRequiredNonAlphanumericCharacters%2A> プロパティによって設定された条件を満たします。  
  
   
  
## Examples  
 次のコード例では、ランダムな10文字のパスワードが生成されます。  
  
 [!code-csharp[System.Web.Security.SqlMembershipProvider#9](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.Security.SqlMembershipProvider/CS/GeneratePasswordcs.aspx#9)]
 [!code-vb[System.Web.Security.SqlMembershipProvider#9](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.Security.SqlMembershipProvider/VB/GeneratePasswordvb.aspx#9)]  
  
 ]]></format>
        </remarks>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)">ASP.NET メンバーシップの概要</related>
      </Docs>
    </Member>
    <Member MemberName="GetAllUsers">
      <MemberSignature Language="C#" Value="public override System.Web.Security.MembershipUserCollection GetAllUsers (int pageIndex, int pageSize, out int totalRecords);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance class System.Web.Security.MembershipUserCollection GetAllUsers(int32 pageIndex, int32 pageSize, [out] int32&amp; totalRecords) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.SqlMembershipProvider.GetAllUsers(System.Int32,System.Int32,System.Int32@)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function GetAllUsers (pageIndex As Integer, pageSize As Integer, ByRef totalRecords As Integer) As MembershipUserCollection" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override System::Web::Security::MembershipUserCollection ^ GetAllUsers(int pageIndex, int pageSize, [Runtime::InteropServices::Out] int % totalRecords);" />
      <MemberSignature Language="F#" Value="override this.GetAllUsers : int * int * int -&gt; System.Web.Security.MembershipUserCollection" Usage="sqlMembershipProvider.GetAllUsers (pageIndex, pageSize, totalRecords)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Web.Security.MembershipUserCollection</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="pageIndex" Type="System.Int32" />
        <Parameter Name="pageSize" Type="System.Int32" />
        <Parameter Name="totalRecords" Type="System.Int32" RefType="out" />
      </Parameters>
      <Docs>
        <param name="pageIndex">返される結果ページのインデックス。 <paramref name="pageIndex" /> は 0 から始まります。</param>
        <param name="pageSize">返される結果ページのサイズ。</param>
        <param name="totalRecords">一致したユーザーの総数。</param>
        <summary>SQL Server メンバーシップ データベース内のすべてのユーザーのコレクションを取得します。</summary>
        <returns>構成されている <see cref="T:System.Web.Security.MembershipUserCollection" /> に対応した、データベース内のすべてのユーザーを表す <see cref="T:System.Web.Security.MembershipUser" /> オブジェクトの <see cref="P:System.Web.Security.SqlMembershipProvider.ApplicationName" />。</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 このメソッドは、ASP.NET アプリケーションの構成ファイル (Web.config) で指定された SQL Server データベースからユーザー情報を取得するために <xref:System.Web.Security.Membership> クラスによって呼び出されます。  
  
 <xref:System.Web.Security.SqlMembershipProvider.GetAllUsers%2A> によって返される結果は、`pageIndex` パラメーターと `pageSize` パラメーターによって制限されます。 `pageSize` パラメーターは、<xref:System.Web.Security.MembershipUserCollection>で返す <xref:System.Web.Security.MembershipUser> オブジェクトの最大数を指定します。 `pageIndex` パラメーターは、返される結果のページを識別します。0は最初のページを示します。 `totalRecords` パラメーターは、構成された `applicationName`のメンバーシップユーザーの合計数に設定された `out` パラメーターです。 たとえば、構成された `applicationName`に13人のユーザーがいて、`pageIndex` の値が1で `pageSize` が5の場合、返される <xref:System.Web.Security.MembershipUserCollection> には 6 ~ 10 番目のユーザーが返されます。 `totalRecords` パラメーターは13に設定されます。  
  
   
  
## Examples  
 次のコード例では、データのページにあるユーザーの一覧を、現在オンラインになっているユーザーの数と共に返します。  
  
> [!NOTE]
>  この例では、<xref:System.Web.Security.Membership> クラスを使用して、web.config ファイルの `defaultProvider` として指定された <xref:System.Web.Security.SqlMembershipProvider> を呼び出します。 <xref:System.Web.Security.SqlMembershipProvider>型として既定のプロバイダーにアクセスする必要がある場合は、<xref:System.Web.Security.Membership> クラスの <xref:System.Web.Security.Membership.Provider%2A> プロパティをキャストできます。 特定のプロバイダーの種類として構成されている他のプロバイダーにアクセスするには、構成された名前で <xref:System.Web.Security.Membership> クラスの <xref:System.Web.Security.Membership.Providers%2A> プロパティを使用してアクセスし、特定のプロバイダーの種類としてキャストします。  
  
 [!code-aspx-csharp[System.Web.Security.SqlMembershipProvider#5](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.Security.SqlMembershipProvider/CS/ShowUserscs.aspx#5)]
 [!code-aspx-vb[System.Web.Security.SqlMembershipProvider#5](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.Security.SqlMembershipProvider/VB/ShowUsersvb.aspx#5)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><paramref name="pageIndex" /> が 0 未満です。  
  
- または - 
 <paramref name="pageSize" /> が 1 未満です。  
  
- または - 
 <paramref name="pageIndex" /> を <paramref name="pageSize" /> でかけて <paramref name="pageSize" /> を足して 1 を引いた値が <see cref="F:System.Int32.MaxValue" /> を超えています。</exception>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)">ASP.NET メンバーシップの概要</related>
      </Docs>
    </Member>
    <Member MemberName="GetNumberOfUsersOnline">
      <MemberSignature Language="C#" Value="public override int GetNumberOfUsersOnline ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance int32 GetNumberOfUsersOnline() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.SqlMembershipProvider.GetNumberOfUsersOnline" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function GetNumberOfUsersOnline () As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override int GetNumberOfUsersOnline();" />
      <MemberSignature Language="F#" Value="override this.GetNumberOfUsersOnline : unit -&gt; int" Usage="sqlMembershipProvider.GetNumberOfUsersOnline " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>アプリケーションに現在アクセスしているユーザーの数を返します。</summary>
        <returns>アプリケーションに現在アクセスしているユーザーの数。</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 このメソッドは <xref:System.Web.Security.Membership> クラスによって呼び出され、ASP.NET アプリケーションの構成ファイル (Web.config) で指定された SQL Server データベースからオンラインと見なされるユーザーの数を取得します。  
  
 <xref:System.Web.Security.SqlMembershipProvider.GetNumberOfUsersOnline%2A> は、現在のアプリケーションの最後のアクティビティの日付と時刻が、現在の日付と時刻よりも後の <xref:System.Web.Security.Membership.UserIsOnlineTimeWindow%2A> プロパティの値 (分) を超えているユーザーの数を返します。  
  
 構成された <xref:System.Web.Security.SqlMembershipProvider.ApplicationName%2A> に関連付けられているユーザーのみがカウントされます。  
  
   
  
## Examples  
 次のコード例では、現在オンラインになっているユーザーの数を持つユーザーの一覧を返します。  
  
> [!NOTE]
>  この例では、<xref:System.Web.Security.Membership> クラスを使用して、web.config ファイルの `defaultProvider` として指定された <xref:System.Web.Security.SqlMembershipProvider> を呼び出します。 <xref:System.Web.Security.SqlMembershipProvider>型として既定のプロバイダーにアクセスする必要がある場合は、<xref:System.Web.Security.Membership> クラスの <xref:System.Web.Security.Membership.Provider%2A> プロパティをキャストできます。 特定のプロバイダーの種類として構成されている他のプロバイダーにアクセスするには、構成された名前で <xref:System.Web.Security.Membership> クラスの <xref:System.Web.Security.Membership.Providers%2A> プロパティを使用してアクセスし、特定のプロバイダーの種類としてキャストします。  
  
 [!code-aspx-csharp[System.Web.Security.SqlMembershipProvider#5](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.Security.SqlMembershipProvider/CS/ShowUserscs.aspx#5)]
 [!code-aspx-vb[System.Web.Security.SqlMembershipProvider#5](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.Security.SqlMembershipProvider/VB/ShowUsersvb.aspx#5)]  
  
 ]]></format>
        </remarks>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)">ASP.NET メンバーシップの概要</related>
      </Docs>
    </Member>
    <Member MemberName="GetPassword">
      <MemberSignature Language="C#" Value="public override string GetPassword (string username, string passwordAnswer);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance string GetPassword(string username, string passwordAnswer) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.SqlMembershipProvider.GetPassword(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function GetPassword (username As String, passwordAnswer As String) As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override System::String ^ GetPassword(System::String ^ username, System::String ^ passwordAnswer);" />
      <MemberSignature Language="F#" Value="override this.GetPassword : string * string -&gt; string" Usage="sqlMembershipProvider.GetPassword (username, passwordAnswer)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="username" Type="System.String" />
        <Parameter Name="passwordAnswer" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="username">パスワードを取得する対象となるユーザー。</param>
        <param name="passwordAnswer">ユーザーのパスワードの解答。</param>
        <summary>SQL Server メンバーシップ データベースから指定のユーザー名のパスワードを返します。</summary>
        <returns>指定したユーザー名のパスワード。</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 このメソッドは、ASP.NET アプリケーションの構成ファイル (Web.config) で指定された SQL Server データベースからユーザーのパスワードを取得するために、<xref:System.Web.Security.MembershipUser> クラスによって呼び出されます。  
  
 <xref:System.Web.Security.SqlMembershipProvider.GetPassword%2A> メソッドに間違ったパスワードの解答が指定された場合、無効なパスワード回答の試行を追跡する内部カウンターは1つずつ増加します。 これにより、ユーザーがロックアウトされ、<xref:System.Web.Security.SqlMembershipProvider.UnlockUser%2A> メソッドの呼び出しによってロックの状態がクリアされるまで、ユーザーがログオンできなくなる可能性があります。 正しいパスワードの解答が指定されていて、ユーザーが現在ロックアウトされていない場合、無効なパスワードの解答の試行を追跡する内部カウンターは0にリセットされます。 詳細については、「<xref:System.Web.Security.SqlMembershipProvider.MaxInvalidPasswordAttempts%2A> と <xref:System.Web.Security.SqlMembershipProvider.PasswordAttemptWindow%2A> のプロパティ」を参照してください。  
  
 最初に <xref:System.Web.Security.Membership> クラスの <xref:System.Web.Security.Membership.Provider%2A> プロパティを使用して <xref:System.Web.Security.SqlMembershipProvider> インスタンスへの参照を取得することで、<xref:System.Web.Security.SqlMembershipProvider.GetPassword%2A> メソッドを直接呼び出すことができます。  
  
 <xref:System.Web.Security.SqlMembershipProvider.PasswordFormat%2A> プロパティが <xref:System.Web.Security.MembershipPasswordFormat.Hashed>に設定されている場合、<xref:System.Web.Security.SqlMembershipProvider.GetPassword%2A> メソッドはパスワードを取得できません。 ハッシュされたパスワードは一方向に暗号化され、暗号化を解除することはできません。 <xref:System.Web.Security.SqlMembershipProvider.PasswordFormat%2A> プロパティが <xref:System.Web.Security.MembershipPasswordFormat.Hashed>に設定されていて、<xref:System.Web.Security.SqlMembershipProvider.EnablePasswordRetrieval%2A> が `true`に設定されている場合、プロバイダーが初期化されるときに <xref:System.Configuration.Provider.ProviderException> がスローされます。  
  
 先頭と末尾のスペースは、すべてのパラメーター値から削除されます。  
  
   
  
## Examples  
 次のコード例では、指定されたユーザー名のパスワードを取得し、電子メールメッセージでユーザーに送信します。  
  
> [!NOTE]
>  高レベルのセキュリティを必要とするサイトでは、電子メールを使用してクリアテキストでパスワードを返すことはお勧めしません。 高セキュリティサイトの場合は、SSL などの暗号化を使用してパスワードを返すことをお勧めします。  
  
> [!NOTE]
>  このサンプルでは、<xref:System.Web.Security.Membership> クラスを使用して、web.config ファイルの `defaultProvider` として指定された <xref:System.Web.Security.SqlMembershipProvider> を呼び出します。 <xref:System.Web.Security.SqlMembershipProvider>型として既定のプロバイダーにアクセスする必要がある場合は、<xref:System.Web.Security.Membership> クラスの <xref:System.Web.Security.Membership.Provider%2A> プロパティをキャストできます。 特定のプロバイダーの種類として構成されている他のプロバイダーにアクセスするには、構成された名前で <xref:System.Web.Security.Membership> クラスの <xref:System.Web.Security.Membership.Providers%2A> プロパティを使用してアクセスし、特定のプロバイダーの種類としてキャストします。  
  
 [!code-aspx-csharp[System.Web.Security.SqlMembershipProvider#4](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.Security.SqlMembershipProvider/CS/RetrievePasswordcs.aspx#4)]
 [!code-aspx-vb[System.Web.Security.SqlMembershipProvider#4](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.Security.SqlMembershipProvider/VB/RetrievePasswordvb.aspx#4)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Web.Security.MembershipPasswordException"><paramref name="passwordAnswer" /> が無効です。  
  
- または - 
<paramref name="username" /> で識別されるメンバーシップ ユーザーはロックされています。</exception>
        <exception cref="T:System.NotSupportedException"><see cref="P:System.Web.Security.SqlMembershipProvider.EnablePasswordRetrieval" /> が <see langword="false" /> に設定されます。</exception>
        <exception cref="T:System.Configuration.Provider.ProviderException"><paramref name="username" /> がメンバーシップ データベース内に見つかりません。  
  
- または - 
データベースからパスワードを取得しているときにエラーが発生しました。</exception>
        <exception cref="T:System.ArgumentException">パラメーター値の 1 つが最大長を超えています。  
  
- または - 
 <paramref name="username" /> が空の文字列 ("") であるか、コンマを含んでいるか、または 256 文字を超えています。  
  
- または - 
 <paramref name="passwordAnswer" /> が空の文字列で <see cref="P:System.Web.Security.SqlMembershipProvider.RequiresQuestionAndAnswer" /> が <see langword="true" /> です。  
  
- または - 
 <paramref name="passwordAnswer" /> が 128 文字を超えています。  
  
- または - 
エンコードされた <paramref name="passwordAnswer" /> の長さが 128 文字を超えています。</exception>
        <exception cref="T:System.ArgumentNullException"><paramref name="username" /> は <see langword="null" />です。  
  
- または - 
 <paramref name="passwordAnswer" /> が <see langword="null" /> で、<see cref="P:System.Web.Security.SqlMembershipProvider.RequiresQuestionAndAnswer" /> が <see langword="true" /> です。</exception>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)">ASP.NET メンバーシップの概要</related>
      </Docs>
    </Member>
    <MemberGroup MemberName="GetUser">
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>データ ソースからメンバーシップ ユーザーの情報を取得します。</summary>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)">ASP.NET メンバーシップの概要</related>
      </Docs>
    </MemberGroup>
    <Member MemberName="GetUser">
      <MemberSignature Language="C#" Value="public override System.Web.Security.MembershipUser GetUser (object providerUserKey, bool userIsOnline);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance class System.Web.Security.MembershipUser GetUser(object providerUserKey, bool userIsOnline) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.SqlMembershipProvider.GetUser(System.Object,System.Boolean)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function GetUser (providerUserKey As Object, userIsOnline As Boolean) As MembershipUser" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override System::Web::Security::MembershipUser ^ GetUser(System::Object ^ providerUserKey, bool userIsOnline);" />
      <MemberSignature Language="F#" Value="override this.GetUser : obj * bool -&gt; System.Web.Security.MembershipUser" Usage="sqlMembershipProvider.GetUser (providerUserKey, userIsOnline)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Web.Security.MembershipUser</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="providerUserKey" Type="System.Object" />
        <Parameter Name="userIsOnline" Type="System.Boolean" />
      </Parameters>
      <Docs>
        <param name="providerUserKey">ユーザーの一意の識別子。</param>
        <param name="userIsOnline">指定したユーザーの最終利用日時スタンプを更新する場合は <see langword="true" />。それ以外の場合は <see langword="false" />。</param>
        <summary>データ ソースから、指定されている一意の識別子に関連付けられているメンバーシップ ユーザーの情報を取得し、指定内容に応じて、そのユーザーの最終利用日時スタンプを更新します。</summary>
        <returns>指定した一意の ID に関連付けられているユーザーを表す <see cref="T:System.Web.Security.MembershipUser" /> オブジェクト。 指定された <paramref name="providerUserKey" /> 値のユーザーがデータベースに見つからない場合、<see langword="null" /> が返されます。</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <xref:System.Web.Security.Membership.GetUser%2A> データソースからユーザー情報を取得し、返されたデータを格納する <xref:System.Web.Security.MembershipUser> オブジェクトを作成します。 ユーザーは、`providerUserKey` パラメーターで指定された一意の識別子を使用して識別されます。  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><paramref name="providerUserKey" /> は <see langword="null" />です。</exception>
        <exception cref="T:System.ArgumentException"><paramref name="providerUserKey" /> が <see cref="T:System.Guid" /> 型ではありません。</exception>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)">ASP.NET メンバーシップの概要</related>
      </Docs>
    </Member>
    <Member MemberName="GetUser">
      <MemberSignature Language="C#" Value="public override System.Web.Security.MembershipUser GetUser (string username, bool userIsOnline);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance class System.Web.Security.MembershipUser GetUser(string username, bool userIsOnline) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.SqlMembershipProvider.GetUser(System.String,System.Boolean)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function GetUser (username As String, userIsOnline As Boolean) As MembershipUser" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override System::Web::Security::MembershipUser ^ GetUser(System::String ^ username, bool userIsOnline);" />
      <MemberSignature Language="F#" Value="override this.GetUser : string * bool -&gt; System.Web.Security.MembershipUser" Usage="sqlMembershipProvider.GetUser (username, userIsOnline)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Web.Security.MembershipUser</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="username" Type="System.String" />
        <Parameter Name="userIsOnline" Type="System.Boolean" />
      </Parameters>
      <Docs>
        <param name="username">情報を取得するユーザーの名前。</param>
        <param name="userIsOnline">ユーザーの最終利用日時スタンプを更新する場合は <see langword="true" />。ユーザーの最終利用日時スタンプを更新しないでユーザー情報を返す場合は <see langword="false" />。</param>
        <summary>SQL Server メンバーシップ データベースからユーザー情報を返し、そのユーザーの最終利用日時スタンプを更新するオプションを提供します。</summary>
        <returns>指定されたユーザーを表す <see cref="T:System.Web.Security.MembershipUser" /> オブジェクト。 指定された <paramref name="username" /> 値のユーザーがデータベースに見つからない場合、<see langword="null" /> が返されます。</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 このメソッドは、ASP.NET アプリケーションの構成ファイル (Web.config) で指定された SQL Server データベースからユーザー情報を取得するために <xref:System.Web.Security.Membership> クラスによって呼び出されます。  
  
 `userIsOnline` が `true`場合は、ユーザーの最後のアクティビティの日付/時刻スタンプが現在の日付と時刻に更新されます。 これは、<xref:System.Web.Security.MembershipUser.LastActivityDate%2A> および <xref:System.Web.Security.MembershipUser.IsOnline%2A> のプロパティと、<xref:System.Web.Security.SqlMembershipProvider.GetNumberOfUsersOnline%2A>によって返される値に反映されます。  
  
 `username` パラメーター値の先頭と末尾の空白はトリムされます。  
  
   
  
## Examples  
 次のコード例では、<xref:System.Web.Security.SqlMembershipProvider.GetUser%2A> メソッドを使用して、ユーザーのパスワードを取得する前にユーザーが存在するかどうかを判断します。  
  
> [!NOTE]
>  この例では、<xref:System.Web.Security.Membership> クラスを使用して、web.config ファイルの `defaultProvider` として指定された <xref:System.Web.Security.SqlMembershipProvider> を呼び出します。 <xref:System.Web.Security.SqlMembershipProvider>型として既定のプロバイダーにアクセスする必要がある場合は、<xref:System.Web.Security.Membership> クラスの <xref:System.Web.Security.Membership.Provider%2A> プロパティをキャストできます。 特定のプロバイダーの種類として構成されている他のプロバイダーにアクセスするには、構成された名前で <xref:System.Web.Security.Membership> クラスの <xref:System.Web.Security.Membership.Providers%2A> プロパティを使用してアクセスし、特定のプロバイダーの種類としてキャストします。  
  
 [!code-aspx-csharp[System.Web.Security.SqlMembershipProvider#4](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.Security.SqlMembershipProvider/CS/RetrievePasswordcs.aspx#4)]
 [!code-aspx-vb[System.Web.Security.SqlMembershipProvider#4](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.Security.SqlMembershipProvider/VB/RetrievePasswordvb.aspx#4)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><paramref name="username" /> が 256 文字を超えています。  
  
- または - 
 <paramref name="username" /> にコンマが含まれています。</exception>
        <exception cref="T:System.ArgumentNullException"><paramref name="username" /> が <see langword="null" /> です。</exception>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)">ASP.NET メンバーシップの概要</related>
      </Docs>
    </Member>
    <Member MemberName="GetUserNameByEmail">
      <MemberSignature Language="C#" Value="public override string GetUserNameByEmail (string email);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance string GetUserNameByEmail(string email) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.SqlMembershipProvider.GetUserNameByEmail(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function GetUserNameByEmail (email As String) As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override System::String ^ GetUserNameByEmail(System::String ^ email);" />
      <MemberSignature Language="F#" Value="override this.GetUserNameByEmail : string -&gt; string" Usage="sqlMembershipProvider.GetUserNameByEmail email" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="email" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="email">検索対象の電子メール アドレス。</param>
        <summary>指定した電子メール アドレスに関連付けられているユーザー名を取得します。</summary>
        <returns>指定した電子メール アドレスに関連付けられているユーザー名。 一致するユーザー名が見つからない場合、このメソッドは <see langword="null" /> を返します。</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 このメソッドは、<xref:System.Web.Security.Membership> クラスによって、電子メールアドレスを使用して呼び出されます。このアドレスは、ASP.NET アプリケーションの構成ファイル (Web.config) で指定された SQL Server データベースから関連付けられたユーザー名を取得するために使用されます。  
  
 メンバーシップデータベースの複数のユーザーが同じ電子メールアドレスを持っている場合は、最初に検出されたユーザー名が返されます。 アプリケーション構成ファイルで `requiresUniqueEmail` 属性を `true` に設定すると、データベース内の各電子メールアドレスが一意になるようにすることができます。  
  
 `email` パラメーター値の先頭と末尾の空白はトリムされます。  
  
   
  
## Examples  
 次のコード例では、指定された電子メールアドレスのユーザー名を取得します。  
  
> [!NOTE]
>  この例では、<xref:System.Web.Security.Membership> クラスを使用して、web.config ファイルの `defaultProvider` として指定された <xref:System.Web.Security.SqlMembershipProvider> を呼び出します。 <xref:System.Web.Security.SqlMembershipProvider>型として既定のプロバイダーにアクセスする必要がある場合は、<xref:System.Web.Security.Membership> クラスの <xref:System.Web.Security.Membership.Provider%2A> プロパティをキャストできます。 特定のプロバイダーの種類として構成されている他のプロバイダーにアクセスするには、構成された名前で <xref:System.Web.Security.Membership> クラスの <xref:System.Web.Security.Membership.Providers%2A> プロパティを使用してアクセスし、特定のプロバイダーの種類としてキャストします。  
  
 [!code-aspx-csharp[System.Web.Security.SqlMembershipProvider#7](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.Security.SqlMembershipProvider/CS/GetUserByEmailcs.aspx#7)]
 [!code-aspx-vb[System.Web.Security.SqlMembershipProvider#7](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.Security.SqlMembershipProvider/VB/GetUserByEmailvb.aspx#7)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><paramref name="email" /> が 256 文字を超えています。</exception>
        <exception cref="T:System.Configuration.Provider.ProviderException">データベースに同じ電子メール アドレスを持つユーザーが複数あり、かつ <see cref="P:System.Web.Security.SqlMembershipProvider.RequiresUniqueEmail" /> が <see langword="true" /> です。</exception>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)">ASP.NET メンバーシップの概要</related>
      </Docs>
    </Member>
    <Member MemberName="Initialize">
      <MemberSignature Language="C#" Value="public override void Initialize (string name, System.Collections.Specialized.NameValueCollection config);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance void Initialize(string name, class System.Collections.Specialized.NameValueCollection config) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.SqlMembershipProvider.Initialize(System.String,System.Collections.Specialized.NameValueCollection)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Sub Initialize (name As String, config As NameValueCollection)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override void Initialize(System::String ^ name, System::Collections::Specialized::NameValueCollection ^ config);" />
      <MemberSignature Language="F#" Value="override this.Initialize : string * System.Collections.Specialized.NameValueCollection -&gt; unit" Usage="sqlMembershipProvider.Initialize (name, config)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="name" Type="System.String" />
        <Parameter Name="config" Type="System.Collections.Specialized.NameValueCollection" />
      </Parameters>
      <Docs>
        <param name="name">初期化する <see cref="T:System.Web.Security.SqlMembershipProvider" /> インスタンスの名前。</param>
        <param name="config">メンバーシップ プロバイダーの構成オプションの名前と値を含む <see cref="T:System.Collections.Specialized.NameValueCollection" />。</param>
        <summary>ASP.NET アプリケーションの構成ファイルに指定されているプロパティ値を使用して、SQL Server メンバーシップ プロバイダーを初期化します。 このメソッドはコードから直接使用するためのものではありません。</summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 このメソッドは、ASP.NET アプリケーション構成ファイル (Web.config) で指定されたプロパティ値を使用して <xref:System.Web.Security.SqlMembershipProvider> を初期化します。コードから直接使用するためのものではありません。  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><paramref name="config" /> は <see langword="null" />です。</exception>
        <exception cref="T:System.Configuration.Provider.ProviderException"><see langword="enablePasswordRetrieval" />、<see langword="enablePasswordReset" />、<see langword="requiresQuestionAndAnswer" />、または <see langword="requiresUniqueEmail" /> の各属性が <see langword="Boolean" /> 以外の値に設定されています。  
  
- または - 
<see langword="maxInvalidPasswordAttempts" /> 属性または <see langword="passwordAttemptWindow" /> 属性が正の整数以外の値に設定されています。  
  
- または - 
<see langword="minRequiredPasswordLength" /> 属性が、正の整数以外の値に設定されています。または値が 128 を超えています。  
  
- または - 
<see langword="minRequiredNonalphanumericCharacters" /> 属性が、0 または正の整数以外の値に設定されています。または値が 128 を超えています。  
  
- または - 
<see langword="passwordStrengthRegularExpression" /> 属性の値が有効な正規表現ではありません。  
  
- または - 
<see langword="applicationName" /> 属性の値が 256 文字を超えています。  
  
- または - 
アプリケーション構成ファイルで指定されている <see langword="passwordFormat" /> 属性が無効な <see cref="T:System.Web.Security.MembershipPasswordFormat" /> 列挙値です。  
  
- または - 
アプリケーション構成ファイル内の <see langword="passwordFormat" /> 属性が <see cref="F:System.Web.Security.MembershipPasswordFormat.Hashed" /> で、<see langword="enablePasswordRetrieval" /> 属性が <see langword="true" /> になっています。  
  
- または - 
<see langword="passwordFormat" /> 属性が <see langword="Encrypted" /> で、<see href="https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/w8h3skw9(v%3dvs.100)">&lt;machineKey&gt;</see> 構成要素が <see langword="decryptionKey" /> 属性に対して <see langword="AutoGenerate" /> を指定しています。  
  
- または - 
アプリケーション構成ファイルで、<see langword="connectionStringName" /> 属性が空か、存在していません。  
  
- または - 
<see langword="connectionStringName" /> 属性値の接続文字列値が空か、または指定されている <see langword="connectionStringName" /> がアプリケーション構成ファイルにありません。  
  
- または - 
<see langword="commandTimeout" /> 属性が 0 または正の整数以外の値に設定されています。  
  
- または - 
この <see cref="T:System.Web.Security.SqlMembershipProvider" /> インスタンスのアプリケーション構成ファイルに、認識できない属性が格納されています。</exception>
        <exception cref="T:System.Web.HttpException">現在の信頼レベルが <see langword="Low" /> 未満です。</exception>
        <exception cref="T:System.InvalidOperationException">プロバイダーが、現在の <see cref="M:System.Web.Security.SqlMembershipProvider.Initialize(System.String,System.Collections.Specialized.NameValueCollection)" /> メソッド呼び出しの前に初期化されています。</exception>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)">ASP.NET メンバーシップの概要</related>
      </Docs>
    </Member>
    <Member MemberName="MaxInvalidPasswordAttempts">
      <MemberSignature Language="C#" Value="public override int MaxInvalidPasswordAttempts { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance int32 MaxInvalidPasswordAttempts" />
      <MemberSignature Language="DocId" Value="P:System.Web.Security.SqlMembershipProvider.MaxInvalidPasswordAttempts" />
      <MemberSignature Language="VB.NET" Value="Public Overrides ReadOnly Property MaxInvalidPasswordAttempts As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual property int MaxInvalidPasswordAttempts { int get(); };" />
      <MemberSignature Language="F#" Value="member this.MaxInvalidPasswordAttempts : int" Usage="System.Web.Security.SqlMembershipProvider.MaxInvalidPasswordAttempts" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>get: System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>メンバーシップ ユーザーがロック アウトされるまでの無効なパスワードまたはパスワード解答の試行回数を取得します。</summary>
        <value>メンバーシップ ユーザーがロック アウトされるまでの無効なパスワードまたはパスワード解答の試行回数。</value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <xref:System.Web.Security.Membership.MaxInvalidPasswordAttempts%2A> は、<xref:System.Web.Security.Membership.PasswordAttemptWindow%2A> と組み合わせて動作し、不要なソースに対して、メンバーシップユーザーのパスワードまたはパスワードの解答を繰り返し試行して推測することを防止します。 メンバーシップユーザーに対して指定された無効なパスワードまたはパスワードの質問の数が、<xref:System.Web.Security.Membership.PasswordAttemptWindow%2A> プロパティの値によって識別された分数内の <xref:System.Web.Security.Membership.MaxInvalidPasswordAttempts%2A> プロパティの値以上の場合、メンバーシップユーザーはロックされます。ユーザーが <xref:System.Web.Security.MembershipUser.UnlockUser%2A> メソッドでロック解除されるまで、<xref:System.Web.Security.MembershipUser.IsLockedOut%2A> プロパティを `true` に設定します。 <xref:System.Web.Security.Membership.MaxInvalidPasswordAttempts%2A> 値に達する前に有効なパスワードが指定されている場合、無効なパスワードとパスワードの解答の試行回数を追跡するカウンターは0にリセットされます。 <xref:System.Web.Security.Membership.MaxInvalidPasswordAttempts%2A> 値に達する前に有効なパスワードの解答が指定された場合、無効なパスワードの解答の試行回数を追跡するカウンターだけが0にリセットされます。  
  
 <xref:System.Web.Security.SqlMembershipProvider> では、無効なパスワードの試行回数と無効なパスワード解答の試行回数を別々に保持します。 無効なパスワード試行の結果として、パスワード試行カウンターのみが増加します。 無効なパスワード回答の試行では、パスワード応答カウンターのみがインクリメントされます。  
  
 <xref:System.Web.Security.Membership.MaxInvalidPasswordAttempts%2A> プロパティの値は、[[メンバーシップ](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/1b9hw62f(v%3dvs.100))の構成] セクションの `maxInvalidPasswordAttempts` 属性を使用して、アプリケーション構成で設定されます。  
  
 <xref:System.Web.Security.Membership.RequiresQuestionAndAnswer%2A> プロパティが `false`に設定されている場合、無効なパスワード解答の試行は追跡されません。  
  
   
  
## Examples  
 ASP.NET アプリケーションの web.config ファイルの `system.web` セクションの[membership](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/1b9hw62f(v%3dvs.100))要素のコード例を次に示します。 これは、アプリケーションが <xref:System.Web.Security.SqlMembershipProvider> のインスタンスを使用し、`maxInvalidPasswordAttempts` 属性を5つの無効な試行に設定し、`passwordAttemptWindow` を30分に設定することを指定します。  
  
```  
<membership defaultProvider="SqlProvider"   
  userIsOnlineTimeWindow="20">  
    <providers>  
      <add name="SqlProvider"  
        type="System.Web.Security.SqlMembershipProvider"  
        connectionStringName="SqlServices"  
        requiresQuestionAndAnswer="true"  
        maxInvalidPasswordAttempts="5"  
        passwordAttemptWindow="30"  
        applicationName="MyApplication" />  
    </providers>  
</membership>  
```  
  
 ]]></format>
        </remarks>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)">ASP.NET メンバーシップの概要</related>
      </Docs>
    </Member>
    <Member MemberName="MinRequiredNonAlphanumericCharacters">
      <MemberSignature Language="C#" Value="public override int MinRequiredNonAlphanumericCharacters { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance int32 MinRequiredNonAlphanumericCharacters" />
      <MemberSignature Language="DocId" Value="P:System.Web.Security.SqlMembershipProvider.MinRequiredNonAlphanumericCharacters" />
      <MemberSignature Language="VB.NET" Value="Public Overrides ReadOnly Property MinRequiredNonAlphanumericCharacters As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual property int MinRequiredNonAlphanumericCharacters { int get(); };" />
      <MemberSignature Language="F#" Value="member this.MinRequiredNonAlphanumericCharacters : int" Usage="System.Web.Security.SqlMembershipProvider.MinRequiredNonAlphanumericCharacters" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>get: System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>有効なパスワードに存在する必要がある特殊文字の最小数を取得します。</summary>
        <value>有効なパスワードに存在する必要がある特殊文字の最小数。</value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <xref:System.Web.Security.SqlMembershipProvider.MinRequiredNonAlphanumericCharacters%2A> プロパティは、<xref:System.Web.Security.SqlMembershipProvider> オブジェクトの有効なパスワードを作成するために入力する必要がある特殊な、英字以外の文字の最小数を返します。  
  
 <xref:System.Web.Security.SqlMembershipProvider.MinRequiredNonAlphanumericCharacters%2A> プロパティ値は、 [Membership 要素 (ASP.NET Settings Schema)](https://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049)構成要素の `minRequiredNonalphanumericCharacters` 属性を使用して、アプリケーション構成で設定されます。  
  
 英数字以外の文字は、<xref:System.Char.IsLetterOrDigit%2A> メソッドが `false`返す文字です。  
  
   
  
## Examples  
 次の例は、アプリケーションの Web.config ファイルの `system.web` セクションにある[Membership 要素 (ASP.NET Settings Schema)](https://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049)構成要素を示しています。 これは、アプリケーションが <xref:System.Web.Security.SqlMembershipProvider> クラスのインスタンスを使用してメンバーシップサービスを提供し、`minRequiredNonalphanumericCharacters` 属性を1文字に設定することを指定します。  
  
```  
<membership defaultProvider="SqlProvider"  
  userIsOnlineTimeWindow = "20">  
  <providers>  
    <add  
      name="SqlProvider"  
      type="System.Web.Security.SqlMembershipProvider"  
      connectionStringName="SqlServices"  
      requiresQuestionAndAnswer="true"  
      minRequiredNonalphanumericCharacters="1"  
      />  
  </providers>  
</membership>  
```  
  
 ]]></format>
        </remarks>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)">ASP.NET メンバーシップの概要</related>
      </Docs>
    </Member>
    <Member MemberName="MinRequiredPasswordLength">
      <MemberSignature Language="C#" Value="public override int MinRequiredPasswordLength { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance int32 MinRequiredPasswordLength" />
      <MemberSignature Language="DocId" Value="P:System.Web.Security.SqlMembershipProvider.MinRequiredPasswordLength" />
      <MemberSignature Language="VB.NET" Value="Public Overrides ReadOnly Property MinRequiredPasswordLength As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual property int MinRequiredPasswordLength { int get(); };" />
      <MemberSignature Language="F#" Value="member this.MinRequiredPasswordLength : int" Usage="System.Web.Security.SqlMembershipProvider.MinRequiredPasswordLength" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>get: System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>パスワードに最低限必要な長さを取得します。</summary>
        <value>パスワードに最低限必要な長さ。</value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <xref:System.Web.Security.SqlMembershipProvider.MinRequiredPasswordLength%2A> プロパティは、<xref:System.Web.Security.SqlMembershipProvider> オブジェクトの有効なパスワードを作成するために入力する必要がある文字の最小数を取得します。  
  
 <xref:System.Web.Security.Membership.MinRequiredPasswordLength%2A> プロパティ値は、 [Membership 要素 (ASP.NET Settings Schema)](https://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049)構成要素の `minRequiredPasswordLength` 属性を使用して、アプリケーション構成で設定されます。  
  
   
  
## Examples  
 次の例は、アプリケーションの Web.config ファイルの `system.web` セクションにある[Membership 要素 (ASP.NET Settings Schema)](https://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049)構成要素を示しています。 これは、アプリケーションが <xref:System.Web.Security.SqlMembershipProvider> クラスのインスタンスを使用してメンバーシップサービスを提供することを指定し、`minRequiredPasswordLength` 属性を7文字に設定します。  
  
```  
<membership defaultProvider="SqlProvider"  
  userIsOnlineTimeWindow = "20">  
    <providers>  
      <add  
        name="SqlProvider"  
        type="System.Web.Security.SqlMembershipProvider"  
        connectionStringName="SqlServices"  
        requiresQuestionAndAnswer="true"  
        minRequiredPasswordLength="7"  
        />  
    </providers>  
</membership>  
```  
  
 ]]></format>
        </remarks>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)">ASP.NET メンバーシップの概要</related>
      </Docs>
    </Member>
    <Member MemberName="PasswordAttemptWindow">
      <MemberSignature Language="C#" Value="public override int PasswordAttemptWindow { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance int32 PasswordAttemptWindow" />
      <MemberSignature Language="DocId" Value="P:System.Web.Security.SqlMembershipProvider.PasswordAttemptWindow" />
      <MemberSignature Language="VB.NET" Value="Public Overrides ReadOnly Property PasswordAttemptWindow As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual property int PasswordAttemptWindow { int get(); };" />
      <MemberSignature Language="F#" Value="member this.PasswordAttemptWindow : int" Usage="System.Web.Security.SqlMembershipProvider.PasswordAttemptWindow" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>get: System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>有効なパスワードまたはパスワードの解答の指定までに、連続して失敗した試行を追跡する時間枠を取得します。</summary>
        <value>有効なパスワードまたはパスワードの解答の指定までに、連続して失敗した試行を追跡する時間枠 (分単位)。 既定値は10分です。 現在失敗した試行と前回失敗した試行の間隔が <see cref="P:System.Web.Security.SqlMembershipProvider.PasswordAttemptWindow" /> プロパティの設定値より大きい場合、それぞれの試行の失敗が最初の失敗として扱われます。</value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <xref:System.Web.Security.SqlMembershipProvider.PasswordAttemptWindow%2A> プロパティは、<xref:System.Web.Security.SqlMembershipProvider.MaxInvalidPasswordAttempts%2A> プロパティと組み合わせて使用することで、不要なソースがパスワードを推測したり、メンバーシップユーザーのパスワードの回答を誤って推測したりするのを防ぐのに役立ちます。 ユーザーがログインしたり、パスワードを変更したり、パスワードをリセットしたりしようとすると、指定された時間枠内に連続して試行された回数だけが許可されます。 時間枠の長さは、<xref:System.Web.Security.SqlMembershipProvider.PasswordAttemptWindow%2A> プロパティによって指定されます。このプロパティは、無効な試行の間隔を分単位で示します。 ユーザーがパスワードをリセットするのに連続して失敗した回数が、<xref:System.Web.Security.SqlMembershipProvider.MaxInvalidPasswordAttempts%2A> プロパティに格納されている値と等しく、最後の無効な試行から経過した時間が、<xref:System.Web.Security.SqlMembershipProvider.PasswordAttemptWindow%2A> プロパティに指定された分数を下回っている場合。では、<xref:System.Web.Security.MembershipUser.IsLockedOut%2A> プロパティを `true`に設定することによって、メンバーシップユーザーがロックアウトされます。 ユーザーのロックを解除するには、<xref:System.Web.Security.MembershipUser.UnlockUser%2A> メソッドを呼び出します。 現在失敗している試行と前回失敗した試行の間隔が <xref:System.Web.Security.SqlMembershipProvider.PasswordAttemptWindow%2A> プロパティ設定よりも大きい場合、現在の無効な試行は最初の試行としてカウントされます。 許容される無効な試行の最大数に達する前に有効なパスワードの解答が指定された場合、無効なパスワード回答の試行回数は0に設定されます。 許可されている無効な試行の最大数に達する前に有効なパスワードを指定した場合、無効なパスワードの試行回数と無効なパスワード解答の試行回数は0に設定されます。  
  
 この <xref:System.Web.Security.SqlMembershipProvider> では、無効なパスワードの試行回数と無効なパスワード解答の試行回数を別々に保持します。 無効なパスワード試行の結果として、パスワード試行カウンターのみが増加します。 無効なパスワード回答の試行では、パスワード応答カウンターのみがインクリメントされます。  
  
 <xref:System.Web.Security.Membership.PasswordAttemptWindow%2A> プロパティの値は、[[メンバーシップ](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/1b9hw62f(v%3dvs.100))の構成] セクションの `passwordAttemptWindow` 属性を使用して、アプリケーション構成で設定されます。  
  
 <xref:System.Web.Security.Membership.RequiresQuestionAndAnswer%2A> プロパティが `false`に設定されている場合、無効なパスワード解答の試行は追跡されません。  
  
   
  
## Examples  
 ASP.NET アプリケーションの web.config ファイルの `system.web` セクションの[membership](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/1b9hw62f(v%3dvs.100))要素のコード例を次に示します。 これは、アプリケーションが <xref:System.Web.Security.SqlMembershipProvider> のインスタンスを使用し、`maxInvalidPasswordAttempts` 属性を5つの無効な試行に設定し、`passwordAttemptWindow` を30分に設定することを指定します。  
  
```  
<membership defaultProvider="SqlProvider"   
  userIsOnlineTimeWindow="20">  
    <providers>  
      <add name="SqlProvider"  
        type="System.Web.Security.SqlMembershipProvider"  
        connectionStringName="SqlServices"  
        requiresQuestionAndAnswer="true"  
        maxInvalidPasswordAttempts="5"  
        passwordAttemptWindow="30"  
        applicationName="MyApplication" />  
    </providers>  
</membership>  
```  
  
 ]]></format>
        </remarks>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)">ASP.NET メンバーシップの概要</related>
      </Docs>
    </Member>
    <Member MemberName="PasswordFormat">
      <MemberSignature Language="C#" Value="public override System.Web.Security.MembershipPasswordFormat PasswordFormat { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance valuetype System.Web.Security.MembershipPasswordFormat PasswordFormat" />
      <MemberSignature Language="DocId" Value="P:System.Web.Security.SqlMembershipProvider.PasswordFormat" />
      <MemberSignature Language="VB.NET" Value="Public Overrides ReadOnly Property PasswordFormat As MembershipPasswordFormat" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual property System::Web::Security::MembershipPasswordFormat PasswordFormat { System::Web::Security::MembershipPasswordFormat get(); };" />
      <MemberSignature Language="F#" Value="member this.PasswordFormat : System.Web.Security.MembershipPasswordFormat" Usage="System.Web.Security.SqlMembershipProvider.PasswordFormat" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>get: System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Web.Security.MembershipPasswordFormat</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>SQL Server メンバーシップ データベースにパスワードを格納する形式を示す値を取得します。</summary>
        <value>SQL Server データベースにパスワードを格納する形式を示す <see cref="T:System.Web.Security.MembershipPasswordFormat" /> 値の 1 つ。</value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 `Hashed` のみを使用し、`Clear` と `Encrypted` は安全ではありません。 `Hashed` パスワードは、一方向のハッシュアルゴリズムと、データベースに格納されている場合はランダムに生成された salt 値を使用してハッシュされます。 パスワードが検証されると、検証のためにデータベースの salt 値を使用してハッシュされます。 ハッシュされたパスワードを取得できません。 `Encrypted` パスワードは安全とは見なされません。データベースの内容を表示する侵害によって暗号化キーが公開されることもあります。 これは、暗号化されたパスワードを復号化して公開できることを意味します。  
  
 <xref:System.Web.Security.SqlMembershipProvider.PasswordFormat%2A> 値は、ASP.NET アプリケーションの web.config ファイルの[providers](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/6d4936ht(v%3dvs.100))セクションで指定されます。  
  
 `Encrypted` と `Hashed` パスワードは、構成の[machineKey](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/w8h3skw9(v%3dvs.100))要素に指定されている情報に基づいて、既定で暗号化またはハッシュされます。 `validation` 属性に `3DES` の値を指定した場合、または値が指定されていない場合は、ハッシュされたパスワードが <xref:System.Security.Cryptography.SHA1> アルゴリズムを使用してハッシュされます。  
  
 カスタムハッシュアルゴリズムは、[メンバーシップ要素 (ASP.NET 設定スキーマ)](https://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049)構成要素の `hashAlgorithmType` 属性を使用して定義できます。 暗号化を選択した場合、既定のパスワード暗号化では AES が使用します。 暗号化アルゴリズムを変更するには、 [machineKey](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/w8h3skw9(v%3dvs.100))構成要素の `decryption` 属性を設定します。 パスワードを暗号化する場合は、 [machineKey](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/w8h3skw9(v%3dvs.100))要素の `decryptionKey` 属性に明示的な値を指定する必要があります。 ASP.NET メンバーシップで暗号化されたパスワードを使用する場合、`decryptionKey` 属性の `AutoGenerate` の既定値はサポートされません。  
  
 SHA1 との競合問題のため、Microsoft では SHA256 以上に基づくセキュリティ モデルを推奨しています。  
  
## Examples  
 ASP.NET アプリケーションの web.config ファイルの `system.web` セクションの[membership](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/1b9hw62f(v%3dvs.100))要素のコード例を次に示します。 これにより、アプリケーションの <xref:System.Web.Security.SqlMembershipProvider> インスタンスが指定され、パスワード形式が `Hashed`に設定されます。  
  
```  
<membership defaultProvider="SqlProvider" userIsOnlineTimeWindow="20">  
  <providers>  
    <add name="SqlProvider"  
      type="System.Web.Security.SqlMembershipProvider"  
      connectionStringName="SqlServices"  
      enablePasswordRetrieval="false"  
      enablePasswordReset="true"  
      requiresQuestionAndAnswer="true"  
      passwordFormat="Hashed"  
      applicationName="MyApplication" />  
  </providers>  
</membership>  
```  
  
 ]]></format>
        </remarks>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)">ASP.NET メンバーシップの概要</related>
      </Docs>
    </Member>
    <Member MemberName="PasswordStrengthRegularExpression">
      <MemberSignature Language="C#" Value="public override string PasswordStrengthRegularExpression { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string PasswordStrengthRegularExpression" />
      <MemberSignature Language="DocId" Value="P:System.Web.Security.SqlMembershipProvider.PasswordStrengthRegularExpression" />
      <MemberSignature Language="VB.NET" Value="Public Overrides ReadOnly Property PasswordStrengthRegularExpression As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual property System::String ^ PasswordStrengthRegularExpression { System::String ^ get(); };" />
      <MemberSignature Language="F#" Value="member this.PasswordStrengthRegularExpression : string" Usage="System.Web.Security.SqlMembershipProvider.PasswordStrengthRegularExpression" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>get: System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>パスワードの評価に使用される正規表現を取得します。</summary>
        <value>パスワードの評価に使用される正規表現。</value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <xref:System.Web.Security.SqlMembershipProvider.PasswordStrengthRegularExpression%2A> プロパティは、<xref:System.Web.Security.SqlMembershipProvider> オブジェクトのパスワードの複雑さを評価するために使用される正規表現を取得します。  
  
 <xref:System.Web.Security.Membership.PasswordStrengthRegularExpression%2A> プロパティは、[メンバーシップ要素 (ASP.NET 設定スキーマ)](https://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049)構成要素の `passwordStrengthRegularExpression` 属性を使用して、アプリケーション構成で設定されます。  
  
   
  
## Examples  
 次の例は、アプリケーションの Web.config ファイルの `system.web` セクションにある[Membership 要素 (ASP.NET Settings Schema)](https://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049)構成要素を示しています。 これは、アプリケーションが <xref:System.Web.Security.SqlMembershipProvider> クラスのインスタンスを使用してメンバーシップサービスを提供することを指定し、`passwordStrengthRegularExpression` 属性を、パスワードが次の条件を満たしていることを検証する正規表現に設定します。  
  
-   は7文字以上です。  
  
-   少なくとも1つの数字が含まれています。  
  
-   には、少なくとも1つの特殊な (英数字以外の) 文字が含まれています。  
  
 パスワードがこれらの条件を満たしていない場合は、メンバーシッププロバイダーによってパスワードが受け付けられません。  
  
```  
<membership defaultProvider="SqlProvider"  
  userIsOnlineTimeWindow = "20">  
  <providers>  
    <add  
      name="SqlProvider"  
      type="System.Web.Security.SqlMembershipProvider"  
      connectionStringName="SqlServices"  
      requiresQuestionAndAnswer="true"  
      passwordStrengthRegularExpression="@\"(?=.{6,})(?=(.*\d){1,})(?=(.*\W){1,})"  
      />  
  </providers>  
</membership>  
```  
  
 ]]></format>
        </remarks>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)">ASP.NET メンバーシップの概要</related>
      </Docs>
    </Member>
    <Member MemberName="RequiresQuestionAndAnswer">
      <MemberSignature Language="C#" Value="public override bool RequiresQuestionAndAnswer { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool RequiresQuestionAndAnswer" />
      <MemberSignature Language="DocId" Value="P:System.Web.Security.SqlMembershipProvider.RequiresQuestionAndAnswer" />
      <MemberSignature Language="VB.NET" Value="Public Overrides ReadOnly Property RequiresQuestionAndAnswer As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual property bool RequiresQuestionAndAnswer { bool get(); };" />
      <MemberSignature Language="F#" Value="member this.RequiresQuestionAndAnswer : bool" Usage="System.Web.Security.SqlMembershipProvider.RequiresQuestionAndAnswer" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>get: System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>ユーザーがパスワードをリセットおよび取得する際にパスワードの質問に答えなければならないように SQL Server メンバーシップ プロバイダーが構成されているかどうかを示す値を取得します。</summary>
        <value>パスワードのリセットと取得においてパスワードの質問に対する回答が必要な場合は <see langword="true" />。それ以外の場合は <see langword="false" />。 既定値は、<see langword="true" /> です。</value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 パスワードの質問と回答を要求すると、ユーザーのパスワードを取得またはリセットするときに、追加のセキュリティ層が提供されます。 ユーザー名を作成する場合、ユーザーは、忘れたパスワードを取得またはリセットするために後で使用できる質問と回答を指定できます。 <xref:System.Web.Security.SqlMembershipProvider.EnablePasswordReset%2A> プロパティと <xref:System.Web.Security.SqlMembershipProvider.EnablePasswordRetrieval%2A> プロパティが両方とも `false`場合、<xref:System.Web.Security.SqlMembershipProvider.RequiresQuestionAndAnswer%2A> プロパティの値は無関係です。  
  
 詳細については、次のトピックを参照してください。 <xref:System.Web.Security.SqlMembershipProvider.ResetPassword%2A> および <xref:System.Web.Security.SqlMembershipProvider.GetPassword%2A>  
  
   
  
## Examples  
 ASP.NET アプリケーションの web.config ファイルの `system.web` セクションの[membership](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/1b9hw62f(v%3dvs.100))要素のコード例を次に示します。 これにより、アプリケーションの <xref:System.Web.Security.SqlMembershipProvider> インスタンスが指定され、パスワードのリセットまたは取得にパスワードの解答を要求するように構成されます。  
  
```  
<membership defaultProvider="SqlProvider" userIsOnlineTimeWindow="20">  
  <providers>  
    <add name="SqlProvider"  
      type="System.Web.Security.SqlMembershipProvider"  
      connectionStringName="SqlServices"  
      enablePasswordRetrieval="false"  
      enablePasswordReset="true"  
      requiresQuestionAndAnswer="true"  
      passwordFormat="Hashed"  
      applicationName="MyApplication" />  
  </providers>  
</membership>  
```  
  
 ]]></format>
        </remarks>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)">ASP.NET メンバーシップの概要</related>
      </Docs>
    </Member>
    <Member MemberName="RequiresUniqueEmail">
      <MemberSignature Language="C#" Value="public override bool RequiresUniqueEmail { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool RequiresUniqueEmail" />
      <MemberSignature Language="DocId" Value="P:System.Web.Security.SqlMembershipProvider.RequiresUniqueEmail" />
      <MemberSignature Language="VB.NET" Value="Public Overrides ReadOnly Property RequiresUniqueEmail As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual property bool RequiresUniqueEmail { bool get(); };" />
      <MemberSignature Language="F#" Value="member this.RequiresUniqueEmail : bool" Usage="System.Web.Security.SqlMembershipProvider.RequiresUniqueEmail" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>get: System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>SQL Server メンバーシップ プロバイダーが各ユーザー名に対して一意の電子メール アドレスを要求するかどうかを示す値を取得します。</summary>
        <value>メンバーシッププロバイダーが一意の電子メールアドレスを必要とする場合に <see langword="true" /> します。それ以外の場合は、<see langword="false" />ます。 既定値は、<see langword="false" /> です。</value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Examples  
 ASP.NET アプリケーションの web.config ファイルの `system.web` セクションの[membership](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/1b9hw62f(v%3dvs.100))要素のコード例を次に示します。 <xref:System.Web.Security.SqlMembershipProvider> インスタンスを指定し、各ユーザー名に対して一意の電子メールアドレスを要求するように構成します。  
  
```  
<membership defaultProvider="SqlProvider" userIsOnlineTimeWindow="20">  
  <providers>  
    <add name="SqlProvider"  
      type="System.Web.Security.SqlMembershipProvider"  
      connectionStringName="SqlServices"  
      enablePasswordRetrieval="false"  
      enablePasswordReset="true"  
      requiresQuestionAndAnswer="true"  
      passwordFormat="Hashed"  
      requiresUniqueEmail="true"  
      applicationName="MyApplication" />  
  </providers>  
</membership>  
```  
  
 ]]></format>
        </remarks>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)">ASP.NET メンバーシップの概要</related>
      </Docs>
    </Member>
    <Member MemberName="ResetPassword">
      <MemberSignature Language="C#" Value="public override string ResetPassword (string username, string passwordAnswer);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance string ResetPassword(string username, string passwordAnswer) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.SqlMembershipProvider.ResetPassword(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function ResetPassword (username As String, passwordAnswer As String) As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override System::String ^ ResetPassword(System::String ^ username, System::String ^ passwordAnswer);" />
      <MemberSignature Language="F#" Value="override this.ResetPassword : string * string -&gt; string" Usage="sqlMembershipProvider.ResetPassword (username, passwordAnswer)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="username" Type="System.String" />
        <Parameter Name="passwordAnswer" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="username">パスワードをリセットするユーザー。</param>
        <param name="passwordAnswer">指定したユーザーのパスワードの解答。</param>
        <summary>ユーザーのパスワードをリセットして、自動的に生成された新しいパスワードにします。</summary>
        <returns>指定したユーザーの新しいパスワード。</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 このメソッドは <xref:System.Web.Security.Membership> クラスによって呼び出され、ASP.NET アプリケーションの構成ファイル (Web.config) で指定された SQL Server データベース内のユーザーのパスワードをランダムに生成された新しい値にリセットします。 新しいパスワードが返されます。  
  
> [!NOTE]
>  <xref:System.Web.Security.SqlMembershipProvider.ResetPassword%2A> メソッドによって作成されたランダムパスワードは、<xref:System.Web.Security.SqlMembershipProvider.PasswordStrengthRegularExpression%2A> プロパティに正規表現を渡すことは保証されていません。 ただし、ランダムなパスワードは、<xref:System.Web.Security.SqlMembershipProvider.MinRequiredPasswordLength%2A> および <xref:System.Web.Security.SqlMembershipProvider.MinRequiredNonAlphanumericCharacters%2A> プロパティによって設定された条件を満たします。  
  
 <xref:System.Web.Security.SqlMembershipProvider.ResetPassword%2A> メソッドは、<xref:System.Web.Security.SqlMembershipProvider.PasswordFormat%2A> プロパティが `Hashed`に設定されている場合に最もよく使用されます。 ハッシュされたパスワードをユーザーが忘れた場合、パスワードを取得することはできません。 ただし、ユーザーが正しいパスワードの解答を入力した場合、プロバイダーは、パスワードを自動的に生成された新しいパスワードにリセットできます。  
  
 <xref:System.Web.Security.SqlMembershipProvider.ResetPassword%2A> メソッドに間違ったパスワードの解答を指定すると、無効なパスワードの試行を追跡する内部カウンターが1ずつ増加します。 これにより、ユーザーがロックアウトされ、<xref:System.Web.Security.SqlMembershipProvider.UnlockUser%2A> メソッドの呼び出しによってロックの状態がクリアされるまで、ユーザーがログオンできなくなる可能性があります。 正しいパスワードの解答が指定されていて、ユーザーが現在ロックアウトされていない場合、無効なパスワードの解答の試行を追跡する内部カウンターは0にリセットされます。 詳細については、「<xref:System.Web.Security.SqlMembershipProvider.MaxInvalidPasswordAttempts%2A> と <xref:System.Web.Security.SqlMembershipProvider.PasswordAttemptWindow%2A> のプロパティ」を参照してください。  
  
 最初に <xref:System.Web.Security.Membership> クラスの <xref:System.Web.Security.Membership.Provider%2A> プロパティから <xref:System.Web.Security.SqlMembershipProvider> インスタンスへの参照を取得することで、<xref:System.Web.Security.SqlMembershipProvider.ResetPassword%2A> メソッドを直接呼び出すことができます。 生成されるパスワードは、14文字以上の長さ、または <xref:System.Web.Security.SqlMembershipProvider.MinRequiredPasswordLength%2A> プロパティに指定された長さになります。また、<xref:System.Web.Security.SqlMembershipProvider.MinRequiredNonAlphanumericCharacters%2A> プロパティに指定されている英数字以外の文字の数が含まれます。 パスワードが指定されている場合は、<xref:System.Web.Security.SqlMembershipProvider.PasswordStrengthRegularExpression%2A> プロパティに含まれている正規表現を渡すことは保証されません。  
  
 先頭と末尾のスペースは、すべてのパラメーター値から削除されます。  
  
   
  
## Examples  
 次のコード例では、ユーザーのパスワードをリセットし、自動的に生成された新しいパスワードを返します。  
  
> [!NOTE]
>  この例では、<xref:System.Web.Security.Membership> クラスを使用して、web.config ファイルの `defaultProvider` として指定された <xref:System.Web.Security.SqlMembershipProvider> を呼び出します。 <xref:System.Web.Security.SqlMembershipProvider>型として既定のプロバイダーにアクセスする必要がある場合は、<xref:System.Web.Security.Membership> クラスの <xref:System.Web.Security.Membership.Provider%2A> プロパティをキャストできます。 特定のプロバイダーの種類として構成されている他のプロバイダーにアクセスするには、構成された名前で <xref:System.Web.Security.Membership> クラスの <xref:System.Web.Security.Membership.Providers%2A> プロパティを使用してアクセスし、特定のプロバイダーの種類としてキャストします。  
  
 [!code-aspx-csharp[System.Web.Security.SqlMembershipProvider#8](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.Security.SqlMembershipProvider/CS/ResetPasswordcs.aspx#8)]
 [!code-aspx-vb[System.Web.Security.SqlMembershipProvider#8](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.Security.SqlMembershipProvider/VB/ResetPasswordvb.aspx#8)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Web.Security.MembershipPasswordException"><paramref name="passwordAnswer" /> が無効です。  
  
- または - 
ユーザー アカウントが現在ロックされています。</exception>
        <exception cref="T:System.NotSupportedException"><see cref="P:System.Web.Security.SqlMembershipProvider.EnablePasswordReset" /> が <see langword="false" /> に設定されます。</exception>
        <exception cref="T:System.Configuration.Provider.ProviderException"><paramref name="username" /> がメンバーシップ データベース内に見つかりません。  
  
- または - 
パスワード変更アクションが <see cref="E:System.Web.Security.Membership.ValidatingPassword" /> イベントのサブスクライバーによってキャンセルされ、かつ <see cref="P:System.Web.Security.ValidatePasswordEventArgs.FailureInformation" /> プロパティが <see langword="null" /> です。  
  
- または - 
データベースからパスワードを取得しているときにエラーが発生しました。</exception>
        <exception cref="T:System.ArgumentException"><paramref name="username" /> が空の文字列 ("") であるか、コンマを含んでいるか、または 256 文字を超えています。  
  
- または - 
 <paramref name="passwordAnswer" /> が空の文字列であるか 128 文字を超えていて、<see cref="P:System.Web.Security.SqlMembershipProvider.RequiresQuestionAndAnswer" /> が <see langword="true" /> です。  
  
- または - 
 エンコードされた <paramref name="passwordAnswer" /> が 128 文字を超えています。</exception>
        <exception cref="T:System.ArgumentNullException"><paramref name="username" /> が <see langword="null" /> です。  
  
- または - 
 <paramref name="passwordAnswer" /> が <see langword="null" /> で、<see cref="P:System.Web.Security.SqlMembershipProvider.RequiresQuestionAndAnswer" /> が <see langword="true" /> です。</exception>
        <exception cref="T:System.Exception">ハンドルされていない例外が発生しました。</exception>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)">ASP.NET メンバーシップの概要</related>
      </Docs>
    </Member>
    <Member MemberName="UnlockUser">
      <MemberSignature Language="C#" Value="public override bool UnlockUser (string username);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance bool UnlockUser(string username) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.SqlMembershipProvider.UnlockUser(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function UnlockUser (username As String) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override bool UnlockUser(System::String ^ username);" />
      <MemberSignature Language="F#" Value="override this.UnlockUser : string -&gt; bool" Usage="sqlMembershipProvider.UnlockUser username" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="username" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="username">ロックを解除するメンバーシップ ユーザーの名前。</param>
        <summary>ユーザーのロック状態を解除し、メンバーシップ ユーザーを検証可能な状態にします。</summary>
        <returns>メンバーシップ ユーザーのロックを正常に解除した場合は <see langword="true" />、それ以外の場合は <see langword="false" />。 ユーザーがデータベース内に存在しない場合にも <see langword="false" /> 値が戻ります。</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 ユーザーは最も一般的にロックアウトされており、<xref:System.Web.Security.SqlMembershipProvider.PasswordAttemptWindow%2A>内で <xref:System.Web.Security.SqlMembershipProvider.MaxInvalidPasswordAttempts%2A> が超過した場合に <xref:System.Web.Security.SqlMembershipProvider.ValidateUser%2A> メソッドで検証することはできません。  
  
 `username` パラメーター値の先頭と末尾の空白はトリムされます。  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><paramref name="username" /> が空の文字列であるか、256 文字を超えているか、またはコンマを含んでいます。</exception>
        <exception cref="T:System.ArgumentNullException"><paramref name="username" /> が <see langword="null" /> です。</exception>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)">ASP.NET メンバーシップの概要</related>
      </Docs>
    </Member>
    <Member MemberName="UpdateUser">
      <MemberSignature Language="C#" Value="public override void UpdateUser (System.Web.Security.MembershipUser user);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance void UpdateUser(class System.Web.Security.MembershipUser user) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.SqlMembershipProvider.UpdateUser(System.Web.Security.MembershipUser)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Sub UpdateUser (user As MembershipUser)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override void UpdateUser(System::Web::Security::MembershipUser ^ user);" />
      <MemberSignature Language="F#" Value="override this.UpdateUser : System.Web.Security.MembershipUser -&gt; unit" Usage="sqlMembershipProvider.UpdateUser user" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="user" Type="System.Web.Security.MembershipUser" />
      </Parameters>
      <Docs>
        <param name="user">更新対象のユーザーとそのユーザーの更新情報を表す <see cref="T:System.Web.Security.MembershipUser" /> オブジェクト。</param>
        <summary>SQL Server メンバーシップ データベース内のユーザー情報を更新します。</summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 このメソッドは、ASP.NET アプリケーションの構成ファイル (Web.config) で指定された SQL Server データベース内のユーザーのユーザー情報を更新するために、<xref:System.Web.Security.Membership> クラスによって呼び出されます。 <xref:System.Web.Security.MembershipUser.Email%2A>、<xref:System.Web.Security.MembershipUser.Comment%2A>、<xref:System.Web.Security.MembershipUser.IsApproved%2A>、<xref:System.Web.Security.MembershipUser.LastLoginDate%2A>、および <xref:System.Web.Security.MembershipUser.LastActivityDate%2A> の各プロパティ値が、指定されたメンバーシップユーザーに対して更新されます。  
  
 <xref:System.Web.Security.MembershipUser.UserName%2A> プロパティの最大長は256文字です。 <xref:System.Web.Security.MembershipUser.Email%2A> プロパティの最大長は256文字です。  
  
 メンバーシップユーザーのパスワードは、<xref:System.Web.Security.SqlMembershipProvider.UpdateUser%2A> メソッドを使用して更新することはできません。 メンバーシップユーザーのパスワードを更新するには、<xref:System.Web.Security.MembershipUser> クラスの <xref:System.Web.Security.MembershipUser.ChangePassword%2A> メソッドを使用します。  
  
   
  
## Examples  
 次のコード例では、ユーザーの電子メールアドレスを更新します。  
  
> [!NOTE]
>  この例では、<xref:System.Web.Security.Membership> クラスを使用して、web.config ファイルの `defaultProvider` として指定された <xref:System.Web.Security.SqlMembershipProvider> を呼び出します。 <xref:System.Web.Security.SqlMembershipProvider>型として既定のプロバイダーにアクセスする必要がある場合は、<xref:System.Web.Security.Membership> クラスの <xref:System.Web.Security.Membership.Provider%2A> プロパティをキャストできます。 特定のプロバイダーの種類として構成されている他のプロバイダーにアクセスするには、構成された名前で <xref:System.Web.Security.Membership> クラスの <xref:System.Web.Security.Membership.Providers%2A> プロパティを使用してアクセスし、特定のプロバイダーの種類としてキャストします。  
  
 [!code-aspx-csharp[System.Web.Security.SqlMembershipProvider#11](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.Security.SqlMembershipProvider/CS/UpdateEmailcs.aspx#11)]
 [!code-aspx-vb[System.Web.Security.SqlMembershipProvider#11](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.Security.SqlMembershipProvider/VB/UpdateEmailvb.aspx#11)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><paramref name="user" /> が <see langword="null" /> です。  
  
- または - 
<paramref name="user" /> の <see cref="P:System.Web.Security.MembershipUser.UserName" /> プロパティが <see langword="null" /> です。  
  
- または - 
<paramref name="user" /> の <see cref="P:System.Web.Security.MembershipUser.Email" /> プロパティが <see langword="null" /> で、<see cref="P:System.Web.Security.SqlMembershipProvider.RequiresUniqueEmail" /> が <see langword="true" /> に設定されています。</exception>
        <exception cref="T:System.ArgumentException"><paramref name="user" /> の <see cref="P:System.Web.Security.MembershipUser.UserName" /> プロパティが空の文字列 ("") であるか、コンマを含んでいるか、または 256 文字を超えています。  
  
- または - 
<paramref name="user" /> の <see cref="P:System.Web.Security.MembershipUser.Email" /> の長さが 256 文字を超えています。  
  
- または - 
<paramref name="user" /> の <see cref="P:System.Web.Security.MembershipUser.Email" /> プロパティが空の文字列で、<see cref="P:System.Web.Security.SqlMembershipProvider.RequiresUniqueEmail" /> が <see langword="true" /> に設定されています。</exception>
        <exception cref="T:System.Configuration.Provider.ProviderException"><paramref name="user" /> の <see cref="P:System.Web.Security.MembershipUser.UserName" /> プロパティがデータベース内に見つかりません。  
  
- または - 
<paramref name="user" /> の <see cref="P:System.Web.Security.MembershipUser.Email" /> プロパティがデータベース内の既存の電子メール アドレスと一致しません。かつ、<see cref="P:System.Web.Security.SqlMembershipProvider.RequiresUniqueEmail" /> が true に設定されています。  
  
- または - 
ユーザーの更新に失敗しました。</exception>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)">ASP.NET メンバーシップの概要</related>
      </Docs>
    </Member>
    <Member MemberName="ValidateUser">
      <MemberSignature Language="C#" Value="public override bool ValidateUser (string username, string password);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance bool ValidateUser(string username, string password) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.SqlMembershipProvider.ValidateUser(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function ValidateUser (username As String, password As String) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override bool ValidateUser(System::String ^ username, System::String ^ password);" />
      <MemberSignature Language="F#" Value="override this.ValidateUser : string * string -&gt; bool" Usage="sqlMembershipProvider.ValidateUser (username, password)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="username" Type="System.String" />
        <Parameter Name="password" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="username">検証するユーザーの名前。</param>
        <param name="password">指定したユーザーのパスワード。</param>
        <summary>指定のユーザー名とパスワードが SQL Server メンバーシップ データベースに存在しているかどうかを検証します。</summary>
        <returns>指定されたユーザー名とパスワードが有効な場合は、<see langword="true" />。それ以外の場合は、<see langword="false" />。 ユーザーがデータベース内に存在しない場合にも <see langword="false" /> 値が戻ります。</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 このメソッドは、ASP.NET アプリケーションの構成ファイル (Web.config) で指定された SQL Server データベース内のユーザーのユーザー情報を検証するために、<xref:System.Web.Security.Membership> クラスによって呼び出されます。  
  
 ユーザーが正常に検証されると、最後のアクティビティの日付と最後のサインイン日付の値が、データベースの現在の日付と時刻に更新されます。  
  
 <xref:System.Web.Security.SqlMembershipProvider.ValidateUser%2A> メソッドに間違ったパスワードを指定した場合、無効なパスワードの試行を追跡する内部カウンターは1つずつ増加します。 これにより、ユーザーがロックアウトされ、<xref:System.Web.Security.SqlMembershipProvider.UnlockUser%2A> メソッドの呼び出しによってロックの状態がクリアされるまで、ユーザーがログオンできなくなる可能性があります。 正しいパスワードが指定されていて、ユーザーが現在ロックアウトされていない場合、無効なパスワードとパスワードの解答の試行を追跡する内部カウンターは0にリセットされます。 詳細については、「<xref:System.Web.Security.SqlMembershipProvider.MaxInvalidPasswordAttempts%2A> と <xref:System.Web.Security.SqlMembershipProvider.PasswordAttemptWindow%2A> のプロパティ」を参照してください。  
  
 先頭と末尾のスペースは、すべてのパラメーター値から削除されます。  
  
   
  
## Examples  
 次のコード例は、フォーム認証と <xref:System.Web.Security.SqlMembershipProvider>を使用するように構成された ASP.NET アプリケーションのサインインページを示しています。 指定されたユーザーの資格情報が無効な場合は、ユーザーにメッセージが表示されます。 それ以外の場合、ユーザーは <xref:System.Web.Security.FormsAuthentication.RedirectFromLoginPage%2A> メソッドを使用して最初に要求された URL にリダイレクトされます。  
  
> [!NOTE]
>  この例では、<xref:System.Web.Security.Membership> クラスを使用して、web.config ファイルの `defaultProvider` として指定された <xref:System.Web.Security.SqlMembershipProvider> を呼び出します。 <xref:System.Web.Security.SqlMembershipProvider>型として既定のプロバイダーにアクセスする必要がある場合は、<xref:System.Web.Security.Membership> クラスの <xref:System.Web.Security.Membership.Provider%2A> プロパティをキャストできます。 特定のプロバイダーの種類として構成されている他のプロバイダーにアクセスするには、構成された名前で <xref:System.Web.Security.Membership> クラスの <xref:System.Web.Security.Membership.Providers%2A> プロパティを使用してアクセスし、特定のプロバイダーの種類としてキャストします。  
  
 [!code-aspx-csharp[System.Web.Security.SqlMembershipProvider#1](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.Security.SqlMembershipProvider/CS/logincs.aspx#1)]
 [!code-aspx-vb[System.Web.Security.SqlMembershipProvider#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.Security.SqlMembershipProvider/VB/loginvb.aspx#1)]  
  
 ]]></format>
        </remarks>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)">ASP.NET メンバーシップの概要</related>
      </Docs>
    </Member>
  </Members>
</Type>
