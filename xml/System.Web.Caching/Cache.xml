<Type Name="Cache" FullName="System.Web.Caching.Cache">
  <Metadata><Meta Name="ms.openlocfilehash" Value="8048906b8b7fd795256b8d0f0b5c7273f2496004" /><Meta Name="ms.sourcegitcommit" Value="f9576bf8c61e3d46834aeeff50f858359f2a99ba" /><Meta Name="ms.translationtype" Value="MT" /><Meta Name="ms.contentlocale" Value="ja-JP" /><Meta Name="ms.lasthandoff" Value="02/09/2020" /><Meta Name="ms.locfileid" Value="77104627" /></Metadata><TypeSignature Language="C#" Value="public sealed class Cache : System.Collections.IEnumerable" />
  <TypeSignature Language="ILAsm" Value=".class public auto ansi sealed beforefieldinit Cache extends System.Object implements class System.Collections.IEnumerable" />
  <TypeSignature Language="DocId" Value="T:System.Web.Caching.Cache" />
  <TypeSignature Language="VB.NET" Value="Public NotInheritable Class Cache&#xA;Implements IEnumerable" />
  <TypeSignature Language="C++ CLI" Value="public ref class Cache sealed : System::Collections::IEnumerable" />
  <TypeSignature Language="F#" Value="type Cache = class&#xA;    interface IEnumerable" />
  <AssemblyInfo>
    <AssemblyName>System.Web</AssemblyName>
    <AssemblyVersion>1.0.5000.0</AssemblyVersion>
    <AssemblyVersion>2.0.0.0</AssemblyVersion>
    <AssemblyVersion>4.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <Base>
    <BaseTypeName>System.Object</BaseTypeName>
  </Base>
  <Interfaces>
    <Interface>
      <InterfaceName>System.Collections.IEnumerable</InterfaceName>
    </Interface>
  </Interfaces>
  <Docs>
    <summary>Web アプリケーションのキャッシュを実装します。 このクラスは継承できません。</summary>
    <remarks>
      <format type="text/markdown"><![CDATA[

## Remarks
 このクラスの1つのインスタンスはアプリケーションドメインごとに作成され、アプリケーションドメインがアクティブなままであれば有効なままです。 このクラスのインスタンスに関する情報は、<xref:System.Web.HttpContext> オブジェクトの `Cache` プロパティ、または <xref:System.Web.UI.Page> オブジェクトの `Cache` プロパティを使用して取得できます。

> [!NOTE]
>  <xref:System.Web.Caching.Cache> クラスは、ASP.NET アプリケーションの外部で使用するためのものではありません。 これは、Web アプリケーションのキャッシュを提供するために ASP.NET で使用するために設計およびテストされています。 コンソールアプリケーションや Windows フォームアプリケーションなど、その他の種類のアプリケーションでは、<xref:System.Runtime.Caching.ObjectCache> クラスを使用します。



## Examples
 次の例は、キャッシュ内の項目に割り当てられた値をユーザーに表示し、項目がキャッシュから削除されたときにその値を通知するページです。 このメソッドは、`CacheItemRemovedCallback` デリゲートのシグネチャを持つ `RemovedCallback` メソッドを作成し、キャッシュ項目が削除されたときにユーザーに通知します。また、<xref:System.Web.Caching.CacheItemRemovedReason> 列挙体を使用して、削除された理由をユーザーに通知します。 また、<xref:System.Web.Caching.Cache.Item%2A?displayProperty=nameWithType> プロパティを使用して、オブジェクトをキャッシュに追加し、それらのオブジェクトの値を取得します。 `AddItemToCache` メソッドでは、<xref:System.Web.Caching.Cache.Add%2A?displayProperty=nameWithType> メソッドを使用して、キャッシュに項目を追加します。 `CacheItemRemovedCallback` デリゲートを使用するには、このメソッドまたは <xref:System.Web.Caching.Cache.Insert%2A?displayProperty=nameWithType> メソッドを使用してキャッシュに項目を追加する必要があります。これにより、項目が削除されたときに ASP.NET が自動的に適切なメソッドを呼び出すことができます。 カスタム `RemoveItemFromCache` メソッドは、<xref:System.Web.Caching.Cache.Remove%2A?displayProperty=nameWithType> メソッドを使用してキャッシュから項目を明示的に削除し、`RemovedCallback` メソッドを呼び出します。

> [!NOTE]
>  次のスニペットによってアクセスされるキャッシュのインスタンスは、このサンプルが継承する <xref:System.Web.UI.Page> オブジェクトのメンバーです。

 [!code-aspx-csharp[System.Web.Caching Examples#1](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.Caching Examples/CS/cachecs.aspx#1)]
 [!code-aspx-vb[System.Web.Caching Examples#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.Caching Examples/VB/cachevb.aspx#1)]

 ]]></format>
    </remarks>
    <threadsafe>この型はスレッド セーフです。</threadsafe>
    <altmember cref="T:System.Web.HttpContext" />
    <altmember cref="T:System.Web.Caching.CacheDependency" />
    <altmember cref="T:System.Web.Caching.CacheItemRemovedCallback" />
    <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/6hbbsfk6(v=vs.100)">アプリケーションデータのキャッシュ</related>
  </Docs>
  <Members>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public Cache ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Caching.Cache.#ctor" />
      <MemberSignature Language="VB.NET" Value="Public Sub New ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; Cache();" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <Parameters />
      <Docs>
        <summary><see cref="T:System.Web.Caching.Cache" /> クラスの新しいインスタンスを初期化します。</summary>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
    <Member MemberName="Add">
      <MemberSignature Language="C#" Value="public object Add (string key, object value, System.Web.Caching.CacheDependency dependencies, DateTime absoluteExpiration, TimeSpan slidingExpiration, System.Web.Caching.CacheItemPriority priority, System.Web.Caching.CacheItemRemovedCallback onRemoveCallback);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance object Add(string key, object value, class System.Web.Caching.CacheDependency dependencies, valuetype System.DateTime absoluteExpiration, valuetype System.TimeSpan slidingExpiration, valuetype System.Web.Caching.CacheItemPriority priority, class System.Web.Caching.CacheItemRemovedCallback onRemoveCallback) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Caching.Cache.Add(System.String,System.Object,System.Web.Caching.CacheDependency,System.DateTime,System.TimeSpan,System.Web.Caching.CacheItemPriority,System.Web.Caching.CacheItemRemovedCallback)" />
      <MemberSignature Language="VB.NET" Value="Public Function Add (key As String, value As Object, dependencies As CacheDependency, absoluteExpiration As DateTime, slidingExpiration As TimeSpan, priority As CacheItemPriority, onRemoveCallback As CacheItemRemovedCallback) As Object" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Object ^ Add(System::String ^ key, System::Object ^ value, System::Web::Caching::CacheDependency ^ dependencies, DateTime absoluteExpiration, TimeSpan slidingExpiration, System::Web::Caching::CacheItemPriority priority, System::Web::Caching::CacheItemRemovedCallback ^ onRemoveCallback);" />
      <MemberSignature Language="F#" Value="member this.Add : string * obj * System.Web.Caching.CacheDependency * DateTime * TimeSpan * System.Web.Caching.CacheItemPriority * System.Web.Caching.CacheItemRemovedCallback -&gt; obj" Usage="cache.Add (key, value, dependencies, absoluteExpiration, slidingExpiration, priority, onRemoveCallback)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Object</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="key" Type="System.String" />
        <Parameter Name="value" Type="System.Object" />
        <Parameter Name="dependencies" Type="System.Web.Caching.CacheDependency" />
        <Parameter Name="absoluteExpiration" Type="System.DateTime" />
        <Parameter Name="slidingExpiration" Type="System.TimeSpan" />
        <Parameter Name="priority" Type="System.Web.Caching.CacheItemPriority" />
        <Parameter Name="onRemoveCallback" Type="System.Web.Caching.CacheItemRemovedCallback" />
      </Parameters>
      <Docs>
        <param name="key">項目の参照に使用されるキャッシュ キー。</param>
        <param name="value">キャッシュに追加される項目。</param>
        <param name="dependencies">項目のファイル依存関係またはキャッシュ キー依存関係。 依存関係が変化すると、オブジェクトは無効になり、キャッシュから削除されます。 依存関係がない場合は、このパラメーターには <see langword="null" /> が格納されます。</param>
        <param name="absoluteExpiration">追加されたオブジェクトの有効期限が切れて、キャッシュから削除される時刻。 スライド式有効期限を使用している場合は、<paramref name="absoluteExpiration" /> パラメーターは <see cref="F:System.Web.Caching.Cache.NoAbsoluteExpiration" /> にする必要があります。</param>
        <param name="slidingExpiration">追加されたオブジェクトが最後にアクセスされてからそのオブジェクトが期限切れになるまでの間隔。 この値が 20 分に設定されている場合、オブジェクトは、最後にアクセスされてから 20 分が経過すると期限切れになり、キャッシュから削除されます。 絶対有効期限を使用している場合は、<paramref name="slidingExpiration" /> パラメーターは <see cref="F:System.Web.Caching.Cache.NoSlidingExpiration" /> にする必要があります。</param>
        <param name="priority"><see cref="T:System.Web.Caching.CacheItemPriority" /> 列挙体によって表現される、オブジェクトの相対コスト。 キャッシュからオブジェクトを削除するときにこの値が使用されます。コストが低いオブジェクトは、コストが高いオブジェクトよりも先にキャッシュから削除されます。</param>
        <param name="onRemoveCallback">オブジェクトがキャッシュから削除される場合に呼び出されるデリゲート (指定されている場合)。 このデリゲートを使用して、オブジェクトがキャッシュから削除されたことをアプリケーションに通知できます。</param>
        <summary>依存関係ポリシー、有効期限ポリシー、優先順位ポリシー、および挿入された項目が <see cref="T:System.Web.Caching.Cache" /> から削除されたことをアプリケーションに通知するために使用できるデリゲートを指定して、<see langword="Cache" /> オブジェクトに指定の項目を追加します。</summary>
        <returns>項目が既にキャッシュに格納されている場合は、追加された項目を表すオブジェクト。それ以外の場合は <see langword="null" />。</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[

## Remarks
 同じ `key` パラメーターを持つ項目が既に `Cache`に格納されている場合、このメソッドの呼び出しは警告なしで失敗します。 同じ `key` パラメーターを使用して既存の `Cache` 項目を上書きするには、<xref:System.Web.Caching.Cache.Insert%2A> メソッドを使用します。

 `absoluteExpiration` と `slidingExpiration` の両方のパラメーターを設定することはできません。 キャッシュ項目が特定の時刻に期限切れになるようにする場合は、`absoluteExpiration` パラメーターを特定の時刻に設定し、`slidingExpiration` パラメーターを <xref:System.Web.Caching.Cache.NoSlidingExpiration>に設定します。

 項目が最後にアクセスされてから一定の時間が経過した後にキャッシュ項目の有効期限が切れるようにするには、`slidingExpiration` パラメーターを有効期限の間隔に設定し、`absoluteExpiration` パラメーターを <xref:System.Web.Caching.Cache.NoAbsoluteExpiration>に設定します。



## Examples
 次の例では、`AddItemToCache` メソッドを作成します。 このメソッドが呼び出されると、`itemRemoved` プロパティを `false` に設定し、`onRemove` メソッドを <xref:System.Web.Caching.CacheItemRemovedCallback> デリゲートの新しいインスタンスに登録します。 デリゲートのシグネチャは、`RemovedCallback` メソッドで使用されます。 `AddItemToCache` メソッドは、キャッシュ内の `Key1` キーに関連付けられている値を確認します。 値が `null`の場合、`Add` メソッドは、`Key1`キー、`Value 1`値、絶対有効期限 (60 秒)、および高いキャッシュ優先度を持つ項目をキャッシュに配置します。 また、引数として `onRemove` メソッドを使用します。 これにより、この項目がキャッシュから削除されたときに、`RemovedCallback` メソッドを呼び出すことができます。

> [!NOTE]
>  <xref:System.Web.Caching.CacheDependency> クラスと <xref:System.Web.Caching.CacheItemRemovedCallback> デリゲートの使用方法の例については、「[アプリケーションデータのキャッシュ](https://docs.microsoft.com/previous-versions/aspnet/6hbbsfk6(v=vs.100))」を参照してください。

 [!code-csharp[System.Web.Caching Examples#3](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.Caching Examples/CS/cachecs.aspx#3)]
 [!code-vb[System.Web.Caching Examples#3](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.Caching Examples/VB/cachevb.aspx#3)]

 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><paramref name="key" /> または <paramref name="value" /> パラメーターが <see langword="null" /> に設定されています。</exception>
        <exception cref="T:System.ArgumentOutOfRangeException"><paramref name="slidingExpiration" /> パラメーターは <see langword="TimeSpan.Zero" /> 未満、または 2 年以上に設定されます。</exception>
        <exception cref="T:System.ArgumentException"><paramref name="absoluteExpiration" /> に追加しようとした項目に、<paramref name="slidingExpiration" /> パラメーターと <see langword="Cache" /> パラメーターの両方が設定されます。</exception>
        <altmember cref="T:System.Web.Caching.CacheDependency" />
        <altmember cref="T:System.Web.Caching.CacheItemPriority" />
        <altmember cref="T:System.Web.Caching.CacheItemRemovedCallback" />
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/6hbbsfk6(v=vs.100)">アプリケーションデータのキャッシュ</related>
      </Docs>
    </Member>
    <Member MemberName="Count">
      <MemberSignature Language="C#" Value="public int Count { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance int32 Count" />
      <MemberSignature Language="DocId" Value="P:System.Web.Caching.Cache.Count" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property Count As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property int Count { int get(); };" />
      <MemberSignature Language="F#" Value="member this.Count : int" Usage="System.Web.Caching.Cache.Count" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>キャッシュに格納されている項目の数を取得します。</summary>
        <value>キャッシュに格納されている項目の数。</value>
        <remarks>
          <format type="text/markdown"><![CDATA[

## Remarks
 このプロパティは、アプリケーションのパフォーマンスを監視する場合や、ASP.NET トレース機能を使用する場合に役立ちます。



## Examples
 次の例では、`Count` プロパティの値を取得し、それを文字列に変換し、<xref:System.Web.UI.WebControls.Label> Web サーバーコントロールの <xref:System.Web.UI.WebControls.Label.Text%2A> プロパティに文字列を代入します。 `Label1`。

 [!code-csharp[System.Web.Caching.Cache.Count#1](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.Caching.Cache.Count/CS/cachecountcs.aspx#1)]
 [!code-vb[System.Web.Caching.Cache.Count#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.Caching.Cache.Count/VB/cachecountvb.aspx#1)]

 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="EffectivePercentagePhysicalMemoryLimit">
      <MemberSignature Language="C#" Value="public long EffectivePercentagePhysicalMemoryLimit { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance int64 EffectivePercentagePhysicalMemoryLimit" />
      <MemberSignature Language="DocId" Value="P:System.Web.Caching.Cache.EffectivePercentagePhysicalMemoryLimit" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property EffectivePercentagePhysicalMemoryLimit As Long" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property long EffectivePercentagePhysicalMemoryLimit { long get(); };" />
      <MemberSignature Language="F#" Value="member this.EffectivePercentagePhysicalMemoryLimit : int64" Usage="System.Web.Caching.Cache.EffectivePercentagePhysicalMemoryLimit" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int64</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>ASP.NET によってキャッシュからの項目の削除が開始される前にアプリケーションで使用できる物理メモリの割合を取得します。</summary>
        <value>アプリケーションで使用できる物理メモリのパーセンテージ。</value>
        <remarks>
          <format type="text/markdown"><![CDATA[

## Remarks
 <xref:System.Web.Caching.Cache.EffectivePercentagePhysicalMemoryLimit%2A> プロパティは、アプリケーションで使用できる物理メモリの割合を返します。 使用可能な割合が少なくなると、キャッシュアルゴリズムはキャッシュから項目の削除を開始します。

 <xref:System.Web.Caching.Cache.EffectivePercentagePhysicalMemoryLimit%2A> プロパティは、アプリケーションの構成ファイルのキャッシュ[(ASP.NET 設定スキーマ) 要素の Cache 要素](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ms228248(v=vs.100))の `percentagePhysicalMemoryUsedLimit` 属性を使用して設定できます。 `percentagePhysicalMemoryUsedLimit` 属性が設定されていない場合は、キャッシュアルゴリズムによってキャッシュの最大サイズが決定され、<xref:System.Web.Caching.Cache.EffectivePercentagePhysicalMemoryLimit%2A> プロパティが計算されます。

 <xref:System.Web.Caching.Cache.EffectivePercentagePhysicalMemoryLimit%2A> は .NET Framework バージョン3.5 で導入されました。  詳細については、「[.NET Framework のバージョンおよび依存関係](~/docs/framework/migration-guide/versions-and-dependencies.md)」を参照してください。

 ]]></format>
        </remarks>
        <altmember cref="P:System.Web.Caching.Cache.EffectivePrivateBytesLimit" />
      </Docs>
    </Member>
    <Member MemberName="EffectivePrivateBytesLimit">
      <MemberSignature Language="C#" Value="public long EffectivePrivateBytesLimit { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance int64 EffectivePrivateBytesLimit" />
      <MemberSignature Language="DocId" Value="P:System.Web.Caching.Cache.EffectivePrivateBytesLimit" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property EffectivePrivateBytesLimit As Long" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property long EffectivePrivateBytesLimit { long get(); };" />
      <MemberSignature Language="F#" Value="member this.EffectivePrivateBytesLimit : int64" Usage="System.Web.Caching.Cache.EffectivePrivateBytesLimit" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int64</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>キャッシュに使用できるバイト数を取得します。</summary>
        <value>キャッシュに使用できるバイト数。</value>
        <remarks>
          <format type="text/markdown"><![CDATA[

## Remarks
 <xref:System.Web.Caching.Cache.EffectivePrivateBytesLimit%2A> プロパティは、アプリケーションプロセスで使用できるバイト数を返します。 この制限に達すると、キャッシュアルゴリズムは積極的にキャッシュの清掃を開始します。

 <xref:System.Web.Caching.Cache.EffectivePrivateBytesLimit%2A> プロパティは、アプリケーションの構成ファイルのキャッシュ[(ASP.NET 設定スキーマ) 要素の Cache 要素](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ms228248(v=vs.100))の `privateBytesLimit` 属性を使用して設定できます。 `privateBytesLimit` 属性が設定されていない場合、キャッシュアルゴリズムによってキャッシュの最大サイズが決まり、<xref:System.Web.Caching.Cache.EffectivePrivateBytesLimit%2A> プロパティにはアルゴリズムによって選択されたサイズが格納されます。



## Examples
 <xref:System.Web.Caching.Cache.EffectivePercentagePhysicalMemoryLimit%2A>

 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="Get">
      <MemberSignature Language="C#" Value="public object Get (string key);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance object Get(string key) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Caching.Cache.Get(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Function Get (key As String) As Object" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Object ^ Get(System::String ^ key);" />
      <MemberSignature Language="F#" Value="member this.Get : string -&gt; obj" Usage="cache.Get key" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Object</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="key" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="key">取得するキャッシュ項目の識別子。</param>
        <summary><see cref="T:System.Web.Caching.Cache" /> オブジェクトから指定した項目を取得します。</summary>
        <returns>取得されたキャッシュ項目。キーが見つからない場合は <see langword="null" />。</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[

## Examples
 次の例は、ASP.NET テキストボックスサーバーコントロールに対してキャッシュされた値を取得する方法を示しています。

 [!code-csharp[Classic Cache.Get Example#1](~/samples/snippets/csharp/VS_Snippets_WebNet/Classic Cache.Get Example/CS/source.cs#1)]
 [!code-vb[Classic Cache.Get Example#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/Classic Cache.Get Example/VB/source.vb#1)]

 ]]></format>
        </remarks>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/6hbbsfk6(v=vs.100)">アプリケーションデータのキャッシュ</related>
      </Docs>
    </Member>
    <Member MemberName="GetEnumerator">
      <MemberSignature Language="C#" Value="public System.Collections.IDictionaryEnumerator GetEnumerator ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Collections.IDictionaryEnumerator GetEnumerator() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Caching.Cache.GetEnumerator" />
      <MemberSignature Language="VB.NET" Value="Public Function GetEnumerator () As IDictionaryEnumerator" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Collections::IDictionaryEnumerator ^ GetEnumerator();" />
      <MemberSignature Language="F#" Value="member this.GetEnumerator : unit -&gt; System.Collections.IDictionaryEnumerator" Usage="cache.GetEnumerator " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Collections.IDictionaryEnumerator</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>キャッシュに含まれているキーの設定と値を介して反復処理するために使用されているディクショナリ列挙子を取得します。</summary>
        <returns><see cref="T:System.Web.Caching.Cache" /> オブジェクトを反復処理する列挙子。</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[

## Remarks
 項目は、このメソッドが項目を列挙している間に、キャッシュに追加したり、キャッシュから削除したりできます。



## Examples
 次の例では、`GetEnumerator` メソッドを使用して `CacheEnum`<xref:System.Collections.IDictionaryEnumerator> オブジェクトを作成します。 列挙子はキャッシュ内を移動し、キャッシュされた各項目の値を文字列に変換してから、その値を Web フォームページに書き込みます。

 [!code-csharp[Cache.GetEnumerator#1](~/samples/snippets/csharp/VS_Snippets_WebNet/Cache.GetEnumerator/CS/getenumcs.aspx#1)]
 [!code-vb[Cache.GetEnumerator#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/Cache.GetEnumerator/VB/getenumvb.aspx#1)]

 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <MemberGroup MemberName="Insert">
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>項目を <see cref="T:System.Web.Caching.Cache" /> オブジェクトに挿入します。 このメソッドのいずれかのバージョンを使用して、同じ <see langword="Cache" /> パラメーターで既存の <paramref name="key" /> 項目を上書きします。</summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="Insert">
      <MemberSignature Language="C#" Value="public void Insert (string key, object value);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void Insert(string key, object value) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Caching.Cache.Insert(System.String,System.Object)" />
      <MemberSignature Language="VB.NET" Value="Public Sub Insert (key As String, value As Object)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void Insert(System::String ^ key, System::Object ^ value);" />
      <MemberSignature Language="F#" Value="member this.Insert : string * obj -&gt; unit" Usage="cache.Insert (key, value)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="key" Type="System.String" />
        <Parameter Name="value" Type="System.Object" />
      </Parameters>
      <Docs>
        <param name="key">項目の参照に使用されるキャッシュ キー。</param>
        <param name="value">キャッシュに挿入するオブジェクト。</param>
        <summary>項目の位置を参照するキャッシュ キーを指定し、<see cref="T:System.Web.Caching.Cache" /> 列挙体が提供する既定値を使用して、<see cref="T:System.Web.Caching.CacheItemPriority" /> オブジェクトに項目を挿入します。</summary>
        <remarks>
          <format type="text/markdown"><![CDATA[

## Remarks
 このメソッドは、`key` パラメーターと一致するキーを持つ既存のキャッシュ項目を上書きします。 `Insert` メソッドのこのオーバーロードを使用して、キャッシュに追加されたオブジェクトは、ファイルまたはキャッシュの依存関係のない、<xref:System.Web.Caching.CacheItemPriority.Default>の優先順位、<xref:System.Web.Caching.Cache.NoSlidingExpiration>のスライド式有効期限の値、および <xref:System.Web.Caching.Cache.NoAbsoluteExpiration>の絶対有効期限の値で挿入されます。



## Examples
 次の例は、アプリケーションのキャッシュに項目を挿入する方法を示しています。

 [!code-csharp[Classic Cache.Insert Example#1](~/samples/snippets/csharp/VS_Snippets_WebNet/Classic Cache.Insert Example/CS/source.cs#1)]
 [!code-vb[Classic Cache.Insert Example#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/Classic Cache.Insert Example/VB/source.vb#1)]

 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><paramref name="key" /> パラメーターまたは <paramref name="value" /> パラメーターが <see langword="null" /> です。</exception>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/6hbbsfk6(v=vs.100)">アプリケーションデータのキャッシュ</related>
      </Docs>
    </Member>
    <Member MemberName="Insert">
      <MemberSignature Language="C#" Value="public void Insert (string key, object value, System.Web.Caching.CacheDependency dependencies);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void Insert(string key, object value, class System.Web.Caching.CacheDependency dependencies) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Caching.Cache.Insert(System.String,System.Object,System.Web.Caching.CacheDependency)" />
      <MemberSignature Language="VB.NET" Value="Public Sub Insert (key As String, value As Object, dependencies As CacheDependency)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void Insert(System::String ^ key, System::Object ^ value, System::Web::Caching::CacheDependency ^ dependencies);" />
      <MemberSignature Language="F#" Value="member this.Insert : string * obj * System.Web.Caching.CacheDependency -&gt; unit" Usage="cache.Insert (key, value, dependencies)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="key" Type="System.String" />
        <Parameter Name="value" Type="System.Object" />
        <Parameter Name="dependencies" Type="System.Web.Caching.CacheDependency" />
      </Parameters>
      <Docs>
        <param name="key">項目の識別に使用されるキャッシュ キー。</param>
        <param name="value">キャッシュに挿入するオブジェクト。</param>
        <param name="dependencies">挿入されるオブジェクトのファイル依存関係またはキャッシュ キー依存関係。 依存関係が変化すると、オブジェクトは無効になり、キャッシュから削除されます。 依存関係がない場合は、このパラメーターには <see langword="null" /> が格納されます。</param>
        <summary>ファイル依存関係またはキー依存関係を持つオブジェクトを <see cref="T:System.Web.Caching.Cache" /> に挿入します。</summary>
        <remarks>
          <format type="text/markdown"><![CDATA[

## Remarks
 このメソッドは、`key` パラメーターと一致するキーを持つ既存のキャッシュ項目を上書きします。 `Insert` メソッドのこのオーバーロードを使用して、キャッシュに追加されたオブジェクトは、ファイルまたはキャッシュの依存関係のない、<xref:System.Web.Caching.CacheItemPriority.Default>の優先順位、<xref:System.Web.Caching.Cache.NoSlidingExpiration>のスライド式有効期限の値、および <xref:System.Web.Caching.Cache.NoAbsoluteExpiration>の絶対有効期限の値で挿入されます。



## Examples
 次の例は、XML 構成ファイルにキャッシュ依存関係がある項目をアプリケーションのキャッシュに挿入する方法を示しています。

 [!code-csharp[Classic Cache.Insert1 Example#1](~/samples/snippets/csharp/VS_Snippets_WebNet/Classic Cache.Insert1 Example/CS/source.cs#1)]
 [!code-vb[Classic Cache.Insert1 Example#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/Classic Cache.Insert1 Example/VB/source.vb#1)]

 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><paramref name="key" /> パラメーターまたは <paramref name="value" /> パラメーターが <see langword="null" /> です。</exception>
        <altmember cref="T:System.Web.Caching.CacheDependency" />
      </Docs>
    </Member>
    <Member MemberName="Insert">
      <MemberSignature Language="C#" Value="public void Insert (string key, object value, System.Web.Caching.CacheDependency dependencies, DateTime absoluteExpiration, TimeSpan slidingExpiration);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void Insert(string key, object value, class System.Web.Caching.CacheDependency dependencies, valuetype System.DateTime absoluteExpiration, valuetype System.TimeSpan slidingExpiration) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Caching.Cache.Insert(System.String,System.Object,System.Web.Caching.CacheDependency,System.DateTime,System.TimeSpan)" />
      <MemberSignature Language="VB.NET" Value="Public Sub Insert (key As String, value As Object, dependencies As CacheDependency, absoluteExpiration As DateTime, slidingExpiration As TimeSpan)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void Insert(System::String ^ key, System::Object ^ value, System::Web::Caching::CacheDependency ^ dependencies, DateTime absoluteExpiration, TimeSpan slidingExpiration);" />
      <MemberSignature Language="F#" Value="member this.Insert : string * obj * System.Web.Caching.CacheDependency * DateTime * TimeSpan -&gt; unit" Usage="cache.Insert (key, value, dependencies, absoluteExpiration, slidingExpiration)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="key" Type="System.String" />
        <Parameter Name="value" Type="System.Object" />
        <Parameter Name="dependencies" Type="System.Web.Caching.CacheDependency" />
        <Parameter Name="absoluteExpiration" Type="System.DateTime" />
        <Parameter Name="slidingExpiration" Type="System.TimeSpan" />
      </Parameters>
      <Docs>
        <param name="key">オブジェクトの参照に使用されるキャッシュ キー。</param>
        <param name="value">キャッシュに挿入するオブジェクト。</param>
        <param name="dependencies">挿入されるオブジェクトのファイル依存関係またはキャッシュ キー依存関係。 依存関係が変化すると、オブジェクトは無効になり、キャッシュから削除されます。 依存関係がない場合は、このパラメーターには <see langword="null" /> が格納されます。</param>
        <param name="absoluteExpiration">挿入されたオブジェクトが期限切れとなり、キャッシュから削除される時刻。 標準時間から夏時間への変更など、ローカル時間に関する問題を回避するには、このパラメーター値には <see cref="P:System.DateTime.UtcNow" /> ではなく <see cref="P:System.DateTime.Now" /> を使用してください。 絶対有効期限を使用している場合は、<paramref name="slidingExpiration" /> パラメーターは <see cref="F:System.Web.Caching.Cache.NoSlidingExpiration" /> にする必要があります。</param>
        <param name="slidingExpiration">挿入されたオブジェクトが最後にアクセスされた日時とそのオブジェクトの有効期限が切れる時刻の間隔です。 この値が 20 分に相当する場合、オブジェクトは、最後のアクセスから 20 分経過すると有効期限が切れ、キャッシュから削除されます。 スライド式有効期限を使用している場合は、<paramref name="absoluteExpiration" /> パラメーターは <see cref="F:System.Web.Caching.Cache.NoAbsoluteExpiration" /> にする必要があります。</param>
        <summary>依存関係ポリシーと有効期限ポリシーを指定して、<see cref="T:System.Web.Caching.Cache" /> にオブジェクトを挿入します。</summary>
        <remarks>
          <format type="text/markdown"><![CDATA[

## Remarks
 このメソッドは、既存の `Cache` 項目を同じ `key` パラメーターで上書きします。

 `slidingExpiration` パラメーターが <xref:System.Web.Caching.Cache.NoSlidingExpiration>に設定されている場合、スライド式有効期限は無効になります。 `slidingExpiration` パラメーターを <xref:System.TimeSpan.Zero>より大きい値に設定すると、`absoluteExpiration` パラメーターが <xref:System.DateTime.Now%2A> に設定され、`slidingExpiration` パラメーターに含まれる値が設定されます。 `absoluteExpiration` パラメーターで指定された時間が経過する前にキャッシュから項目が要求された場合、項目は再びキャッシュに配置され、`absoluteExpiration` には `DateTime.Now` に加え、`slidingExpiration` パラメーターに含まれる値も設定されます。 項目が `absoluteExpiration` パラメーターの日付より前にキャッシュから要求されていない場合、項目はキャッシュから削除されます。 。 Insert メソッドのこのオーバーロードを使用してキャッシュに追加された項目は、<xref:System.Web.Caching.CacheItemPriority.Default>の優先度で挿入されます。



## Examples
 次の例は、絶対有効期限を使用して、アプリケーションのキャッシュに項目を挿入する方法を示しています。

> [!NOTE]
>  この形式の `Insert` メソッドはキャッシュの依存関係をサポートしているため、項目に依存関係がない場合は、パラメーターのコンマ区切りのリストで `dependency` パラメーターを `null` (Visual Basic で`Nothing`) として宣言する必要があります。

 [!code-csharp[Classic Cache.Insert2 Example#1](~/samples/snippets/csharp/VS_Snippets_WebNet/Classic Cache.Insert2 Example/CS/source.cs#1)]
 [!code-vb[Classic Cache.Insert2 Example#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/Classic Cache.Insert2 Example/VB/source.vb#1)]

 次の例は、スライド式有効期限を持つ項目をキャッシュに挿入する方法を示しています。

 [!code-csharp[Classic Cache.Insert2 Example#2](~/samples/snippets/csharp/VS_Snippets_WebNet/Classic Cache.Insert2 Example/CS/source.cs#2)]
 [!code-vb[Classic Cache.Insert2 Example#2](~/samples/snippets/visualbasic/VS_Snippets_WebNet/Classic Cache.Insert2 Example/VB/source.vb#2)]

 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><paramref name="key" /> パラメーターまたは <paramref name="value" /> パラメーターが <see langword="null" /> です。</exception>
        <exception cref="T:System.ArgumentOutOfRangeException"><paramref name="slidingExpiration" /> パラメーターは、<see langword="TimeSpan.Zero" /> 未満、または 1 年を超える年数に設定します。</exception>
        <exception cref="T:System.ArgumentException"><paramref name="absoluteExpiration" /> に追加しようとした項目に、<paramref name="slidingExpiration" /> パラメーターと <see langword="Cache" /> パラメーターの両方が設定されます。</exception>
        <altmember cref="T:System.DateTime" />
        <altmember cref="T:System.TimeSpan" />
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/6hbbsfk6(v=vs.100)">アプリケーションデータのキャッシュ</related>
      </Docs>
    </Member>
    <Member MemberName="Insert">
      <MemberSignature Language="C#" Value="public void Insert (string key, object value, System.Web.Caching.CacheDependency dependencies, DateTime absoluteExpiration, TimeSpan slidingExpiration, System.Web.Caching.CacheItemUpdateCallback onUpdateCallback);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void Insert(string key, object value, class System.Web.Caching.CacheDependency dependencies, valuetype System.DateTime absoluteExpiration, valuetype System.TimeSpan slidingExpiration, class System.Web.Caching.CacheItemUpdateCallback onUpdateCallback) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Caching.Cache.Insert(System.String,System.Object,System.Web.Caching.CacheDependency,System.DateTime,System.TimeSpan,System.Web.Caching.CacheItemUpdateCallback)" />
      <MemberSignature Language="VB.NET" Value="Public Sub Insert (key As String, value As Object, dependencies As CacheDependency, absoluteExpiration As DateTime, slidingExpiration As TimeSpan, onUpdateCallback As CacheItemUpdateCallback)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void Insert(System::String ^ key, System::Object ^ value, System::Web::Caching::CacheDependency ^ dependencies, DateTime absoluteExpiration, TimeSpan slidingExpiration, System::Web::Caching::CacheItemUpdateCallback ^ onUpdateCallback);" />
      <MemberSignature Language="F#" Value="member this.Insert : string * obj * System.Web.Caching.CacheDependency * DateTime * TimeSpan * System.Web.Caching.CacheItemUpdateCallback -&gt; unit" Usage="cache.Insert (key, value, dependencies, absoluteExpiration, slidingExpiration, onUpdateCallback)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="key" Type="System.String" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="value" Type="System.Object" Index="1" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="dependencies" Type="System.Web.Caching.CacheDependency" Index="2" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="absoluteExpiration" Type="System.DateTime" Index="3" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="slidingExpiration" Type="System.TimeSpan" Index="4" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="onUpdateCallback" Type="System.Web.Caching.CacheItemUpdateCallback" Index="5" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="key">オブジェクトの参照に使用されるキャッシュ キー。</param>
        <param name="value">キャッシュに挿入するオブジェクト。</param>
        <param name="dependencies">項目のファイル依存関係またはキャッシュ キー依存関係。 依存関係が変化すると、オブジェクトは無効になり、キャッシュから削除されます。 依存関係がない場合は、このパラメーターには <see langword="null" /> が格納されます。</param>
        <param name="absoluteExpiration">挿入されたオブジェクトが期限切れとなり、キャッシュから削除される時刻。 標準時間から夏時間への変更など、ローカル時間に関する問題を回避するには、このパラメーター値には <see cref="P:System.DateTime.UtcNow" /> ではなく <see cref="P:System.DateTime.Now" /> を使用してください。 絶対有効期限を使用している場合は、<paramref name="slidingExpiration" /> パラメーターは <see cref="F:System.Web.Caching.Cache.NoSlidingExpiration" /> に設定する必要があります。</param>
        <param name="slidingExpiration">キャッシュされたオブジェクトが最後にアクセスされてからそのオブジェクトが期限切れになるまでの間隔。 この値が 20 分に相当する場合、オブジェクトは、最後のアクセスから 20 分経過すると有効期限が切れ、キャッシュから削除されます。 スライド式有効期限を使用している場合は、<paramref name="absoluteExpiration" /> パラメーターは <see cref="F:System.Web.Caching.Cache.NoAbsoluteExpiration" /> に設定する必要があります。</param>
        <param name="onUpdateCallback">オブジェクトがキャッシュから削除される前に呼び出されるデリゲート。 これを使用して、キャッシュされた項目を更新し、キャッシュから削除されないようにできます。</param>
        <summary>依存関係、有効期限ポリシー、およびキャッシュから項目が削除される前のアプリケーションへの通知に使用できるデリゲートを指定して、<see cref="T:System.Web.Caching.Cache" /> オブジェクトにオブジェクトを挿入します。</summary>
        <remarks>
          <format type="text/markdown"><![CDATA[

## Remarks
 <xref:System.Web.Caching.Cache.Insert%2A> メソッドを使用すると、キャッシュに新しい項目を挿入し、項目がキャッシュから削除される前に呼び出されるデリゲートを指定できます。 デリゲートでは、キャッシュされた項目を更新して、キャッシュから削除されないようにすることができます。

 このメソッドは、既存の `Cache` 項目を同じ `key` パラメーターで上書きします。

 `absoluteExpiration` と `slidingExpiration` の両方のパラメーターを設定することはできません。 キャッシュ項目が特定の時刻に期限切れになるようにする場合は、`absoluteExpiration` パラメーターを特定の時刻に設定し、`slidingExpiration` パラメーターを <xref:System.Web.Caching.Cache.NoSlidingExpiration>に設定します。

 項目が最後にアクセスされてからの設定期間が経過した後にキャッシュ項目の有効期限が切れるようにする場合は、`slidingExpiration` パラメーターを有効期限の間隔に設定し、`absoluteExpiration` パラメーターを <xref:System.Web.Caching.Cache.NoAbsoluteExpiration>に設定します。

 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><paramref name="key" />、<paramref name="value" />、または <paramref name="onUpdateCallback" /> パラメーターが <see langword="null" />です。</exception>
        <exception cref="T:System.ArgumentOutOfRangeException"><paramref name="slidingExpiration" /> パラメーターは、<see langword="TimeSpan.Zero" /> 未満、または 1 年を超える年数に設定します。</exception>
        <exception cref="T:System.ArgumentException"><paramref name="absoluteExpiration" /> に追加しようとした項目に、<paramref name="slidingExpiration" /> パラメーターと <see langword="Cache" /> パラメーターの両方が設定されます。

または

<paramref name="dependencies" /> パラメーターは <see langword="null" /> であり、<paramref name="absoluteExpiration" /> パラメーターは <see cref="F:System.Web.Caching.Cache.NoAbsoluteExpiration" /> に設定され、<paramref name="slidingExpiration" /> パラメーターは <see cref="F:System.Web.Caching.Cache.NoSlidingExpiration" /> に設定されます。</exception>
        <altmember cref="T:System.Web.Caching.CacheItemUpdateCallback" />
      </Docs>
    </Member>
    <Member MemberName="Insert">
      <MemberSignature Language="C#" Value="public void Insert (string key, object value, System.Web.Caching.CacheDependency dependencies, DateTime absoluteExpiration, TimeSpan slidingExpiration, System.Web.Caching.CacheItemPriority priority, System.Web.Caching.CacheItemRemovedCallback onRemoveCallback);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void Insert(string key, object value, class System.Web.Caching.CacheDependency dependencies, valuetype System.DateTime absoluteExpiration, valuetype System.TimeSpan slidingExpiration, valuetype System.Web.Caching.CacheItemPriority priority, class System.Web.Caching.CacheItemRemovedCallback onRemoveCallback) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Caching.Cache.Insert(System.String,System.Object,System.Web.Caching.CacheDependency,System.DateTime,System.TimeSpan,System.Web.Caching.CacheItemPriority,System.Web.Caching.CacheItemRemovedCallback)" />
      <MemberSignature Language="VB.NET" Value="Public Sub Insert (key As String, value As Object, dependencies As CacheDependency, absoluteExpiration As DateTime, slidingExpiration As TimeSpan, priority As CacheItemPriority, onRemoveCallback As CacheItemRemovedCallback)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void Insert(System::String ^ key, System::Object ^ value, System::Web::Caching::CacheDependency ^ dependencies, DateTime absoluteExpiration, TimeSpan slidingExpiration, System::Web::Caching::CacheItemPriority priority, System::Web::Caching::CacheItemRemovedCallback ^ onRemoveCallback);" />
      <MemberSignature Language="F#" Value="member this.Insert : string * obj * System.Web.Caching.CacheDependency * DateTime * TimeSpan * System.Web.Caching.CacheItemPriority * System.Web.Caching.CacheItemRemovedCallback -&gt; unit" Usage="cache.Insert (key, value, dependencies, absoluteExpiration, slidingExpiration, priority, onRemoveCallback)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="key" Type="System.String" />
        <Parameter Name="value" Type="System.Object" />
        <Parameter Name="dependencies" Type="System.Web.Caching.CacheDependency" />
        <Parameter Name="absoluteExpiration" Type="System.DateTime" />
        <Parameter Name="slidingExpiration" Type="System.TimeSpan" />
        <Parameter Name="priority" Type="System.Web.Caching.CacheItemPriority" />
        <Parameter Name="onRemoveCallback" Type="System.Web.Caching.CacheItemRemovedCallback" />
      </Parameters>
      <Docs>
        <param name="key">オブジェクトの参照に使用されるキャッシュ キー。</param>
        <param name="value">キャッシュに挿入するオブジェクト。</param>
        <param name="dependencies">項目のファイル依存関係またはキャッシュ キー依存関係。 依存関係が変化すると、オブジェクトは無効になり、キャッシュから削除されます。 依存関係がない場合は、このパラメーターには <see langword="null" /> が格納されます。</param>
        <param name="absoluteExpiration">挿入されたオブジェクトが期限切れとなり、キャッシュから削除される時刻。 標準時間から夏時間への変更など、ローカル時間に関する問題を回避するには、このパラメーター値には <see cref="P:System.DateTime.UtcNow" /> ではなく <see cref="P:System.DateTime.Now" /> を使用してください。 絶対有効期限を使用している場合は、<paramref name="slidingExpiration" /> パラメーターは <see cref="F:System.Web.Caching.Cache.NoSlidingExpiration" /> にする必要があります。</param>
        <param name="slidingExpiration">挿入されたオブジェクトが最後にアクセスされてからそのオブジェクトが期限切れになるまでの間隔。 この値が 20 分に相当する場合、オブジェクトは、最後のアクセスから 20 分経過すると有効期限が切れ、キャッシュから削除されます。 スライド式有効期限を使用している場合は、<paramref name="absoluteExpiration" /> パラメーターは <see cref="F:System.Web.Caching.Cache.NoAbsoluteExpiration" /> にする必要があります。</param>
        <param name="priority"><see cref="T:System.Web.Caching.CacheItemPriority" /> 列挙体によって表現される、キャッシュ内に格納された他の項目に対するオブジェクトの相対コスト。 キャッシュからオブジェクトが削除されるときにこの値が使用されます。コストが低いオブジェクトは、コストが高いオブジェクトよりも先にキャッシュから削除されます。</param>
        <param name="onRemoveCallback">オブジェクトがキャッシュから削除されると呼び出されるデリゲート (指定されている場合)。 このデリゲートを使用して、オブジェクトがキャッシュから削除されたことをアプリケーションに通知できます。</param>
        <summary>依存関係ポリシー、有効期限ポリシー、優先順位ポリシー、および挿入された項目が <see cref="T:System.Web.Caching.Cache" /> から削除されたことをアプリケーションに通知するために使用できるデリゲートを指定して、<see langword="Cache" /> オブジェクトにオブジェクトを挿入します。</summary>
        <remarks>
          <format type="text/markdown"><![CDATA[

## Remarks
 このメソッドは、既存の `Cache` 項目を同じ `key` パラメーターで上書きします。

 `absoluteExpiration` と `slidingExpiration` の両方のパラメーターを設定することはできません。 キャッシュ項目が特定の時刻に期限切れになるようにする場合は、`absoluteExpiration` パラメーターを特定の時刻に設定し、`slidingExpiration` パラメーターを <xref:System.Web.Caching.Cache.NoSlidingExpiration>に設定します。

 項目への最後のアクセス以降に一定の時間が経過した後にキャッシュ項目の有効期限が切れるようにする場合は、`slidingExpiration` パラメーターを有効期限の間隔に設定し、`absoluteExpiration` パラメーターを <xref:System.Web.Caching.Cache.NoAbsoluteExpiration>に設定します。



## Examples
 次の例は、アプリケーションの `Cache` オブジェクトに項目を挿入するときに、優先順位の高い項目を割り当てる方法を示しています。

> [!NOTE]
>  このメソッドを <xref:System.Web.Caching.CacheItemRemovedCallback> デリゲートと共に使用する方法の詳細については、「[方法: キャッシュから項目が削除されたときにアプリケーションに通知](https://docs.microsoft.com/previous-versions/aspnet/7kxdx246(v=vs.100))する」を参照してください。

 [!code-csharp[Classic Cache.Insert3 Example#1](~/samples/snippets/csharp/VS_Snippets_WebNet/Classic Cache.Insert3 Example/CS/source.cs#1)]
 [!code-vb[Classic Cache.Insert3 Example#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/Classic Cache.Insert3 Example/VB/source.vb#1)]

 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><paramref name="key" /> パラメーターまたは <paramref name="value" /> パラメーターが <see langword="null" /> です。</exception>
        <exception cref="T:System.ArgumentOutOfRangeException"><paramref name="slidingExpiration" /> パラメーターは、<see langword="TimeSpan.Zero" /> 未満、または 1 年を超える年数に設定します。</exception>
        <exception cref="T:System.ArgumentException"><paramref name="absoluteExpiration" /> に追加しようとした項目に、<paramref name="slidingExpiration" /> パラメーターと <see langword="Cache" /> パラメーターの両方が設定されます。</exception>
        <altmember cref="T:System.DateTime" />
        <altmember cref="T:System.TimeSpan" />
        <altmember cref="T:System.Web.Caching.CacheItemPriority" />
        <altmember cref="T:System.Web.Caching.CacheItemRemovedCallback" />
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/6hbbsfk6(v=vs.100)">アプリケーションデータのキャッシュ</related>
      </Docs>
    </Member>
    <Member MemberName="Item">
      <MemberSignature Language="C#" Value="public object this[string key] { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance object Item(string)" />
      <MemberSignature Language="DocId" Value="P:System.Web.Caching.Cache.Item(System.String)" />
      <MemberSignature Language="VB.NET" Value="Default Public Property Item(key As String) As Object" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Object ^ default[System::String ^] { System::Object ^ get(System::String ^ key); void set(System::String ^ key, System::Object ^ value); };" />
      <MemberSignature Language="F#" Value="member this.Item(string) : obj with get, set" Usage="System.Web.Caching.Cache.Item" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>get: System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>set: System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Object</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="key" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="key">キャッシュ項目のキーを表す <see cref="T:System.String" /> オブジェクト。</param>
        <summary>指定したキーのキャッシュ項目を取得または設定します。</summary>
        <value>指定したキャッシュ項目。</value>
        <remarks>
          <format type="text/markdown"><![CDATA[

## Remarks
 このプロパティを使用して、指定したキャッシュ項目の値を取得したり、項目とキーをキャッシュに追加したりすることができます。 <xref:System.Web.Caching.Cache.Item%2A> プロパティを使用してキャッシュ項目を追加することは、<xref:System.Web.Caching.Cache.Insert%2A?displayProperty=nameWithType> メソッドを呼び出すことと同じです。



## Examples
 次の例では、`Item` プロパティを使用して、`Key1` キーに関連付けられているキャッシュされたオブジェクトの値を取得します。 次に、<xref:System.Web.HttpResponse.Write%2A?displayProperty=nameWithType> メソッドを使用して、値と概要テキストおよび B HTML 要素を Web フォームページに書き込みます。

 [!code-csharp[System.Web.Caching Examples#5](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.Caching Examples/CS/cachecs.aspx#5)]
 [!code-vb[System.Web.Caching Examples#5](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.Caching Examples/VB/cachevb.aspx#5)]

 次の例は、このプロパティを使用して、テキストボックスの値をキャッシュに挿入する方法を示しています。

 [!code-csharp[Classic Cache.this Example#2](~/samples/snippets/csharp/VS_Snippets_WebNet/Classic Cache.this Example/CS/source.cs#2)]
 [!code-vb[Classic Cache.this Example#2](~/samples/snippets/visualbasic/VS_Snippets_WebNet/Classic Cache.this Example/VB/source.vb#2)]

 ]]></format>
        </remarks>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/6hbbsfk6(v=vs.100)">アプリケーションデータのキャッシュ</related>
      </Docs>
    </Member>
    <Member MemberName="NoAbsoluteExpiration">
      <MemberSignature Language="C#" Value="public static readonly DateTime NoAbsoluteExpiration;" />
      <MemberSignature Language="ILAsm" Value=".field public static initonly valuetype System.DateTime NoAbsoluteExpiration" />
      <MemberSignature Language="DocId" Value="F:System.Web.Caching.Cache.NoAbsoluteExpiration" />
      <MemberSignature Language="VB.NET" Value="Public Shared ReadOnly NoAbsoluteExpiration As DateTime " />
      <MemberSignature Language="C++ CLI" Value="public: static initonly DateTime NoAbsoluteExpiration;" />
      <MemberSignature Language="F#" Value=" staticval mutable NoAbsoluteExpiration : DateTime" Usage="System.Web.Caching.Cache.NoAbsoluteExpiration" />
      <MemberType>Field</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.DateTime</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><paramref name="absoluteExpiration" /> メソッド呼び出し内の <see cref="M:System.Web.Caching.Cache.Insert(System.String,System.Object)" /> パラメーターで使用され、項目の有効期限が切れないことを示します。 このフィールドは読み取り専用です。</summary>
        <remarks>
          <format type="text/markdown"><![CDATA[

## Remarks
 このフィールドを使用すると、`absoluteExpiration` パラメーターが <xref:System.DateTime.MaxValue>に等しい値に設定されます。これは、可能な最大の `DateTime` 値である 12/31/9999 11:59:59 PM を表す定数です。



## Examples
 次の例では、`NoAbsoluteExpiration` フィールドを使用して、`Cache`に項目を挿入するときの絶対有効期限を無効にする方法を示します。

 [!code-csharp[Classic Cache.NoAbsoluteExpiration Example#1](~/samples/snippets/csharp/VS_Snippets_WebNet/Classic Cache.NoAbsoluteExpiration Example/CS/source.cs#1)]
 [!code-vb[Classic Cache.NoAbsoluteExpiration Example#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/Classic Cache.NoAbsoluteExpiration Example/VB/source.vb#1)]

 ]]></format>
        </remarks>
        <altmember cref="T:System.DateTime" />
        <altmember cref="M:System.Web.Caching.Cache.Insert(System.String,System.Object)" />
      </Docs>
    </Member>
    <Member MemberName="NoSlidingExpiration">
      <MemberSignature Language="C#" Value="public static readonly TimeSpan NoSlidingExpiration;" />
      <MemberSignature Language="ILAsm" Value=".field public static initonly valuetype System.TimeSpan NoSlidingExpiration" />
      <MemberSignature Language="DocId" Value="F:System.Web.Caching.Cache.NoSlidingExpiration" />
      <MemberSignature Language="VB.NET" Value="Public Shared ReadOnly NoSlidingExpiration As TimeSpan " />
      <MemberSignature Language="C++ CLI" Value="public: static initonly TimeSpan NoSlidingExpiration;" />
      <MemberSignature Language="F#" Value=" staticval mutable NoSlidingExpiration : TimeSpan" Usage="System.Web.Caching.Cache.NoSlidingExpiration" />
      <MemberType>Field</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.TimeSpan</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><paramref name="slidingExpiration" /> または <see cref="M:System.Web.Caching.Cache.Insert(System.String,System.Object)" /> メソッド呼び出し内で <see cref="M:System.Web.Caching.Cache.Add(System.String,System.Object,System.Web.Caching.CacheDependency,System.DateTime,System.TimeSpan,System.Web.Caching.CacheItemPriority,System.Web.Caching.CacheItemRemovedCallback)" /> パラメーターとして使用され、スライド式有効期限を無効にします。 このフィールドは読み取り専用です。</summary>
        <remarks>
          <format type="text/markdown"><![CDATA[

## Remarks
 このフィールドを使用すると、`slidingExpiration` パラメーターが、定数値が0の <xref:System.TimeSpan.Zero?displayProperty=nameWithType> フィールドに設定されます。 キャッシュされた項目は、`Insert` または `Add` メソッドの呼び出しに関連付けられた `absoluteExpiration` パラメーターに従って有効期限が切れます。



## Examples
 次の例では、Insert メソッドを使用して、`NoSlidingExpiration` フィールドを使用して <xref:System.Web.Caching.Cache> オブジェクトに項目を追加する方法を示します。

 [!code-csharp[Classic Cache.NoSlidingExpiration Example#1](~/samples/snippets/csharp/VS_Snippets_WebNet/Classic Cache.NoSlidingExpiration Example/CS/source.cs#1)]
 [!code-vb[Classic Cache.NoSlidingExpiration Example#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/Classic Cache.NoSlidingExpiration Example/VB/source.vb#1)]

 ]]></format>
        </remarks>
        <altmember cref="F:System.TimeSpan.Zero" />
        <altmember cref="M:System.Web.Caching.Cache.Insert(System.String,System.Object)" />
      </Docs>
    </Member>
    <Member MemberName="Remove">
      <MemberSignature Language="C#" Value="public object Remove (string key);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance object Remove(string key) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Caching.Cache.Remove(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Function Remove (key As String) As Object" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Object ^ Remove(System::String ^ key);" />
      <MemberSignature Language="F#" Value="member this.Remove : string -&gt; obj" Usage="cache.Remove key" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Object</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="key" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="key">削除するキャッシュ項目の <see cref="T:System.String" /> ID。</param>
        <summary>アプリケーションの <see cref="T:System.Web.Caching.Cache" /> オブジェクトから、指定した項目を削除します。</summary>
        <returns><see langword="Cache" /> から削除される項目。 キー パラメーターの値が見つからない場合は、<see langword="null" /> を返します。</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[

## Examples
 次の例では、`RemoveItemFromCache` メソッドを作成します。 このメソッドが呼び出されると、<xref:System.Web.Caching.Cache.Item%2A> プロパティを使用して、`Key1` キー値に関連付けられているオブジェクトがキャッシュに格納されているかどうかを確認します。 その場合は、`Remove` メソッドを呼び出してオブジェクトを削除します。

 [!code-csharp[System.Web.Caching Examples#4](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.Caching Examples/CS/cachecs.aspx#4)]
 [!code-vb[System.Web.Caching Examples#4](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.Caching Examples/VB/cachevb.aspx#4)]

 ]]></format>
        </remarks>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/6hbbsfk6(v=vs.100)">アプリケーションデータのキャッシュ</related>
      </Docs>
    </Member>
    <Member MemberName="System.Collections.IEnumerable.GetEnumerator">
      <MemberSignature Language="C#" Value="System.Collections.IEnumerator IEnumerable.GetEnumerator ();" />
      <MemberSignature Language="ILAsm" Value=".method hidebysig newslot virtual instance class System.Collections.IEnumerator System.Collections.IEnumerable.GetEnumerator() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Caching.Cache.System#Collections#IEnumerable#GetEnumerator" />
      <MemberSignature Language="VB.NET" Value="Function GetEnumerator () As IEnumerator Implements IEnumerable.GetEnumerator" />
      <MemberSignature Language="C++ CLI" Value=" virtual System::Collections::IEnumerator ^ System.Collections.IEnumerable.GetEnumerator() = System::Collections::IEnumerable::GetEnumerator;" />
      <MemberType>Method</MemberType>
      <Implements>
        <InterfaceMember>M:System.Collections.IEnumerable.GetEnumerator</InterfaceMember>
      </Implements>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Collections.IEnumerator</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><see cref="T:System.Web.Caching.Cache" /> オブジェクト コレクションを反復処理できる列挙子を返します。</summary>
        <returns><see cref="T:System.Web.Caching.Cache" /> オブジェクトを反復処理できる列挙子。</returns>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
  </Members>
</Type>
