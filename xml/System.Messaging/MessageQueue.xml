<Type Name="MessageQueue" FullName="System.Messaging.MessageQueue">
  <Metadata><Meta Name="ms.openlocfilehash" Value="955dbf0dee587fca5b4e84df42c8ef4af06762bd" /><Meta Name="ms.sourcegitcommit" Value="1b924db57b3a1cf768d98c21f9b988d6966a0f2b" /><Meta Name="ms.translationtype" Value="MT" /><Meta Name="ms.contentlocale" Value="ja-JP" /><Meta Name="ms.lasthandoff" Value="03/06/2020" /><Meta Name="ms.locfileid" Value="78699570" /></Metadata><TypeSignature Language="C#" Value="public class MessageQueue : System.ComponentModel.Component, System.Collections.IEnumerable" />
  <TypeSignature Language="ILAsm" Value=".class public auto ansi beforefieldinit MessageQueue extends System.ComponentModel.Component implements class System.Collections.IEnumerable" FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;xamarinmac-3.0" />
  <TypeSignature Language="DocId" Value="T:System.Messaging.MessageQueue" />
  <TypeSignature Language="VB.NET" Value="Public Class MessageQueue&#xA;Inherits Component&#xA;Implements IEnumerable" />
  <TypeSignature Language="C++ CLI" Value="public ref class MessageQueue : System::ComponentModel::Component, System::Collections::IEnumerable" />
  <TypeSignature Language="F#" Value="type MessageQueue = class&#xA;    inherit Component&#xA;    interface IEnumerable" />
  <TypeSignature Language="ILAsm" Value=".class public auto ansi MessageQueue extends System.ComponentModel.Component implements class System.Collections.IEnumerable" FrameworkAlternate="netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
  <AssemblyInfo>
    <AssemblyName>System.Messaging</AssemblyName>
    <AssemblyVersion>1.0.5000.0</AssemblyVersion>
    <AssemblyVersion>2.0.0.0</AssemblyVersion>
    <AssemblyVersion>4.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <Base>
    <BaseTypeName>System.ComponentModel.Component</BaseTypeName>
  </Base>
  <Interfaces>
    <Interface>
      <InterfaceName>System.Collections.IEnumerable</InterfaceName>
    </Interface>
  </Interfaces>
  <Attributes>
    <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
      <AttributeName>System.ComponentModel.DefaultEvent("ReceiveCompleted")</AttributeName>
    </Attribute>
    <Attribute FrameworkAlternate="netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
      <AttributeName>System.ComponentModel.Editor("System.Messaging.Design.QueuePathEditor", "System.Drawing.Design.UITypeEditor, System.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
    </Attribute>
    <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
      <AttributeName>System.ComponentModel.InstallerType(typeof(System.Messaging.MessageQueueInstaller))</AttributeName>
    </Attribute>
    <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
      <AttributeName>System.ComponentModel.TypeConverter(typeof(System.Messaging.Design.MessageQueueConverter))</AttributeName>
    </Attribute>
    <Attribute FrameworkAlternate="netframework-1.1">
      <AttributeName>System.ComponentModel.Designer("Microsoft.VisualStudio.Install.MessageQueueInstallableComponentDesigner, Microsoft.VisualStudio, Version=1.0.5000.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
    </Attribute>
    <Attribute FrameworkAlternate="netframework-1.1">
      <AttributeName>System.ComponentModel.Editor("System.Messaging.Design.QueuePathEditor", "System.Drawing.Design.UITypeEditor, System.Drawing, Version=1.0.5000.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
    </Attribute>
    <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5">
      <AttributeName>System.ComponentModel.Editor("System.Messaging.Design.QueuePathEditor", "System.Drawing.Design.UITypeEditor, System.Drawing, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
    </Attribute>
    <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
      <AttributeName>System.Messaging.MessagingDescription("MessageQueueDesc")</AttributeName>
    </Attribute>
  </Attributes>
  <Docs>
    <summary><span data-ttu-id="f3a8c-101">メッセージ キュー サーバーのキューにアクセスできるようにします。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-101">Provides access to a queue on a Message Queuing server.</span></span></summary>
    <remarks>
      <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-102">メッセージキューテクノロジを使用すると、異なるタイミングで実行されているアプリケーションが、一時的にオフラインになっている可能性のある異種ネットワークやシステム間で通信を行うことができます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-102">The Message Queuing technology allows applications running at different times to communicate across heterogeneous networks and systems that might be temporarily offline.</span></span> <span data-ttu-id="f3a8c-103">アプリケーションは、キューからメッセージを送信、受信、またはピーク (削除せずに読み取り) します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-103">Applications send, receive, or peek (read without removing) messages from queues.</span></span> <span data-ttu-id="f3a8c-104">メッセージキューは [!INCLUDE[Win2kFamily](~/includes/win2kfamily-md.md)] および Windows NT のオプションのコンポーネントであり、個別にインストールする必要があります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-104">Message Queuing is an optional component of [!INCLUDE[Win2kFamily](~/includes/win2kfamily-md.md)] and Windows NT, and must be installed separately.</span></span>  
  
 <span data-ttu-id="f3a8c-105"><xref:System.Messaging.MessageQueue> クラスは、メッセージキューのラッパーです。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-105">The <xref:System.Messaging.MessageQueue> class is a wrapper around Message Queuing.</span></span> <span data-ttu-id="f3a8c-106">メッセージキューには複数のバージョンがあり、<xref:System.Messaging.MessageQueue> クラスを使用すると、使用しているオペレーティングシステムによって若干異なる動作が発生する可能性があります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-106">There are multiple versions of Message Queuing, and using the <xref:System.Messaging.MessageQueue> class can result in slightly different behavior, depending on the operating system you are using.</span></span> <span data-ttu-id="f3a8c-107">各バージョンのメッセージキューの特定の機能の詳細については、MSDN のプラットフォーム SDK の「メッセージキューの新機能」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-107">For information about specific features of each version of Message Queuing, see the topic "What's New in Message Queuing" in the Platform SDK in MSDN.</span></span>  
  
 <span data-ttu-id="f3a8c-108"><xref:System.Messaging.MessageQueue> クラスは、メッセージキューのキューへの参照を提供します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-108">The <xref:System.Messaging.MessageQueue> class provides a reference to a Message Queuing queue.</span></span> <span data-ttu-id="f3a8c-109"><xref:System.Messaging.MessageQueue.%23ctor%2A> コンストラクターでパスを指定して既存のリソースに接続することも、サーバーに新しいキューを作成することもできます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-109">You can specify a path in the <xref:System.Messaging.MessageQueue.%23ctor%2A> constructor to connect to an existing resource, or you can create a new queue on the server.</span></span> <span data-ttu-id="f3a8c-110"><xref:System.Messaging.MessageQueue.Send%28System.Object%29>、<xref:System.Messaging.MessageQueue.Peek%2A>、または <xref:System.Messaging.MessageQueue.Receive%2A>を呼び出すには、<xref:System.Messaging.MessageQueue> クラスの新しいインスタンスを既存のキューに関連付ける必要があります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-110">Before you can call <xref:System.Messaging.MessageQueue.Send%28System.Object%29>, <xref:System.Messaging.MessageQueue.Peek%2A>, or <xref:System.Messaging.MessageQueue.Receive%2A>, you must associate the new instance of the <xref:System.Messaging.MessageQueue> class with an existing queue.</span></span> <span data-ttu-id="f3a8c-111">その時点で、<xref:System.Messaging.MessageQueue.Category%2A> や <xref:System.Messaging.MessageQueue.Label%2A>などのキューのプロパティを操作できます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-111">At that point, you can manipulate the queue properties such as <xref:System.Messaging.MessageQueue.Category%2A> and <xref:System.Messaging.MessageQueue.Label%2A>.</span></span>  
  
 <span data-ttu-id="f3a8c-112"><xref:System.Messaging.MessageQueue> では、同期と非同期の2種類のメッセージ取得がサポートされています。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-112"><xref:System.Messaging.MessageQueue> supports two types of message retrieval: synchronous and asynchronous.</span></span> <span data-ttu-id="f3a8c-113">同期メソッドである <xref:System.Messaging.MessageQueue.Peek%2A> と <xref:System.Messaging.MessageQueue.Receive%2A>により、プロセススレッドは、新しいメッセージがキューに到着するまで、指定された時間間隔待機します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-113">The synchronous methods, <xref:System.Messaging.MessageQueue.Peek%2A> and <xref:System.Messaging.MessageQueue.Receive%2A>, cause the process thread to wait a specified time interval for a new message to arrive in the queue.</span></span> <span data-ttu-id="f3a8c-114">非同期メソッド、<xref:System.Messaging.MessageQueue.BeginPeek%2A> および <xref:System.Messaging.MessageQueue.BeginReceive%2A>を使用すると、メッセージがキューに到着するまで、メインアプリケーションタスクが別のスレッドで続行されるようにすることができます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-114">The asynchronous methods, <xref:System.Messaging.MessageQueue.BeginPeek%2A> and <xref:System.Messaging.MessageQueue.BeginReceive%2A>, allow the main application tasks to continue in a separate thread until a message arrives in the queue.</span></span> <span data-ttu-id="f3a8c-115">これらのメソッドは、コールバックオブジェクトと状態オブジェクトを使用してスレッド間で情報を伝達することによって機能します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-115">These methods work by using callback objects and state objects to communicate information between threads.</span></span>  
  
 <span data-ttu-id="f3a8c-116"><xref:System.Messaging.MessageQueue> クラスの新しいインスタンスを作成しても、新しいメッセージキューのキューは作成されません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-116">When you create a new instance of the <xref:System.Messaging.MessageQueue> class, you are not creating a new Message Queuing queue.</span></span> <span data-ttu-id="f3a8c-117">代わりに、<xref:System.Messaging.MessageQueue.Create%28System.String%29>、<xref:System.Messaging.MessageQueue.Delete%28System.String%29>、および <xref:System.Messaging.MessageQueue.Purge%2A> の各メソッドを使用して、サーバー上のキューを管理できます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-117">Instead, you can use the <xref:System.Messaging.MessageQueue.Create%28System.String%29>, <xref:System.Messaging.MessageQueue.Delete%28System.String%29>, and <xref:System.Messaging.MessageQueue.Purge%2A> methods to manage queues on the server.</span></span>  
  
 <span data-ttu-id="f3a8c-118"><xref:System.Messaging.MessageQueue.Purge%2A>とは異なり、<xref:System.Messaging.MessageQueue.Create%28System.String%29> と <xref:System.Messaging.MessageQueue.Delete%28System.String%29> は `static` メンバーであるため、<xref:System.Messaging.MessageQueue> クラスの新しいインスタンスを作成せずに呼び出すことができます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-118">Unlike <xref:System.Messaging.MessageQueue.Purge%2A>, <xref:System.Messaging.MessageQueue.Create%28System.String%29> and <xref:System.Messaging.MessageQueue.Delete%28System.String%29> are `static` members, so you can call them without creating a new instance of the <xref:System.Messaging.MessageQueue> class.</span></span>  
  
 <span data-ttu-id="f3a8c-119"><xref:System.Messaging.MessageQueue> オブジェクトの <xref:System.Messaging.MessageQueue.Path%2A> プロパティは、表示名、<xref:System.Messaging.MessageQueue.FormatName%2A>、または <xref:System.Messaging.MessageQueue.Label%2A>の3つの名前のいずれかを使用して設定できます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-119">You can set the <xref:System.Messaging.MessageQueue> object's <xref:System.Messaging.MessageQueue.Path%2A> property with one of three names: the friendly name, the <xref:System.Messaging.MessageQueue.FormatName%2A>, or the <xref:System.Messaging.MessageQueue.Label%2A>.</span></span> <span data-ttu-id="f3a8c-120">キューの <xref:System.Messaging.MessageQueue.MachineName%2A> と <xref:System.Messaging.MessageQueue.QueueName%2A> プロパティによって定義される表示名は、パブリックキューの <xref:System.Messaging.MessageQueue.QueueName%2A> \\<xref:System.Messaging.MessageQueue.MachineName%2A>、プライベートキューの <xref:System.Messaging.MessageQueue.MachineName%2A>\\`Private$`\\<xref:System.Messaging.MessageQueue.QueueName%2A> ます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-120">The friendly name, which is defined by the queue's <xref:System.Messaging.MessageQueue.MachineName%2A> and <xref:System.Messaging.MessageQueue.QueueName%2A> properties, is <xref:System.Messaging.MessageQueue.MachineName%2A>\\<xref:System.Messaging.MessageQueue.QueueName%2A> for a public queue, and <xref:System.Messaging.MessageQueue.MachineName%2A>\\`Private$`\\<xref:System.Messaging.MessageQueue.QueueName%2A> for a private queue.</span></span> <span data-ttu-id="f3a8c-121"><xref:System.Messaging.MessageQueue.FormatName%2A> プロパティを使用すると、メッセージキューにオフラインでアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-121">The <xref:System.Messaging.MessageQueue.FormatName%2A> property allows offline access to message queues.</span></span> <span data-ttu-id="f3a8c-122">最後に、キューの <xref:System.Messaging.MessageQueue.Label%2A> プロパティを使用して、キューの <xref:System.Messaging.MessageQueue.Path%2A>を設定できます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-122">Lastly, you can use the queue's <xref:System.Messaging.MessageQueue.Label%2A> property to set the queue's <xref:System.Messaging.MessageQueue.Path%2A>.</span></span>  
  
 <span data-ttu-id="f3a8c-123"><xref:System.Messaging.MessageQueue>のインスタンスの初期プロパティ値の一覧については、<xref:System.Messaging.MessageQueue.%23ctor%2A> コンストラクターを参照してください。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-123">For a list of initial property values for an instance of <xref:System.Messaging.MessageQueue>, see the <xref:System.Messaging.MessageQueue.%23ctor%2A> constructor.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-124">次のコード例では、さまざまなパス名の構文型を使用して、新しい <xref:System.Messaging.MessageQueue> オブジェクトを作成します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-124">The following code example creates new <xref:System.Messaging.MessageQueue> objects using various path name syntax types.</span></span> <span data-ttu-id="f3a8c-125">いずれの場合も、コンストラクターで定義されているパスを持つキューにメッセージを送信します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-125">In each case, it sends a message to the queue whose path is defined in the constructor.</span></span>  
  
 [!code-cpp[MessageQueue.Path#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Path/CPP/mqpath.cpp#1)]
 [!code-csharp[MessageQueue.Path#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Path/CS/mqpath.cs#1)]
 [!code-vb[MessageQueue.Path#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Path/VB/mqpath.vb#1)]  
  
 <span data-ttu-id="f3a8c-126">次のコード例では、メッセージをキューに送信し、`Order`というアプリケーション固有のクラスを使用してキューからメッセージを受信します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-126">The following code example sends a message to a queue, and receives a message from a queue, using an application-specific class called `Order`.</span></span>  
  
 [!code-cpp[MessageQueue.Receive_noparms#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Receive_noparms/CPP/mqreceive_noparms.cpp#1)]
 [!code-csharp[MessageQueue.Receive_noparms#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Receive_noparms/CS/mqreceive_noparms.cs#1)]
 [!code-vb[MessageQueue.Receive_noparms#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Receive_noparms/VB/mqreceive_noparms.vb#1)]  
  
 ]]></format>
    </remarks>
    <threadsafe><span data-ttu-id="f3a8c-127"><see cref="M:System.Messaging.MessageQueue.GetAllMessages" /> メソッドだけがスレッドセーフです。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-127">Only the <see cref="M:System.Messaging.MessageQueue.GetAllMessages" /> method is thread safe.</span></span></threadsafe>
    <altmember cref="T:System.Messaging.Message" />
    <altmember cref="T:System.Messaging.DefaultPropertiesToSend" />
    <altmember cref="T:System.Messaging.MessageQueueException" />
    <altmember cref="M:System.Messaging.MessageQueue.#ctor" />
    <altmember cref="M:System.Messaging.MessageQueue.Peek" />
    <altmember cref="M:System.Messaging.MessageQueue.Receive" />
    <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
    <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
    <altmember cref="P:System.Messaging.MessageQueue.Path" />
    <altmember cref="P:System.Messaging.MessageQueue.Label" />
    <altmember cref="P:System.Messaging.MessageQueue.FormatName" />
    <altmember cref="P:System.Messaging.MessageQueue.QueueName" />
    <altmember cref="P:System.Messaging.MessageQueue.MachineName" />
  </Docs>
  <Members>
    <MemberGroup MemberName=".ctor">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="f3a8c-128"><see cref="T:System.Messaging.MessageQueue" /> クラスの新しいインスタンスを初期化します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-128">Initializes a new instance of the <see cref="T:System.Messaging.MessageQueue" /> class.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public MessageQueue ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.#ctor" />
      <MemberSignature Language="VB.NET" Value="Public Sub New ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; MessageQueue();" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="f3a8c-129"><see cref="T:System.Messaging.MessageQueue" /> クラスの新しいインスタンスを初期化します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-129">Initializes a new instance of the <see cref="T:System.Messaging.MessageQueue" /> class.</span></span> <span data-ttu-id="f3a8c-130">パラメーターなしのコンストラクターが新しいインスタンスを初期化した後、そのインスタンスを使用する前にインスタンスの <see cref="P:System.Messaging.MessageQueue.Path" /> プロパティを設定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-130">After the parameterless constructor initializes the new instance, you must set the instance's <see cref="P:System.Messaging.MessageQueue.Path" /> property before you can use the instance.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-131">このオーバーロードを使用して、メッセージキューサーバーのキューにすぐに関連付けられていない <xref:System.Messaging.MessageQueue> クラスの新しいインスタンスを作成します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-131">Use this overload to create a new instance of the <xref:System.Messaging.MessageQueue> class that is not immediately tied to a queue on the Message Queuing server.</span></span> <span data-ttu-id="f3a8c-132">このインスタンスを使用する前に、<xref:System.Messaging.MessageQueue.Path%2A> プロパティを設定して、既存のメッセージキューのキューに接続する必要があります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-132">Before using this instance, you must connect it to an existing Message Queuing queue by setting the <xref:System.Messaging.MessageQueue.Path%2A> property.</span></span> <span data-ttu-id="f3a8c-133">または、<xref:System.Messaging.MessageQueue.Create%28System.String%29> メソッドの戻り値への <xref:System.Messaging.MessageQueue> 参照を設定して、新しいメッセージキューのキューを作成することもできます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-133">Alternatively, you can set the <xref:System.Messaging.MessageQueue> reference to the <xref:System.Messaging.MessageQueue.Create%28System.String%29> method's return value, thereby creating a new Message Queuing queue.</span></span>  
  
 <span data-ttu-id="f3a8c-134"><xref:System.Messaging.MessageQueue.%23ctor%2A> コンストラクターは、<xref:System.Messaging.MessageQueue> クラスの新しいインスタンスをインスタンス化します。新しいメッセージキューのキューは作成されません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-134">The <xref:System.Messaging.MessageQueue.%23ctor%2A> constructor instantiates a new instance of the <xref:System.Messaging.MessageQueue> class; it does not create a new Message Queuing queue.</span></span>  
  
 <span data-ttu-id="f3a8c-135">次の表に、<xref:System.Messaging.MessageQueue>のインスタンスのプロパティの初期値を示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-135">The following table shows initial property values for an instance of <xref:System.Messaging.MessageQueue>.</span></span>  
  
|<span data-ttu-id="f3a8c-136">プロパティ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-136">Property</span></span>|<span data-ttu-id="f3a8c-137">初期値</span><span class="sxs-lookup"><span data-stu-id="f3a8c-137">Initial value</span></span>|  
|--------------|-------------------|  
|<xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A>|<span data-ttu-id="f3a8c-138"><xref:System.Messaging.DefaultPropertiesToSend> クラスのパラメーターなしのコンストラクターによって設定される値。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-138">The values set by the parameterless constructor of the <xref:System.Messaging.DefaultPropertiesToSend> class.</span></span>|  
|<xref:System.Messaging.MessageQueue.Formatter%2A>|<xref:System.Messaging.XmlMessageFormatter>|  
|<xref:System.Messaging.MessageQueue.MessageReadPropertyFilter%2A>|<span data-ttu-id="f3a8c-139"><xref:System.Messaging.MessagePropertyFilter> クラスのパラメーターなしのコンストラクターによって設定される値。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-139">The values set by the parameterless constructor of the <xref:System.Messaging.MessagePropertyFilter> class.</span></span> <span data-ttu-id="f3a8c-140">すべてのフィルター値が `true`に設定されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-140">All the filter values are set to `true`.</span></span>|  
|<xref:System.Messaging.MessageQueue.DenySharedReceive%2A>|`false`|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-141">次のコード例では、新しい <xref:System.Messaging.MessageQueue> を作成します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-141">The following code example creates a new <xref:System.Messaging.MessageQueue>.</span></span>  
  
 [!code-csharp[MessageQueue#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#1)]  
  
 ]]></format>
        </remarks>
        <altmember cref="P:System.Messaging.MessageQueue.Path" />
        <altmember cref="P:System.Messaging.MessageQueue.QueueName" />
        <altmember cref="P:System.Messaging.MessageQueue.FormatName" />
        <altmember cref="P:System.Messaging.MessageQueue.Label" />
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public MessageQueue (string path);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(string path) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.#ctor(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (path As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; MessageQueue(System::String ^ path);" />
      <MemberSignature Language="F#" Value="new System.Messaging.MessageQueue : string -&gt; System.Messaging.MessageQueue" Usage="new System.Messaging.MessageQueue path" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="path" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="path"><span data-ttu-id="f3a8c-142">この <see cref="T:System.Messaging.MessageQueue" /> が参照するキューの場所。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-142">The location of the queue referenced by this <see cref="T:System.Messaging.MessageQueue" />.</span></span></param>
        <summary><span data-ttu-id="f3a8c-143">指定したパスのメッセージ キューのキューを参照する <see cref="T:System.Messaging.MessageQueue" /> クラスの新しいインスタンスを初期化します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-143">Initializes a new instance of the <see cref="T:System.Messaging.MessageQueue" /> class that references the Message Queuing queue at the specified path.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-144">このオーバーロードは、新しい <xref:System.Messaging.MessageQueue> インスタンスを、パス、形式名、またはラベルがわかっている特定のメッセージキューキューに関連付ける場合に使用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-144">Use this overload when you want to tie the new <xref:System.Messaging.MessageQueue> instance to a particular Message Queuing queue, for which you know the path, format name, or label.</span></span> <span data-ttu-id="f3a8c-145">キューを参照する最初のアプリケーションに排他アクセスを許可する場合は、<xref:System.Messaging.MessageQueue.DenySharedReceive%2A> プロパティを `true` に設定するか、読み取りアクセス制限パラメーターを渡すコンストラクターを使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-145">If you want to grant exclusive access to the first application that references the queue, you must set the <xref:System.Messaging.MessageQueue.DenySharedReceive%2A> property to `true` or use the constructor that passes a read-access restriction parameter.</span></span>  
  
 <span data-ttu-id="f3a8c-146"><xref:System.Messaging.MessageQueue.%23ctor%2A> コンストラクターは、<xref:System.Messaging.MessageQueue> クラスの新しいインスタンスをインスタンス化します。新しいメッセージキューのキューは作成されません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-146">The <xref:System.Messaging.MessageQueue.%23ctor%2A> constructor instantiates a new instance of the <xref:System.Messaging.MessageQueue> class; it does not create a new Message Queuing queue.</span></span> <span data-ttu-id="f3a8c-147">メッセージキューに新しいキューを作成するには、<xref:System.Messaging.MessageQueue.Create%28System.String%29>を使用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-147">To create a new queue in Message Queuing, use <xref:System.Messaging.MessageQueue.Create%28System.String%29>.</span></span>  
  
 <span data-ttu-id="f3a8c-148">`path` パラメーターの構文は、次の表に示すように、参照するキューの種類によって異なります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-148">The syntax of the `path` parameter depends on the type of queue it references, as shown in the following table.</span></span>  
  
|<span data-ttu-id="f3a8c-149">[キューの種類]</span><span class="sxs-lookup"><span data-stu-id="f3a8c-149">Queue type</span></span>|<span data-ttu-id="f3a8c-150">構文</span><span class="sxs-lookup"><span data-stu-id="f3a8c-150">Syntax</span></span>|  
|----------------|------------|  
|<span data-ttu-id="f3a8c-151">パブリックキュー</span><span class="sxs-lookup"><span data-stu-id="f3a8c-151">Public queue</span></span>|`MachineName`\\`QueueName`|  
|<span data-ttu-id="f3a8c-152">専用キュー</span><span class="sxs-lookup"><span data-stu-id="f3a8c-152">Private queue</span></span>|`MachineName`\\`Private$`\\`QueueName`|  
|<span data-ttu-id="f3a8c-153">ジャーナル キュー</span><span class="sxs-lookup"><span data-stu-id="f3a8c-153">Journal queue</span></span>|`MachineName`\\`QueueName`\\`Journal$`|  
|<span data-ttu-id="f3a8c-154">マシンジャーナルキュー</span><span class="sxs-lookup"><span data-stu-id="f3a8c-154">Machine journal queue</span></span>|`MachineName`\\`Journal$`|  
|<span data-ttu-id="f3a8c-155">コンピューターの配信不能キュー</span><span class="sxs-lookup"><span data-stu-id="f3a8c-155">Machine dead-letter queue</span></span>|`MachineName`\\`Deadletter$`|  
|<span data-ttu-id="f3a8c-156">コンピュータートランザクション配信不能キュー</span><span class="sxs-lookup"><span data-stu-id="f3a8c-156">Machine transactional dead-letter queue</span></span>|`MachineName`\\`XactDeadletter$`|  
  
 <span data-ttu-id="f3a8c-157">または、次の表に示すように、<xref:System.Messaging.MessageQueue.FormatName%2A> または <xref:System.Messaging.MessageQueue.Label%2A> を使用してキューのパスを記述することもできます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-157">Alternatively, you can use the <xref:System.Messaging.MessageQueue.FormatName%2A> or <xref:System.Messaging.MessageQueue.Label%2A> to describe the queue path, as shown in the following table.</span></span>  
  
|<span data-ttu-id="f3a8c-158">関連項目</span><span class="sxs-lookup"><span data-stu-id="f3a8c-158">Reference</span></span>|<span data-ttu-id="f3a8c-159">構文</span><span class="sxs-lookup"><span data-stu-id="f3a8c-159">Syntax</span></span>|<span data-ttu-id="f3a8c-160">例</span><span class="sxs-lookup"><span data-stu-id="f3a8c-160">Example</span></span>|  
|---------------|------------|-------------|  
|<span data-ttu-id="f3a8c-161">形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-161">Format name</span></span>|<span data-ttu-id="f3a8c-162">`FormatName:` [*形式名*]</span><span class="sxs-lookup"><span data-stu-id="f3a8c-162">`FormatName:` [ *format name* ]</span></span>|<span data-ttu-id="f3a8c-163">`FormatName:Public=` 5A5F7535-AE9A-41d4-935C-845C2AFF7112</span><span class="sxs-lookup"><span data-stu-id="f3a8c-163">`FormatName:Public=` 5A5F7535-AE9A-41d4-935C-845C2AFF7112</span></span><br /><br /> <span data-ttu-id="f3a8c-164">`FormatName:DIRECT=SPX:` `NetworkNumber`;`HostNumber`\\`QueueName`</span><span class="sxs-lookup"><span data-stu-id="f3a8c-164">`FormatName:DIRECT=SPX:` `NetworkNumber`; `HostNumber`\\`QueueName`</span></span><br /><br /> <span data-ttu-id="f3a8c-165">`FormatName:DIRECT=TCP:` `IPAddress`\\`QueueName`</span><span class="sxs-lookup"><span data-stu-id="f3a8c-165">`FormatName:DIRECT=TCP:` `IPAddress`\\`QueueName`</span></span><br /><br /> <span data-ttu-id="f3a8c-166">`FormatName:DIRECT=OS:` `MachineName`\\`QueueName`</span><span class="sxs-lookup"><span data-stu-id="f3a8c-166">`FormatName:DIRECT=OS:` `MachineName`\\`QueueName`</span></span>|  
|<span data-ttu-id="f3a8c-167">group1</span><span class="sxs-lookup"><span data-stu-id="f3a8c-167">Label</span></span>|<span data-ttu-id="f3a8c-168">`Label:` [*ラベル*]</span><span class="sxs-lookup"><span data-stu-id="f3a8c-168">`Label:` [ *label* ]</span></span>|<span data-ttu-id="f3a8c-169">`Label:` TheLabel</span><span class="sxs-lookup"><span data-stu-id="f3a8c-169">`Label:` TheLabel</span></span>|  
  
 <span data-ttu-id="f3a8c-170">オフラインで作業するには、コンストラクターのパス名の構文ではなく、形式名の構文を使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-170">To work offline, you must use the format name syntax, not the path name syntax for the constructor.</span></span> <span data-ttu-id="f3a8c-171">そうしないと、プライマリドメインコントローラーが形式名へのパスを解決できないため、例外がスローされます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-171">Otherwise, an exception is thrown because the primary domain controller is not available to resolve the path to the format name.</span></span>  
  
 <span data-ttu-id="f3a8c-172">次の表に、<xref:System.Messaging.MessageQueue>のインスタンスのプロパティの初期値を示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-172">The following table shows initial property values for an instance of <xref:System.Messaging.MessageQueue>.</span></span> <span data-ttu-id="f3a8c-173">これらの値は、`path` パラメーターによって指定されたパスを持つメッセージキューのキューのプロパティに基づいています。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-173">These values are based on the properties of the Message Queuing queue with the path specified by the `path` parameter.</span></span>  
  
|<span data-ttu-id="f3a8c-174">プロパティ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-174">Property</span></span>|<span data-ttu-id="f3a8c-175">初期値</span><span class="sxs-lookup"><span data-stu-id="f3a8c-175">Initial value</span></span>|  
|--------------|-------------------|  
|<xref:System.Messaging.MessageQueue.Authenticate%2A>|`false`|  
|<xref:System.Messaging.MessageQueue.BasePriority%2A>|<span data-ttu-id="f3a8c-176">0</span><span class="sxs-lookup"><span data-stu-id="f3a8c-176">0</span></span>|  
|<xref:System.Messaging.MessageQueue.Category%2A>|<xref:System.Guid.Empty>|  
|<xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A>|<span data-ttu-id="f3a8c-177"><xref:System.Messaging.DefaultPropertiesToSend> クラスのパラメーターなしのコンストラクターによって設定される値。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-177">The values set by the parameterless constructor of the <xref:System.Messaging.DefaultPropertiesToSend> class.</span></span>|  
|<xref:System.Messaging.MessageQueue.EncryptionRequired%2A>|<span data-ttu-id="f3a8c-178">メッセージキューのキューのプライバシーレベルの設定が "Body" の場合、`true`ます。それ以外の場合は、`false`ます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-178">`true`, if the Message Queuing queue's privacy level setting is "Body"; otherwise, `false`.</span></span>|  
|<xref:System.Messaging.MessageQueue.Formatter%2A>|<xref:System.Messaging.XmlMessageFormatter>|  
|<xref:System.Messaging.MessageQueue.Label%2A>|<xref:System.String.Empty>|  
|<xref:System.Messaging.MessageQueue.MachineName%2A>|<span data-ttu-id="f3a8c-179">メッセージキューのキューのコンピューター名プロパティの値。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-179">The value of the Message Queuing queue's computer name property.</span></span>|  
|<xref:System.Messaging.MessageQueue.MaximumJournalSize%2A>|<xref:System.Messaging.MessageQueue.InfiniteQueueSize>|  
|<xref:System.Messaging.MessageQueue.MaximumQueueSize%2A>|<xref:System.Messaging.MessageQueue.InfiniteQueueSize>|  
|<xref:System.Messaging.MessageQueue.MessageReadPropertyFilter%2A>|<span data-ttu-id="f3a8c-180"><xref:System.Messaging.MessagePropertyFilter> クラスのパラメーターなしのコンストラクターによって設定される値。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-180">The values set by the parameterless constructor of the <xref:System.Messaging.MessagePropertyFilter> class.</span></span>|  
|<xref:System.Messaging.MessageQueue.Path%2A>|<span data-ttu-id="f3a8c-181">コンストラクターによって設定されていない場合は <xref:System.String.Empty>。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-181"><xref:System.String.Empty>, if not set by the constructor.</span></span>|  
|<xref:System.Messaging.MessageQueue.QueueName%2A>|<span data-ttu-id="f3a8c-182">コンストラクターによって設定されていない場合は <xref:System.String.Empty>。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-182"><xref:System.String.Empty>, if not set by the constructor.</span></span>|  
|<xref:System.Messaging.MessageQueue.DenySharedReceive%2A>|`false`|  
|<xref:System.Messaging.MessageQueue.UseJournalQueue%2A>|<span data-ttu-id="f3a8c-183">メッセージキューオブジェクトのジャーナル設定が有効になっている場合は `true`。それ以外の場合は、`false`ます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-183">`true`, if the Message Queuing object's journal setting is enabled; otherwise, `false`.</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-184">次のコード例では、さまざまなパス名の構文型を使用して、新しい <xref:System.Messaging.MessageQueue> オブジェクトを作成します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-184">The following code example creates new <xref:System.Messaging.MessageQueue> objects using various path name syntax types.</span></span> <span data-ttu-id="f3a8c-185">いずれの場合も、コンストラクターで定義されているパスを持つキューにメッセージを送信します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-185">In each case, it sends a message to the queue whose path is defined in the constructor.</span></span>  
  
 [!code-cpp[MessageQueue.Path#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Path/CPP/mqpath.cpp#1)]
 [!code-csharp[MessageQueue.Path#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Path/CS/mqpath.cs#1)]
 [!code-vb[MessageQueue.Path#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Path/VB/mqpath.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="f3a8c-186"><see cref="P:System.Messaging.MessageQueue.Path" /> プロパティが無効です。プロパティが設定されていないためと考えられます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-186">The <see cref="P:System.Messaging.MessageQueue.Path" /> property is not valid, possibly because it has not been set.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.FormatName" />
        <altmember cref="P:System.Messaging.MessageQueue.Label" />
        <altmember cref="P:System.Messaging.MessageQueue.QueueName" />
        <altmember cref="P:System.Messaging.MessageQueue.Path" />
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public MessageQueue (string path, bool sharedModeDenyReceive);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(string path, bool sharedModeDenyReceive) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.#ctor(System.String,System.Boolean)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (path As String, sharedModeDenyReceive As Boolean)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; MessageQueue(System::String ^ path, bool sharedModeDenyReceive);" />
      <MemberSignature Language="F#" Value="new System.Messaging.MessageQueue : string * bool -&gt; System.Messaging.MessageQueue" Usage="new System.Messaging.MessageQueue (path, sharedModeDenyReceive)" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="path" Type="System.String" />
        <Parameter Name="sharedModeDenyReceive" Type="System.Boolean" />
      </Parameters>
      <Docs>
        <param name="path"><span data-ttu-id="f3a8c-187">この <see cref="T:System.Messaging.MessageQueue" /> が参照するキューの場所。ローカル コンピューターの場合は "." にできます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-187">The location of the queue referenced by this <see cref="T:System.Messaging.MessageQueue" />, which can be "." for the local computer.</span></span></param>
        <param name="sharedModeDenyReceive"><span data-ttu-id="f3a8c-188">キューにアクセスする最初のアプリケーションに排他読み取りアクセス許可を与える場合は <see langword="true" />。それ以外の場合は <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-188"><see langword="true" /> to grant exclusive read access to the first application that accesses the queue; otherwise, <see langword="false" />.</span></span></param>
        <summary><span data-ttu-id="f3a8c-189">指定した読み取りアクセス制限を持つ指定したパスのメッセージ キューのキューを参照する <see cref="T:System.Messaging.MessageQueue" /> クラスの新しいインスタンスを初期化します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-189">Initializes a new instance of the <see cref="T:System.Messaging.MessageQueue" /> class that references the Message Queuing queue at the specified path and with the specified read-access restriction.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-190">パス、形式名、またはラベルがわかっている特定のメッセージキューのキューに新しい <xref:System.Messaging.MessageQueue> を関連付ける場合は、このオーバーロードを使用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-190">Use this overload when you want to tie the new <xref:System.Messaging.MessageQueue> to a particular Message Queuing queue, for which you know the path, format name, or label.</span></span> <span data-ttu-id="f3a8c-191">キューを参照する最初のアプリケーションに排他アクセスを許可する場合は、`sharedModeDenyReceive` パラメーターを `true`に設定します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-191">If you want to grant exclusive access to the first application that references the queue, set the `sharedModeDenyReceive` parameter to `true`.</span></span> <span data-ttu-id="f3a8c-192">それ以外の場合は、`sharedModeDenyReceive` を、`path` パラメーターのみを持つコンストラクターを `false` または使用するように設定します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-192">Otherwise, set `sharedModeDenyReceive` to `false` or use the constructor that has only a `path` parameter.</span></span>  
  
 <span data-ttu-id="f3a8c-193">`sharedModeDenyReceive` を `true` に設定すると、他のアプリケーションを含め、メッセージキューのキューにアクセスするすべてのオブジェクトに影響します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-193">Setting `sharedModeDenyReceive` to `true` affects all objects that access the Message Queuing queue, including other applications.</span></span> <span data-ttu-id="f3a8c-194">パラメーターの効果は、このアプリケーションに限定されません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-194">The effects of the parameter are not restricted to this application.</span></span>  
  
 <span data-ttu-id="f3a8c-195"><xref:System.Messaging.MessageQueue.%23ctor%2A> コンストラクターは、<xref:System.Messaging.MessageQueue> クラスの新しいインスタンスを作成します。新しいメッセージキューのキューは作成されません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-195">The <xref:System.Messaging.MessageQueue.%23ctor%2A> constructor creates a new instance of the <xref:System.Messaging.MessageQueue> class; it does not create a new Message Queuing queue.</span></span> <span data-ttu-id="f3a8c-196">メッセージキューに新しいキューを作成するには、<xref:System.Messaging.MessageQueue.Create%28System.String%29>を使用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-196">To create a new queue in Message Queuing, use <xref:System.Messaging.MessageQueue.Create%28System.String%29>.</span></span>  
  
 <span data-ttu-id="f3a8c-197">`path` パラメーターの構文は、キューの種類によって異なります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-197">The syntax of the `path` parameter depends on the type of queue.</span></span>  
  
|<span data-ttu-id="f3a8c-198">[キューの種類]</span><span class="sxs-lookup"><span data-stu-id="f3a8c-198">Queue type</span></span>|<span data-ttu-id="f3a8c-199">構文</span><span class="sxs-lookup"><span data-stu-id="f3a8c-199">Syntax</span></span>|  
|----------------|------------|  
|<span data-ttu-id="f3a8c-200">パブリックキュー</span><span class="sxs-lookup"><span data-stu-id="f3a8c-200">Public queue</span></span>|`MachineName`\\`QueueName`|  
|<span data-ttu-id="f3a8c-201">専用キュー</span><span class="sxs-lookup"><span data-stu-id="f3a8c-201">Private queue</span></span>|`MachineName`\\`Private$`\\`QueueName`|  
|<span data-ttu-id="f3a8c-202">ジャーナル キュー</span><span class="sxs-lookup"><span data-stu-id="f3a8c-202">Journal queue</span></span>|`MachineName`\\`QueueName`\\`Journal$`|  
|<span data-ttu-id="f3a8c-203">マシンジャーナルキュー</span><span class="sxs-lookup"><span data-stu-id="f3a8c-203">Machine journal queue</span></span>|`MachineName`\\`Journal$`|  
|<span data-ttu-id="f3a8c-204">コンピューターの配信不能キュー</span><span class="sxs-lookup"><span data-stu-id="f3a8c-204">Machine dead-letter queue</span></span>|`MachineName`\\`Deadletter$`|  
|<span data-ttu-id="f3a8c-205">コンピュータートランザクション配信不能キュー</span><span class="sxs-lookup"><span data-stu-id="f3a8c-205">Machine transactional dead-letter queue</span></span>|`MachineName`\\`XactDeadletter$`|  
  
 <span data-ttu-id="f3a8c-206">また、メッセージキューのキューの形式名またはラベルを使用して、キューのパスを記述することもできます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-206">Alternatively, you can use the format name or label of a Message Queuing queue to describe the queue path.</span></span>  
  
|<span data-ttu-id="f3a8c-207">関連項目</span><span class="sxs-lookup"><span data-stu-id="f3a8c-207">Reference</span></span>|<span data-ttu-id="f3a8c-208">構文</span><span class="sxs-lookup"><span data-stu-id="f3a8c-208">Syntax</span></span>|<span data-ttu-id="f3a8c-209">例</span><span class="sxs-lookup"><span data-stu-id="f3a8c-209">Example</span></span>|  
|---------------|------------|-------------|  
|<span data-ttu-id="f3a8c-210">形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-210">Format name</span></span>|<span data-ttu-id="f3a8c-211">`FormatName:` [*形式名*]</span><span class="sxs-lookup"><span data-stu-id="f3a8c-211">`FormatName:` [ *format name* ]</span></span>|<span data-ttu-id="f3a8c-212">`FormatName:Public=` 5A5F7535-AE9A-41d4-935C-845C2AFF7112</span><span class="sxs-lookup"><span data-stu-id="f3a8c-212">`FormatName:Public=` 5A5F7535-AE9A-41d4-935C-845C2AFF7112</span></span><br /><br /> <span data-ttu-id="f3a8c-213">`FormatName:DIRECT=SPX:` `NetworkNumber`;`HostNumber`\\`QueueName`</span><span class="sxs-lookup"><span data-stu-id="f3a8c-213">`FormatName:DIRECT=SPX:` `NetworkNumber`; `HostNumber`\\`QueueName`</span></span><br /><br /> <span data-ttu-id="f3a8c-214">`FormatName:DIRECT=TCP:` `IPAddress`\\`QueueName`</span><span class="sxs-lookup"><span data-stu-id="f3a8c-214">`FormatName:DIRECT=TCP:` `IPAddress`\\`QueueName`</span></span><br /><br /> <span data-ttu-id="f3a8c-215">`FormatName:DIRECT=OS:` `MachineName`\\`QueueName`</span><span class="sxs-lookup"><span data-stu-id="f3a8c-215">`FormatName:DIRECT=OS:` `MachineName`\\`QueueName`</span></span>|  
|<span data-ttu-id="f3a8c-216">group1</span><span class="sxs-lookup"><span data-stu-id="f3a8c-216">Label</span></span>|<span data-ttu-id="f3a8c-217">`Label:` [*ラベル*]</span><span class="sxs-lookup"><span data-stu-id="f3a8c-217">`Label:` [ *label* ]</span></span>|<span data-ttu-id="f3a8c-218">`Label:` TheLabel</span><span class="sxs-lookup"><span data-stu-id="f3a8c-218">`Label:` TheLabel</span></span>|  
  
 <span data-ttu-id="f3a8c-219">オフラインで作業するには、フレンドリ名の構文ではなく、形式名の構文を使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-219">To work offline, you must use the format name syntax, rather than the friendly name syntax.</span></span> <span data-ttu-id="f3a8c-220">それ以外の場合は、(Active Directory が存在する) プライマリドメインコントローラーが形式名へのパスを解決できないため、例外がスローされます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-220">Otherwise, an exception is thrown because the primary domain controller (on which Active Directory resides) is not available to resolve the path to the format name.</span></span>  
  
 <span data-ttu-id="f3a8c-221"><xref:System.Messaging.MessageQueue> が `sharedModeDenyReceive` パラメーターを `true`に設定してキューを開くと、共有違反が発生したため、後でキューからの読み取りを試みたすべての <xref:System.Messaging.MessageQueue> で <xref:System.Messaging.MessageQueueException> が生成されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-221">If a <xref:System.Messaging.MessageQueue> opens a queue with the `sharedModeDenyReceive` parameter set to `true`, any <xref:System.Messaging.MessageQueue> that subsequently tries to read from the queue generates a <xref:System.Messaging.MessageQueueException> because of a sharing violation.</span></span> <span data-ttu-id="f3a8c-222"><xref:System.Messaging.MessageQueueException> は、<xref:System.Messaging.MessageQueue> が排他モードでキューにアクセスしようとしたときに、別の <xref:System.Messaging.MessageQueue> が既にキューへの非排他的アクセスを試みた場合にもスローされます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-222">A <xref:System.Messaging.MessageQueueException> is also thrown if a <xref:System.Messaging.MessageQueue> tries to access the queue in exclusive mode while another <xref:System.Messaging.MessageQueue> already has non-exclusive access to the queue.</span></span>  
  
 <span data-ttu-id="f3a8c-223">次の表に、<xref:System.Messaging.MessageQueue>のインスタンスのプロパティの初期値を示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-223">The following table shows initial property values for an instance of <xref:System.Messaging.MessageQueue>.</span></span> <span data-ttu-id="f3a8c-224">これらの値は、メッセージキューのキューのプロパティに基づいており、`path` パラメーターによって指定されたパスが使用されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-224">These values are based on the properties of the Message Queuing queue, with the path specified by the `path` parameter.</span></span>  
  
|<span data-ttu-id="f3a8c-225">プロパティ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-225">Property</span></span>|<span data-ttu-id="f3a8c-226">初期値</span><span class="sxs-lookup"><span data-stu-id="f3a8c-226">Initial value</span></span>|  
|--------------|-------------------|  
|<xref:System.Messaging.MessageQueue.Authenticate%2A>|<span data-ttu-id="f3a8c-227">`false`。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-227">`false`.</span></span>|  
|<xref:System.Messaging.MessageQueue.BasePriority%2A>|<span data-ttu-id="f3a8c-228">0.</span><span class="sxs-lookup"><span data-stu-id="f3a8c-228">0.</span></span>|  
|<xref:System.Messaging.MessageQueue.Category%2A>|<span data-ttu-id="f3a8c-229"><xref:System.Guid.Empty>。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-229"><xref:System.Guid.Empty>.</span></span>|  
|<xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A>|<span data-ttu-id="f3a8c-230"><xref:System.Messaging.DefaultPropertiesToSend> クラスのパラメーターなしのコンストラクターによって設定される値。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-230">The values set by the parameterless constructor of the <xref:System.Messaging.DefaultPropertiesToSend> class.</span></span>|  
|<xref:System.Messaging.MessageQueue.EncryptionRequired%2A>|<span data-ttu-id="f3a8c-231">メッセージキューのキューのプライバシーレベルの設定が "Body" の場合、`true`ます。それ以外の場合は、`false`ます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-231">`true`, if the Message Queuing queue's privacy level setting is "Body"; otherwise, `false`.</span></span>|  
|<xref:System.Messaging.MessageQueue.Formatter%2A>|<span data-ttu-id="f3a8c-232"><xref:System.Messaging.XmlMessageFormatter>。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-232"><xref:System.Messaging.XmlMessageFormatter>.</span></span>|  
|<xref:System.Messaging.MessageQueue.Label%2A>|<span data-ttu-id="f3a8c-233"><xref:System.String.Empty>。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-233"><xref:System.String.Empty>.</span></span>|  
|<xref:System.Messaging.MessageQueue.MachineName%2A>|<span data-ttu-id="f3a8c-234">メッセージキューのキューのコンピューター名プロパティの値。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-234">The value of the Message Queuing queue's computer name property.</span></span>|  
|<xref:System.Messaging.MessageQueue.MaximumJournalSize%2A>|<span data-ttu-id="f3a8c-235"><xref:System.Messaging.MessageQueue.InfiniteQueueSize>。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-235"><xref:System.Messaging.MessageQueue.InfiniteQueueSize>.</span></span>|  
|<xref:System.Messaging.MessageQueue.MaximumQueueSize%2A>|<span data-ttu-id="f3a8c-236"><xref:System.Messaging.MessageQueue.InfiniteQueueSize>。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-236"><xref:System.Messaging.MessageQueue.InfiniteQueueSize>.</span></span>|  
|<xref:System.Messaging.MessageQueue.MessageReadPropertyFilter%2A>|<span data-ttu-id="f3a8c-237"><xref:System.Messaging.MessagePropertyFilter> クラスのパラメーターなしのコンストラクターによって設定される値。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-237">The values set by the parameterless constructor of the <xref:System.Messaging.MessagePropertyFilter> class.</span></span>|  
|<xref:System.Messaging.MessageQueue.Path%2A>|<span data-ttu-id="f3a8c-238">コンストラクターによって設定されていない場合は <xref:System.String.Empty>。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-238"><xref:System.String.Empty>, if not set by the constructor.</span></span>|  
|<xref:System.Messaging.MessageQueue.QueueName%2A>|<span data-ttu-id="f3a8c-239">コンストラクターによって設定されていない場合は <xref:System.String.Empty>。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-239"><xref:System.String.Empty>, if not set by the constructor.</span></span>|  
|<xref:System.Messaging.MessageQueue.DenySharedReceive%2A>|<span data-ttu-id="f3a8c-240">`sharedModeDenyReceive` パラメーターの値。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-240">The value of the `sharedModeDenyReceive` parameter.</span></span>|  
|<xref:System.Messaging.MessageQueue.UseJournalQueue%2A>|<span data-ttu-id="f3a8c-241">メッセージキューオブジェクトのジャーナル設定が有効になっている場合は `true`。それ以外の場合は、`false`ます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-241">`true`, if the Message Queuing object's journal setting is enabled; otherwise, `false`.</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-242">次のコード例では、排他アクセスを使用して新しい <xref:System.Messaging.MessageQueue> を作成し、そのパスを設定して、メッセージをキューに送信します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-242">The following code example creates a new <xref:System.Messaging.MessageQueue> with exclusive access, sets its path, and sends a message to the queue.</span></span>  
  
 [!code-cpp[MessageQueue.ctor_PathSharedModeDenyReceive#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.ctor_PathSharedModeDenyReceive/CPP/mqctor_denysharedreceive.cpp#1)]
 [!code-csharp[MessageQueue.ctor_PathSharedModeDenyReceive#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.ctor_PathSharedModeDenyReceive/CS/mqctor_denysharedreceive.cs#1)]
 [!code-vb[MessageQueue.ctor_PathSharedModeDenyReceive#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.ctor_PathSharedModeDenyReceive/VB/mqctor_denysharedreceive.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="f3a8c-243"><see cref="P:System.Messaging.MessageQueue.Path" /> プロパティが無効です。プロパティが設定されていないためと考えられます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-243">The <see cref="P:System.Messaging.MessageQueue.Path" /> property is not valid, possibly because it has not been set.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.FormatName" />
        <altmember cref="P:System.Messaging.MessageQueue.Label" />
        <altmember cref="P:System.Messaging.MessageQueue.Path" />
        <altmember cref="P:System.Messaging.MessageQueue.QueueName" />
        <altmember cref="P:System.Messaging.MessageQueue.DenySharedReceive" />
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public MessageQueue (string path, System.Messaging.QueueAccessMode accessMode);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(string path, valuetype System.Messaging.QueueAccessMode accessMode) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.#ctor(System.String,System.Messaging.QueueAccessMode)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (path As String, accessMode As QueueAccessMode)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; MessageQueue(System::String ^ path, System::Messaging::QueueAccessMode accessMode);" />
      <MemberSignature Language="F#" Value="new System.Messaging.MessageQueue : string * System.Messaging.QueueAccessMode -&gt; System.Messaging.MessageQueue" Usage="new System.Messaging.MessageQueue (path, accessMode)" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="path" Type="System.String" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8;xamarinmac-3.0" />
        <Parameter Name="accessMode" Type="System.Messaging.QueueAccessMode" Index="1" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8;xamarinmac-3.0" />
      </Parameters>
      <Docs>
        <param name="path"><span data-ttu-id="f3a8c-244">この <see cref="T:System.Messaging.MessageQueue" /> が参照するキューの場所。ローカル コンピューターの場合は "." にできます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-244">The location of the queue referenced by this <see cref="T:System.Messaging.MessageQueue" />, which can be "." for the local computer.</span></span></param>
        <param name="accessMode"><span data-ttu-id="f3a8c-245"><see cref="T:System.Messaging.QueueAccessMode" /> 値のいずれか 1 つ。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-245">One of the <see cref="T:System.Messaging.QueueAccessMode" /> values.</span></span></param>
        <summary><span data-ttu-id="f3a8c-246"><see cref="T:System.Messaging.MessageQueue" /> クラスの新しいインスタンスを初期化します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-246">Initializes a new instance of the <see cref="T:System.Messaging.MessageQueue" /> class.</span></span></summary>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public MessageQueue (string path, bool sharedModeDenyReceive, bool enableCache);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(string path, bool sharedModeDenyReceive, bool enableCache) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.#ctor(System.String,System.Boolean,System.Boolean)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (path As String, sharedModeDenyReceive As Boolean, enableCache As Boolean)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; MessageQueue(System::String ^ path, bool sharedModeDenyReceive, bool enableCache);" />
      <MemberSignature Language="F#" Value="new System.Messaging.MessageQueue : string * bool * bool -&gt; System.Messaging.MessageQueue" Usage="new System.Messaging.MessageQueue (path, sharedModeDenyReceive, enableCache)" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="path" Type="System.String" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="sharedModeDenyReceive" Type="System.Boolean" Index="1" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="enableCache" Type="System.Boolean" Index="2" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="path"><span data-ttu-id="f3a8c-247">この <see cref="T:System.Messaging.MessageQueue" /> が参照するキューの場所。ローカル コンピューターの場合は "." にできます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-247">The location of the queue referenced by this <see cref="T:System.Messaging.MessageQueue" />, which can be "." for the local computer.</span></span></param>
        <param name="sharedModeDenyReceive"><span data-ttu-id="f3a8c-248">キューにアクセスする最初のアプリケーションに排他読み取りアクセス許可を与える場合は <see langword="true" />。それ以外の場合は <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-248"><see langword="true" /> to grant exclusive read access to the first application that accesses the queue; otherwise, <see langword="false" />.</span></span></param>
        <param name="enableCache"><span data-ttu-id="f3a8c-249">接続キャッシュを作成し、使用する場合は <see langword="true" />。それ以外の場合は <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-249"><see langword="true" /> to create and use a connection cache; otherwise, <see langword="false" />.</span></span></param>
        <summary><span data-ttu-id="f3a8c-250"><see cref="T:System.Messaging.MessageQueue" /> クラスの新しいインスタンスを初期化します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-250">Initializes a new instance of the <see cref="T:System.Messaging.MessageQueue" /> class.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Examples  
 <span data-ttu-id="f3a8c-251">次のコード例では、排他的読み取りアクセスと接続キャッシュを有効にした新しい <xref:System.Messaging.MessageQueue> を作成します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-251">The following code example creates a new <xref:System.Messaging.MessageQueue> with exclusive read access and with connection caching enabled.</span></span>  
  
 [!code-cpp[MessageQueue4#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue4/cpp/class1.cpp#1)]
 [!code-csharp[MessageQueue4#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue4/CS/class1.cs#1)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public MessageQueue (string path, bool sharedModeDenyReceive, bool enableCache, System.Messaging.QueueAccessMode accessMode);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(string path, bool sharedModeDenyReceive, bool enableCache, valuetype System.Messaging.QueueAccessMode accessMode) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.#ctor(System.String,System.Boolean,System.Boolean,System.Messaging.QueueAccessMode)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (path As String, sharedModeDenyReceive As Boolean, enableCache As Boolean, accessMode As QueueAccessMode)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; MessageQueue(System::String ^ path, bool sharedModeDenyReceive, bool enableCache, System::Messaging::QueueAccessMode accessMode);" />
      <MemberSignature Language="F#" Value="new System.Messaging.MessageQueue : string * bool * bool * System.Messaging.QueueAccessMode -&gt; System.Messaging.MessageQueue" Usage="new System.Messaging.MessageQueue (path, sharedModeDenyReceive, enableCache, accessMode)" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="path" Type="System.String" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="sharedModeDenyReceive" Type="System.Boolean" Index="1" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="enableCache" Type="System.Boolean" Index="2" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="accessMode" Type="System.Messaging.QueueAccessMode" Index="3" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="path"><span data-ttu-id="f3a8c-252">この <see cref="T:System.Messaging.MessageQueue" /> が参照するキューの場所。ローカル コンピューターの場合は "." にできます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-252">The location of the queue referenced by this <see cref="T:System.Messaging.MessageQueue" />, which can be "." for the local computer.</span></span></param>
        <param name="sharedModeDenyReceive"><span data-ttu-id="f3a8c-253">キューにアクセスする最初のアプリケーションに排他読み取りアクセス許可を与える場合は <see langword="true" />。それ以外の場合は <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-253"><see langword="true" /> to grant exclusive read access to the first application that accesses the queue; otherwise, <see langword="false" />.</span></span></param>
        <param name="enableCache"><span data-ttu-id="f3a8c-254">接続キャッシュを作成し、使用する場合は <see langword="true" />。それ以外の場合は <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-254"><see langword="true" /> to create and use a connection cache; otherwise, <see langword="false" />.</span></span></param>
        <param name="accessMode"><span data-ttu-id="f3a8c-255"><see cref="T:System.Messaging.QueueAccessMode" /> 値のいずれか 1 つ。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-255">One of the <see cref="T:System.Messaging.QueueAccessMode" /> values.</span></span></param>
        <summary><span data-ttu-id="f3a8c-256"><see cref="T:System.Messaging.MessageQueue" /> クラスの新しいインスタンスを初期化します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-256">Initializes a new instance of the <see cref="T:System.Messaging.MessageQueue" /> class.</span></span></summary>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
    <Member MemberName="AccessMode">
      <MemberSignature Language="C#" Value="public System.Messaging.QueueAccessMode AccessMode { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance valuetype System.Messaging.QueueAccessMode AccessMode" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.AccessMode" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property AccessMode As QueueAccessMode" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Messaging::QueueAccessMode AccessMode { System::Messaging::QueueAccessMode get(); };" />
      <MemberSignature Language="F#" Value="member this.AccessMode : System.Messaging.QueueAccessMode" Usage="System.Messaging.MessageQueue.AccessMode" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.QueueAccessMode</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="f3a8c-257">キューのアクセス モードを示す値を取得します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-257">Gets a value that indicates the access mode for the queue.</span></span></summary>
        <value><span data-ttu-id="f3a8c-258"><see cref="T:System.Messaging.QueueAccessMode" /> 値のいずれか 1 つ。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-258">One of the <see cref="T:System.Messaging.QueueAccessMode" /> values.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-259">コンストラクターを呼び出すときに特に指定しない限り、キューの既定のアクセスモードは `QueueAccessMode.SendAndReceive`ます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-259">The default access mode for a queue is `QueueAccessMode.SendAndReceive`, unless you specify otherwise when calling the constructor.</span></span>  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="Authenticate">
      <MemberSignature Language="C#" Value="public bool Authenticate { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool Authenticate" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.Authenticate" />
      <MemberSignature Language="VB.NET" Value="Public Property Authenticate As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property bool Authenticate { bool get(); void set(bool value); };" />
      <MemberSignature Language="F#" Value="member this.Authenticate : bool with get, set" Usage="System.Messaging.MessageQueue.Authenticate" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_Authenticate")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="f3a8c-260">キューが認証済みメッセージだけを受け入れるかどうかを示す値を取得または設定します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-260">Gets or sets a value that indicates whether the queue accepts only authenticated messages.</span></span></summary>
        <value><span data-ttu-id="f3a8c-261">キューが認証済みメッセージだけを受け入れる場合は <see langword="true" />。それ以外の場合は <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-261"><see langword="true" /> if the queue accepts only authenticated messages; otherwise, <see langword="false" />.</span></span> <span data-ttu-id="f3a8c-262">既定値は、<see langword="false" /> です。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-262">The default is <see langword="false" />.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-263">メッセージ認証は、メッセージの整合性を確保し、メッセージを送信したユーザーを確認する手段を提供します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-263">Message authentication provides a way to ensure message integrity and to verify who sent the message.</span></span> <span data-ttu-id="f3a8c-264">送信アプリケーションは、認証を要求するために、メッセージの認証レベルを設定します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-264">To request authentication, the sending application sets the message's authentication level.</span></span>  
  
 <span data-ttu-id="f3a8c-265"><xref:System.Messaging.MessageQueue.Authenticate%2A> を `true`に設定すると、この <xref:System.Messaging.MessageQueue> インスタンスだけでなく、サーバー上のキューへのアクセスが制限されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-265">When you set <xref:System.Messaging.MessageQueue.Authenticate%2A> to `true`, you are restricting access to the queue on the server, not only to this <xref:System.Messaging.MessageQueue> instance.</span></span> <span data-ttu-id="f3a8c-266">同じメッセージキューのキューに対して動作しているすべてのクライアントが影響を受けます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-266">All clients working against the same Message Queuing queue will be affected.</span></span>  
  
 <span data-ttu-id="f3a8c-267">認証済みのメッセージだけを受け入れるキューは、認証されていないメッセージを拒否します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-267">A queue that accepts only authenticated messages will reject a non-authenticated message.</span></span> <span data-ttu-id="f3a8c-268">メッセージの拒否通知を要求するには、送信側アプリケーションでメッセージの <xref:System.Messaging.Message.AcknowledgeType%2A> プロパティを設定します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-268">To request notification of message rejection, a sending application can set the <xref:System.Messaging.Message.AcknowledgeType%2A> property of the message.</span></span> <span data-ttu-id="f3a8c-269">メッセージが拒否されることは他にないため、配信元のアプリケーションは、配信不能キューに送信されるように要求しない限り、メッセージを紛失する可能性があります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-269">Because no other indication of message rejection exists, the sending application can lose the message unless you request that it be sent to the dead-letter queue.</span></span>  
  
 <span data-ttu-id="f3a8c-270">次の表は、このプロパティがさまざまなワークグループモードで使用できるかどうかを示しています。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-270">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-271">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-271">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-272">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-272">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-273">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-273">Local computer</span></span>|<span data-ttu-id="f3a8c-274">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-274">Yes</span></span>|  
|<span data-ttu-id="f3a8c-275">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-275">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-276">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-276">Yes</span></span>|  
|<span data-ttu-id="f3a8c-277">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-277">Remote computer</span></span>|<span data-ttu-id="f3a8c-278">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-278">No</span></span>|  
|<span data-ttu-id="f3a8c-279">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-279">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-280">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-280">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-281">次のコード例では、メッセージキューの <xref:System.Messaging.MessageQueue.Authenticate%2A> プロパティの値を取得して設定します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-281">The following code example gets and sets the value of a message queue's <xref:System.Messaging.MessageQueue.Authenticate%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#3](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#3)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="f3a8c-282">メッセージ キューのメソッドにアクセスしたときにエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-282">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.Message.UseDeadLetterQueue" />
        <altmember cref="P:System.Messaging.Message.AcknowledgeType" />
      </Docs>
    </Member>
    <Member MemberName="BasePriority">
      <MemberSignature Language="C#" Value="public short BasePriority { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance int16 BasePriority" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.BasePriority" />
      <MemberSignature Language="VB.NET" Value="Public Property BasePriority As Short" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property short BasePriority { short get(); void set(short value); };" />
      <MemberSignature Language="F#" Value="member this.BasePriority : int16 with get, set" Usage="System.Messaging.MessageQueue.BasePriority" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_BasePriority")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Int16</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="f3a8c-283">ネットワーク上でパブリック キューのメッセージを送信するためにメッセージ キューが使用する基本優先順位を取得または設定します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-283">Gets or sets the base priority Message Queuing uses to route a public queue's messages over the network.</span></span></summary>
        <value><span data-ttu-id="f3a8c-284">パブリック キューに送信されるすべてのメッセージに適用される単一の基本優先順位。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-284">The single base priority for all messages sent to the (public) queue.</span></span> <span data-ttu-id="f3a8c-285">既定値は 0 です。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-285">The default is zero (0).</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-286">メッセージキューの基本優先順位によって、そのキューに送信されるメッセージをネットワーク経由で転送するときにどのように処理するかが指定されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-286">A message queue's base priority specifies how a message en route to that queue is treated as it travels through the network.</span></span> <span data-ttu-id="f3a8c-287"><xref:System.Messaging.MessageQueue.BasePriority%2A> プロパティを設定すると、指定したキューに送信されるすべてのメッセージに対して、他のキューに送信されるメッセージよりも優先度が高いまたは低い優先順位になります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-287">You can set the <xref:System.Messaging.MessageQueue.BasePriority%2A> property to confer a higher or lower priority to all messages sent to the specified queue than those sent to other queues.</span></span> <span data-ttu-id="f3a8c-288">このプロパティを設定すると、メッセージキューのキューが変更されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-288">Setting this property modifies the Message Queuing queue.</span></span> <span data-ttu-id="f3a8c-289">そのため、その他の <xref:System.Messaging.MessageQueue> インスタンスは変更の影響を受けます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-289">Therefore, any other <xref:System.Messaging.MessageQueue> instances are affected by the change.</span></span>  
  
 <span data-ttu-id="f3a8c-290">メッセージキューの <xref:System.Messaging.MessageQueue.BasePriority%2A> は、メッセージの <xref:System.Messaging.Message.Priority%2A> プロパティに関連付けられていません。これは、受信メッセージがキューに配置される順序を指定します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-290">A message queue's <xref:System.Messaging.MessageQueue.BasePriority%2A> is not related to the <xref:System.Messaging.Message.Priority%2A> property of a message, which specifies the order in which an incoming message is placed in the queue.</span></span>  
  
 <span data-ttu-id="f3a8c-291"><xref:System.Messaging.MessageQueue.BasePriority%2A> は、形式名を使用してパスが指定されているパブリックキューにのみ適用されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-291"><xref:System.Messaging.MessageQueue.BasePriority%2A> applies only to public queues whose paths are specified using the format name.</span></span> <span data-ttu-id="f3a8c-292">プライベートキューの基本優先順位は常にゼロ (0) です。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-292">The base priority of a private queue is always zero (0).</span></span>  
  
 <span data-ttu-id="f3a8c-293">次の表は、このプロパティがさまざまなワークグループモードで使用できるかどうかを示しています。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-293">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-294">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-294">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-295">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-295">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-296">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-296">Local computer</span></span>|<span data-ttu-id="f3a8c-297">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-297">Yes</span></span>|  
|<span data-ttu-id="f3a8c-298">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-298">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-299">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-299">Yes</span></span>|  
|<span data-ttu-id="f3a8c-300">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-300">Remote computer</span></span>|<span data-ttu-id="f3a8c-301">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-301">No</span></span>|  
|<span data-ttu-id="f3a8c-302">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-302">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-303">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-303">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-304">次のコード例では、メッセージキューの <xref:System.Messaging.MessageQueue.BasePriority%2A> プロパティの値を取得して設定します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-304">The following code example gets and sets the value of a message queue's <xref:System.Messaging.MessageQueue.BasePriority%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#4](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#4)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="f3a8c-305">基本優先順位に無効な値が設定されています。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-305">The base priority was set to an invalid value.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="f3a8c-306">メッセージ キューのメソッドにアクセスしたときにエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-306">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.FormatName" />
      </Docs>
    </Member>
    <MemberGroup MemberName="BeginPeek">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <threadsafe><span data-ttu-id="f3a8c-307">メソッドはスレッドセーフではありません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-307">The method is not thread safe.</span></span></threadsafe>
        <summary><span data-ttu-id="f3a8c-308">メッセージのピークを開始し、完了したときにイベント ハンドラーに通知するようにメッセージ キューに指示して、非同期のピーク操作を実行します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-308">Initiates an asynchronous peek operation by telling Message Queuing to begin peeking a message and notify the event handler when finished.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="BeginPeek">
      <MemberSignature Language="C#" Value="public IAsyncResult BeginPeek ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.IAsyncResult BeginPeek() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.BeginPeek" />
      <MemberSignature Language="VB.NET" Value="Public Function BeginPeek () As IAsyncResult" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; IAsyncResult ^ BeginPeek();" />
      <MemberSignature Language="F#" Value="member this.BeginPeek : unit -&gt; IAsyncResult" Usage="messageQueue.BeginPeek " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.IAsyncResult</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="f3a8c-309">タイムアウトのない非同期のピーク操作を実行します。操作は、キューのメッセージが利用可能になるまで完了しません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-309">Initiates an asynchronous peek operation that has no time-out. The operation is not complete until a message becomes available in the queue.</span></span></summary>
        <returns><span data-ttu-id="f3a8c-310">ポストされた非同期要求を識別する <see cref="T:System.IAsyncResult" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-310">The <see cref="T:System.IAsyncResult" /> that identifies the posted asynchronous request.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-311">非同期処理では、<xref:System.Messaging.MessageQueue.BeginPeek%2A> を使用して、キューでメッセージが使用可能になったときに <xref:System.Messaging.MessageQueue.PeekCompleted> イベントを発生させます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-311">In asynchronous processing, you use <xref:System.Messaging.MessageQueue.BeginPeek%2A> to raise the <xref:System.Messaging.MessageQueue.PeekCompleted> event when a message becomes available in the queue.</span></span>  
  
 <span data-ttu-id="f3a8c-312"><xref:System.Messaging.MessageQueue.PeekCompleted> は、メッセージが既にキューに存在する場合にも発生します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-312"><xref:System.Messaging.MessageQueue.PeekCompleted> is also raised if a message already exists in the queue.</span></span>  
  
 <span data-ttu-id="f3a8c-313"><xref:System.Messaging.MessageQueue.BeginPeek%2A>を使用するには、非同期操作の結果を処理してイベントデリゲートに関連付けるイベントハンドラーを作成します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-313">To use <xref:System.Messaging.MessageQueue.BeginPeek%2A>, create an event handler that processes the results of the asynchronous operation, and associate it with your event delegate.</span></span> <span data-ttu-id="f3a8c-314"><xref:System.Messaging.MessageQueue.BeginPeek%2A> は、非同期のピーク操作を開始します。メッセージがキューに到着すると、<xref:System.Messaging.MessageQueue> には、<xref:System.Messaging.MessageQueue.PeekCompleted> イベントの発生時に通知されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-314"><xref:System.Messaging.MessageQueue.BeginPeek%2A> initiates an asynchronous peek operation; the <xref:System.Messaging.MessageQueue> is notified, through the raising of the <xref:System.Messaging.MessageQueue.PeekCompleted> event, when a message arrives in the queue.</span></span> <span data-ttu-id="f3a8c-315"><xref:System.Messaging.MessageQueue> は、<xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> を呼び出すか、<xref:System.Messaging.PeekCompletedEventArgs>を使用して結果を取得することによって、メッセージにアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-315">The <xref:System.Messaging.MessageQueue> can then access the message by calling <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> or by retrieving the result using the <xref:System.Messaging.PeekCompletedEventArgs>.</span></span>  
  
 <span data-ttu-id="f3a8c-316"><xref:System.Messaging.MessageQueue.BeginPeek%2A> メソッドはすぐに制御を返しますが、非同期操作は、イベントハンドラーが呼び出されるまで完了しません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-316">The <xref:System.Messaging.MessageQueue.BeginPeek%2A> method returns immediately, but the asynchronous operation is not completed until the event handler is called.</span></span>  
  
 <span data-ttu-id="f3a8c-317"><xref:System.Messaging.MessageQueue.BeginPeek%2A> は非同期であるため、このメソッドを呼び出して、現在の実行スレッドをブロックせずにキューをピークすることができます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-317">Because <xref:System.Messaging.MessageQueue.BeginPeek%2A> is asynchronous, you can call it to peek the queue without blocking the current thread of execution.</span></span> <span data-ttu-id="f3a8c-318">キューを同期的にピークするには、<xref:System.Messaging.MessageQueue.Peek%2A> メソッドを使用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-318">To synchronously peek the queue, use the <xref:System.Messaging.MessageQueue.Peek%2A> method.</span></span>  
  
 <span data-ttu-id="f3a8c-319">非同期操作が完了したら、イベントハンドラーで <xref:System.Messaging.MessageQueue.BeginPeek%2A> または <xref:System.Messaging.MessageQueue.BeginReceive%2A> を再度呼び出して、通知を受け取ることができます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-319">Once an asynchronous operation completes, you can call <xref:System.Messaging.MessageQueue.BeginPeek%2A> or <xref:System.Messaging.MessageQueue.BeginReceive%2A> again in the event handler to keep receiving notifications.</span></span>  
  
 <span data-ttu-id="f3a8c-320"><xref:System.Messaging.MessageQueue.BeginPeek%2A> 返される <xref:System.IAsyncResult> は、メソッドが開始した非同期操作を識別します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-320">The <xref:System.IAsyncResult> that <xref:System.Messaging.MessageQueue.BeginPeek%2A> returns identifies the asynchronous operation that the method started.</span></span> <span data-ttu-id="f3a8c-321">この <xref:System.IAsyncResult> は、操作の有効期間全体を通して使用できます。ただし、<xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> が呼び出されるまでは通常は使用しません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-321">You can use this <xref:System.IAsyncResult> throughout the lifetime of the operation, although you generally do not use it until <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> is called.</span></span> <span data-ttu-id="f3a8c-322">ただし、いくつかの非同期操作を開始する場合は、<xref:System.IAsyncResult> 値を配列に格納し、すべての操作または操作が完了するまで待機するかどうかを指定できます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-322">However, if you start several asynchronous operations, you can place their <xref:System.IAsyncResult> values in an array and specify whether to wait for all operations or any operation to complete.</span></span> <span data-ttu-id="f3a8c-323">この場合は、<xref:System.IAsyncResult> の <xref:System.IAsyncResult.AsyncWaitHandle%2A> プロパティを使用して、完了した操作を識別します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-323">In this case, you use the <xref:System.IAsyncResult.AsyncWaitHandle%2A> property of the <xref:System.IAsyncResult> to identify the completed operation.</span></span>  
  
 <span data-ttu-id="f3a8c-324"><xref:System.Messaging.MessageQueue.CanRead%2A> が `false`場合、完了イベントが発生しますが、<xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29>を呼び出すと例外がスローされます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-324">If <xref:System.Messaging.MessageQueue.CanRead%2A> is `false`, the completion event is raised, but an exception will be thrown when calling <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29>.</span></span>  
  
 <span data-ttu-id="f3a8c-325">次の表に、この方法をさまざまなワークグループモードで使用できるかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-325">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-326">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-326">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-327">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-327">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-328">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-328">Local computer</span></span>|<span data-ttu-id="f3a8c-329">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-329">Yes</span></span>|  
|<span data-ttu-id="f3a8c-330">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-330">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-331">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-331">Yes</span></span>|  
|<span data-ttu-id="f3a8c-332">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-332">Remote computer</span></span>|<span data-ttu-id="f3a8c-333">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-333">No</span></span>|  
|<span data-ttu-id="f3a8c-334">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-334">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-335">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-335">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-336">次のコード例では、`MyPeekCompleted`という名前のイベントハンドラーを作成し、それを <xref:System.Messaging.MessageQueue.PeekCompleted> イベントハンドラーデリゲートにアタッチし、<xref:System.Messaging.MessageQueue.BeginPeek%2A> を呼び出して、パス ".\myQueue" にあるキューで非同期のピーク操作を開始します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-336">The following code example creates an event handler named `MyPeekCompleted`, attaches it to the <xref:System.Messaging.MessageQueue.PeekCompleted> event handler delegate, and calls <xref:System.Messaging.MessageQueue.BeginPeek%2A> to initiate an asynchronous peek operation on the queue that is located at the path ".\myQueue".</span></span> <span data-ttu-id="f3a8c-337"><xref:System.Messaging.MessageQueue.PeekCompleted> イベントが発生すると、この例ではメッセージをピークし、その本文を画面に書き込みます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-337">When a <xref:System.Messaging.MessageQueue.PeekCompleted> event is raised, the example peeks the message and writes its body to the screen.</span></span> <span data-ttu-id="f3a8c-338">この例では、<xref:System.Messaging.MessageQueue.BeginPeek%2A> を再度呼び出して、新しい非同期ピーク操作を開始します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-338">The example then calls <xref:System.Messaging.MessageQueue.BeginPeek%2A> again to initiate a new asynchronous peek operation.</span></span>  
  
 [!code-cpp[MessageQueue.BeginPeek_noparms#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.BeginPeek_noparms/CPP/mqbeginpeek_noparms.cpp#1)]
 [!code-csharp[MessageQueue.BeginPeek_noparms#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.BeginPeek_noparms/CS/mqbeginpeek_noparms.cs#1)]
 [!code-vb[MessageQueue.BeginPeek_noparms#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.BeginPeek_noparms/VB/mqbeginpeek_noparms.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="f3a8c-339">メッセージ キューのメソッドにアクセスしたときにエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-339">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <threadsafe><span data-ttu-id="f3a8c-340">メソッドはスレッドセーフではありません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-340">The method is not thread safe.</span></span></threadsafe>
        <altmember cref="E:System.Messaging.MessageQueue.PeekCompleted" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
      </Docs>
    </Member>
    <Member MemberName="BeginPeek">
      <MemberSignature Language="C#" Value="public IAsyncResult BeginPeek (TimeSpan timeout);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.IAsyncResult BeginPeek(valuetype System.TimeSpan timeout) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.BeginPeek(System.TimeSpan)" />
      <MemberSignature Language="VB.NET" Value="Public Function BeginPeek (timeout As TimeSpan) As IAsyncResult" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; IAsyncResult ^ BeginPeek(TimeSpan timeout);" />
      <MemberSignature Language="F#" Value="member this.BeginPeek : TimeSpan -&gt; IAsyncResult" Usage="messageQueue.BeginPeek timeout" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.IAsyncResult</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" />
      </Parameters>
      <Docs>
        <param name="timeout"><span data-ttu-id="f3a8c-341">メッセージを使用できるようになるまでの待機時間を示す <see cref="T:System.TimeSpan" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-341">A <see cref="T:System.TimeSpan" /> that indicates the interval of time to wait for a message to become available.</span></span></param>
        <summary><span data-ttu-id="f3a8c-342">指定したタイムアウトのある非同期のピーク操作を実行します。この操作は、メッセージをキューで使用できるようになるか、タイムアウトが発生するまで完了しません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-342">Initiates an asynchronous peek operation that has a specified time-out. The operation is not complete until either a message becomes available in the queue or the time-out occurs.</span></span></summary>
        <returns><span data-ttu-id="f3a8c-343">ポストされた非同期要求を識別する <see cref="T:System.IAsyncResult" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-343">The <see cref="T:System.IAsyncResult" /> that identifies the posted asynchronous request.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-344">非同期処理では、<xref:System.Messaging.MessageQueue.BeginPeek%2A> を使用して、メッセージがキューで使用可能になったとき、または指定した時間が経過したときに <xref:System.Messaging.MessageQueue.PeekCompleted> イベントを発生させます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-344">In asynchronous processing, you use <xref:System.Messaging.MessageQueue.BeginPeek%2A> to raise the <xref:System.Messaging.MessageQueue.PeekCompleted> event when a message becomes available in the queue or when the specified interval of time has expired.</span></span>  
  
 <span data-ttu-id="f3a8c-345"><xref:System.Messaging.MessageQueue.PeekCompleted> は、メッセージが既にキューに存在する場合にも発生します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-345"><xref:System.Messaging.MessageQueue.PeekCompleted> is also raised if a message already exists in the queue.</span></span>  
  
 <span data-ttu-id="f3a8c-346"><xref:System.Messaging.MessageQueue.BeginPeek%2A>を使用するには、非同期操作の結果を処理してイベントデリゲートに関連付けるイベントハンドラーを作成します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-346">To use <xref:System.Messaging.MessageQueue.BeginPeek%2A>, create an event handler that processes the results of the asynchronous operation, and associate it with your event delegate.</span></span> <span data-ttu-id="f3a8c-347"><xref:System.Messaging.MessageQueue.BeginPeek%2A> は、非同期のピーク操作を開始します。メッセージがキューに到着すると、<xref:System.Messaging.MessageQueue> には、<xref:System.Messaging.MessageQueue.PeekCompleted> イベントの発生時に通知されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-347"><xref:System.Messaging.MessageQueue.BeginPeek%2A> initiates an asynchronous peek operation; the <xref:System.Messaging.MessageQueue> is notified, through the raising of the <xref:System.Messaging.MessageQueue.PeekCompleted> event, when a message arrives in the queue.</span></span> <span data-ttu-id="f3a8c-348"><xref:System.Messaging.MessageQueue> は、<xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> を呼び出すか、<xref:System.Messaging.PeekCompletedEventArgs>を使用して結果を取得することによって、メッセージにアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-348">The <xref:System.Messaging.MessageQueue> can then access the message by calling <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> or by retrieving the result using the <xref:System.Messaging.PeekCompletedEventArgs>.</span></span>  
  
 <span data-ttu-id="f3a8c-349"><xref:System.Messaging.MessageQueue.BeginPeek%2A> メソッドはすぐに制御を返しますが、非同期操作は、イベントハンドラーが呼び出されるまで完了しません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-349">The <xref:System.Messaging.MessageQueue.BeginPeek%2A> method returns immediately, but the asynchronous operation is not completed until the event handler is called.</span></span>  
  
 <span data-ttu-id="f3a8c-350"><xref:System.Messaging.MessageQueue.BeginPeek%2A> は非同期であるため、このメソッドを呼び出して、現在の実行スレッドをブロックせずにキューをピークすることができます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-350">Because <xref:System.Messaging.MessageQueue.BeginPeek%2A> is asynchronous, you can call it to peek the queue without blocking the current thread of execution.</span></span> <span data-ttu-id="f3a8c-351">キューを同期的にピークするには、<xref:System.Messaging.MessageQueue.Peek%2A> メソッドを使用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-351">To synchronously peek the queue, use the <xref:System.Messaging.MessageQueue.Peek%2A> method.</span></span>  
  
 <span data-ttu-id="f3a8c-352">非同期操作が完了したら、イベントハンドラーで <xref:System.Messaging.MessageQueue.BeginPeek%2A> または <xref:System.Messaging.MessageQueue.BeginReceive%2A> を再度呼び出して、通知を受け取ることができます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-352">Once an asynchronous operation completes, you can call <xref:System.Messaging.MessageQueue.BeginPeek%2A> or <xref:System.Messaging.MessageQueue.BeginReceive%2A> again in the event handler to keep receiving notifications.</span></span>  
  
 <span data-ttu-id="f3a8c-353"><xref:System.Messaging.MessageQueue.BeginPeek%2A> 返される <xref:System.IAsyncResult> は、メソッドが開始した非同期操作を識別します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-353">The <xref:System.IAsyncResult> that <xref:System.Messaging.MessageQueue.BeginPeek%2A> returns identifies the asynchronous operation that the method started.</span></span> <span data-ttu-id="f3a8c-354">この <xref:System.IAsyncResult> は、操作の有効期間全体を通して使用できます。ただし、<xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> が呼び出されるまでは通常は使用しません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-354">You can use this <xref:System.IAsyncResult> throughout the lifetime of the operation, although you generally do not use it until <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> is called.</span></span> <span data-ttu-id="f3a8c-355">ただし、いくつかの非同期操作を開始する場合は、<xref:System.IAsyncResult> 値を配列に格納し、すべての操作または操作が完了するまで待機するかどうかを指定できます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-355">However, if you start several asynchronous operations, you can place their <xref:System.IAsyncResult> values in an array and specify whether to wait for all operations or any operation to complete.</span></span> <span data-ttu-id="f3a8c-356">この場合は、<xref:System.IAsyncResult> の <xref:System.IAsyncResult.AsyncWaitHandle%2A> プロパティを使用して、完了した操作を識別します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-356">In this case, you use the <xref:System.IAsyncResult.AsyncWaitHandle%2A> property of the <xref:System.IAsyncResult> to identify the completed operation.</span></span>  
  
 <span data-ttu-id="f3a8c-357">このオーバーロードは、タイムアウトを指定します。`timeout` パラメーターで指定した間隔が経過すると、このコンポーネントは <xref:System.Messaging.MessageQueue.PeekCompleted> イベントを発生させます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-357">This overload specifies a time-out. If the interval specified by the `timeout` parameter expires, this component raises the <xref:System.Messaging.MessageQueue.PeekCompleted> event.</span></span> <span data-ttu-id="f3a8c-358">メッセージが存在しないため、後続の <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> を呼び出すと、例外がスローされます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-358">Because no message exists, a subsequent call to <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> will throw an exception.</span></span>  
  
 <span data-ttu-id="f3a8c-359"><xref:System.Messaging.MessageQueue.CanRead%2A> が `false`場合、完了イベントが発生しますが、<xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29>を呼び出すと例外がスローされます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-359">If <xref:System.Messaging.MessageQueue.CanRead%2A> is `false`, the completion event is raised, but an exception will be thrown when calling <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29>.</span></span>  
  
 <span data-ttu-id="f3a8c-360">次の表に、この方法をさまざまなワークグループモードで使用できるかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-360">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-361">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-361">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-362">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-362">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-363">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-363">Local computer</span></span>|<span data-ttu-id="f3a8c-364">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-364">Yes</span></span>|  
|<span data-ttu-id="f3a8c-365">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-365">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-366">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-366">Yes</span></span>|  
|<span data-ttu-id="f3a8c-367">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-367">Remote computer</span></span>|<span data-ttu-id="f3a8c-368">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-368">No</span></span>|  
|<span data-ttu-id="f3a8c-369">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-369">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-370">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-370">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-371">次のコード例では、キューのパス ".\myQueue" を使用して、非同期のピーク操作を作成します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-371">The following code example creates an asynchronous peek operation, using the queue path ".\myQueue".</span></span> <span data-ttu-id="f3a8c-372">イベントハンドラーを作成し、`MyPeekCompleted`して、<xref:System.Messaging.MessageQueue.PeekCompleted> イベントハンドラーデリゲートにアタッチします。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-372">It creates an event handler, `MyPeekCompleted`, and attaches it to the <xref:System.Messaging.MessageQueue.PeekCompleted> event handler delegate.</span></span> <span data-ttu-id="f3a8c-373">非同期のピーク操作を開始するには、1分のタイムアウトを使用して <xref:System.Messaging.MessageQueue.BeginPeek%2A> が呼び出されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-373"><xref:System.Messaging.MessageQueue.BeginPeek%2A> is called with a time-out of one minute, to initiate the asynchronous peek operation.</span></span> <span data-ttu-id="f3a8c-374"><xref:System.Messaging.MessageQueue.PeekCompleted> イベントが発生するか、タイムアウトの時間が経過すると、メッセージが存在する場合はメッセージが取得され、本文は画面に書き込まれます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-374">When a <xref:System.Messaging.MessageQueue.PeekCompleted> event is raised or the time-out expires, the message is retrieved if one exists, and its body is written to the screen.</span></span> <span data-ttu-id="f3a8c-375">次に、<xref:System.Messaging.MessageQueue.BeginPeek%2A> を再度呼び出して、同じタイムアウトを持つ新しい非同期ピーク操作を開始します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-375">Then <xref:System.Messaging.MessageQueue.BeginPeek%2A> is called again to initiate a new asynchronous peek operation with the same time-out.</span></span>  
  
 [!code-cpp[MessageQueue.BeginPeek_timeout#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.BeginPeek_timeout/CPP/mqbeginpeek_timeout.cpp#1)]
 [!code-csharp[MessageQueue.BeginPeek_timeout#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.BeginPeek_timeout/CS/mqbeginpeek_timeout.cs#1)]
 [!code-vb[MessageQueue.BeginPeek_timeout#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.BeginPeek_timeout/VB/mqbeginpeek_timeout.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="f3a8c-376"><paramref name="timeout" /> パラメーターに指定された値が無効です。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-376">The value specified for the <paramref name="timeout" /> parameter is not valid.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="f3a8c-377">メッセージ キューのメソッドにアクセスしたときにエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-377">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <threadsafe><span data-ttu-id="f3a8c-378">メソッドはスレッドセーフではありません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-378">The method is not thread safe.</span></span></threadsafe>
        <altmember cref="E:System.Messaging.MessageQueue.PeekCompleted" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="T:System.TimeSpan" />
      </Docs>
    </Member>
    <Member MemberName="BeginPeek">
      <MemberSignature Language="C#" Value="public IAsyncResult BeginPeek (TimeSpan timeout, object stateObject);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.IAsyncResult BeginPeek(valuetype System.TimeSpan timeout, object stateObject) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.BeginPeek(System.TimeSpan,System.Object)" />
      <MemberSignature Language="VB.NET" Value="Public Function BeginPeek (timeout As TimeSpan, stateObject As Object) As IAsyncResult" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; IAsyncResult ^ BeginPeek(TimeSpan timeout, System::Object ^ stateObject);" />
      <MemberSignature Language="F#" Value="member this.BeginPeek : TimeSpan * obj -&gt; IAsyncResult" Usage="messageQueue.BeginPeek (timeout, stateObject)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.IAsyncResult</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" />
        <Parameter Name="stateObject" Type="System.Object" />
      </Parameters>
      <Docs>
        <param name="timeout"><span data-ttu-id="f3a8c-379">メッセージを使用できるようになるまでの待機時間を示す <see cref="T:System.TimeSpan" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-379">A <see cref="T:System.TimeSpan" /> that indicates the interval of time to wait for a message to become available.</span></span></param>
        <param name="stateObject"><span data-ttu-id="f3a8c-380">非同期操作に関連付けられている情報を保持する状態オブジェクト。アプリケーションで指定します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-380">A state object, specified by the application, that contains information associated with the asynchronous operation.</span></span></param>
        <summary><span data-ttu-id="f3a8c-381">指定したタイムアウトと指定した状態オブジェクトを持つ非同期のピーク操作を実行します。状態オブジェクトは、操作の有効期間を通じて関連付けられた情報を提供します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-381">Initiates an asynchronous peek operation that has a specified time-out and a specified state object, which provides associated information throughout the operation's lifetime.</span></span> <span data-ttu-id="f3a8c-382">この操作は、メッセージをキューで使用できるようになるか、タイムアウトが発生するまで完了しません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-382">The operation is not complete until either a message becomes available in the queue or the time-out occurs.</span></span></summary>
        <returns><span data-ttu-id="f3a8c-383">ポストされた非同期要求を識別する <see cref="T:System.IAsyncResult" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-383">The <see cref="T:System.IAsyncResult" /> that identifies the posted asynchronous request.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-384">非同期処理では、<xref:System.Messaging.MessageQueue.BeginPeek%2A> を使用して、メッセージがキューで使用可能になったとき、または指定した時間が経過したときに <xref:System.Messaging.MessageQueue.PeekCompleted> イベントを発生させます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-384">In asynchronous processing, you use <xref:System.Messaging.MessageQueue.BeginPeek%2A> to raise the <xref:System.Messaging.MessageQueue.PeekCompleted> event when a message becomes available in the queue or when the specified interval of time has expired.</span></span>  
  
 <span data-ttu-id="f3a8c-385"><xref:System.Messaging.MessageQueue.PeekCompleted> は、メッセージが既にキューに存在する場合にも発生します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-385"><xref:System.Messaging.MessageQueue.PeekCompleted> is also raised if a message already exists in the queue.</span></span>  
  
 <span data-ttu-id="f3a8c-386">このオーバーロードを使用して、操作の有効期間全体にわたって保持される操作に情報を関連付けます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-386">Use this overload to associate information with the operation that will be preserved throughout the operation's lifetime.</span></span> <span data-ttu-id="f3a8c-387">イベントハンドラーは、操作に関連付けられている <xref:System.IAsyncResult> の <xref:System.IAsyncResult.AsyncState%2A> プロパティを参照することによって、この情報にアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-387">The event handler can access this information by looking at the <xref:System.IAsyncResult.AsyncState%2A> property of the <xref:System.IAsyncResult> that is associated with the operation.</span></span>  
  
 <span data-ttu-id="f3a8c-388"><xref:System.Messaging.MessageQueue.BeginPeek%2A>を使用するには、非同期操作の結果を処理してイベントデリゲートに関連付けるイベントハンドラーを作成します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-388">To use <xref:System.Messaging.MessageQueue.BeginPeek%2A>, create an event handler that processes the results of the asynchronous operation, and associate it with your event delegate.</span></span> <span data-ttu-id="f3a8c-389"><xref:System.Messaging.MessageQueue.BeginPeek%2A> は、非同期のピーク操作を開始します。メッセージがキューに到着すると、<xref:System.Messaging.MessageQueue> には、<xref:System.Messaging.MessageQueue.PeekCompleted> イベントの発生時に通知されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-389"><xref:System.Messaging.MessageQueue.BeginPeek%2A> initiates an asynchronous peek operation; the <xref:System.Messaging.MessageQueue> is notified, through the raising of the <xref:System.Messaging.MessageQueue.PeekCompleted> event, when a message arrives in the queue.</span></span> <span data-ttu-id="f3a8c-390"><xref:System.Messaging.MessageQueue> は、<xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> を呼び出すか、<xref:System.Messaging.PeekCompletedEventArgs>を使用して結果を取得することによって、メッセージにアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-390">The <xref:System.Messaging.MessageQueue> can then access the message by calling <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> or by retrieving the result using the <xref:System.Messaging.PeekCompletedEventArgs>.</span></span>  
  
 <span data-ttu-id="f3a8c-391"><xref:System.Messaging.MessageQueue.BeginPeek%2A> メソッドはすぐに制御を返しますが、非同期操作は、イベントハンドラーが呼び出されるまで完了しません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-391">The <xref:System.Messaging.MessageQueue.BeginPeek%2A> method returns immediately, but the asynchronous operation is not completed until the event handler is called.</span></span>  
  
 <span data-ttu-id="f3a8c-392"><xref:System.Messaging.MessageQueue.BeginPeek%2A> は非同期であるため、このメソッドを呼び出して、現在の実行スレッドをブロックせずにキューをピークすることができます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-392">Because <xref:System.Messaging.MessageQueue.BeginPeek%2A> is asynchronous, you can call it to peek the queue without blocking the current thread of execution.</span></span> <span data-ttu-id="f3a8c-393">キューを同期的にピークするには、<xref:System.Messaging.MessageQueue.Peek%2A> メソッドを使用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-393">To synchronously peek the queue, use the <xref:System.Messaging.MessageQueue.Peek%2A> method.</span></span>  
  
 <span data-ttu-id="f3a8c-394">非同期操作が完了したら、イベントハンドラーで <xref:System.Messaging.MessageQueue.BeginPeek%2A> または <xref:System.Messaging.MessageQueue.BeginReceive%2A> を再度呼び出して、通知を受け取ることができます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-394">Once an asynchronous operation completes, you can call <xref:System.Messaging.MessageQueue.BeginPeek%2A> or <xref:System.Messaging.MessageQueue.BeginReceive%2A> again in the event handler to keep receiving notifications.</span></span>  
  
 <span data-ttu-id="f3a8c-395"><xref:System.Messaging.MessageQueue.BeginPeek%2A> は、メソッドが開始した非同期操作を識別する <xref:System.IAsyncResult> を返します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-395"><xref:System.Messaging.MessageQueue.BeginPeek%2A> returns a <xref:System.IAsyncResult> that identifies the asynchronous operation that the method started.</span></span> <span data-ttu-id="f3a8c-396">この <xref:System.IAsyncResult> は、操作の有効期間全体を通して使用できます。ただし、<xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> が呼び出されるまでは通常は使用しません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-396">You can use this <xref:System.IAsyncResult> throughout the lifetime of the operation, although you generally do not use it until <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> is called.</span></span> <span data-ttu-id="f3a8c-397">ただし、いくつかの非同期操作を開始する場合は、<xref:System.IAsyncResult> 値を配列に格納し、すべての操作または操作が完了するまで待機するかどうかを指定できます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-397">However, if you start several asynchronous operations, you can place their <xref:System.IAsyncResult> values in an array and specify whether to wait for all operations or any operation to complete.</span></span> <span data-ttu-id="f3a8c-398">この場合は、<xref:System.IAsyncResult> の <xref:System.IAsyncResult.AsyncWaitHandle%2A> プロパティを使用して、完了した操作を識別します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-398">In this case, you use the <xref:System.IAsyncResult.AsyncWaitHandle%2A> property of the <xref:System.IAsyncResult> to identify the completed operation.</span></span>  
  
 <span data-ttu-id="f3a8c-399">このオーバーロードは、タイムアウトと状態オブジェクトを指定します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-399">This overload specifies a time-out and a state object.</span></span> <span data-ttu-id="f3a8c-400">`timeout` パラメーターで指定した間隔が経過すると、このコンポーネントは <xref:System.Messaging.MessageQueue.PeekCompleted> イベントを発生させます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-400">If the interval specified by the `timeout` parameter expires, this component raises the <xref:System.Messaging.MessageQueue.PeekCompleted> event.</span></span> <span data-ttu-id="f3a8c-401">メッセージが存在しないため、後続の <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> を呼び出すと、例外がスローされます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-401">Because no message exists, a subsequent call to <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> will throw an exception.</span></span>  
  
 <span data-ttu-id="f3a8c-402">状態オブジェクトは、状態情報を操作に関連付けます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-402">The state object associates state information with the operation.</span></span> <span data-ttu-id="f3a8c-403">たとえば、複数回 <xref:System.Messaging.MessageQueue.BeginPeek%2A> を呼び出して複数の操作を開始する場合は、定義した個別の状態オブジェクトを使用して各操作を識別できます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-403">For example, if you call <xref:System.Messaging.MessageQueue.BeginPeek%2A> multiple times to initiate multiple operations, you can identify each operation through a separate state object that you define.</span></span> <span data-ttu-id="f3a8c-404">このシナリオの図解は、「例」のセクションを参照してください。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-404">For an illustration of this scenario, see the Example section.</span></span>  
  
 <span data-ttu-id="f3a8c-405">また、state オブジェクトを使用して、プロセススレッド間で情報を渡すこともできます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-405">You can also use the state object to pass information across process threads.</span></span> <span data-ttu-id="f3a8c-406">スレッドが開始されていても、コールバックが非同期シナリオの別のスレッドにある場合は、状態オブジェクトがマーシャリングされ、イベントからの情報と共に返されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-406">If a thread is started but the callback is on a different thread in an asynchronous scenario, the state object is marshaled and passed back along with information from the event.</span></span>  
  
 <span data-ttu-id="f3a8c-407"><xref:System.Messaging.MessageQueue.CanRead%2A> が `false`場合、完了イベントが発生しますが、<xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29>を呼び出すと例外がスローされます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-407">If <xref:System.Messaging.MessageQueue.CanRead%2A> is `false`, the completion event is raised, but an exception will be thrown when calling <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29>.</span></span>  
  
 <span data-ttu-id="f3a8c-408">次の表に、この方法をさまざまなワークグループモードで使用できるかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-408">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-409">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-409">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-410">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-410">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-411">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-411">Local computer</span></span>|<span data-ttu-id="f3a8c-412">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-412">Yes</span></span>|  
|<span data-ttu-id="f3a8c-413">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-413">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-414">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-414">Yes</span></span>|  
|<span data-ttu-id="f3a8c-415">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-415">Remote computer</span></span>|<span data-ttu-id="f3a8c-416">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-416">No</span></span>|  
|<span data-ttu-id="f3a8c-417">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-417">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-418">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-418">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-419">次のコード例では、キューのパス ".\myQueue" を使用して、非同期のピーク操作を作成します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-419">The following code example creates an asynchronous peek operation, using the queue path ".\myQueue".</span></span> <span data-ttu-id="f3a8c-420">イベントハンドラーを作成し、`MyPeekCompleted`して、<xref:System.Messaging.MessageQueue.PeekCompleted> イベントハンドラーデリゲートにアタッチします。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-420">It creates an event handler, `MyPeekCompleted`, and attaches it to the <xref:System.Messaging.MessageQueue.PeekCompleted> event handler delegate.</span></span> <span data-ttu-id="f3a8c-421"><xref:System.Messaging.MessageQueue.BeginPeek%2A> が1分のタイムアウトで呼び出されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-421"><xref:System.Messaging.MessageQueue.BeginPeek%2A> is called, with a time-out of one minute.</span></span> <span data-ttu-id="f3a8c-422"><xref:System.Messaging.MessageQueue.BeginPeek%2A> の各呼び出しには、その特定の操作を識別する一意の関連付けられた整数があります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-422">Each call to <xref:System.Messaging.MessageQueue.BeginPeek%2A> has a unique associated integer that identifies that particular operation.</span></span> <span data-ttu-id="f3a8c-423"><xref:System.Messaging.MessageQueue.PeekCompleted> イベントが発生するか、タイムアウトの時間が経過すると、メッセージ (存在する場合) が取得され、その本文および操作固有の整数識別子が画面に書き込まれます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-423">When a <xref:System.Messaging.MessageQueue.PeekCompleted> event is raised or the time-out expired, the message, if one exists, is retrieved and its body and the operation-specific integer identifier are written to the screen.</span></span> <span data-ttu-id="f3a8c-424">次に、<xref:System.Messaging.MessageQueue.BeginPeek%2A> が再度呼び出され、同じタイムアウトと、完了した直前の操作の関連付けられた整数を使用して、新しい非同期ピーク操作を開始します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-424">Then <xref:System.Messaging.MessageQueue.BeginPeek%2A> is called again to initiate a new asynchronous peek operation with the same time-out and the associated integer of the just completed operation.</span></span>  
  
 [!code-cpp[MessageQueue.BeginPeek_TimeSpanStateObject#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.BeginPeek_TimeSpanStateObject/CPP/mqbeginpeek_timeoutstateobject.cpp#1)]
 [!code-csharp[MessageQueue.BeginPeek_TimeSpanStateObject#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.BeginPeek_TimeSpanStateObject/CS/mqbeginpeek_timeoutstateobject.cs#1)]
 [!code-vb[MessageQueue.BeginPeek_TimeSpanStateObject#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.BeginPeek_TimeSpanStateObject/VB/mqbeginpeek_timeoutstateobject.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="f3a8c-425"><paramref name="timeout" /> パラメーターに指定された値が無効です。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-425">The value specified for the <paramref name="timeout" /> parameter is not valid.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="f3a8c-426">メッセージ キューのメソッドにアクセスしたときにエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-426">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <threadsafe><span data-ttu-id="f3a8c-427">メソッドはスレッドセーフではありません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-427">The method is not thread safe.</span></span></threadsafe>
        <altmember cref="E:System.Messaging.MessageQueue.PeekCompleted" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="T:System.TimeSpan" />
      </Docs>
    </Member>
    <Member MemberName="BeginPeek">
      <MemberSignature Language="C#" Value="public IAsyncResult BeginPeek (TimeSpan timeout, object stateObject, AsyncCallback callback);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.IAsyncResult BeginPeek(valuetype System.TimeSpan timeout, object stateObject, class System.AsyncCallback callback) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.BeginPeek(System.TimeSpan,System.Object,System.AsyncCallback)" />
      <MemberSignature Language="VB.NET" Value="Public Function BeginPeek (timeout As TimeSpan, stateObject As Object, callback As AsyncCallback) As IAsyncResult" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; IAsyncResult ^ BeginPeek(TimeSpan timeout, System::Object ^ stateObject, AsyncCallback ^ callback);" />
      <MemberSignature Language="F#" Value="member this.BeginPeek : TimeSpan * obj * AsyncCallback -&gt; IAsyncResult" Usage="messageQueue.BeginPeek (timeout, stateObject, callback)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.IAsyncResult</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" />
        <Parameter Name="stateObject" Type="System.Object" />
        <Parameter Name="callback" Type="System.AsyncCallback" />
      </Parameters>
      <Docs>
        <param name="timeout"><span data-ttu-id="f3a8c-428">メッセージを使用できるようになるまでの待機時間を示す <see cref="T:System.TimeSpan" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-428">A <see cref="T:System.TimeSpan" /> that indicates the interval of time to wait for a message to become available.</span></span></param>
        <param name="stateObject"><span data-ttu-id="f3a8c-429">非同期操作に関連付けられている情報を保持する状態オブジェクト。アプリケーションで指定します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-429">A state object, specified by the application, that contains information associated with the asynchronous operation.</span></span></param>
        <param name="callback"><span data-ttu-id="f3a8c-430">非同期操作の完了通知を受信する <see cref="T:System.AsyncCallback" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-430">The <see cref="T:System.AsyncCallback" /> that will receive the notification of the asynchronous operation completion.</span></span></param>
        <summary><span data-ttu-id="f3a8c-431">指定したタイムアウトと指定した状態オブジェクトを持つ非同期のピーク操作を実行します。状態オブジェクトは、操作の有効期間を通じて関連付けられた情報を提供します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-431">Initiates an asynchronous peek operation that has a specified time-out and a specified state object, which provides associated information throughout the operation's lifetime.</span></span> <span data-ttu-id="f3a8c-432">このオーバーロードは、コールバックを通じて操作のイベント ハンドラー ID の通知を受信します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-432">This overload receives notification, through a callback, of the identity of the event handler for the operation.</span></span> <span data-ttu-id="f3a8c-433">この操作は、メッセージをキューで使用できるようになるか、タイムアウトが発生するまで完了しません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-433">The operation is not complete until either a message becomes available in the queue or the time-out occurs.</span></span></summary>
        <returns><span data-ttu-id="f3a8c-434">ポストされた非同期要求を識別する <see cref="T:System.IAsyncResult" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-434">The <see cref="T:System.IAsyncResult" /> that identifies the posted asynchronous request.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-435">このオーバーロードを使用すると、メッセージがキューで利用可能になるか、指定した時間が経過したときに、callback パラメーターで指定されたコールバックが直接呼び出されます。<xref:System.Messaging.MessageQueue.PeekCompleted> イベントが発生していません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-435">When you use this overload, the callback specified in the callback parameter is invoked directly when a message becomes available in the queue or when the specified interval of time has expired; the <xref:System.Messaging.MessageQueue.PeekCompleted> event is not raised.</span></span> <span data-ttu-id="f3a8c-436"><xref:System.Messaging.MessageQueue.BeginPeek%2A> の他のオーバーロードは、このコンポーネントに依存して <xref:System.Messaging.MessageQueue.PeekCompleted> イベントを発生させます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-436">The other overloads of <xref:System.Messaging.MessageQueue.BeginPeek%2A> rely on this component to raise the <xref:System.Messaging.MessageQueue.PeekCompleted> event.</span></span>  
  
 <span data-ttu-id="f3a8c-437"><xref:System.Messaging.MessageQueue.PeekCompleted> は、メッセージが既にキューに存在する場合にも発生します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-437"><xref:System.Messaging.MessageQueue.PeekCompleted> is also raised if a message already exists in the queue.</span></span>  
  
 <span data-ttu-id="f3a8c-438"><xref:System.Messaging.MessageQueue.BeginPeek%2A> メソッドはすぐに制御を返しますが、非同期操作は、イベントハンドラーが呼び出されるまで完了しません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-438">The <xref:System.Messaging.MessageQueue.BeginPeek%2A> method returns immediately, but the asynchronous operation is not completed until the event handler is called.</span></span>  
  
 <span data-ttu-id="f3a8c-439"><xref:System.Messaging.MessageQueue.BeginPeek%2A> は非同期であるため、このメソッドを呼び出して、現在の実行スレッドをブロックせずにキューをピークすることができます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-439">Because <xref:System.Messaging.MessageQueue.BeginPeek%2A> is asynchronous, you can call it to peek the queue without blocking the current thread of execution.</span></span> <span data-ttu-id="f3a8c-440">キューを同期的にピークするには、<xref:System.Messaging.MessageQueue.Peek%2A> メソッドを使用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-440">To synchronously peek the queue, use the <xref:System.Messaging.MessageQueue.Peek%2A> method.</span></span>  
  
 <span data-ttu-id="f3a8c-441">非同期操作が完了したら、イベントハンドラーで <xref:System.Messaging.MessageQueue.BeginPeek%2A> または <xref:System.Messaging.MessageQueue.BeginReceive%2A> を再度呼び出して、通知を受け取ることができます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-441">Once an asynchronous operation completes, you can call <xref:System.Messaging.MessageQueue.BeginPeek%2A> or <xref:System.Messaging.MessageQueue.BeginReceive%2A> again in the event handler to keep receiving notifications.</span></span>  
  
 <span data-ttu-id="f3a8c-442"><xref:System.Messaging.MessageQueue.BeginPeek%2A> は、メソッドが開始した非同期操作を識別する <xref:System.IAsyncResult> を返します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-442"><xref:System.Messaging.MessageQueue.BeginPeek%2A> returns a <xref:System.IAsyncResult> that identifies the asynchronous operation that the method started.</span></span> <span data-ttu-id="f3a8c-443">この <xref:System.IAsyncResult> は、操作の有効期間全体を通して使用できます。ただし、<xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> が呼び出されるまでは通常は使用しません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-443">You can use this <xref:System.IAsyncResult> throughout the lifetime of the operation, although you generally do not use it until <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> is called.</span></span> <span data-ttu-id="f3a8c-444">ただし、いくつかの非同期操作を開始する場合は、<xref:System.IAsyncResult> 値を配列に格納し、すべての操作または操作が完了するまで待機するかどうかを指定できます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-444">However, if you start several asynchronous operations, you can place their <xref:System.IAsyncResult> values in an array and specify whether to wait for all operations or any operation to complete.</span></span> <span data-ttu-id="f3a8c-445">この場合は、<xref:System.IAsyncResult> の <xref:System.IAsyncResult.AsyncWaitHandle%2A> プロパティを使用して、完了した操作を識別します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-445">In this case, you use the <xref:System.IAsyncResult.AsyncWaitHandle%2A> property of the <xref:System.IAsyncResult> to identify the completed operation.</span></span>  
  
 <span data-ttu-id="f3a8c-446">状態オブジェクトは、状態情報を操作に関連付けます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-446">The state object associates state information with the operation.</span></span> <span data-ttu-id="f3a8c-447">たとえば、複数回 <xref:System.Messaging.MessageQueue.BeginPeek%2A> を呼び出して複数の操作を開始する場合は、定義した個別の状態オブジェクトを使用して各操作を識別できます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-447">For example, if you call <xref:System.Messaging.MessageQueue.BeginPeek%2A> multiple times to initiate multiple operations, you can identify each operation through a separate state object that you define.</span></span>  
  
 <span data-ttu-id="f3a8c-448">次の表に、この方法をさまざまなワークグループモードで使用できるかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-448">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-449">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-449">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-450">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-450">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-451">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-451">Local computer</span></span>|<span data-ttu-id="f3a8c-452">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-452">Yes</span></span>|  
|<span data-ttu-id="f3a8c-453">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-453">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-454">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-454">Yes</span></span>|  
|<span data-ttu-id="f3a8c-455">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-455">Remote computer</span></span>|<span data-ttu-id="f3a8c-456">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-456">No</span></span>|  
|<span data-ttu-id="f3a8c-457">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-457">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-458">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-458">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-459">次のコード例では、非同期のピーク操作を作成します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-459">The following code example creates an asynchronous peek operation.</span></span> <span data-ttu-id="f3a8c-460">このコード例では、メッセージをローカルのメッセージキューに送信し、<xref:System.Messaging.MessageQueue.BeginPeek%28System.TimeSpan%2CSystem.Object%2CSystem.AsyncCallback%29>を呼び出して、10秒のタイムアウト値を渡します。特定のメッセージを識別する一意の整数。イベントハンドラー、`MyPeekCompleted`を識別する <xref:System.AsyncCallback> の新しいインスタンス。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-460">The code example sends a message to a local message queue, then calls <xref:System.Messaging.MessageQueue.BeginPeek%28System.TimeSpan%2CSystem.Object%2CSystem.AsyncCallback%29>, passing in: a time-out value of ten seconds; a unique integer that identifies that particular message; and a new instance of <xref:System.AsyncCallback> that identifies the event handler, `MyPeekCompleted`.</span></span> <span data-ttu-id="f3a8c-461"><xref:System.Messaging.MessageQueue.PeekCompleted> イベントが発生すると、イベントハンドラーはメッセージをピークし、メッセージ本文と整数メッセージ識別子を画面に書き込みます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-461">When a <xref:System.Messaging.MessageQueue.PeekCompleted> event is raised, the event handler peeks at the message and writes the message body and the integer message identifier to the screen.</span></span>  
  
 [!code-cpp[MessageQueueBeginPeek#0](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueueBeginPeek/cpp/class1.cpp#0)]
 [!code-csharp[MessageQueueBeginPeek#0](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueueBeginPeek/CS/class1.cs#0)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="f3a8c-462"><paramref name="timeout" /> パラメーターに指定された値が無効です。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-462">The value specified for the <paramref name="timeout" /> parameter is not valid.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="f3a8c-463">メッセージ キューのメソッドにアクセスしたときにエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-463">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <threadsafe><span data-ttu-id="f3a8c-464">メソッドはスレッドセーフではありません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-464">The method is not thread safe.</span></span></threadsafe>
        <altmember cref="E:System.Messaging.MessageQueue.PeekCompleted" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="T:System.AsyncCallback" />
        <altmember cref="T:System.TimeSpan" />
      </Docs>
    </Member>
    <Member MemberName="BeginPeek">
      <MemberSignature Language="C#" Value="public IAsyncResult BeginPeek (TimeSpan timeout, System.Messaging.Cursor cursor, System.Messaging.PeekAction action, object state, AsyncCallback callback);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.IAsyncResult BeginPeek(valuetype System.TimeSpan timeout, class System.Messaging.Cursor cursor, valuetype System.Messaging.PeekAction action, object state, class System.AsyncCallback callback) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.BeginPeek(System.TimeSpan,System.Messaging.Cursor,System.Messaging.PeekAction,System.Object,System.AsyncCallback)" />
      <MemberSignature Language="VB.NET" Value="Public Function BeginPeek (timeout As TimeSpan, cursor As Cursor, action As PeekAction, state As Object, callback As AsyncCallback) As IAsyncResult" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; IAsyncResult ^ BeginPeek(TimeSpan timeout, System::Messaging::Cursor ^ cursor, System::Messaging::PeekAction action, System::Object ^ state, AsyncCallback ^ callback);" />
      <MemberSignature Language="F#" Value="member this.BeginPeek : TimeSpan * System.Messaging.Cursor * System.Messaging.PeekAction * obj * AsyncCallback -&gt; IAsyncResult" Usage="messageQueue.BeginPeek (timeout, cursor, action, state, callback)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.IAsyncResult</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="cursor" Type="System.Messaging.Cursor" Index="1" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="action" Type="System.Messaging.PeekAction" Index="2" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="state" Type="System.Object" Index="3" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="callback" Type="System.AsyncCallback" Index="4" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="timeout"><span data-ttu-id="f3a8c-465">メッセージを使用できるようになるまでの待機時間を示す <see cref="T:System.TimeSpan" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-465">A <see cref="T:System.TimeSpan" /> that indicates the interval of time to wait for a message to become available.</span></span></param>
        <param name="cursor"><span data-ttu-id="f3a8c-466">メッセージ キュー内の特定の位置を維持する <see cref="T:System.Messaging.Cursor" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-466">A <see cref="T:System.Messaging.Cursor" /> that maintains a specific position in the message queue.</span></span></param>
        <param name="action"><span data-ttu-id="f3a8c-467"><see cref="T:System.Messaging.PeekAction" /> 値のいずれか 1 つ。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-467">One of the <see cref="T:System.Messaging.PeekAction" /> values.</span></span> <span data-ttu-id="f3a8c-468">キュー内の現在のメッセージと次のメッセージのどちらをピークするかを示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-468">Indicates whether to peek at the current message in the queue, or the next message.</span></span></param>
        <param name="state"><span data-ttu-id="f3a8c-469">非同期操作に関連付けられている情報を保持する状態オブジェクト。アプリケーションで指定します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-469">A state object, specified by the application, that contains information associated with the asynchronous operation.</span></span></param>
        <param name="callback"><span data-ttu-id="f3a8c-470">非同期操作の完了通知を受信する <see cref="T:System.AsyncCallback" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-470">The <see cref="T:System.AsyncCallback" /> that receives the notification of the asynchronous operation completion.</span></span></param>
        <summary><span data-ttu-id="f3a8c-471">指定したタイムアウトがあり、指定したカーソル、ピーク処理、および状態オブジェクトを使用する非同期のピーク操作を実行します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-471">Initiates an asynchronous peek operation that has a specified time-out and that uses a specified cursor, a specified peek action, and a specified state object.</span></span> <span data-ttu-id="f3a8c-472">状態オブジェクトは、操作の有効期間を通じて、関連付けられた情報を提供します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-472">The state object provides associated information throughout the lifetime of the operation.</span></span> <span data-ttu-id="f3a8c-473">このオーバーロードは、コールバックを通じて操作のイベント ハンドラー ID の通知を受信します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-473">This overload receives notification, through a callback, of the identity of the event handler for the operation.</span></span> <span data-ttu-id="f3a8c-474">この操作は、メッセージをキューで使用できるようになるか、タイムアウトが発生するまで完了しません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-474">The operation is not complete until either a message becomes available in the queue or the time-out occurs.</span></span></summary>
        <returns><span data-ttu-id="f3a8c-475">ポストされた非同期要求を識別する <see cref="T:System.IAsyncResult" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-475">The <see cref="T:System.IAsyncResult" /> that identifies the posted asynchronous request.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-476">このオーバーロードを使用すると、メッセージがキューで使用可能になったとき、または指定した時間間隔が経過したときに、callback パラメーターで指定されたコールバックが直接呼び出されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-476">When you use this overload, the callback specified in the callback parameter is invoked directly when a message becomes available in the queue or when the specified interval of time has expired.</span></span> <span data-ttu-id="f3a8c-477"><xref:System.Messaging.MessageQueue.PeekCompleted> イベントが発生していません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-477">The <xref:System.Messaging.MessageQueue.PeekCompleted> event is not raised.</span></span> <span data-ttu-id="f3a8c-478"><xref:System.Messaging.MessageQueue.BeginPeek%2A> の他のオーバーロードは、このコンポーネントに依存して <xref:System.Messaging.MessageQueue.PeekCompleted> イベントを発生させます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-478">The other overloads of <xref:System.Messaging.MessageQueue.BeginPeek%2A> rely on this component to raise the <xref:System.Messaging.MessageQueue.PeekCompleted> event.</span></span>  
  
 <span data-ttu-id="f3a8c-479"><xref:System.Messaging.MessageQueue.PeekCompleted> は、メッセージが既にキューに存在する場合にも発生します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-479"><xref:System.Messaging.MessageQueue.PeekCompleted> is also raised if a message already exists in the queue.</span></span>  
  
 <span data-ttu-id="f3a8c-480"><xref:System.Messaging.MessageQueue.BeginPeek%2A> メソッドはすぐに制御を返しますが、非同期操作は、イベントハンドラーが呼び出されるまで完了しません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-480">The <xref:System.Messaging.MessageQueue.BeginPeek%2A> method returns immediately, but the asynchronous operation is not completed until the event handler is called.</span></span>  
  
 <span data-ttu-id="f3a8c-481"><xref:System.Messaging.MessageQueue.BeginPeek%2A> は非同期であるため、このメソッドを呼び出して、現在の実行スレッドをブロックせずにキューをピークすることができます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-481">Because <xref:System.Messaging.MessageQueue.BeginPeek%2A> is asynchronous, you can call it to peek the queue without blocking the current thread of execution.</span></span> <span data-ttu-id="f3a8c-482">キューを同期的にピークするには、<xref:System.Messaging.MessageQueue.Peek%2A> メソッドを使用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-482">To synchronously peek the queue, use the <xref:System.Messaging.MessageQueue.Peek%2A> method.</span></span>  
  
 <span data-ttu-id="f3a8c-483">非同期操作が完了したら、イベントハンドラーで <xref:System.Messaging.MessageQueue.BeginPeek%2A> または <xref:System.Messaging.MessageQueue.BeginReceive%2A> を再度呼び出して、通知を受け取ることができます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-483">Once an asynchronous operation completes, you can call <xref:System.Messaging.MessageQueue.BeginPeek%2A> or <xref:System.Messaging.MessageQueue.BeginReceive%2A> again in the event handler to keep receiving notifications.</span></span>  
  
 <span data-ttu-id="f3a8c-484"><xref:System.Messaging.MessageQueue.BeginPeek%2A> は、メソッドによって開始された非同期操作を識別する <xref:System.IAsyncResult> を返します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-484"><xref:System.Messaging.MessageQueue.BeginPeek%2A> returns a <xref:System.IAsyncResult> that identifies the asynchronous operation started by the method.</span></span> <span data-ttu-id="f3a8c-485">この <xref:System.IAsyncResult> は、操作の有効期間全体を通して使用できます。ただし、<xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> が呼び出されるまでは通常は使用しません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-485">You can use this <xref:System.IAsyncResult> throughout the lifetime of the operation, although you generally do not use it until <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> is called.</span></span> <span data-ttu-id="f3a8c-486">ただし、いくつかの非同期操作を開始する場合は、<xref:System.IAsyncResult> 値を配列に格納し、すべての操作または操作が完了するまで待機するかどうかを指定できます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-486">However, if you start several asynchronous operations, you can place their <xref:System.IAsyncResult> values in an array and specify whether to wait for all operations or any operation to complete.</span></span> <span data-ttu-id="f3a8c-487">この場合は、<xref:System.IAsyncResult> の <xref:System.IAsyncResult.AsyncWaitHandle%2A> プロパティを使用して、完了した操作を識別します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-487">In this case, use the <xref:System.IAsyncResult.AsyncWaitHandle%2A> property of the <xref:System.IAsyncResult> to identify the completed operation.</span></span>  
  
 <span data-ttu-id="f3a8c-488">状態オブジェクトは、状態情報を操作に関連付けます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-488">The state object associates state information with the operation.</span></span> <span data-ttu-id="f3a8c-489">たとえば、複数回 <xref:System.Messaging.MessageQueue.BeginPeek%2A> を呼び出して複数の操作を開始する場合は、定義した個別の状態オブジェクトを使用して各操作を識別できます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-489">For example, if you call <xref:System.Messaging.MessageQueue.BeginPeek%2A> multiple times to initiate multiple operations, you can identify each operation through a separate state object that you define.</span></span>  
  
 <span data-ttu-id="f3a8c-490">次の表に、この方法をさまざまなワークグループモードで使用できるかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-490">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-491">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-491">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-492">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-492">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-493">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-493">Local computer</span></span>|<span data-ttu-id="f3a8c-494">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-494">Yes</span></span>|  
|<span data-ttu-id="f3a8c-495">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-495">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-496">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-496">Yes</span></span>|  
|<span data-ttu-id="f3a8c-497">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-497">Remote computer</span></span>|<span data-ttu-id="f3a8c-498">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-498">No</span></span>|  
|<span data-ttu-id="f3a8c-499">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-499">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-500">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-500">Yes</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentOutOfRangeException"><span data-ttu-id="f3a8c-501"><paramref name="action" /> パラメーターに <see langword="PeekAction.Current" /> または <see langword="PeekAction.Next" /> 以外の値が指定されました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-501">A value other than <see langword="PeekAction.Current" /> or <see langword="PeekAction.Next" /> was specified for the <paramref name="action" /> parameter.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="f3a8c-502"><paramref name="cursor" /> パラメーターが <see langword="null" /> です。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-502">The <paramref name="cursor" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="f3a8c-503"><paramref name="timeout" /> パラメーターに指定された値が無効です。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-503">The value specified for the <paramref name="timeout" /> parameter is not valid.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="f3a8c-504">メッセージ キューのメソッドにアクセスしたときにエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-504">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <threadsafe><span data-ttu-id="f3a8c-505">メソッドはスレッドセーフではありません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-505">The method is not thread safe.</span></span></threadsafe>
        <altmember cref="E:System.Messaging.MessageQueue.PeekCompleted" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="T:System.AsyncCallback" />
        <altmember cref="T:System.TimeSpan" />
      </Docs>
    </Member>
    <MemberGroup MemberName="BeginReceive">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <threadsafe><span data-ttu-id="f3a8c-506">メソッドはスレッドセーフではありません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-506">The method is not thread safe.</span></span></threadsafe>
        <summary><span data-ttu-id="f3a8c-507">メッセージの受信を開始し、完了したときにイベント ハンドラーに通知するようにメッセージ キューに指示して、非同期の受信操作を実行します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-507">Initiates an asynchronous receive operation by telling Message Queuing to begin receiving a message and notify the event handler when finished.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="BeginReceive">
      <MemberSignature Language="C#" Value="public IAsyncResult BeginReceive ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.IAsyncResult BeginReceive() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.BeginReceive" />
      <MemberSignature Language="VB.NET" Value="Public Function BeginReceive () As IAsyncResult" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; IAsyncResult ^ BeginReceive();" />
      <MemberSignature Language="F#" Value="member this.BeginReceive : unit -&gt; IAsyncResult" Usage="messageQueue.BeginReceive " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.IAsyncResult</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="f3a8c-508">タイムアウトのない非同期の受信操作を実行します。操作は、キューのメッセージが利用可能になるまで完了しません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-508">Initiates an asynchronous receive operation that has no time-out. The operation is not complete until a message becomes available in the queue.</span></span></summary>
        <returns><span data-ttu-id="f3a8c-509">ポストされた非同期要求を識別する <see cref="T:System.IAsyncResult" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-509">The <see cref="T:System.IAsyncResult" /> that identifies the posted asynchronous request.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-510">非同期処理では、<xref:System.Messaging.MessageQueue.BeginReceive%2A> を使用して、キューからメッセージが削除されたときに <xref:System.Messaging.MessageQueue.ReceiveCompleted> イベントを発生させます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-510">In asynchronous processing, you use <xref:System.Messaging.MessageQueue.BeginReceive%2A> to raise the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event when a message has been removed from the queue.</span></span>  
  
 <span data-ttu-id="f3a8c-511"><xref:System.Messaging.MessageQueue.ReceiveCompleted> は、メッセージが既にキューに存在する場合にも発生します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-511"><xref:System.Messaging.MessageQueue.ReceiveCompleted> is also raised if a message already exists in the queue.</span></span>  
  
 <span data-ttu-id="f3a8c-512"><xref:System.Messaging.MessageQueue.BeginReceive%2A>を使用するには、非同期操作の結果を処理してイベントデリゲートに関連付けるイベントハンドラーを作成します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-512">To use <xref:System.Messaging.MessageQueue.BeginReceive%2A>, create an event handler that processes the results of the asynchronous operation and associate it with your event delegate.</span></span> <span data-ttu-id="f3a8c-513"><xref:System.Messaging.MessageQueue.BeginReceive%2A> は、非同期の受信操作を開始します。メッセージがキューに到着すると、<xref:System.Messaging.MessageQueue> には、<xref:System.Messaging.MessageQueue.ReceiveCompleted> イベントの発生時に通知されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-513"><xref:System.Messaging.MessageQueue.BeginReceive%2A> initiates an asynchronous receive operation; the <xref:System.Messaging.MessageQueue> is notified, through the raising of the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event, when a message arrives in the queue.</span></span> <span data-ttu-id="f3a8c-514"><xref:System.Messaging.MessageQueue> は、<xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29>を呼び出すことによってメッセージにアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-514">The <xref:System.Messaging.MessageQueue> can then access the message by calling <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29>.</span></span>  
  
 <span data-ttu-id="f3a8c-515"><xref:System.Messaging.MessageQueue.BeginReceive%2A> メソッドはすぐに制御を返しますが、非同期操作は、イベントハンドラーが呼び出されるまで完了しません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-515">The <xref:System.Messaging.MessageQueue.BeginReceive%2A> method returns immediately, but the asynchronous operation is not completed until the event handler is called.</span></span>  
  
 <span data-ttu-id="f3a8c-516"><xref:System.Messaging.MessageQueue.BeginReceive%2A> は非同期であるため、このメソッドを呼び出して、現在の実行スレッドをブロックせずにキューからメッセージを受信することができます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-516">Because <xref:System.Messaging.MessageQueue.BeginReceive%2A> is asynchronous, you can call it to receive a message from the queue without blocking the current thread of execution.</span></span> <span data-ttu-id="f3a8c-517">同期的にメッセージを受信するには、<xref:System.Messaging.MessageQueue.Receive%2A> メソッドを使用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-517">To synchronously receive a message, use the <xref:System.Messaging.MessageQueue.Receive%2A> method.</span></span>  
  
 <span data-ttu-id="f3a8c-518">非同期操作が完了したら、イベントハンドラーで <xref:System.Messaging.MessageQueue.BeginPeek%2A> または <xref:System.Messaging.MessageQueue.BeginReceive%2A> を再度呼び出して、通知を受け取ることができます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-518">Once an asynchronous operation completes, you can call <xref:System.Messaging.MessageQueue.BeginPeek%2A> or <xref:System.Messaging.MessageQueue.BeginReceive%2A> again in the event handler to keep receiving notifications.</span></span>  
  
 <span data-ttu-id="f3a8c-519"><xref:System.Messaging.MessageQueue.BeginReceive%2A> 返される <xref:System.IAsyncResult> は、メソッドが開始した非同期操作を識別します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-519">The <xref:System.IAsyncResult> that <xref:System.Messaging.MessageQueue.BeginReceive%2A> returns identifies the asynchronous operation that the method started.</span></span> <span data-ttu-id="f3a8c-520">この <xref:System.IAsyncResult> は、操作の有効期間全体を通して使用できます。ただし、<xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> が呼び出されるまでは通常は使用しません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-520">You can use this <xref:System.IAsyncResult> throughout the lifetime of the operation, although you generally do not use it until <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> is called.</span></span> <span data-ttu-id="f3a8c-521">ただし、いくつかの非同期操作を開始する場合は、<xref:System.IAsyncResult> 値を配列に格納し、すべての操作または操作が完了するまで待機するかどうかを指定できます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-521">However, if you start several asynchronous operations, you can place their <xref:System.IAsyncResult> values in an array and specify whether to wait for all operations or any operation to complete.</span></span> <span data-ttu-id="f3a8c-522">この場合は、<xref:System.IAsyncResult> の <xref:System.IAsyncResult.AsyncWaitHandle%2A> プロパティを使用して、完了した操作を識別します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-522">In this case, you use the <xref:System.IAsyncResult.AsyncWaitHandle%2A> property of the <xref:System.IAsyncResult> to identify the completed operation.</span></span>  
  
 <span data-ttu-id="f3a8c-523"><xref:System.Messaging.MessageQueue.CanRead%2A> が `false`場合、完了イベントが発生しますが、<xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29>を呼び出すと例外がスローされます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-523">If <xref:System.Messaging.MessageQueue.CanRead%2A> is `false`, the completion event is raised, but an exception will be thrown when calling <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29>.</span></span>  
  
 <span data-ttu-id="f3a8c-524">トランザクションで <xref:System.Messaging.MessageQueue.BeginReceive%2A> 非同期呼び出しを使用しないでください。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-524">Do not use the asynchronous call <xref:System.Messaging.MessageQueue.BeginReceive%2A> with transactions.</span></span> <span data-ttu-id="f3a8c-525">トランザクション非同期操作を実行する場合は、<xref:System.Messaging.MessageQueue.BeginPeek%2A>を呼び出し、トランザクションと (同期) <xref:System.Messaging.MessageQueue.Receive%2A> メソッドを、ピーク操作用に作成したイベントハンドラー内に配置します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-525">If you want to perform a transactional asynchronous operation, call <xref:System.Messaging.MessageQueue.BeginPeek%2A>, and put the transaction and the (synchronous) <xref:System.Messaging.MessageQueue.Receive%2A> method within the event handler you create for the peek operation.</span></span> <span data-ttu-id="f3a8c-526">イベントハンドラーには、次C#のコードに示すような機能が含まれている場合があります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-526">Your event handler might contain functionality as shown in the following C# code.</span></span>  
  
```csharp  
myMessageQueue.BeginTransaction();  
 myMessageQueue.Receive();  
 myMessageQueue.CommitTransaction();  
```  
  
 <span data-ttu-id="f3a8c-527">次の表に、この方法をさまざまなワークグループモードで使用できるかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-527">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-528">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-528">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-529">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-529">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-530">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-530">Local computer</span></span>|<span data-ttu-id="f3a8c-531">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-531">Yes</span></span>|  
|<span data-ttu-id="f3a8c-532">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-532">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-533">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-533">Yes</span></span>|  
|<span data-ttu-id="f3a8c-534">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-534">Remote computer</span></span>|<span data-ttu-id="f3a8c-535">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-535">No</span></span>|  
|<span data-ttu-id="f3a8c-536">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-536">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-537">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-537">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-538">次のコード例では、非同期要求をチェーンします。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-538">The following code example chains asynchronous requests.</span></span> <span data-ttu-id="f3a8c-539">これは、"myQueue" という名前のローカルコンピューターにキューがあることを前提としています。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-539">It assumes there is a queue on the local computer called "myQueue".</span></span> <span data-ttu-id="f3a8c-540">`Main` 関数は、`MyReceiveCompleted` ルーチンによって処理される非同期操作を開始します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-540">The `Main` function begins the asynchronous operation that is handled by the `MyReceiveCompleted` routine.</span></span> <span data-ttu-id="f3a8c-541">`MyReceiveCompleted` は、現在のメッセージを処理し、新しい非同期の受信操作を開始します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-541">`MyReceiveCompleted` processes the current message and begins a new asynchronous receive operation.</span></span>  
  
 [!code-cpp[MessageQueue.BeginReceive_noparms_combined#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.BeginReceive_noparms_combined/CPP/mqbeginreceive_noparms_mre.cpp#1)]
 [!code-csharp[MessageQueue.BeginReceive_noparms_combined#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.BeginReceive_noparms_combined/CS/mqbeginreceive_noparms_mre.cs#1)]
 [!code-vb[MessageQueue.BeginReceive_noparms_combined#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.BeginReceive_noparms_combined/VB/mqbeginreceive_noparms_mre.vb#1)]  
  
 <span data-ttu-id="f3a8c-542">次のコード例では、非同期要求をキューに置いています。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-542">The following code example queues asynchronous requests.</span></span> <span data-ttu-id="f3a8c-543"><xref:System.Messaging.MessageQueue.BeginReceive%2A> を呼び出すと、戻り値に <xref:System.IAsyncResult.AsyncWaitHandle%2A> が使用されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-543">The call to <xref:System.Messaging.MessageQueue.BeginReceive%2A> uses the <xref:System.IAsyncResult.AsyncWaitHandle%2A> in its return value.</span></span> <span data-ttu-id="f3a8c-544">`Main` ルーチンは、すべての非同期操作が完了するのを待ってから終了します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-544">The `Main` routine waits for all asynchronous operations to be completed before exiting.</span></span>  
  
 [!code-cpp[MessageQueue.BeginReceive_noparms_combined#2](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.BeginReceive_noparms_combined/CPP/mqbeginreceive_noparms_wh.cpp#2)]
 [!code-csharp[MessageQueue.BeginReceive_noparms_combined#2](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.BeginReceive_noparms_combined/CS/mqbeginreceive_noparms_wh.cs#2)]
 [!code-vb[MessageQueue.BeginReceive_noparms_combined#2](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.BeginReceive_noparms_combined/VB/mqbeginreceive_noparms_wh.vb#2)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="f3a8c-545">メッセージ キューのメソッドにアクセスしたときにエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-545">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <threadsafe><span data-ttu-id="f3a8c-546">メソッドはスレッドセーフではありません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-546">The method is not thread safe.</span></span></threadsafe>
        <altmember cref="E:System.Messaging.MessageQueue.ReceiveCompleted" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
      </Docs>
    </Member>
    <Member MemberName="BeginReceive">
      <MemberSignature Language="C#" Value="public IAsyncResult BeginReceive (TimeSpan timeout);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.IAsyncResult BeginReceive(valuetype System.TimeSpan timeout) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.BeginReceive(System.TimeSpan)" />
      <MemberSignature Language="VB.NET" Value="Public Function BeginReceive (timeout As TimeSpan) As IAsyncResult" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; IAsyncResult ^ BeginReceive(TimeSpan timeout);" />
      <MemberSignature Language="F#" Value="member this.BeginReceive : TimeSpan -&gt; IAsyncResult" Usage="messageQueue.BeginReceive timeout" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.IAsyncResult</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" />
      </Parameters>
      <Docs>
        <param name="timeout"><span data-ttu-id="f3a8c-547">メッセージを使用できるようになるまでの待機時間を示す <see cref="T:System.TimeSpan" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-547">A <see cref="T:System.TimeSpan" /> that indicates the interval of time to wait for a message to become available.</span></span></param>
        <summary><span data-ttu-id="f3a8c-548">指定したタイムアウトのある非同期の受信操作を実行します。この操作は、メッセージをキューで使用できるようになるか、タイムアウトが発生するまで完了しません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-548">Initiates an asynchronous receive operation that has a specified time-out. The operation is not complete until either a message becomes available in the queue or the time-out occurs.</span></span></summary>
        <returns><span data-ttu-id="f3a8c-549">ポストされた非同期要求を識別する <see cref="T:System.IAsyncResult" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-549">The <see cref="T:System.IAsyncResult" /> that identifies the posted asynchronous request.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-550">非同期処理では、<xref:System.Messaging.MessageQueue.BeginReceive%2A> を使用して、メッセージがキューで使用可能になったとき、または指定した時間が経過したときに <xref:System.Messaging.MessageQueue.ReceiveCompleted> イベントを発生させます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-550">In asynchronous processing, you use <xref:System.Messaging.MessageQueue.BeginReceive%2A> to raise the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event when a message becomes available in the queue or when the specified interval of time has expired.</span></span>  
  
 <span data-ttu-id="f3a8c-551"><xref:System.Messaging.MessageQueue.ReceiveCompleted> は、メッセージが既にキューに存在する場合にも発生します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-551"><xref:System.Messaging.MessageQueue.ReceiveCompleted> is also raised if a message already exists in the queue.</span></span>  
  
 <span data-ttu-id="f3a8c-552"><xref:System.Messaging.MessageQueue.BeginReceive%2A>を使用するには、非同期操作の結果を処理してイベントデリゲートに関連付けるイベントハンドラーを作成します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-552">To use <xref:System.Messaging.MessageQueue.BeginReceive%2A>, create an event handler that processes the results of the asynchronous operation and associate it with your event delegate.</span></span> <span data-ttu-id="f3a8c-553"><xref:System.Messaging.MessageQueue.BeginReceive%2A> は、非同期の受信操作を開始します。メッセージがキューに到着すると、<xref:System.Messaging.MessageQueue> には、<xref:System.Messaging.MessageQueue.ReceiveCompleted> イベントの発生時に通知されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-553"><xref:System.Messaging.MessageQueue.BeginReceive%2A> initiates an asynchronous receive operation; the <xref:System.Messaging.MessageQueue> is notified, through the raising of the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event, when a message arrives in the queue.</span></span> <span data-ttu-id="f3a8c-554"><xref:System.Messaging.MessageQueue> は、<xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> を呼び出すか、<xref:System.Messaging.ReceiveCompletedEventArgs>を使用して結果を取得することによって、メッセージにアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-554">The <xref:System.Messaging.MessageQueue> can then access the message by calling <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> or retrieving the result using the <xref:System.Messaging.ReceiveCompletedEventArgs>.</span></span>  
  
 <span data-ttu-id="f3a8c-555"><xref:System.Messaging.MessageQueue.BeginReceive%2A> メソッドはすぐに制御を返しますが、非同期操作は、イベントハンドラーが呼び出されるまで完了しません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-555">The <xref:System.Messaging.MessageQueue.BeginReceive%2A> method returns immediately, but the asynchronous operation is not completed until the event handler is called.</span></span>  
  
 <span data-ttu-id="f3a8c-556"><xref:System.Messaging.MessageQueue.BeginReceive%2A> は非同期であるため、このメソッドを呼び出して、現在の実行スレッドをブロックせずにキューからメッセージを受信することができます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-556">Because <xref:System.Messaging.MessageQueue.BeginReceive%2A> is asynchronous, you can call it to receive a message from the queue without blocking the current thread of execution.</span></span> <span data-ttu-id="f3a8c-557">同期的にメッセージを受信するには、<xref:System.Messaging.MessageQueue.Receive%2A> メソッドを使用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-557">To synchronously receive a message, use the <xref:System.Messaging.MessageQueue.Receive%2A> method.</span></span>  
  
 <span data-ttu-id="f3a8c-558">非同期操作が完了したら、イベントハンドラーで <xref:System.Messaging.MessageQueue.BeginPeek%2A> または <xref:System.Messaging.MessageQueue.BeginReceive%2A> を再度呼び出して、通知を受け取ることができます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-558">Once an asynchronous operation completes, you can call <xref:System.Messaging.MessageQueue.BeginPeek%2A> or <xref:System.Messaging.MessageQueue.BeginReceive%2A> again in the event handler to keep receiving notifications.</span></span>  
  
 <span data-ttu-id="f3a8c-559"><xref:System.Messaging.MessageQueue.CanRead%2A> が `false`場合、完了イベントが発生しますが、<xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29>を呼び出すと例外がスローされます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-559">If <xref:System.Messaging.MessageQueue.CanRead%2A> is `false`, the completion event is raised, but an exception will be thrown when calling <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29>.</span></span>  
  
 <span data-ttu-id="f3a8c-560"><xref:System.Messaging.MessageQueue.BeginReceive%2A> 返される <xref:System.IAsyncResult> は、メソッドが開始した非同期操作を識別します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-560">The <xref:System.IAsyncResult> that <xref:System.Messaging.MessageQueue.BeginReceive%2A> returns identifies the asynchronous operation that the method started.</span></span> <span data-ttu-id="f3a8c-561">この <xref:System.IAsyncResult> は、操作の有効期間全体を通して使用できます。ただし、<xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> が呼び出されるまでは通常は使用しません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-561">You can use this <xref:System.IAsyncResult> throughout the lifetime of the operation, although you generally do not use it until <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> is called.</span></span> <span data-ttu-id="f3a8c-562">ただし、いくつかの非同期操作を開始する場合は、<xref:System.IAsyncResult> 値を配列に格納し、すべての操作または操作が完了するまで待機するかどうかを指定できます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-562">However, if you start several asynchronous operations, you can place their <xref:System.IAsyncResult> values in an array and specify whether to wait for all operations or any operation to complete.</span></span> <span data-ttu-id="f3a8c-563">この場合は、<xref:System.IAsyncResult> の <xref:System.IAsyncResult.AsyncWaitHandle%2A> プロパティを使用して、完了した操作を識別します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-563">In this case, you use the <xref:System.IAsyncResult.AsyncWaitHandle%2A> property of the <xref:System.IAsyncResult> to identify the completed operation.</span></span>  
  
 <span data-ttu-id="f3a8c-564">このオーバーロードは、タイムアウトを指定します。`timeout` パラメーターで指定した間隔が経過すると、このコンポーネントは <xref:System.Messaging.MessageQueue.ReceiveCompleted> イベントを発生させます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-564">This overload specifies a time-out. If the interval specified by the `timeout` parameter expires, this component raises the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event.</span></span> <span data-ttu-id="f3a8c-565">メッセージが存在しないため、後続の <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> を呼び出すと、例外がスローされます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-565">Because no message exists, a subsequent call to <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> will throw an exception.</span></span>  
  
 <span data-ttu-id="f3a8c-566">トランザクションで <xref:System.Messaging.MessageQueue.BeginReceive%2A> 非同期呼び出しを使用しないでください。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-566">Do not use the asynchronous call <xref:System.Messaging.MessageQueue.BeginReceive%2A> with transactions.</span></span> <span data-ttu-id="f3a8c-567">トランザクション非同期操作を実行する場合は、<xref:System.Messaging.MessageQueue.BeginPeek%2A>を呼び出し、トランザクションと (同期) <xref:System.Messaging.MessageQueue.Receive%2A> メソッドを、ピーク操作用に作成したイベントハンドラー内に配置します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-567">If you want to perform a transactional asynchronous operation, call <xref:System.Messaging.MessageQueue.BeginPeek%2A>, and put the transaction and the (synchronous) <xref:System.Messaging.MessageQueue.Receive%2A> method within the event handler you create for the peek operation.</span></span> <span data-ttu-id="f3a8c-568">イベントハンドラーには、次C#のコードに示すような機能が含まれている場合があります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-568">Your event handler might contain functionality as shown in the following C# code.</span></span>  
  
```csharp  
myMessageQueue.BeginTransaction();  
 myMessageQueue.Receive();  
 myMessageQueue.CommitTransaction();  
```  
  
 <span data-ttu-id="f3a8c-569">次の表に、この方法をさまざまなワークグループモードで使用できるかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-569">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-570">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-570">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-571">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-571">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-572">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-572">Local computer</span></span>|<span data-ttu-id="f3a8c-573">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-573">Yes</span></span>|  
|<span data-ttu-id="f3a8c-574">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-574">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-575">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-575">Yes</span></span>|  
|<span data-ttu-id="f3a8c-576">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-576">Remote computer</span></span>|<span data-ttu-id="f3a8c-577">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-577">No</span></span>|  
|<span data-ttu-id="f3a8c-578">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-578">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-579">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-579">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-580">次のコード例では、非同期の受信操作を作成します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-580">The following code example creates an asynchronous receive operation.</span></span> <span data-ttu-id="f3a8c-581">このコード例では、イベントハンドラーを作成し、`MyReceiveCompleted`して、<xref:System.Messaging.MessageQueue.ReceiveCompleted> イベントハンドラーデリゲートにアタッチします。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-581">The code example creates an event handler, `MyReceiveCompleted`, and attaches it to the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event handler delegate.</span></span> <span data-ttu-id="f3a8c-582">このコード例では、メッセージをローカルのメッセージキューに送信し、<xref:System.Messaging.MessageQueue.BeginReceive%28System.TimeSpan%29>を呼び出して、タイムアウト値を10秒に渡します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-582">The code example sends a message to a local message queue, then calls <xref:System.Messaging.MessageQueue.BeginReceive%28System.TimeSpan%29>, passing in a time-out value of ten seconds.</span></span> <span data-ttu-id="f3a8c-583"><xref:System.Messaging.MessageQueue.ReceiveCompleted> イベントが発生すると、イベントハンドラーはメッセージを受信し、メッセージ本文を画面に書き込みます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-583">When a <xref:System.Messaging.MessageQueue.ReceiveCompleted> event is raised, the event handler receives the message and writes the message body to the screen.</span></span>  
  
 [!code-cpp[MessageQueueBeginReceive1#0](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueueBeginReceive1/cpp/class1.cpp#0)]
 [!code-csharp[MessageQueueBeginReceive1#0](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueueBeginReceive1/CS/class1.cs#0)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="f3a8c-584"><paramref name="timeout" /> パラメーターに指定された値が無効です。負数の可能性があります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-584">The value specified for the <paramref name="timeout" /> parameter is not valid, possibly because it represents a negative number.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="f3a8c-585">メッセージ キューのメソッドにアクセスしたときにエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-585">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <threadsafe><span data-ttu-id="f3a8c-586">メソッドはスレッドセーフではありません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-586">The method is not thread safe.</span></span></threadsafe>
        <altmember cref="E:System.Messaging.MessageQueue.ReceiveCompleted" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="T:System.TimeSpan" />
      </Docs>
    </Member>
    <Member MemberName="BeginReceive">
      <MemberSignature Language="C#" Value="public IAsyncResult BeginReceive (TimeSpan timeout, object stateObject);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.IAsyncResult BeginReceive(valuetype System.TimeSpan timeout, object stateObject) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.BeginReceive(System.TimeSpan,System.Object)" />
      <MemberSignature Language="VB.NET" Value="Public Function BeginReceive (timeout As TimeSpan, stateObject As Object) As IAsyncResult" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; IAsyncResult ^ BeginReceive(TimeSpan timeout, System::Object ^ stateObject);" />
      <MemberSignature Language="F#" Value="member this.BeginReceive : TimeSpan * obj -&gt; IAsyncResult" Usage="messageQueue.BeginReceive (timeout, stateObject)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.IAsyncResult</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" />
        <Parameter Name="stateObject" Type="System.Object" />
      </Parameters>
      <Docs>
        <param name="timeout"><span data-ttu-id="f3a8c-587">メッセージを使用できるようになるまでの待機時間を示す <see cref="T:System.TimeSpan" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-587">A <see cref="T:System.TimeSpan" /> that indicates the interval of time to wait for a message to become available.</span></span></param>
        <param name="stateObject"><span data-ttu-id="f3a8c-588">非同期操作に関連付けられている情報を保持する状態オブジェクト。アプリケーションで指定します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-588">A state object, specified by the application, that contains information associated with the asynchronous operation.</span></span></param>
        <summary><span data-ttu-id="f3a8c-589">指定したタイムアウトと指定した状態オブジェクトを持つ非同期の受信操作を実行します。状態オブジェクトは、操作の有効期間を通じて関連付けられた情報を提供します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-589">Initiates an asynchronous receive operation that has a specified time-out and a specified state object, which provides associated information throughout the operation's lifetime.</span></span> <span data-ttu-id="f3a8c-590">この操作は、メッセージをキューで使用できるようになるか、タイムアウトが発生するまで完了しません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-590">The operation is not complete until either a message becomes available in the queue or the time-out occurs.</span></span></summary>
        <returns><span data-ttu-id="f3a8c-591">ポストされた非同期要求を識別する <see cref="T:System.IAsyncResult" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-591">The <see cref="T:System.IAsyncResult" /> that identifies the posted asynchronous request.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-592">非同期処理では、<xref:System.Messaging.MessageQueue.BeginReceive%2A> を使用して、メッセージがキューで使用可能になったとき、または指定した時間が経過したときに <xref:System.Messaging.MessageQueue.ReceiveCompleted> イベントを発生させます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-592">In asynchronous processing, you use <xref:System.Messaging.MessageQueue.BeginReceive%2A> to raise the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event when a message becomes available in the queue or when the specified interval of time has expired.</span></span>  
  
 <span data-ttu-id="f3a8c-593"><xref:System.Messaging.MessageQueue.ReceiveCompleted> は、メッセージが既にキューに存在する場合にも発生します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-593"><xref:System.Messaging.MessageQueue.ReceiveCompleted> is also raised if a message already exists in the queue.</span></span>  
  
 <span data-ttu-id="f3a8c-594">このオーバーロードを使用して、操作の有効期間全体にわたって保持される操作に情報を関連付けます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-594">Use this overload to associate information with the operation that will be preserved throughout the operation's lifetime.</span></span> <span data-ttu-id="f3a8c-595">イベントハンドラーは、操作に関連付けられている <xref:System.IAsyncResult> の <xref:System.IAsyncResult.AsyncState%2A> プロパティを参照して、この情報を検出できます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-595">The event handler can detect this information by looking at the <xref:System.IAsyncResult.AsyncState%2A> property of the <xref:System.IAsyncResult> that is associated with the operation.</span></span>  
  
 <span data-ttu-id="f3a8c-596"><xref:System.Messaging.MessageQueue.BeginReceive%2A>を使用するには、非同期操作の結果を処理してイベントデリゲートに関連付けるイベントハンドラーを作成します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-596">To use <xref:System.Messaging.MessageQueue.BeginReceive%2A>, create an event handler that processes the results of the asynchronous operation and associate it with your event delegate.</span></span> <span data-ttu-id="f3a8c-597"><xref:System.Messaging.MessageQueue.BeginReceive%2A> は、非同期の受信操作を開始します。メッセージがキューに到着すると、<xref:System.Messaging.MessageQueue> には、<xref:System.Messaging.MessageQueue.ReceiveCompleted> イベントの発生時に通知されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-597"><xref:System.Messaging.MessageQueue.BeginReceive%2A> initiates an asynchronous receive operation; the <xref:System.Messaging.MessageQueue> is notified, through the raising of the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event, when a message arrives in the queue.</span></span> <span data-ttu-id="f3a8c-598"><xref:System.Messaging.MessageQueue> は、<xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> を呼び出すか、<xref:System.Messaging.ReceiveCompletedEventArgs>を使用して結果を取得することによって、メッセージにアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-598">The <xref:System.Messaging.MessageQueue> can then access the message by calling <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> or retrieving the result using the <xref:System.Messaging.ReceiveCompletedEventArgs>.</span></span>  
  
 <span data-ttu-id="f3a8c-599"><xref:System.Messaging.MessageQueue.BeginReceive%2A> メソッドはすぐに制御を返しますが、非同期操作は、イベントハンドラーが呼び出されるまで完了しません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-599">The <xref:System.Messaging.MessageQueue.BeginReceive%2A> method returns immediately, but the asynchronous operation is not completed until the event handler is called.</span></span>  
  
 <span data-ttu-id="f3a8c-600"><xref:System.Messaging.MessageQueue.BeginReceive%2A> は非同期であるため、このメソッドを呼び出して、現在の実行スレッドをブロックせずにキューからメッセージを受信することができます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-600">Because <xref:System.Messaging.MessageQueue.BeginReceive%2A> is asynchronous, you can call it to receive a message from the queue without blocking the current thread of execution.</span></span> <span data-ttu-id="f3a8c-601">同期的にメッセージを受信するには、<xref:System.Messaging.MessageQueue.Receive%2A> メソッドを使用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-601">To synchronously receive a message, use the <xref:System.Messaging.MessageQueue.Receive%2A> method.</span></span>  
  
 <span data-ttu-id="f3a8c-602">非同期操作が完了したら、イベントハンドラーで <xref:System.Messaging.MessageQueue.BeginPeek%2A> または <xref:System.Messaging.MessageQueue.BeginReceive%2A> を再度呼び出して、通知を受け取ることができます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-602">Once an asynchronous operation completes, you can call <xref:System.Messaging.MessageQueue.BeginPeek%2A> or <xref:System.Messaging.MessageQueue.BeginReceive%2A> again in the event handler to keep receiving notifications.</span></span>  
  
 <span data-ttu-id="f3a8c-603"><xref:System.Messaging.MessageQueue.BeginReceive%2A> 返される <xref:System.IAsyncResult> は、メソッドが開始した非同期操作を識別します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-603">The <xref:System.IAsyncResult> that <xref:System.Messaging.MessageQueue.BeginReceive%2A> returns identifies the asynchronous operation that the method started.</span></span> <span data-ttu-id="f3a8c-604">この <xref:System.IAsyncResult> は、操作の有効期間全体を通して使用できます。ただし、<xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> が呼び出されるまでは通常は使用しません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-604">You can use this <xref:System.IAsyncResult> throughout the lifetime of the operation, although you generally do not use it until <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> is called.</span></span> <span data-ttu-id="f3a8c-605">ただし、いくつかの非同期操作を開始する場合は、<xref:System.IAsyncResult> 値を配列に格納し、すべての操作または操作が完了するまで待機するかどうかを指定できます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-605">However, if you start several asynchronous operations, you can place their <xref:System.IAsyncResult> values in an array and specify whether to wait for all operations or any operation to complete.</span></span> <span data-ttu-id="f3a8c-606">この場合は、<xref:System.IAsyncResult> の <xref:System.IAsyncResult.AsyncWaitHandle%2A> プロパティを使用して、完了した操作を識別します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-606">In this case, you use the <xref:System.IAsyncResult.AsyncWaitHandle%2A> property of the <xref:System.IAsyncResult> to identify the completed operation.</span></span>  
  
 <span data-ttu-id="f3a8c-607">このオーバーロードは、タイムアウトと状態オブジェクトを指定します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-607">This overload specifies a time-out and a state object.</span></span> <span data-ttu-id="f3a8c-608">`timeout` パラメーターで指定した間隔が経過すると、このコンポーネントは <xref:System.Messaging.MessageQueue.ReceiveCompleted> イベントを発生させます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-608">If the interval specified by the `timeout` parameter expires, this component raises the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event.</span></span> <span data-ttu-id="f3a8c-609">メッセージが存在しないため、後続の <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> を呼び出すと、例外がスローされます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-609">Because no message exists, a subsequent call to <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> will throw an exception.</span></span>  
  
 <span data-ttu-id="f3a8c-610">状態オブジェクトは、状態情報を操作に関連付けます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-610">The state object associates state information with the operation.</span></span> <span data-ttu-id="f3a8c-611">たとえば、複数回 <xref:System.Messaging.MessageQueue.BeginReceive%2A> を呼び出して複数の操作を開始する場合は、定義した個別の状態オブジェクトを使用して各操作を識別できます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-611">For example, if you call <xref:System.Messaging.MessageQueue.BeginReceive%2A> multiple times to initiate multiple operations, you can identify each operation through a separate state object that you define.</span></span>  
  
 <span data-ttu-id="f3a8c-612">また、state オブジェクトを使用して、プロセススレッド間で情報を渡すこともできます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-612">You can also use the state object to pass information across process threads.</span></span> <span data-ttu-id="f3a8c-613">スレッドが開始されていても、コールバックが非同期シナリオの別のスレッドにある場合は、状態オブジェクトがマーシャリングされ、イベントからの情報と共に返されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-613">If a thread is started but the callback is on a different thread in an asynchronous scenario, the state object is marshaled and passed back along with information from the event.</span></span>  
  
 <span data-ttu-id="f3a8c-614">トランザクションで <xref:System.Messaging.MessageQueue.BeginReceive%2A> 非同期呼び出しを使用しないでください。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-614">Do not use the asynchronous call <xref:System.Messaging.MessageQueue.BeginReceive%2A> with transactions.</span></span> <span data-ttu-id="f3a8c-615">トランザクション非同期操作を実行する場合は、<xref:System.Messaging.MessageQueue.BeginPeek%2A>を呼び出し、トランザクションと (同期) <xref:System.Messaging.MessageQueue.Receive%2A> メソッドを、ピーク操作用に作成したイベントハンドラー内に配置します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-615">If you want to perform a transactional asynchronous operation, call <xref:System.Messaging.MessageQueue.BeginPeek%2A>, and put the transaction and the (synchronous) <xref:System.Messaging.MessageQueue.Receive%2A> method within the event handler you create for the peek operation.</span></span> <span data-ttu-id="f3a8c-616">イベントハンドラーには、次C#のコードに示すような機能が含まれている場合があります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-616">Your event handler might contain functionality as shown in the following C# code.</span></span>  
  
```csharp  
myMessageQueue.BeginTransaction();  
 myMessageQueue.Receive();  
 myMessageQueue.CommitTransaction();  
```  
  
 <span data-ttu-id="f3a8c-617">次の表に、この方法をさまざまなワークグループモードで使用できるかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-617">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-618">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-618">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-619">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-619">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-620">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-620">Local computer</span></span>|<span data-ttu-id="f3a8c-621">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-621">Yes</span></span>|  
|<span data-ttu-id="f3a8c-622">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-622">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-623">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-623">Yes</span></span>|  
|<span data-ttu-id="f3a8c-624">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-624">Remote computer</span></span>|<span data-ttu-id="f3a8c-625">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-625">No</span></span>|  
|<span data-ttu-id="f3a8c-626">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-626">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-627">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-627">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-628">次のコード例では、非同期の受信操作を作成します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-628">The following code example creates an asynchronous receive operation.</span></span> <span data-ttu-id="f3a8c-629">このコード例では、イベントハンドラーを作成し、`MyReceiveCompleted`して、<xref:System.Messaging.MessageQueue.ReceiveCompleted> イベントハンドラーデリゲートにアタッチします。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-629">The code example creates an event handler, `MyReceiveCompleted`, and attaches it to the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event handler delegate.</span></span> <span data-ttu-id="f3a8c-630">このコード例では、メッセージをローカルのメッセージキューに送信した後、<xref:System.Messaging.MessageQueue.BeginReceive%28System.TimeSpan%2CSystem.Object%29>を呼び出して、タイムアウト値を10秒、特定のメッセージを識別する一意の整数を渡します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-630">The code example sends a message to a local message queue, then calls <xref:System.Messaging.MessageQueue.BeginReceive%28System.TimeSpan%2CSystem.Object%29>, passing in a time-out value of ten seconds and a unique integer that identifies that particular message.</span></span> <span data-ttu-id="f3a8c-631"><xref:System.Messaging.MessageQueue.ReceiveCompleted> イベントが発生すると、イベントハンドラーはメッセージを受信し、メッセージ本文と整数メッセージ識別子を画面に書き込みます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-631">When a <xref:System.Messaging.MessageQueue.ReceiveCompleted> event is raised, the event handler receives the message and writes the message body and the integer message identifier to the screen.</span></span>  
  
 [!code-cpp[MessageQueueBeginReceive2#0](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueueBeginReceive2/cpp/class1.cpp#0)]
 [!code-csharp[MessageQueueBeginReceive2#0](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueueBeginReceive2/CS/class1.cs#0)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="f3a8c-632"><paramref name="timeout" /> パラメーターに指定された値が無効です。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-632">The value specified for the <paramref name="timeout" /> parameter is not valid.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="f3a8c-633">メッセージ キューのメソッドにアクセスしたときにエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-633">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <threadsafe><span data-ttu-id="f3a8c-634">メソッドはスレッドセーフではありません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-634">The method is not thread safe.</span></span></threadsafe>
        <altmember cref="E:System.Messaging.MessageQueue.ReceiveCompleted" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="T:System.TimeSpan" />
      </Docs>
    </Member>
    <Member MemberName="BeginReceive">
      <MemberSignature Language="C#" Value="public IAsyncResult BeginReceive (TimeSpan timeout, object stateObject, AsyncCallback callback);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.IAsyncResult BeginReceive(valuetype System.TimeSpan timeout, object stateObject, class System.AsyncCallback callback) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.BeginReceive(System.TimeSpan,System.Object,System.AsyncCallback)" />
      <MemberSignature Language="VB.NET" Value="Public Function BeginReceive (timeout As TimeSpan, stateObject As Object, callback As AsyncCallback) As IAsyncResult" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; IAsyncResult ^ BeginReceive(TimeSpan timeout, System::Object ^ stateObject, AsyncCallback ^ callback);" />
      <MemberSignature Language="F#" Value="member this.BeginReceive : TimeSpan * obj * AsyncCallback -&gt; IAsyncResult" Usage="messageQueue.BeginReceive (timeout, stateObject, callback)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.IAsyncResult</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" />
        <Parameter Name="stateObject" Type="System.Object" />
        <Parameter Name="callback" Type="System.AsyncCallback" />
      </Parameters>
      <Docs>
        <param name="timeout"><span data-ttu-id="f3a8c-635">メッセージを使用できるようになるまでの待機時間を示す <see cref="T:System.TimeSpan" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-635">A <see cref="T:System.TimeSpan" /> that indicates the interval of time to wait for a message to become available.</span></span></param>
        <param name="stateObject"><span data-ttu-id="f3a8c-636">非同期操作に関連付けられている情報を保持する状態オブジェクト。アプリケーションで指定します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-636">A state object, specified by the application, that contains information associated with the asynchronous operation.</span></span></param>
        <param name="callback"><span data-ttu-id="f3a8c-637">非同期操作の完了通知を受信する <see cref="T:System.AsyncCallback" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-637">The <see cref="T:System.AsyncCallback" /> that will receive the notification of the asynchronous operation completion.</span></span></param>
        <summary><span data-ttu-id="f3a8c-638">指定したタイムアウトと指定した状態オブジェクトを持つ非同期の受信操作を実行します。状態オブジェクトは、操作の有効期間を通じて関連付けられた情報を提供します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-638">Initiates an asynchronous receive operation that has a specified time-out and a specified state object, which provides associated information throughout the operation's lifetime.</span></span> <span data-ttu-id="f3a8c-639">このオーバーロードは、コールバックを通じて操作のイベント ハンドラー ID の通知を受信します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-639">This overload receives notification, through a callback, of the identity of the event handler for the operation.</span></span> <span data-ttu-id="f3a8c-640">この操作は、メッセージをキューで使用できるようになるか、タイムアウトが発生するまで完了しません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-640">The operation is not complete until either a message becomes available in the queue or the time-out occurs.</span></span></summary>
        <returns><span data-ttu-id="f3a8c-641">ポストされた非同期要求を識別する <see cref="T:System.IAsyncResult" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-641">The <see cref="T:System.IAsyncResult" /> that identifies the posted asynchronous request.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-642">このオーバーロードを使用すると、メッセージがキューで利用可能になるか、指定した時間が経過したときに、callback パラメーターで指定されたコールバックが直接呼び出されます。<xref:System.Messaging.MessageQueue.ReceiveCompleted> イベントが発生していません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-642">When you use this overload, the callback specified in the callback parameter is invoked directly when a message becomes available in the queue or when the specified interval of time has expired; the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event is not raised.</span></span> <span data-ttu-id="f3a8c-643"><xref:System.Messaging.MessageQueue.BeginReceive%2A> の他のオーバーロードは、このコンポーネントに依存して <xref:System.Messaging.MessageQueue.ReceiveCompleted> イベントを発生させます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-643">The other overloads of <xref:System.Messaging.MessageQueue.BeginReceive%2A> rely on this component to raise the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event.</span></span>  
  
 <span data-ttu-id="f3a8c-644"><xref:System.Messaging.MessageQueue.ReceiveCompleted> は、メッセージが既にキューに存在する場合にも発生します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-644"><xref:System.Messaging.MessageQueue.ReceiveCompleted> is also raised if a message already exists in the queue.</span></span>  
  
 <span data-ttu-id="f3a8c-645"><xref:System.Messaging.MessageQueue.BeginReceive%2A>を使用するには、非同期操作の結果を処理してイベントデリゲートに関連付けるイベントハンドラーを作成します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-645">To use <xref:System.Messaging.MessageQueue.BeginReceive%2A>, create an event handler that processes the results of the asynchronous operation and associate it with your event delegate.</span></span> <span data-ttu-id="f3a8c-646"><xref:System.Messaging.MessageQueue.BeginReceive%2A> は、非同期の受信操作を開始します。メッセージがキューに到着すると、<xref:System.Messaging.MessageQueue> には、<xref:System.Messaging.MessageQueue.ReceiveCompleted> イベントの発生時に通知されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-646"><xref:System.Messaging.MessageQueue.BeginReceive%2A> initiates an asynchronous receive operation; the <xref:System.Messaging.MessageQueue> is notified, through the raising of the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event, when a message arrives in the queue.</span></span> <span data-ttu-id="f3a8c-647"><xref:System.Messaging.MessageQueue> は、<xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> を呼び出すか、<xref:System.Messaging.ReceiveCompletedEventArgs>を使用して結果を取得することによって、メッセージにアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-647">The <xref:System.Messaging.MessageQueue> can then access the message by calling <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> or retrieving the result using the <xref:System.Messaging.ReceiveCompletedEventArgs>.</span></span>  
  
 <span data-ttu-id="f3a8c-648"><xref:System.Messaging.MessageQueue.BeginReceive%2A> メソッドはすぐに制御を返しますが、非同期操作は、イベントハンドラーが呼び出されるまで完了しません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-648">The <xref:System.Messaging.MessageQueue.BeginReceive%2A> method returns immediately, but the asynchronous operation is not completed until the event handler is called.</span></span>  
  
 <span data-ttu-id="f3a8c-649"><xref:System.Messaging.MessageQueue.BeginReceive%2A> は非同期であるため、このメソッドを呼び出して、現在の実行スレッドをブロックせずにキューからメッセージを受信することができます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-649">Because <xref:System.Messaging.MessageQueue.BeginReceive%2A> is asynchronous, you can call it to receive a message from the queue without blocking the current thread of execution.</span></span> <span data-ttu-id="f3a8c-650">同期的にメッセージを受信するには、<xref:System.Messaging.MessageQueue.Receive%2A> メソッドを使用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-650">To synchronously receive a message, use the <xref:System.Messaging.MessageQueue.Receive%2A> method.</span></span>  
  
 <span data-ttu-id="f3a8c-651">非同期操作が完了したら、イベントハンドラーで <xref:System.Messaging.MessageQueue.BeginPeek%2A> または <xref:System.Messaging.MessageQueue.BeginReceive%2A> を再度呼び出して、通知を受け取ることができます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-651">Once an asynchronous operation completes, you can call <xref:System.Messaging.MessageQueue.BeginPeek%2A> or <xref:System.Messaging.MessageQueue.BeginReceive%2A> again in the event handler to keep receiving notifications.</span></span>  
  
 <span data-ttu-id="f3a8c-652"><xref:System.Messaging.MessageQueue.BeginReceive%2A> 返される <xref:System.IAsyncResult> は、メソッドが開始した非同期操作を識別します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-652">The <xref:System.IAsyncResult> that <xref:System.Messaging.MessageQueue.BeginReceive%2A> returns identifies the asynchronous operation that the method started.</span></span> <span data-ttu-id="f3a8c-653">この <xref:System.IAsyncResult> は、操作の有効期間全体を通して使用できます。ただし、<xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> が呼び出されるまでは通常は使用しません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-653">You can use this <xref:System.IAsyncResult> throughout the lifetime of the operation, although you generally do not use it until <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> is called.</span></span> <span data-ttu-id="f3a8c-654">ただし、いくつかの非同期操作を開始する場合は、<xref:System.IAsyncResult> 値を配列に格納し、すべての操作または操作が完了するまで待機するかどうかを指定できます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-654">However, if you start several asynchronous operations, you can place their <xref:System.IAsyncResult> values in an array and specify whether to wait for all operations or any operation to complete.</span></span> <span data-ttu-id="f3a8c-655">この場合は、<xref:System.IAsyncResult> の <xref:System.IAsyncResult.AsyncWaitHandle%2A> プロパティを使用して、完了した操作を識別します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-655">In this case, you use the <xref:System.IAsyncResult.AsyncWaitHandle%2A> property of the <xref:System.IAsyncResult> to identify the completed operation.</span></span>  
  
 <span data-ttu-id="f3a8c-656">状態オブジェクトは、状態情報を操作に関連付けます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-656">The state object associates state information with the operation.</span></span> <span data-ttu-id="f3a8c-657">たとえば、複数回 <xref:System.Messaging.MessageQueue.BeginReceive%2A> を呼び出して複数の操作を開始する場合は、定義した個別の状態オブジェクトを使用して各操作を識別できます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-657">For example, if you call <xref:System.Messaging.MessageQueue.BeginReceive%2A> multiple times to initiate multiple operations, you can identify each operation through a separate state object that you define.</span></span>  
  
 <span data-ttu-id="f3a8c-658">また、state オブジェクトを使用して、プロセススレッド間で情報を渡すこともできます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-658">You can also use the state object to pass information across process threads.</span></span> <span data-ttu-id="f3a8c-659">スレッドが開始されていても、コールバックが非同期シナリオの別のスレッドにある場合は、状態オブジェクトがマーシャリングされ、イベントからの情報と共に返されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-659">If a thread is started but the callback is on a different thread in an asynchronous scenario, the state object is marshaled and passed back along with information from the event.</span></span>  
  
 <span data-ttu-id="f3a8c-660">トランザクションで <xref:System.Messaging.MessageQueue.BeginReceive%2A> 非同期呼び出しを使用しないでください。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-660">Do not use the asynchronous call <xref:System.Messaging.MessageQueue.BeginReceive%2A> with transactions.</span></span> <span data-ttu-id="f3a8c-661">トランザクション非同期操作を実行する場合は、<xref:System.Messaging.MessageQueue.BeginPeek%2A>を呼び出し、トランザクションと (同期) <xref:System.Messaging.MessageQueue.Receive%2A> メソッドを、ピーク操作用に作成したイベントハンドラー内に配置します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-661">If you want to perform a transactional asynchronous operation, call <xref:System.Messaging.MessageQueue.BeginPeek%2A>, and put the transaction and the (synchronous) <xref:System.Messaging.MessageQueue.Receive%2A> method within the event handler you create for the peek operation.</span></span> <span data-ttu-id="f3a8c-662">イベントハンドラーには、次C#のコードに示すような機能が含まれている場合があります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-662">Your event handler might contain functionality as shown in the following C# code.</span></span>  
  
```csharp  
myMessageQueue.BeginTransaction();  
 myMessageQueue.Receive();  
 myMessageQueue.CommitTransaction();  
```  
  
 <span data-ttu-id="f3a8c-663">次の表に、この方法をさまざまなワークグループモードで使用できるかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-663">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-664">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-664">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-665">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-665">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-666">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-666">Local computer</span></span>|<span data-ttu-id="f3a8c-667">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-667">Yes</span></span>|  
|<span data-ttu-id="f3a8c-668">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-668">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-669">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-669">Yes</span></span>|  
|<span data-ttu-id="f3a8c-670">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-670">Remote computer</span></span>|<span data-ttu-id="f3a8c-671">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-671">No</span></span>|  
|<span data-ttu-id="f3a8c-672">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-672">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-673">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-673">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-674">次のコード例では、非同期の受信操作を作成します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-674">The following code example creates an asynchronous receive operation.</span></span> <span data-ttu-id="f3a8c-675">このコード例では、メッセージをローカルのメッセージキューに送信し、<xref:System.Messaging.MessageQueue.BeginReceive%28System.TimeSpan%2CSystem.Object%2CSystem.AsyncCallback%29>を呼び出して、10秒のタイムアウト値を渡します。特定のメッセージを識別する一意の整数。イベントハンドラー、`MyReceiveCompleted`を識別する <xref:System.AsyncCallback> の新しいインスタンス。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-675">The code example sends a message to a local message queue, then calls <xref:System.Messaging.MessageQueue.BeginReceive%28System.TimeSpan%2CSystem.Object%2CSystem.AsyncCallback%29>, passing in: a time-out value of ten seconds; a unique integer that identifies that particular message; and a new instance of <xref:System.AsyncCallback> that identifies the event handler, `MyReceiveCompleted`.</span></span> <span data-ttu-id="f3a8c-676"><xref:System.Messaging.MessageQueue.ReceiveCompleted> イベントが発生すると、イベントハンドラーはメッセージを受信し、メッセージ本文と整数メッセージ識別子を画面に書き込みます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-676">When a <xref:System.Messaging.MessageQueue.ReceiveCompleted> event is raised, the event handler receives the message and writes the message body and the integer message identifier to the screen.</span></span>  
  
 [!code-cpp[MessageQueueBeginReceive3#0](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueueBeginReceive3/cpp/class1.cpp#0)]
 [!code-csharp[MessageQueueBeginReceive3#0](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueueBeginReceive3/CS/class1.cs#0)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="f3a8c-677"><paramref name="timeout" /> パラメーターに指定された値が無効です。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-677">The value specified for the <paramref name="timeout" /> parameter is not valid.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="f3a8c-678">メッセージ キューのメソッドにアクセスしたときにエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-678">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <threadsafe><span data-ttu-id="f3a8c-679">メソッドはスレッドセーフではありません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-679">The method is not thread safe.</span></span></threadsafe>
        <altmember cref="E:System.Messaging.MessageQueue.ReceiveCompleted" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="T:System.AsyncCallback" />
        <altmember cref="T:System.TimeSpan" />
      </Docs>
    </Member>
    <Member MemberName="BeginReceive">
      <MemberSignature Language="C#" Value="public IAsyncResult BeginReceive (TimeSpan timeout, System.Messaging.Cursor cursor, object state, AsyncCallback callback);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.IAsyncResult BeginReceive(valuetype System.TimeSpan timeout, class System.Messaging.Cursor cursor, object state, class System.AsyncCallback callback) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.BeginReceive(System.TimeSpan,System.Messaging.Cursor,System.Object,System.AsyncCallback)" />
      <MemberSignature Language="VB.NET" Value="Public Function BeginReceive (timeout As TimeSpan, cursor As Cursor, state As Object, callback As AsyncCallback) As IAsyncResult" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; IAsyncResult ^ BeginReceive(TimeSpan timeout, System::Messaging::Cursor ^ cursor, System::Object ^ state, AsyncCallback ^ callback);" />
      <MemberSignature Language="F#" Value="member this.BeginReceive : TimeSpan * System.Messaging.Cursor * obj * AsyncCallback -&gt; IAsyncResult" Usage="messageQueue.BeginReceive (timeout, cursor, state, callback)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.IAsyncResult</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="cursor" Type="System.Messaging.Cursor" Index="1" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="state" Type="System.Object" Index="2" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="callback" Type="System.AsyncCallback" Index="3" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="timeout"><span data-ttu-id="f3a8c-680">メッセージを使用できるようになるまでの待機時間を示す <see cref="T:System.TimeSpan" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-680">A <see cref="T:System.TimeSpan" /> that indicates the interval of time to wait for a message to become available.</span></span></param>
        <param name="cursor"><span data-ttu-id="f3a8c-681">メッセージ キュー内の特定の位置を維持する <see cref="T:System.Messaging.Cursor" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-681">A <see cref="T:System.Messaging.Cursor" /> that maintains a specific position in the message queue.</span></span></param>
        <param name="state"><span data-ttu-id="f3a8c-682">非同期操作に関連付けられている情報を保持する状態オブジェクト。アプリケーションで指定します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-682">A state object, specified by the application, that contains information associated with the asynchronous operation.</span></span></param>
        <param name="callback"><span data-ttu-id="f3a8c-683">非同期操作の完了通知を受信する <see cref="T:System.AsyncCallback" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-683">The <see cref="T:System.AsyncCallback" /> that receives the notification of the asynchronous operation completion.</span></span></param>
        <summary><span data-ttu-id="f3a8c-684">指定したタイムアウトがあり、指定したカーソルおよび状態オブジェクトを使用する非同期の受信操作を実行します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-684">Initiates an asynchronous receive operation that has a specified time-out and uses a specified cursor and a specified state object.</span></span> <span data-ttu-id="f3a8c-685">状態オブジェクトは、操作の有効期間を通じて、関連付けられた情報を提供します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-685">The state object provides associated information throughout the lifetime of the operation.</span></span> <span data-ttu-id="f3a8c-686">このオーバーロードは、コールバックを通じて操作のイベント ハンドラー ID の通知を受信します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-686">This overload receives notification, through a callback, of the identity of the event handler for the operation.</span></span> <span data-ttu-id="f3a8c-687">この操作は、メッセージをキューで使用できるようになるか、タイムアウトが発生するまで完了しません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-687">The operation is not complete until either a message becomes available in the queue or the time-out occurs.</span></span></summary>
        <returns><span data-ttu-id="f3a8c-688">ポストされた非同期要求を識別する <see cref="T:System.IAsyncResult" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-688">The <see cref="T:System.IAsyncResult" /> that identifies the posted asynchronous request.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-689">このオーバーロードを使用すると、メッセージがキューで利用可能になるか、指定した時間が経過したときに、callback パラメーターで指定されたコールバックが直接呼び出されます。<xref:System.Messaging.MessageQueue.ReceiveCompleted> イベントが発生していません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-689">When you use this overload, the callback specified in the callback parameter is invoked directly when a message becomes available in the queue or when the specified interval of time has expired; the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event is not raised.</span></span> <span data-ttu-id="f3a8c-690"><xref:System.Messaging.MessageQueue.BeginReceive%2A> の他のオーバーロードは、このコンポーネントに依存して <xref:System.Messaging.MessageQueue.ReceiveCompleted> イベントを発生させます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-690">The other overloads of <xref:System.Messaging.MessageQueue.BeginReceive%2A> rely on this component to raise the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event.</span></span>  
  
 <span data-ttu-id="f3a8c-691"><xref:System.Messaging.MessageQueue.ReceiveCompleted> は、メッセージが既にキューに存在する場合にも発生します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-691"><xref:System.Messaging.MessageQueue.ReceiveCompleted> is also raised if a message already exists in the queue.</span></span>  
  
 <span data-ttu-id="f3a8c-692"><xref:System.Messaging.MessageQueue.BeginReceive%2A>を使用するには、非同期操作の結果を処理してイベントデリゲートに関連付けるイベントハンドラーを作成します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-692">To use <xref:System.Messaging.MessageQueue.BeginReceive%2A>, create an event handler that processes the results of the asynchronous operation and associate it with your event delegate.</span></span> <span data-ttu-id="f3a8c-693"><xref:System.Messaging.MessageQueue.BeginReceive%2A> は、非同期の受信操作を開始します。メッセージがキューに到着すると、<xref:System.Messaging.MessageQueue> には、<xref:System.Messaging.MessageQueue.ReceiveCompleted> イベントの発生時に通知されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-693"><xref:System.Messaging.MessageQueue.BeginReceive%2A> initiates an asynchronous receive operation; the <xref:System.Messaging.MessageQueue> is notified, through the raising of the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event, when a message arrives in the queue.</span></span> <span data-ttu-id="f3a8c-694"><xref:System.Messaging.MessageQueue> は、<xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> を呼び出すか、<xref:System.Messaging.ReceiveCompletedEventArgs>を使用して結果を取得することによって、メッセージにアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-694">The <xref:System.Messaging.MessageQueue> can then access the message by calling <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> or retrieving the result using the <xref:System.Messaging.ReceiveCompletedEventArgs>.</span></span>  
  
 <span data-ttu-id="f3a8c-695"><xref:System.Messaging.MessageQueue.BeginReceive%2A> メソッドはすぐに制御を返しますが、非同期操作は、イベントハンドラーが呼び出されるまで完了しません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-695">The <xref:System.Messaging.MessageQueue.BeginReceive%2A> method returns immediately, but the asynchronous operation is not completed until the event handler is called.</span></span>  
  
 <span data-ttu-id="f3a8c-696"><xref:System.Messaging.MessageQueue.BeginReceive%2A> は非同期であるため、このメソッドを呼び出して、現在の実行スレッドをブロックせずにキューからメッセージを受信することができます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-696">Because <xref:System.Messaging.MessageQueue.BeginReceive%2A> is asynchronous, you can call it to receive a message from the queue without blocking the current thread of execution.</span></span> <span data-ttu-id="f3a8c-697">同期的にメッセージを受信するには、<xref:System.Messaging.MessageQueue.Receive%2A> メソッドを使用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-697">To synchronously receive a message, use the <xref:System.Messaging.MessageQueue.Receive%2A> method.</span></span>  
  
 <span data-ttu-id="f3a8c-698">非同期操作が完了したら、イベントハンドラーで <xref:System.Messaging.MessageQueue.BeginPeek%2A> または <xref:System.Messaging.MessageQueue.BeginReceive%2A> を再度呼び出して、通知を受け取ることができます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-698">Once an asynchronous operation completes, you can call <xref:System.Messaging.MessageQueue.BeginPeek%2A> or <xref:System.Messaging.MessageQueue.BeginReceive%2A> again in the event handler to keep receiving notifications.</span></span>  
  
 <span data-ttu-id="f3a8c-699"><xref:System.Messaging.MessageQueue.BeginReceive%2A> 返される <xref:System.IAsyncResult> は、メソッドが開始した非同期操作を識別します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-699">The <xref:System.IAsyncResult> that <xref:System.Messaging.MessageQueue.BeginReceive%2A> returns identifies the asynchronous operation that the method started.</span></span> <span data-ttu-id="f3a8c-700">この <xref:System.IAsyncResult> は、操作の有効期間全体を通して使用できます。ただし、<xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> が呼び出されるまでは通常は使用しません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-700">You can use this <xref:System.IAsyncResult> throughout the lifetime of the operation, although you generally do not use it until <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> is called.</span></span> <span data-ttu-id="f3a8c-701">ただし、いくつかの非同期操作を開始する場合は、<xref:System.IAsyncResult> 値を配列に格納し、すべての操作または操作が完了するまで待機するかどうかを指定できます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-701">However, if you start several asynchronous operations, you can place their <xref:System.IAsyncResult> values in an array and specify whether to wait for all operations or any operation to complete.</span></span> <span data-ttu-id="f3a8c-702">この場合は、<xref:System.IAsyncResult> の <xref:System.IAsyncResult.AsyncWaitHandle%2A> プロパティを使用して、完了した操作を識別します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-702">In this case, use the <xref:System.IAsyncResult.AsyncWaitHandle%2A> property of the <xref:System.IAsyncResult> to identify the completed operation.</span></span>  
  
 <span data-ttu-id="f3a8c-703">状態オブジェクトは、状態情報を操作に関連付けます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-703">The state object associates state information with the operation.</span></span> <span data-ttu-id="f3a8c-704">たとえば、複数回 <xref:System.Messaging.MessageQueue.BeginReceive%2A> を呼び出して複数の操作を開始する場合は、定義した個別の状態オブジェクトを使用して各操作を識別できます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-704">For example, if you call <xref:System.Messaging.MessageQueue.BeginReceive%2A> multiple times to initiate multiple operations, you can identify each operation through a separate state object that you define.</span></span>  
  
 <span data-ttu-id="f3a8c-705">また、state オブジェクトを使用して、プロセススレッド間で情報を渡すこともできます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-705">You can also use the state object to pass information across process threads.</span></span> <span data-ttu-id="f3a8c-706">スレッドが開始されていても、コールバックが非同期シナリオの別のスレッドにある場合は、状態オブジェクトがマーシャリングされ、イベントからの情報と共に返されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-706">If a thread is started but the callback is on a different thread in an asynchronous scenario, the state object is marshaled and passed back along with information from the event.</span></span>  
  
 <span data-ttu-id="f3a8c-707">トランザクションで <xref:System.Messaging.MessageQueue.BeginReceive%2A> 非同期呼び出しを使用しないでください。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-707">Do not use the asynchronous call <xref:System.Messaging.MessageQueue.BeginReceive%2A> with transactions.</span></span> <span data-ttu-id="f3a8c-708">トランザクション非同期操作を実行する場合は、<xref:System.Messaging.MessageQueue.BeginPeek%2A>を呼び出し、トランザクションと (同期) <xref:System.Messaging.MessageQueue.Receive%2A> メソッドを、ピーク操作用に作成したイベントハンドラー内に配置します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-708">If you want to perform a transactional asynchronous operation, call <xref:System.Messaging.MessageQueue.BeginPeek%2A>, and put the transaction and the (synchronous) <xref:System.Messaging.MessageQueue.Receive%2A> method within the event handler you create for the peek operation.</span></span> <span data-ttu-id="f3a8c-709">イベントハンドラーには、次C#のコードに示すような機能が含まれている場合があります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-709">Your event handler might contain functionality as shown in the following C# code.</span></span>  
  
```csharp  
myMessageQueue.BeginTransaction();  
 myMessageQueue.Receive();  
 myMessageQueue.CommitTransaction();  
```  
  
 <span data-ttu-id="f3a8c-710">次の表に、この方法をさまざまなワークグループモードで使用できるかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-710">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-711">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-711">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-712">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-712">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-713">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-713">Local computer</span></span>|<span data-ttu-id="f3a8c-714">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-714">Yes</span></span>|  
|<span data-ttu-id="f3a8c-715">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-715">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-716">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-716">Yes</span></span>|  
|<span data-ttu-id="f3a8c-717">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-717">Remote computer</span></span>|<span data-ttu-id="f3a8c-718">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-718">No</span></span>|  
|<span data-ttu-id="f3a8c-719">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-719">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-720">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-720">Yes</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="f3a8c-721"><paramref name="cursor" /> パラメーターが <see langword="null" /> です。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-721">The <paramref name="cursor" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="f3a8c-722"><paramref name="timeout" /> パラメーターに指定された値が無効です。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-722">The value specified for the <paramref name="timeout" /> parameter is not valid.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="f3a8c-723">メッセージ キューのメソッドにアクセスしたときにエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-723">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <threadsafe><span data-ttu-id="f3a8c-724">メソッドはスレッドセーフではありません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-724">The method is not thread safe.</span></span></threadsafe>
        <altmember cref="T:System.Messaging.Cursor" />
        <altmember cref="E:System.Messaging.MessageQueue.ReceiveCompleted" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="T:System.AsyncCallback" />
        <altmember cref="T:System.TimeSpan" />
      </Docs>
    </Member>
    <Member MemberName="CanRead">
      <MemberSignature Language="C#" Value="public bool CanRead { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool CanRead" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.CanRead" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property CanRead As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property bool CanRead { bool get(); };" />
      <MemberSignature Language="F#" Value="member this.CanRead : bool" Usage="System.Messaging.MessageQueue.CanRead" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_CanRead")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="f3a8c-725"><see cref="T:System.Messaging.MessageQueue" /> を読み取ることができるかどうかを示す値を取得します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-725">Gets a value that indicates whether the <see cref="T:System.Messaging.MessageQueue" /> can be read.</span></span></summary>
        <value><span data-ttu-id="f3a8c-726"><see cref="T:System.Messaging.MessageQueue" /> が存在し、アプリケーションが読み取ることができる場合は <see langword="true" />。それ以外の場合は <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-726"><see langword="true" /> if the <see cref="T:System.Messaging.MessageQueue" /> exists and the application can read from it; otherwise, <see langword="false" />.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-727"><xref:System.Messaging.MessageQueue.CanRead%2A> は、アプリケーションがキューからメッセージをピークまたは受信できるかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-727"><xref:System.Messaging.MessageQueue.CanRead%2A> indicates whether the application is able to peek or receive messages from the queue.</span></span> <span data-ttu-id="f3a8c-728"><xref:System.Messaging.MessageQueue.CanRead%2A> が `true`場合、<xref:System.Messaging.MessageQueue> はキューからメッセージを受信またはピークできます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-728">If <xref:System.Messaging.MessageQueue.CanRead%2A> is `true`, the <xref:System.Messaging.MessageQueue> can receive or peek messages from the queue.</span></span> <span data-ttu-id="f3a8c-729">それ以外の場合はできません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-729">Otherwise, it cannot.</span></span>  
  
 <span data-ttu-id="f3a8c-730"><xref:System.Messaging.MessageQueue.CanRead%2A> は、キューが排他読み取りアクセスで既に開いている場合 (または非排他アクセスで開かれている場合、およびこの <xref:System.Messaging.MessageQueue> 排他アクセスが要求される場合)、またはアプリケーションにアクセスするための十分な権限がない場合に `false` ます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-730"><xref:System.Messaging.MessageQueue.CanRead%2A> is `false` if a queue is already open with exclusive read access (or if it's open with non-exclusive access and this <xref:System.Messaging.MessageQueue> requests exclusive access), or if the application does not have sufficient rights to access it.</span></span> <span data-ttu-id="f3a8c-731"><xref:System.Messaging.MessageQueue.CanRead%2A> が `false`されたときにアプリケーションがキューからの読み取りを試行した場合、アクセスは拒否されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-731">If your application tries to read from a queue when <xref:System.Messaging.MessageQueue.CanRead%2A> is `false`, access is denied.</span></span>  
  
 <span data-ttu-id="f3a8c-732">次の表は、このプロパティがさまざまなワークグループモードで使用できるかどうかを示しています。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-732">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-733">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-733">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-734">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-734">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-735">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-735">Local computer</span></span>|<span data-ttu-id="f3a8c-736">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-736">Yes</span></span>|  
|<span data-ttu-id="f3a8c-737">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-737">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-738">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-738">Yes</span></span>|  
|<span data-ttu-id="f3a8c-739">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-739">Remote computer</span></span>|<span data-ttu-id="f3a8c-740">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-740">No</span></span>|  
|<span data-ttu-id="f3a8c-741">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-741">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-742">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-742">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-743">次のコード例では、メッセージキューの <xref:System.Messaging.MessageQueue.CanRead%2A> プロパティの値を表示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-743">The following code example displays the value of a message queue's <xref:System.Messaging.MessageQueue.CanRead%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#5](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#5)]  
  
 ]]></format>
        </remarks>
        <altmember cref="P:System.Messaging.MessageQueue.CanWrite" />
        <altmember cref="P:System.Messaging.MessageQueue.ReadHandle" />
      </Docs>
    </Member>
    <Member MemberName="CanWrite">
      <MemberSignature Language="C#" Value="public bool CanWrite { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool CanWrite" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.CanWrite" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property CanWrite As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property bool CanWrite { bool get(); };" />
      <MemberSignature Language="F#" Value="member this.CanWrite : bool" Usage="System.Messaging.MessageQueue.CanWrite" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_CanWrite")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="f3a8c-744"><see cref="T:System.Messaging.MessageQueue" /> に書き込むことができるかどうかを示す値を取得します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-744">Gets a value that indicates whether the <see cref="T:System.Messaging.MessageQueue" /> can be written to.</span></span></summary>
        <value><span data-ttu-id="f3a8c-745"><see cref="T:System.Messaging.MessageQueue" /> が存在し、アプリケーションが書き込むことができる場合は <see langword="true" />。それ以外の場合は <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-745"><see langword="true" /> if the <see cref="T:System.Messaging.MessageQueue" /> exists and the application can write to it; otherwise, <see langword="false" />.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-746"><xref:System.Messaging.MessageQueue.CanWrite%2A> は、アプリケーションがメッセージをキューに送信できるかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-746"><xref:System.Messaging.MessageQueue.CanWrite%2A> indicates whether the application is able to send messages to the queue.</span></span> <span data-ttu-id="f3a8c-747"><xref:System.Messaging.MessageQueue.CanWrite%2A> が `true`場合、<xref:System.Messaging.MessageQueue> はキューにメッセージを送信できます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-747">If <xref:System.Messaging.MessageQueue.CanWrite%2A> is `true`, the <xref:System.Messaging.MessageQueue> can send messages to the queue.</span></span> <span data-ttu-id="f3a8c-748">それ以外の場合はできません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-748">Otherwise, it cannot.</span></span>  
  
 <span data-ttu-id="f3a8c-749">キューが排他的な書き込みアクセスで既に開かれている場合 (または、排他アクセスを使用して開いている場合、この <xref:System.Messaging.MessageQueue> 排他アクセスを要求した場合)、またはアプリケーションにアクセスするための十分な権限がない場合は、<xref:System.Messaging.MessageQueue.CanWrite%2A> が `false` ます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-749"><xref:System.Messaging.MessageQueue.CanWrite%2A> is `false` if a queue is already open with exclusive write access (or if it's open with non-exclusive access and this <xref:System.Messaging.MessageQueue> requests exclusive access), or if the application does not have sufficient rights to access it.</span></span> <span data-ttu-id="f3a8c-750"><xref:System.Messaging.MessageQueue.CanWrite%2A> が `false`されたときにアプリケーションがキューに書き込もうとした場合、アクセスが拒否されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-750">If your application tries to write to a queue when <xref:System.Messaging.MessageQueue.CanWrite%2A> is `false`, access is denied.</span></span>  
  
 <span data-ttu-id="f3a8c-751">次の表は、このプロパティがさまざまなワークグループモードで使用できるかどうかを示しています。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-751">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-752">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-752">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-753">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-753">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-754">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-754">Local computer</span></span>|<span data-ttu-id="f3a8c-755">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-755">Yes</span></span>|  
|<span data-ttu-id="f3a8c-756">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-756">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-757">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-757">Yes</span></span>|  
|<span data-ttu-id="f3a8c-758">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-758">Remote computer</span></span>|<span data-ttu-id="f3a8c-759">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-759">No</span></span>|  
|<span data-ttu-id="f3a8c-760">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-760">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-761">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-761">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-762">次のコード例では、メッセージキューの <xref:System.Messaging.MessageQueue.CanWrite%2A> プロパティの値を表示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-762">The following code example displays the value of a message queue's <xref:System.Messaging.MessageQueue.CanWrite%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#6](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#6)]  
  
 ]]></format>
        </remarks>
        <altmember cref="P:System.Messaging.MessageQueue.WriteHandle" />
        <altmember cref="P:System.Messaging.MessageQueue.CanRead" />
      </Docs>
    </Member>
    <Member MemberName="Category">
      <MemberSignature Language="C#" Value="public Guid Category { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance valuetype System.Guid Category" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.Category" />
      <MemberSignature Language="VB.NET" Value="Public Property Category As Guid" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property Guid Category { Guid get(); void set(Guid value); };" />
      <MemberSignature Language="F#" Value="member this.Category : Guid with get, set" Usage="System.Messaging.MessageQueue.Category" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_Category")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Guid</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="f3a8c-763">キュー カテゴリを取得または設定します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-763">Gets or sets the queue category.</span></span></summary>
        <value><span data-ttu-id="f3a8c-764">キュー カテゴリを表す <see cref="T:System.Guid" /> (メッセージ キュー タイプ ID)。これによって、アプリケーションはキューを分類できます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-764">A <see cref="T:System.Guid" /> that represents the queue category (Message Queuing type identifier), which allows an application to categorize its queues.</span></span> <span data-ttu-id="f3a8c-765">既定値は、<see langword="Guid.empty" /> です。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-765">The default is <see langword="Guid.empty" />.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-766">キューカテゴリを使用すると、アプリケーションはキューを分類できます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-766">The queue category allows an application to categorize its queues.</span></span> <span data-ttu-id="f3a8c-767">たとえば、すべての請求キューを1つのカテゴリに配置し、すべての注文キューを別のカテゴリに配置できます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-767">For example, you can place all Billing queues in one category and all Order queues in another.</span></span>  
  
 <span data-ttu-id="f3a8c-768"><xref:System.Messaging.MessageQueue.Category%2A> プロパティを使用すると、コンピューターの管理コンソールの **[キューのプロパティ]** ダイアログボックスからアクセスできる "メッセージキューの種類 ID" プロパティ (読み取り/書き込み) にアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-768">The <xref:System.Messaging.MessageQueue.Category%2A> property provides access to the Message Queuing Type ID property (which is read/write), accessible through the **Queue Properties** dialog box in the Computer Management Console.</span></span> <span data-ttu-id="f3a8c-769">新しいカテゴリを定義できます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-769">You can define a new category.</span></span> <span data-ttu-id="f3a8c-770"><xref:System.Guid.NewGuid%2A> を使用して、すべての <xref:System.Guid> 値で一意のカテゴリ値を作成することもできますが、このようなアクションは必要ありません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-770">Although you can use <xref:System.Guid.NewGuid%2A> to create a category value that is unique across all <xref:System.Guid> values, such an action is unnecessary.</span></span> <span data-ttu-id="f3a8c-771">カテゴリ値は、他のすべての <xref:System.Guid> 値からではなく、他のカテゴリからのみ一意である必要があります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-771">The category value needs to be distinct only from other categories, not from all other <xref:System.Guid> values.</span></span> <span data-ttu-id="f3a8c-772">たとえば、{00000000-0000-0000-0000-000000000001} を1つのキューセットの <xref:System.Messaging.MessageQueue.Category%2A> として、別のセットの <xref:System.Messaging.MessageQueue.Category%2A> として {00000000-0000-0000-0000-000000000002} を割り当てることができます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-772">For example, you can assign {00000000-0000-0000-0000-000000000001} as the <xref:System.Messaging.MessageQueue.Category%2A> for one set of queues and {00000000-0000-0000-0000-000000000002} as the <xref:System.Messaging.MessageQueue.Category%2A> for another set.</span></span>  
  
 <span data-ttu-id="f3a8c-773"><xref:System.Messaging.MessageQueue.Category%2A>を設定する必要はありません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-773">It is not necessary to set the <xref:System.Messaging.MessageQueue.Category%2A>.</span></span> <span data-ttu-id="f3a8c-774">値として `null` を指定できます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-774">The value can be `null`.</span></span>  
  
 <span data-ttu-id="f3a8c-775">このプロパティを設定すると、メッセージキューのキューが変更されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-775">Setting this property modifies the Message Queuing queue.</span></span> <span data-ttu-id="f3a8c-776">そのため、その他の <xref:System.Messaging.MessageQueue> インスタンスは変更の影響を受けます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-776">Therefore, any other <xref:System.Messaging.MessageQueue> instances are affected by the change.</span></span>  
  
 <span data-ttu-id="f3a8c-777">次の表は、このプロパティがさまざまなワークグループモードで使用できるかどうかを示しています。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-777">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-778">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-778">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-779">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-779">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-780">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-780">Local computer</span></span>|<span data-ttu-id="f3a8c-781">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-781">Yes</span></span>|  
|<span data-ttu-id="f3a8c-782">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-782">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-783">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-783">Yes</span></span>|  
|<span data-ttu-id="f3a8c-784">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-784">Remote computer</span></span>|<span data-ttu-id="f3a8c-785">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-785">No</span></span>|  
|<span data-ttu-id="f3a8c-786">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-786">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-787">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-787">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-788">次のコード例では、メッセージキューの <xref:System.Messaging.MessageQueue.Category%2A> プロパティの値を取得して設定します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-788">The following code example gets and sets the value of a message queue's <xref:System.Messaging.MessageQueue.Category%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#7](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#7)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="f3a8c-789">キュー カテゴリに無効な値が設定されています。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-789">The queue category was set to an invalid value.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="f3a8c-790">メッセージ キューのメソッドにアクセスしたときにエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-790">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.Id" />
        <altmember cref="P:System.Messaging.MessageQueue.Label" />
        <altmember cref="M:System.Messaging.MessageQueue.GetPublicQueues" />
      </Docs>
    </Member>
    <Member MemberName="ClearConnectionCache">
      <MemberSignature Language="C#" Value="public static void ClearConnectionCache ();" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void ClearConnectionCache() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ClearConnectionCache" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub ClearConnectionCache ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void ClearConnectionCache();" />
      <MemberSignature Language="F#" Value="static member ClearConnectionCache : unit -&gt; unit" Usage="System.Messaging.MessageQueue.ClearConnectionCache " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="f3a8c-791">接続キャッシュを消去します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-791">Clears the connection cache.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-792"><xref:System.Messaging.MessageQueue.ClearConnectionCache%2A>を呼び出すと、キャッシュに格納されている形式名が削除され、キャッシュに格納されて格納されているハンドルが閉じられます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-792">When you call <xref:System.Messaging.MessageQueue.ClearConnectionCache%2A>, the format names stored in the cache are removed and handles opened and stored in the cache are closed.</span></span>  
  
 <span data-ttu-id="f3a8c-793">次の表に、この方法をさまざまなワークグループモードで使用できるかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-793">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-794">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-794">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-795">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-795">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-796">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-796">Local computer</span></span>|<span data-ttu-id="f3a8c-797">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-797">Yes</span></span>|  
|<span data-ttu-id="f3a8c-798">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-798">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-799">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-799">Yes</span></span>|  
|<span data-ttu-id="f3a8c-800">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-800">Remote computer</span></span>|<span data-ttu-id="f3a8c-801">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-801">Yes</span></span>|  
|<span data-ttu-id="f3a8c-802">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-802">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-803">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-803">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-804"><xref:System.Messaging.MessageQueue.ClearConnectionCache%2A> を呼び出すコード例を次に示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-804">The following code example calls <xref:System.Messaging.MessageQueue.ClearConnectionCache%2A>.</span></span>  
  
 [!code-csharp[MessageQueue#8](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#8)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="Close">
      <MemberSignature Language="C#" Value="public void Close ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void Close() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Close" />
      <MemberSignature Language="VB.NET" Value="Public Sub Close ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void Close();" />
      <MemberSignature Language="F#" Value="member this.Close : unit -&gt; unit" Usage="messageQueue.Close " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="f3a8c-805"><see cref="T:System.Messaging.MessageQueue" /> で割り当てられたすべてのリソースを解放します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-805">Frees all resources allocated by the <see cref="T:System.Messaging.MessageQueue" />.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-806">必要に応じて、共有リソースを含め、<xref:System.Messaging.MessageQueue>に関連付けられているすべてのリソースを解放 <xref:System.Messaging.MessageQueue.Close%2A> ます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-806"><xref:System.Messaging.MessageQueue.Close%2A> frees all resources associated with a <xref:System.Messaging.MessageQueue>, including shared resources if appropriate.</span></span> <span data-ttu-id="f3a8c-807">次のコードのように、これらのリソースが引き続き使用可能な場合は、システムによって自動的に再取得さC#れます。たとえば、次のコードに示すように、<xref:System.Messaging.MessageQueue.Send%28System.Object%29> メソッドを呼び出す場合などです。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-807">The system re-acquires these resources automatically if they are still available, for example when you call the <xref:System.Messaging.MessageQueue.Send%28System.Object%29> method, as in the following C# code.</span></span>  
  
```csharp  
myMessageQueue.Send("Text 1.");  
myMessageQueue.Close();  
myMessageQueue.Send("Text 2."); //Resources are re-acquired.  
```  
  
 <span data-ttu-id="f3a8c-808"><xref:System.Messaging.MessageQueue.Close%2A>を呼び出すと、メッセージキューのキューに直接アクセスするすべての <xref:System.Messaging.MessageQueue> プロパティがクリアされます。<xref:System.Messaging.MessageQueue.Path%2A>、<xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A>、<xref:System.Messaging.MessageQueue.Formatter%2A>、および <xref:System.Messaging.MessageQueue.MessageReadPropertyFilter%2A> はすべてそのまま残ります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-808">When you call <xref:System.Messaging.MessageQueue.Close%2A>, all <xref:System.Messaging.MessageQueue> properties that directly access the Message Queuing queue are cleared out. The <xref:System.Messaging.MessageQueue.Path%2A>, <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A>, <xref:System.Messaging.MessageQueue.Formatter%2A>, and <xref:System.Messaging.MessageQueue.MessageReadPropertyFilter%2A> all remain as they were.</span></span>  
  
 <span data-ttu-id="f3a8c-809"><xref:System.Messaging.MessageQueue.Close%2A> は、共有されている可能性があるため、キューに対して読み取りおよび書き込みハンドルを必ず解放するわけではありません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-809"><xref:System.Messaging.MessageQueue.Close%2A> does not always free the read and write handles to a queue, because they might be shared.</span></span> <span data-ttu-id="f3a8c-810">次のいずれかの手順を実行して、<xref:System.Messaging.MessageQueue.Close%2A> が読み取りハンドルと書き込みハンドルをキューに解放できるようにすることができます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-810">You can take any of the following steps to ensure that <xref:System.Messaging.MessageQueue.Close%2A> frees the read and write handles to a queue:</span></span>  
  
-   <span data-ttu-id="f3a8c-811">排他アクセスで <xref:System.Messaging.MessageQueue> を作成します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-811">Create the <xref:System.Messaging.MessageQueue> with exclusive access.</span></span> <span data-ttu-id="f3a8c-812">これを行うには、<xref:System.Messaging.MessageQueue.%23ctor%28System.String%2CSystem.Boolean%29> または <xref:System.Messaging.MessageQueue.%23ctor%28System.String%2CSystem.Boolean%2CSystem.Boolean%29> コンストラクターを呼び出し、`sharedModeDenyReceive` パラメーターを `true`に設定します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-812">To do so, call the <xref:System.Messaging.MessageQueue.%23ctor%28System.String%2CSystem.Boolean%29> or <xref:System.Messaging.MessageQueue.%23ctor%28System.String%2CSystem.Boolean%2CSystem.Boolean%29> constructor, and set the `sharedModeDenyReceive` parameter to `true`.</span></span>  
  
-   <span data-ttu-id="f3a8c-813">接続キャッシュを無効にして <xref:System.Messaging.MessageQueue> を作成します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-813">Create the <xref:System.Messaging.MessageQueue> with connection caching disabled.</span></span> <span data-ttu-id="f3a8c-814">これを行うには、<xref:System.Messaging.MessageQueue.%23ctor%28System.String%2CSystem.Boolean%2CSystem.Boolean%29> コンストラクターを呼び出し、`enableConnectionCache` パラメーターを `false`に設定します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-814">To do so, call the <xref:System.Messaging.MessageQueue.%23ctor%28System.String%2CSystem.Boolean%2CSystem.Boolean%29> constructor and set the `enableConnectionCache` parameter to `false`.</span></span>  
  
-   <span data-ttu-id="f3a8c-815">接続キャッシュを無効にします。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-815">Disable connection caching.</span></span> <span data-ttu-id="f3a8c-816">これを行うには、<xref:System.Messaging.MessageQueue.EnableConnectionCache%2A> プロパティを `false`に設定します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-816">To do so, set the <xref:System.Messaging.MessageQueue.EnableConnectionCache%2A> property to `false`.</span></span>  
  
 <span data-ttu-id="f3a8c-817">メッセージキューサーバーのキューを削除する前に、キューの <xref:System.Messaging.MessageQueue.Close%2A> を呼び出す必要があります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-817">You should call <xref:System.Messaging.MessageQueue.Close%2A> for a queue before you delete the queue on the Message Queuing server.</span></span> <span data-ttu-id="f3a8c-818">そうしないと、キューに送信されたメッセージが例外をスローしたり、配信不能キューに表示されたりする可能性があります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-818">Otherwise, messages sent to the queue could throw exceptions or appear in the dead-letter queue.</span></span>  
  
 <span data-ttu-id="f3a8c-819">次の表に、この方法をさまざまなワークグループモードで使用できるかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-819">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-820">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-820">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-821">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-821">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-822">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-822">Local computer</span></span>|<span data-ttu-id="f3a8c-823">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-823">Yes</span></span>|  
|<span data-ttu-id="f3a8c-824">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-824">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-825">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-825">Yes</span></span>|  
|<span data-ttu-id="f3a8c-826">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-826">Remote computer</span></span>|<span data-ttu-id="f3a8c-827">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-827">Yes</span></span>|  
|<span data-ttu-id="f3a8c-828">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-828">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-829">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-829">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-830">次のコード例では、メッセージキューのキューを閉じます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-830">The following code example closes a Message Queuing queue.</span></span>  
  
 [!code-cpp[MessageQueue.Close#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Close/CPP/mqclose.cpp#1)]
 [!code-csharp[MessageQueue.Close#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Close/CS/mqclose.cs#1)]
 [!code-vb[MessageQueue.Close#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Close/VB/mqclose.vb#1)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <MemberGroup MemberName="Create">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="f3a8c-831">メッセージ キュー サーバーの指定したパスに新しいキューを作成します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-831">Creates a new queue at the specified path on a Message Queuing server.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="Create">
      <MemberSignature Language="C#" Value="public static System.Messaging.MessageQueue Create (string path);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Messaging.MessageQueue Create(string path) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Create(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function Create (path As String) As MessageQueue" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::Messaging::MessageQueue ^ Create(System::String ^ path);" />
      <MemberSignature Language="F#" Value="static member Create : string -&gt; System.Messaging.MessageQueue" Usage="System.Messaging.MessageQueue.Create path" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.MessageQueue</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="path" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="path"><span data-ttu-id="f3a8c-832">作成するキューのパス。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-832">The path of the queue to create.</span></span></param>
        <summary><span data-ttu-id="f3a8c-833">指定したパスに非トランザクション メッセージ キューのキューを作成します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-833">Creates a non-transactional Message Queuing queue at the specified path.</span></span></summary>
        <returns><span data-ttu-id="f3a8c-834">新しいキューを表す <see cref="T:System.Messaging.MessageQueue" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-834">A <see cref="T:System.Messaging.MessageQueue" /> that represents the new queue.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-835">このオーバーロードを使用して、非トランザクションメッセージキューのキューを作成します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-835">Use this overload to create a non-transactional Message Queuing queue.</span></span>  
  
 <span data-ttu-id="f3a8c-836">アプリケーションで <xref:System.Messaging.MessageQueue> クラスの新しいインスタンスを作成し、既存のキューにバインドするには、<xref:System.Messaging.MessageQueue.%23ctor%2A> コンストラクターを使用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-836">To create a new instance of the <xref:System.Messaging.MessageQueue> class in your application and bind it to an existing queue, use the <xref:System.Messaging.MessageQueue.%23ctor%2A> constructor.</span></span> <span data-ttu-id="f3a8c-837">メッセージキューに新しいキューを作成するには、<xref:System.Messaging.MessageQueue.Create%28System.String%29>を呼び出します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-837">To create a new queue in Message Queuing, call <xref:System.Messaging.MessageQueue.Create%28System.String%29>.</span></span>  
  
 <span data-ttu-id="f3a8c-838">`path` パラメーターの構文は、次の表に示すように、参照するキューの種類によって異なります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-838">The syntax for the `path` parameter depends on the type of queue it references, as shown in the following table.</span></span>  
  
|<span data-ttu-id="f3a8c-839">[キューの種類]</span><span class="sxs-lookup"><span data-stu-id="f3a8c-839">Queue type</span></span>|<span data-ttu-id="f3a8c-840">構文</span><span class="sxs-lookup"><span data-stu-id="f3a8c-840">Syntax</span></span>|  
|----------------|------------|  
|<span data-ttu-id="f3a8c-841">パブリックキュー</span><span class="sxs-lookup"><span data-stu-id="f3a8c-841">Public queue</span></span>|`MachineName`\\`QueueName`|  
|<span data-ttu-id="f3a8c-842">専用キュー</span><span class="sxs-lookup"><span data-stu-id="f3a8c-842">Private queue</span></span>|`MachineName`\\`Private$`\\`QueueName`|  
  
 <span data-ttu-id="f3a8c-843">ローカルコンピューターには "." を使用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-843">Use "." for the local computer.</span></span> <span data-ttu-id="f3a8c-844">構文の詳細については、<xref:System.Messaging.MessageQueue.Path%2A> プロパティを参照してください。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-844">For more syntax, see the <xref:System.Messaging.MessageQueue.Path%2A> property.</span></span>  
  
 <span data-ttu-id="f3a8c-845">次の表に、この方法をさまざまなワークグループモードで使用できるかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-845">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-846">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-846">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-847">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-847">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-848">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-848">Local computer</span></span>|<span data-ttu-id="f3a8c-849">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-849">Yes</span></span>|  
|<span data-ttu-id="f3a8c-850">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-850">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-851">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-851">Yes</span></span>|  
|<span data-ttu-id="f3a8c-852">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-852">Remote computer</span></span>|<span data-ttu-id="f3a8c-853">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-853">No</span></span>|  
|<span data-ttu-id="f3a8c-854">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-854">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-855">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-855">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-856">次のコード例では、パブリックキューと専用キューを作成します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-856">The following code example creates public and private queues.</span></span> <span data-ttu-id="f3a8c-857">選択したキューにメッセージを送信します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-857">It sends a message to selected queues.</span></span>  
  
 [!code-cpp[MessageQueue.Create_path#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Create_path/CPP/mqcreate.cpp#1)]
 [!code-csharp[MessageQueue.Create_path#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Create_path/CS/mqcreate.cs#1)]
 [!code-vb[MessageQueue.Create_path#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Create_path/VB/mqcreate.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="f3a8c-858"><paramref name="path" /> パラメーターが <see langword="null" /> または空の文字列 ("") です。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-858">The <paramref name="path" /> parameter is <see langword="null" /> or is an empty string ("").</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="f3a8c-859">指定したパスには既にキューが存在します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-859">A queue already exists at the specified path.</span></span>  
  
 <span data-ttu-id="f3a8c-860">- または -</span><span class="sxs-lookup"><span data-stu-id="f3a8c-860">-or-</span></span>  
  
 <span data-ttu-id="f3a8c-861">メッセージ キューのメソッドにアクセスしたときにエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-861">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.Path" />
        <altmember cref="M:System.Messaging.MessageQueue.#ctor" />
      </Docs>
    </Member>
    <Member MemberName="Create">
      <MemberSignature Language="C#" Value="public static System.Messaging.MessageQueue Create (string path, bool transactional);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Messaging.MessageQueue Create(string path, bool transactional) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Create(System.String,System.Boolean)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function Create (path As String, transactional As Boolean) As MessageQueue" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::Messaging::MessageQueue ^ Create(System::String ^ path, bool transactional);" />
      <MemberSignature Language="F#" Value="static member Create : string * bool -&gt; System.Messaging.MessageQueue" Usage="System.Messaging.MessageQueue.Create (path, transactional)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.MessageQueue</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="path" Type="System.String" />
        <Parameter Name="transactional" Type="System.Boolean" />
      </Parameters>
      <Docs>
        <param name="path"><span data-ttu-id="f3a8c-862">作成するキューのパス。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-862">The path of the queue to create.</span></span></param>
        <param name="transactional"><span data-ttu-id="f3a8c-863">トランザクション キューを作成する場合は <see langword="true" />。非トランザクション キューを作成する場合は <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-863"><see langword="true" /> to create a transactional queue; <see langword="false" /> to create a non-transactional queue.</span></span></param>
        <summary><span data-ttu-id="f3a8c-864">指定したパスに、トランザクション メッセージ キューのキューまたは非トランザクション メッセージ キューのキューを作成します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-864">Creates a transactional or non-transactional Message Queuing queue at the specified path.</span></span></summary>
        <returns><span data-ttu-id="f3a8c-865">新しいキューを表す <see cref="T:System.Messaging.MessageQueue" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-865">A <see cref="T:System.Messaging.MessageQueue" /> that represents the new queue.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-866">このオーバーロードを使用して、メッセージキューでトランザクションキューを作成できます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-866">You can use this overload to create a transactional queue in Message Queuing.</span></span> <span data-ttu-id="f3a8c-867">非トランザクションキューを作成するには、`transactional` パラメーターを `false` に設定するか、<xref:System.Messaging.MessageQueue.Create%28System.String%29>の他のオーバーロードを呼び出します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-867">You can create a non-transactional queue, by setting the `transactional` parameter to `false` or by calling the other overload of <xref:System.Messaging.MessageQueue.Create%28System.String%29>.</span></span>  
  
 <span data-ttu-id="f3a8c-868">アプリケーションで <xref:System.Messaging.MessageQueue> クラスの新しいインスタンスを作成し、既存のキューにバインドするには、<xref:System.Messaging.MessageQueue.%23ctor%2A> コンストラクターを使用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-868">To create a new instance of the <xref:System.Messaging.MessageQueue> class in your application and bind it to an existing queue, use the <xref:System.Messaging.MessageQueue.%23ctor%2A> constructor.</span></span> <span data-ttu-id="f3a8c-869">メッセージキューに新しいキューを作成するには、<xref:System.Messaging.MessageQueue.Create%28System.String%29>を呼び出します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-869">To create a new queue in Message Queuing, call <xref:System.Messaging.MessageQueue.Create%28System.String%29>.</span></span>  
  
 <span data-ttu-id="f3a8c-870">`path` パラメーターの構文は、次の表に示すように、参照するキューの種類によって異なります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-870">The syntax for the `path` parameter depends on the type of queue it references, as shown in the following table.</span></span>  
  
|<span data-ttu-id="f3a8c-871">[キューの種類]</span><span class="sxs-lookup"><span data-stu-id="f3a8c-871">Queue type</span></span>|<span data-ttu-id="f3a8c-872">構文</span><span class="sxs-lookup"><span data-stu-id="f3a8c-872">Syntax</span></span>|  
|----------------|------------|  
|<span data-ttu-id="f3a8c-873">パブリックキュー</span><span class="sxs-lookup"><span data-stu-id="f3a8c-873">Public queue</span></span>|`MachineName`\\`QueueName`|  
|<span data-ttu-id="f3a8c-874">専用キュー</span><span class="sxs-lookup"><span data-stu-id="f3a8c-874">Private queue</span></span>|`MachineName`\\`Private$`\\`QueueName`|  
  
 <span data-ttu-id="f3a8c-875">ローカルコンピューターには "." を使用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-875">Use "." for the local computer.</span></span> <span data-ttu-id="f3a8c-876">構文の詳細については、<xref:System.Messaging.MessageQueue.Path%2A> プロパティを参照してください。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-876">For more syntax, see the <xref:System.Messaging.MessageQueue.Path%2A> property.</span></span>  
  
 <span data-ttu-id="f3a8c-877">次の表に、この方法をさまざまなワークグループモードで使用できるかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-877">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-878">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-878">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-879">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-879">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-880">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-880">Local computer</span></span>|<span data-ttu-id="f3a8c-881">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-881">Yes</span></span>|  
|<span data-ttu-id="f3a8c-882">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-882">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-883">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-883">Yes</span></span>|  
|<span data-ttu-id="f3a8c-884">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-884">Remote computer</span></span>|<span data-ttu-id="f3a8c-885">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-885">No</span></span>|  
|<span data-ttu-id="f3a8c-886">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-886">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-887">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-887">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-888">次のコード例では、パブリックおよびプライベートのトランザクションキューを作成します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-888">The following code example creates public and private transactional queues.</span></span> <span data-ttu-id="f3a8c-889">選択したキューにメッセージを送信します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-889">It sends a message to selected queues.</span></span>  
  
 [!code-cpp[MessageQueue.Create_PathTransactional#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Create_PathTransactional/CPP/mqcreate_transactional.cpp#1)]
 [!code-csharp[MessageQueue.Create_PathTransactional#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Create_PathTransactional/CS/mqcreate_transactional.cs#1)]
 [!code-vb[MessageQueue.Create_PathTransactional#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Create_PathTransactional/VB/mqcreate_transactional.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="f3a8c-890"><paramref name="path" /> パラメーターが <see langword="null" /> または空の文字列 ("") です。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-890">The <paramref name="path" /> parameter is <see langword="null" /> or is an empty string ("").</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="f3a8c-891">指定したパスには既にキューが存在します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-891">A queue already exists at the specified path.</span></span>  
  
 <span data-ttu-id="f3a8c-892">- または -</span><span class="sxs-lookup"><span data-stu-id="f3a8c-892">-or-</span></span>  
  
 <span data-ttu-id="f3a8c-893">メッセージ キューのメソッドにアクセスしたときにエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-893">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.Path" />
        <altmember cref="M:System.Messaging.MessageQueue.#ctor" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
      </Docs>
    </Member>
    <Member MemberName="CreateCursor">
      <MemberSignature Language="C#" Value="public System.Messaging.Cursor CreateCursor ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Cursor CreateCursor() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.CreateCursor" />
      <MemberSignature Language="VB.NET" Value="Public Function CreateCursor () As Cursor" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Cursor ^ CreateCursor();" />
      <MemberSignature Language="F#" Value="member this.CreateCursor : unit -&gt; System.Messaging.Cursor" Usage="messageQueue.CreateCursor " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Cursor</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="f3a8c-894">現在のメッセージ キューの新しい <see cref="T:System.Messaging.Cursor" /> を作成します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-894">Creates a new <see cref="T:System.Messaging.Cursor" /> for the current message queue.</span></span></summary>
        <returns><span data-ttu-id="f3a8c-895">現在のメッセージ キューの新しい <see cref="T:System.Messaging.Cursor" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-895">A new <see cref="T:System.Messaging.Cursor" /> for the current message queue.</span></span> <span data-ttu-id="f3a8c-896">このカーソルは、キューのメッセージを読み取るときに、キュー内の特定の場所を維持するために使用されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-896">This cursor is used to maintain a specific location in the queue when reading the queue's messages.</span></span></returns>
        <remarks>To be added.</remarks>
        <altmember cref="T:System.Messaging.Cursor" />
      </Docs>
    </Member>
    <Member MemberName="CreateTime">
      <MemberSignature Language="C#" Value="public DateTime CreateTime { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance valuetype System.DateTime CreateTime" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.CreateTime" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property CreateTime As DateTime" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property DateTime CreateTime { DateTime get(); };" />
      <MemberSignature Language="F#" Value="member this.CreateTime : DateTime" Usage="System.Messaging.MessageQueue.CreateTime" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_CreateTime")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.DateTime</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="f3a8c-897">キューがメッセージ キューに作成された時刻と日付を取得します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-897">Gets the time and date that the queue was created in Message Queuing.</span></span></summary>
        <value><span data-ttu-id="f3a8c-898">キューが作成された日付と時刻を表す <see cref="T:System.DateTime" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-898">A <see cref="T:System.DateTime" /> that represents the date and time at which the queue was created.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-899"><xref:System.Messaging.MessageQueue.CreateTime%2A> は、<xref:System.Messaging.MessageQueue> インスタンスではなく、メッセージキューサーバーのキューを指します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-899"><xref:System.Messaging.MessageQueue.CreateTime%2A> refers to the queue on the Message Queuing server, not the <xref:System.Messaging.MessageQueue> instance.</span></span>  
  
 <span data-ttu-id="f3a8c-900">キューが存在する場合、このプロパティはキューが作成された時刻を表し、キューが存在するサーバーのローカル時刻に調整されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-900">If the queue exists, this property represents the time the queue was created, adjusted to the local time of the server on which the queue exists.</span></span>  
  
 <span data-ttu-id="f3a8c-901">次の表は、このプロパティがさまざまなワークグループモードで使用できるかどうかを示しています。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-901">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-902">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-902">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-903">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-903">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-904">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-904">Local computer</span></span>|<span data-ttu-id="f3a8c-905">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-905">Yes</span></span>|  
|<span data-ttu-id="f3a8c-906">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-906">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-907">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-907">Yes</span></span>|  
|<span data-ttu-id="f3a8c-908">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-908">Remote computer</span></span>|<span data-ttu-id="f3a8c-909">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-909">No</span></span>|  
|<span data-ttu-id="f3a8c-910">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-910">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-911">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-911">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-912">次のコード例では、メッセージキューの <xref:System.Messaging.MessageQueue.CreateTime%2A> プロパティの値を表示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-912">The following code example displays the value of a message queue's <xref:System.Messaging.MessageQueue.CreateTime%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#9](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#9)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="f3a8c-913">メッセージ キューのメソッドにアクセスしたときにエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-913">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.LastModifyTime" />
      </Docs>
    </Member>
    <Member MemberName="DefaultPropertiesToSend">
      <MemberSignature Language="C#" Value="public System.Messaging.DefaultPropertiesToSend DefaultPropertiesToSend { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class System.Messaging.DefaultPropertiesToSend DefaultPropertiesToSend" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.DefaultPropertiesToSend" />
      <MemberSignature Language="VB.NET" Value="Public Property DefaultPropertiesToSend As DefaultPropertiesToSend" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Messaging::DefaultPropertiesToSend ^ DefaultPropertiesToSend { System::Messaging::DefaultPropertiesToSend ^ get(); void set(System::Messaging::DefaultPropertiesToSend ^ value); };" />
      <MemberSignature Language="F#" Value="member this.DefaultPropertiesToSend : System.Messaging.DefaultPropertiesToSend with get, set" Usage="System.Messaging.MessageQueue.DefaultPropertiesToSend" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_DefaultPropertiesToSend")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Content)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Messaging.DefaultPropertiesToSend</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="f3a8c-914">アプリケーションがメッセージをキューに送信するときに既定で使用されるメッセージ プロパティ値を取得または設定します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-914">Gets or sets the message property values to be used by default when the application sends messages to the queue.</span></span></summary>
        <value><span data-ttu-id="f3a8c-915">アプリケーションが <see cref="T:System.Messaging.DefaultPropertiesToSend" /> インスタンス以外のオブジェクトをキューに送信するときに使用する既定のメッセージ キューのメッセージ プロパティ値を含む <see cref="T:System.Messaging.Message" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-915">A <see cref="T:System.Messaging.DefaultPropertiesToSend" /> that contains the default Message Queuing message property values used when the application sends objects other than <see cref="T:System.Messaging.Message" /> instances to the queue.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-916"><xref:System.Messaging.Message> 型ではないオブジェクトをキューに送信すると、<xref:System.Messaging.MessageQueue> はそのオブジェクトをメッセージキューメッセージに挿入します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-916">When you send any object that is not of type <xref:System.Messaging.Message> to the queue, the <xref:System.Messaging.MessageQueue> inserts the object into a Message Queuing message.</span></span> <span data-ttu-id="f3a8c-917">その時点で、<xref:System.Messaging.MessageQueue> は、<xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> プロパティに指定したプロパティ値をメッセージに適用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-917">At that time, the <xref:System.Messaging.MessageQueue> applies to the message the property values you specify in the <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> property.</span></span> <span data-ttu-id="f3a8c-918">逆に、<xref:System.Messaging.Message> をキューに送信すると、これらのプロパティは既にインスタンス自体に対して指定されているので、<xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> は <xref:System.Messaging.Message>に対して無視されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-918">Conversely, if you send a <xref:System.Messaging.Message> to the queue, these properties are already specified for the instance itself, so <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> is ignored for the <xref:System.Messaging.Message>.</span></span>  
  
 <span data-ttu-id="f3a8c-919"><xref:System.Messaging.MessageQueue> オブジェクトを使用してプロパティを設定しても、<xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> はキュー自体ではなく、キューに送信されるメッセージのプロパティを参照します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-919">Although you set the properties through the <xref:System.Messaging.MessageQueue> object, the <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> refers to the properties of the messages that are sent to the queue, not the queue itself.</span></span>  
  
 <span data-ttu-id="f3a8c-920">次の表に、プロパティの既定値を示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-920">The default values for the properties are shown in the following table.</span></span>  
  
|<span data-ttu-id="f3a8c-921">プロパティ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-921">Property</span></span>|<span data-ttu-id="f3a8c-922">既定値</span><span class="sxs-lookup"><span data-stu-id="f3a8c-922">Default value</span></span>|  
|--------------|-------------------|  
|<xref:System.Messaging.DefaultPropertiesToSend.AcknowledgeType%2A>|`AcknowledgeType.None`|  
|<xref:System.Messaging.DefaultPropertiesToSend.AdministrationQueue%2A>|`null`|  
|<xref:System.Messaging.DefaultPropertiesToSend.AppSpecific%2A>|<span data-ttu-id="f3a8c-923">ゼロ (0)</span><span class="sxs-lookup"><span data-stu-id="f3a8c-923">Zero (0)</span></span>|  
|<xref:System.Messaging.DefaultPropertiesToSend.AttachSenderId%2A>|`true`|  
|<xref:System.Messaging.DefaultPropertiesToSend.EncryptionAlgorithm%2A>|`EncryptionAlgorithm.RC2`|  
|<xref:System.Messaging.DefaultPropertiesToSend.Extension%2A>|<span data-ttu-id="f3a8c-924">長さ0のバイト配列</span><span class="sxs-lookup"><span data-stu-id="f3a8c-924">A zero-length array of bytes</span></span>|  
|<xref:System.Messaging.DefaultPropertiesToSend.HashAlgorithm%2A>|`HashAlgorithm.MD5`|  
|<xref:System.Messaging.DefaultPropertiesToSend.Label%2A>|<span data-ttu-id="f3a8c-925">空の文字列 ("")</span><span class="sxs-lookup"><span data-stu-id="f3a8c-925">Empty string ("")</span></span>|  
|<xref:System.Messaging.DefaultPropertiesToSend.Priority%2A>|`MessagePriority.Normal`|  
|<xref:System.Messaging.DefaultPropertiesToSend.Recoverable%2A>|`false`|  
|<xref:System.Messaging.DefaultPropertiesToSend.ResponseQueue%2A>|`null`|  
|<xref:System.Messaging.DefaultPropertiesToSend.TimeToBeReceived%2A>|`Message.InfiniteTimeout`|  
|<xref:System.Messaging.DefaultPropertiesToSend.TimeToReachQueue%2A>|`Message.InfiniteTimeout`|  
|<xref:System.Messaging.DefaultPropertiesToSend.TransactionStatusQueue%2A>|`null`|  
|<xref:System.Messaging.DefaultPropertiesToSend.UseAuthentication%2A>|`false`|  
|<xref:System.Messaging.DefaultPropertiesToSend.UseDeadLetterQueue%2A>|`false`|  
|<xref:System.Messaging.DefaultPropertiesToSend.UseEncryption%2A>|`false`|  
|<xref:System.Messaging.DefaultPropertiesToSend.UseJournalQueue%2A>|`false`|  
|<xref:System.Messaging.DefaultPropertiesToSend.UseTracing%2A>|`false`|  
  
 <span data-ttu-id="f3a8c-926">次の表は、このプロパティがさまざまなワークグループモードで使用できるかどうかを示しています。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-926">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-927">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-927">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-928">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-928">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-929">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-929">Local computer</span></span>|<span data-ttu-id="f3a8c-930">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-930">Yes</span></span>|  
|<span data-ttu-id="f3a8c-931">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-931">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-932">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-932">Yes</span></span>|  
|<span data-ttu-id="f3a8c-933">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-933">Remote computer</span></span>|<span data-ttu-id="f3a8c-934">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-934">Yes</span></span>|  
|<span data-ttu-id="f3a8c-935">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-935">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-936">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-936">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-937">次のコード例では、メッセージの優先度を使用して、メッセージに対して送信する既定のプロパティを決定します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-937">The following code example uses the priority of a message to determine default properties to send for the message.</span></span>  
  
 [!code-cpp[MessageQueue.DefaultPropertiesToSend#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.DefaultPropertiesToSend/CPP/mqdefaultpropertiestosend.cpp#1)]
 [!code-csharp[MessageQueue.DefaultPropertiesToSend#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.DefaultPropertiesToSend/CS/mqdefaultpropertiestosend.cs#1)]
 [!code-vb[MessageQueue.DefaultPropertiesToSend#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.DefaultPropertiesToSend/VB/mqdefaultpropertiestosend.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="f3a8c-938">既定のプロパティをキューに設定できませんでした。いずれかのプロパティが無効であることが原因である可能性があります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-938">The default properties could not be set for the queue, possibly because one of the properties is not valid.</span></span></exception>
        <altmember cref="T:System.Messaging.Message" />
        <altmember cref="T:System.Messaging.AcknowledgeTypes" />
        <altmember cref="T:System.Messaging.EncryptionAlgorithm" />
        <altmember cref="T:System.Messaging.HashAlgorithm" />
        <altmember cref="F:System.Messaging.Message.InfiniteTimeout" />
      </Docs>
    </Member>
    <Member MemberName="Delete">
      <MemberSignature Language="C#" Value="public static void Delete (string path);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void Delete(string path) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Delete(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub Delete (path As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void Delete(System::String ^ path);" />
      <MemberSignature Language="F#" Value="static member Delete : string -&gt; unit" Usage="System.Messaging.MessageQueue.Delete path" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="path" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="path"><span data-ttu-id="f3a8c-939">削除するキューの場所。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-939">The location of the queue to be deleted.</span></span></param>
        <summary><span data-ttu-id="f3a8c-940">メッセージ キュー サーバーのキューを削除します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-940">Deletes a queue on a Message Queuing server.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-941">`path` パラメーターの構文は、キューの種類によって異なります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-941">The syntax for the `path` parameter depends on the type of queue.</span></span>  
  
|<span data-ttu-id="f3a8c-942">[キューの種類]</span><span class="sxs-lookup"><span data-stu-id="f3a8c-942">Queue type</span></span>|<span data-ttu-id="f3a8c-943">構文</span><span class="sxs-lookup"><span data-stu-id="f3a8c-943">Syntax</span></span>|  
|----------------|------------|  
|<span data-ttu-id="f3a8c-944">パブリックキュー</span><span class="sxs-lookup"><span data-stu-id="f3a8c-944">Public queue</span></span>|`MachineName`\\`QueueName`|  
|<span data-ttu-id="f3a8c-945">専用キュー</span><span class="sxs-lookup"><span data-stu-id="f3a8c-945">Private queue</span></span>|`MachineName`\\`Private$`\\`QueueName`|  
  
 <span data-ttu-id="f3a8c-946">構文の詳細については、<xref:System.Messaging.MessageQueue.Path%2A> プロパティを参照してください。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-946">For more syntax, see the <xref:System.Messaging.MessageQueue.Path%2A> property.</span></span>  
  
 <span data-ttu-id="f3a8c-947">または、<xref:System.Messaging.MessageQueue.FormatName%2A> または <xref:System.Messaging.MessageQueue.Label%2A> を使用して、キューのパスを記述することもできます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-947">Alternatively, you can use the <xref:System.Messaging.MessageQueue.FormatName%2A> or <xref:System.Messaging.MessageQueue.Label%2A> to describe the queue path.</span></span>  
  
|<span data-ttu-id="f3a8c-948">関連項目</span><span class="sxs-lookup"><span data-stu-id="f3a8c-948">Reference</span></span>|<span data-ttu-id="f3a8c-949">構文</span><span class="sxs-lookup"><span data-stu-id="f3a8c-949">Syntax</span></span>|  
|---------------|------------|  
|<span data-ttu-id="f3a8c-950">形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-950">Format name</span></span>|<span data-ttu-id="f3a8c-951">FormatName: [*形式名*]</span><span class="sxs-lookup"><span data-stu-id="f3a8c-951">FormatName:[ *format name* ]</span></span>|  
|<span data-ttu-id="f3a8c-952">group1</span><span class="sxs-lookup"><span data-stu-id="f3a8c-952">Label</span></span>|<span data-ttu-id="f3a8c-953">ラベル: [*ラベル*]</span><span class="sxs-lookup"><span data-stu-id="f3a8c-953">Label:[ *label* ]</span></span>|  
  
 <span data-ttu-id="f3a8c-954">次の表に、この方法をさまざまなワークグループモードで使用できるかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-954">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-955">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-955">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-956">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-956">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-957">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-957">Local computer</span></span>|<span data-ttu-id="f3a8c-958">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-958">Yes</span></span>|  
|<span data-ttu-id="f3a8c-959">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-959">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-960">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-960">Yes</span></span>|  
|<span data-ttu-id="f3a8c-961">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-961">Remote computer</span></span>|<span data-ttu-id="f3a8c-962">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-962">No</span></span>|  
|<span data-ttu-id="f3a8c-963">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-963">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-964">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-964">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-965">次のコード例では、メッセージキューのキューが存在する場合は削除します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-965">The following code example deletes a Message Queuing queue, if it exists.</span></span>  
  
 [!code-cpp[MessageQueue.ExistsDelete#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.ExistsDelete/CPP/mqexistsdelete.cpp#1)]
 [!code-csharp[MessageQueue.ExistsDelete#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.ExistsDelete/CS/mqexistsdelete.cs#1)]
 [!code-vb[MessageQueue.ExistsDelete#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.ExistsDelete/VB/mqexistsdelete.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="f3a8c-966"><paramref name="path" /> パラメーターが <see langword="null" /> または空の文字列 ("") です。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-966">The <paramref name="path" /> parameter is <see langword="null" /> or is an empty string ("").</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="f3a8c-967"><paramref name="path" /> パラメーターの構文が無効です。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-967">The syntax for the <paramref name="path" /> parameter is not valid.</span></span>  
  
<span data-ttu-id="f3a8c-968">- または -</span><span class="sxs-lookup"><span data-stu-id="f3a8c-968">-or-</span></span> 
<span data-ttu-id="f3a8c-969">メッセージ キューのメソッドにアクセスしたときにエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-969">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="M:System.Messaging.MessageQueue.Close" />
        <altmember cref="P:System.Messaging.MessageQueue.Path" />
      </Docs>
    </Member>
    <Member MemberName="DenySharedReceive">
      <MemberSignature Language="C#" Value="public bool DenySharedReceive { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool DenySharedReceive" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.DenySharedReceive" />
      <MemberSignature Language="VB.NET" Value="Public Property DenySharedReceive As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property bool DenySharedReceive { bool get(); void set(bool value); };" />
      <MemberSignature Language="F#" Value="member this.DenySharedReceive : bool with get, set" Usage="System.Messaging.MessageQueue.DenySharedReceive" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.DefaultValue(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_DenySharedReceive")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="f3a8c-970">この <see cref="T:System.Messaging.MessageQueue" /> に、メッセージ キューのキューからメッセージを受信する排他アクセス許可が与えられているかどうかを示す値を取得または設定します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-970">Gets or sets a value that indicates whether this <see cref="T:System.Messaging.MessageQueue" /> has exclusive access to receive messages from the Message Queuing queue.</span></span></summary>
        <value><span data-ttu-id="f3a8c-971">この <see cref="T:System.Messaging.MessageQueue" /> に、キューからメッセージを受信する排他アクセス許可が与えられている場合は <see langword="true" />。それ以外の場合は <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-971"><see langword="true" /> if this <see cref="T:System.Messaging.MessageQueue" /> has exclusive rights to receive messages from the queue; otherwise, <see langword="false" />.</span></span> <span data-ttu-id="f3a8c-972">既定値は、<see langword="false" /> です。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-972">The default is <see langword="false" />.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-973"><xref:System.Messaging.MessageQueue.DenySharedReceive%2A> は、この <xref:System.Messaging.MessageQueue>によって参照されるキューの共有モードを指定します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-973"><xref:System.Messaging.MessageQueue.DenySharedReceive%2A> specifies the shared mode of the queue referenced by this <xref:System.Messaging.MessageQueue>.</span></span> <span data-ttu-id="f3a8c-974"><xref:System.Messaging.MessageQueue.DenySharedReceive%2A> を `true` に設定して、指定した <xref:System.Messaging.MessageQueue.Path%2A>を使用してキューからメッセージをピークまたは受信するために、この <xref:System.Messaging.MessageQueue> のみにアクセス権を与える必要があることを示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-974">Set <xref:System.Messaging.MessageQueue.DenySharedReceive%2A> to `true` to indicate that only this <xref:System.Messaging.MessageQueue> should have access to peek or receive messages from the queue with the specified <xref:System.Messaging.MessageQueue.Path%2A>.</span></span> <span data-ttu-id="f3a8c-975">別の <xref:System.Messaging.MessageQueue> または別のアプリケーションが同じキューリソースに関連付けられている場合、そのインスタンスまたはアプリケーションはメッセージをピークまたは受信できませんが、メッセージを送信することはできます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-975">If another <xref:System.Messaging.MessageQueue> or another application is associated with the same queue resource, that instance or application will not be able to peek or receive messages, but it can still send them.</span></span>  
  
 <span data-ttu-id="f3a8c-976"><xref:System.Messaging.MessageQueue.DenySharedReceive%2A> が `false`場合、キューはメッセージの送信、ピーク、または受信のために複数のアプリケーションで使用できます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-976">If <xref:System.Messaging.MessageQueue.DenySharedReceive%2A> is `false`, the queue is available to multiple applications for sending, peeking, or receiving messages.</span></span>  
  
 <span data-ttu-id="f3a8c-977">次の表は、このプロパティがさまざまなワークグループモードで使用できるかどうかを示しています。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-977">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-978">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-978">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-979">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-979">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-980">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-980">Local computer</span></span>|<span data-ttu-id="f3a8c-981">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-981">Yes</span></span>|  
|<span data-ttu-id="f3a8c-982">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-982">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-983">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-983">Yes</span></span>|  
|<span data-ttu-id="f3a8c-984">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-984">Remote computer</span></span>|<span data-ttu-id="f3a8c-985">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-985">Yes</span></span>|  
|<span data-ttu-id="f3a8c-986">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-986">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-987">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-987">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-988">次のコード例では、メッセージキューの <xref:System.Messaging.MessageQueue.DenySharedReceive%2A> プロパティの値を取得して設定します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-988">The following code example gets and sets the value of a message queue's <xref:System.Messaging.MessageQueue.DenySharedReceive%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#10](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#10)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Messaging.MessageQueue.#ctor" />
        <altmember cref="P:System.Messaging.MessageQueue.EnableConnectionCache" />
      </Docs>
    </Member>
    <Member MemberName="Dispose">
      <MemberSignature Language="C#" Value="protected override void Dispose (bool disposing);" />
      <MemberSignature Language="ILAsm" Value=".method familyhidebysig virtual instance void Dispose(bool disposing) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Dispose(System.Boolean)" />
      <MemberSignature Language="VB.NET" Value="Protected Overrides Sub Dispose (disposing As Boolean)" />
      <MemberSignature Language="C++ CLI" Value="protected:&#xA; override void Dispose(bool disposing);" />
      <MemberSignature Language="F#" Value="override this.Dispose : bool -&gt; unit" Usage="messageQueue.Dispose disposing" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="disposing" Type="System.Boolean" />
      </Parameters>
      <Docs>
        <param name="disposing"><span data-ttu-id="f3a8c-989">マネージド リソースとアンマネージド リソースの両方を解放する場合は <see langword="true" />。アンマネージド リソースだけを解放する場合は <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-989"><see langword="true" /> to release both managed and unmanaged resources; <see langword="false" /> to release only unmanaged resources.</span></span></param>
        <summary><span data-ttu-id="f3a8c-990"><see cref="T:System.Messaging.MessageQueue" /> で使用されていたリソース (メモリを除く) を解放します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-990">Disposes of the resources (other than memory) used by the <see cref="T:System.Messaging.MessageQueue" />.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-991"><xref:System.Messaging.MessageQueue> を使い終わったら、<xref:System.Messaging.MessageQueue.Dispose%28System.Boolean%29>を呼び出します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-991">Call <xref:System.Messaging.MessageQueue.Dispose%28System.Boolean%29> when you are finished using the <xref:System.Messaging.MessageQueue>.</span></span> <span data-ttu-id="f3a8c-992"><xref:System.Messaging.MessageQueue.Dispose%28System.Boolean%29>メソッドによって、<xref:System.Messaging.MessageQueue> は使用不可の状態になります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-992">The <xref:System.Messaging.MessageQueue.Dispose%28System.Boolean%29> method leaves the <xref:System.Messaging.MessageQueue> in an unusable state.</span></span> <span data-ttu-id="f3a8c-993"><xref:System.Messaging.MessageQueue.Dispose%28System.Boolean%29>を呼び出した後、使用していたメモリがガベージコレクションによって回収されるように、<xref:System.Messaging.MessageQueue> へのすべての参照を解放する必要があります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-993">After calling <xref:System.Messaging.MessageQueue.Dispose%28System.Boolean%29>, you must release all references to the <xref:System.Messaging.MessageQueue> so the memory it was occupying can be reclaimed by garbage collection.</span></span>  
  
 <span data-ttu-id="f3a8c-994"><xref:System.Messaging.MessageQueue>への最後の参照を解放する前に、<xref:System.Messaging.MessageQueue.Dispose%28System.Boolean%29> を呼び出す必要があります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-994">You should call <xref:System.Messaging.MessageQueue.Dispose%28System.Boolean%29> before you release your last reference to the <xref:System.Messaging.MessageQueue>.</span></span> <span data-ttu-id="f3a8c-995">それ以外の場合、<xref:System.Messaging.MessageQueue> が使用しているリソースは、ガベージコレクションが <xref:System.Messaging.MessageQueue> オブジェクトのデストラクターを呼び出すまで解放されません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-995">Otherwise, the resources the <xref:System.Messaging.MessageQueue> is using will not be freed until garbage collection calls the <xref:System.Messaging.MessageQueue> object's destructor.</span></span>  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Messaging.MessageQueue.Close" />
      </Docs>
    </Member>
    <Member MemberName="EnableConnectionCache">
      <MemberSignature Language="C#" Value="public static bool EnableConnectionCache { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property bool EnableConnectionCache" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.EnableConnectionCache" />
      <MemberSignature Language="VB.NET" Value="Public Shared Property EnableConnectionCache As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static property bool EnableConnectionCache { bool get(); void set(bool value); };" />
      <MemberSignature Language="F#" Value="member this.EnableConnectionCache : bool with get, set" Usage="System.Messaging.MessageQueue.EnableConnectionCache" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="f3a8c-996">接続のキャッシュをアプリケーションで維持するかどうかを示す値を取得または設定します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-996">Gets or sets a value that indicates whether a cache of connections will be maintained by the application.</span></span></summary>
        <value><span data-ttu-id="f3a8c-997">接続キャッシュを作成し、使用する場合は <see langword="true" />。それ以外の場合は <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-997"><see langword="true" /> to create and use a connection cache; otherwise, <see langword="false" />.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-998">接続キャッシュとは、キューへの読み取りまたは書き込みハンドルを含む構造体への参照の一覧です。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-998">A connection cache is a list of references to structures that contain read or write handles to queues.</span></span> <span data-ttu-id="f3a8c-999"><xref:System.Messaging.MessageQueue.EnableConnectionCache%2A> が `true`場合、<xref:System.Messaging.MessageQueue> ではは、新しいハンドルを開くのではなく、<xref:System.Messaging.MessageQueue.Send%28System.Object%29>、<xref:System.Messaging.MessageQueue.Peek%2A>、または <xref:System.Messaging.MessageQueue.Receive%2A>を呼び出すたびにキャッシュから処理されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-999">When <xref:System.Messaging.MessageQueue.EnableConnectionCache%2A> is `true`, the <xref:System.Messaging.MessageQueue> borrows handles from the cache each time you call <xref:System.Messaging.MessageQueue.Send%28System.Object%29>, <xref:System.Messaging.MessageQueue.Peek%2A>, or <xref:System.Messaging.MessageQueue.Receive%2A>, rather than open new handles.</span></span> <span data-ttu-id="f3a8c-1000">これにより、パフォーマンスが向上します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1000">This can improve performance.</span></span> <span data-ttu-id="f3a8c-1001">また、接続キャッシュを使用すると、ネットワークトポロジの変更によって <xref:System.Messaging.MessageQueue> が分離されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1001">Using a connection cache also insulates the <xref:System.Messaging.MessageQueue> from changes in the network topology.</span></span>  
  
 <span data-ttu-id="f3a8c-1002">接続キャッシュがいっぱいになったときにキューへの新しい接続を作成すると、<xref:System.Messaging.MessageQueue> によって、最近アクセスした構造体が新しい接続で上書きされます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1002">If you create a new connection to a queue when the connection cache is full, the <xref:System.Messaging.MessageQueue> overwrites the least recently accessed structure with the new connection.</span></span> <span data-ttu-id="f3a8c-1003"><xref:System.Messaging.MessageQueue.ClearConnectionCache%2A>を呼び出すことによって、キャッシュを完全に消去できます。たとえば、使用しているキューの形式名が変更され、以前の読み取りハンドルと書き込みハンドルが無効になっている場合などです。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1003">You can clear the cache entirely by calling <xref:System.Messaging.MessageQueue.ClearConnectionCache%2A>, for example, if the format names of the queues you are working with have changed so that the previous read and write handles are no longer valid.</span></span>  
  
 <span data-ttu-id="f3a8c-1004">次の表は、このプロパティがさまざまなワークグループモードで使用できるかどうかを示しています。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1004">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-1005">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1005">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-1006">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1006">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-1007">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1007">Local computer</span></span>|<span data-ttu-id="f3a8c-1008">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1008">Yes</span></span>|  
|<span data-ttu-id="f3a8c-1009">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1009">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-1010">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1010">Yes</span></span>|  
|<span data-ttu-id="f3a8c-1011">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1011">Remote computer</span></span>|<span data-ttu-id="f3a8c-1012">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1012">Yes</span></span>|  
|<span data-ttu-id="f3a8c-1013">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1013">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-1014">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1014">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-1015">次のコード例では、メッセージキューの <xref:System.Messaging.MessageQueue.EnableConnectionCache%2A> プロパティの値を取得して設定します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1015">The following code example gets and sets the value of a message queue's <xref:System.Messaging.MessageQueue.EnableConnectionCache%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#11](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#11)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Messaging.MessageQueue.ClearConnectionCache" />
      </Docs>
    </Member>
    <Member MemberName="EncryptionRequired">
      <MemberSignature Language="C#" Value="public System.Messaging.EncryptionRequired EncryptionRequired { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance valuetype System.Messaging.EncryptionRequired EncryptionRequired" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.EncryptionRequired" />
      <MemberSignature Language="VB.NET" Value="Public Property EncryptionRequired As EncryptionRequired" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Messaging::EncryptionRequired EncryptionRequired { System::Messaging::EncryptionRequired get(); void set(System::Messaging::EncryptionRequired value); };" />
      <MemberSignature Language="F#" Value="member this.EncryptionRequired : System.Messaging.EncryptionRequired with get, set" Usage="System.Messaging.MessageQueue.EncryptionRequired" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_EncryptionRequired")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Messaging.EncryptionRequired</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="f3a8c-1016">キューが非プライベート (暗号化されていない) メッセージだけを受け入れるかどうかを示す値を取得または設定します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1016">Gets or sets a value that indicates whether the queue accepts only non-private (non-encrypted) messages.</span></span></summary>
        <value><span data-ttu-id="f3a8c-1017"><see cref="T:System.Messaging.EncryptionRequired" /> 値のいずれか 1 つ。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1017">One of the <see cref="T:System.Messaging.EncryptionRequired" /> values.</span></span> <span data-ttu-id="f3a8c-1018">既定値は、<see langword="None" /> です。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1018">The default is <see langword="None" />.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-1019">キューに送信されるメッセージに暗号化が必要であることを指定すると、メッセージ本文のみが暗号化されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1019">When you specify that encryption is required for the messages sent to a queue, only the message bodies are encrypted.</span></span> <span data-ttu-id="f3a8c-1020">その他のメンバー (たとえば、<xref:System.Messaging.Message.Label%2A> と <xref:System.Messaging.Message.SenderId%2A> のプロパティ) は暗号化できません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1020">The other members (for example, the <xref:System.Messaging.Message.Label%2A> and <xref:System.Messaging.Message.SenderId%2A> properties) cannot be encrypted.</span></span>  
  
 <span data-ttu-id="f3a8c-1021">このプロパティを設定すると、メッセージキューのキューが変更されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1021">Setting this property modifies the Message Queuing queue.</span></span> <span data-ttu-id="f3a8c-1022">そのため、その他の <xref:System.Messaging.MessageQueue> インスタンスは変更の影響を受けます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1022">Therefore, any other <xref:System.Messaging.MessageQueue> instances are affected by the change.</span></span>  
  
 <span data-ttu-id="f3a8c-1023">メッセージを暗号化すると、メッセージがプライベートになります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1023">Encrypting a message makes the message private.</span></span> <span data-ttu-id="f3a8c-1024"><xref:System.Messaging.MessageQueue.EncryptionRequired%2A> プロパティを適切に設定することによって、キューの暗号化要件を `None`、`Body`、または `Optional` に指定できます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1024">You can specify the queue's encryption requirement to be `None`, `Body`, or `Optional` by setting the <xref:System.Messaging.MessageQueue.EncryptionRequired%2A> property appropriately.</span></span> <span data-ttu-id="f3a8c-1025">メッセージの <xref:System.Messaging.Message.UseEncryption%2A> 設定は、キューの暗号化要件に対応している必要があります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1025">The <xref:System.Messaging.Message.UseEncryption%2A> setting of the message must correspond to the encryption requirement of the queue.</span></span> <span data-ttu-id="f3a8c-1026">メッセージが暗号化されていないが、キューによって `Body`が指定されている場合、またはメッセージが暗号化されていてもキューで `None`が指定されている場合、メッセージはキューによって拒否されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1026">If the message is not encrypted but the queue specifies `Body`, or if the message is encrypted but the queue specifies `None`, the message is rejected by the queue.</span></span> <span data-ttu-id="f3a8c-1027">送信元のアプリケーションがこのイベントで否定受信確認メッセージを要求した場合、メッセージキューは、送信元アプリケーションに対するメッセージの拒否を示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1027">If the sending application requests a negative acknowledgment message in this event, Message Queuing indicates the message's rejection to the sending application.</span></span> <span data-ttu-id="f3a8c-1028"><xref:System.Messaging.Message.UseDeadLetterQueue%2A> プロパティが `true`場合は、暗号化に失敗したメッセージが配信不能キューに送信されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1028">If the <xref:System.Messaging.Message.UseDeadLetterQueue%2A> property is `true`, a message that fails encryption is sent to the dead-letter queue.</span></span> <span data-ttu-id="f3a8c-1029">それ以外の場合、メッセージは失われます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1029">Otherwise, the message is lost.</span></span>  
  
 <span data-ttu-id="f3a8c-1030">次の表は、このプロパティがさまざまなワークグループモードで使用できるかどうかを示しています。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1030">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-1031">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1031">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-1032">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1032">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-1033">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1033">Local computer</span></span>|<span data-ttu-id="f3a8c-1034">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1034">Yes</span></span>|  
|<span data-ttu-id="f3a8c-1035">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1035">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-1036">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1036">Yes</span></span>|  
|<span data-ttu-id="f3a8c-1037">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1037">Remote computer</span></span>|<span data-ttu-id="f3a8c-1038">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1038">No</span></span>|  
|<span data-ttu-id="f3a8c-1039">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1039">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-1040">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1040">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-1041">次のコード例では、メッセージキューの <xref:System.Messaging.MessageQueue.EncryptionRequired%2A> プロパティの値を取得して設定します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1041">The following code example gets and sets the value of a message queue's <xref:System.Messaging.MessageQueue.EncryptionRequired%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#12](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#12)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="f3a8c-1042">メッセージ キューのメソッドにアクセスしたときにエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1042">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="T:System.Messaging.Acknowledgment" />
        <altmember cref="P:System.Messaging.Message.UseEncryption" />
      </Docs>
    </Member>
    <Member MemberName="EndPeek">
      <MemberSignature Language="C#" Value="public System.Messaging.Message EndPeek (IAsyncResult asyncResult);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message EndPeek(class System.IAsyncResult asyncResult) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.EndPeek(System.IAsyncResult)" />
      <MemberSignature Language="VB.NET" Value="Public Function EndPeek (asyncResult As IAsyncResult) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ EndPeek(IAsyncResult ^ asyncResult);" />
      <MemberSignature Language="F#" Value="member this.EndPeek : IAsyncResult -&gt; System.Messaging.Message" Usage="messageQueue.EndPeek asyncResult" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="asyncResult" Type="System.IAsyncResult" />
      </Parameters>
      <Docs>
        <param name="asyncResult"><span data-ttu-id="f3a8c-1043">完了する非同期のピーク操作を識別する <see cref="T:System.IAsyncResult" />。ここから最終結果が取得されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1043">The <see cref="T:System.IAsyncResult" /> that identifies the asynchronous peek operation to finish and from which to retrieve an end result.</span></span></param>
        <summary><span data-ttu-id="f3a8c-1044">指定した非同期のピーク操作を完了します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1044">Completes the specified asynchronous peek operation.</span></span></summary>
        <returns><span data-ttu-id="f3a8c-1045">完了した非同期操作に関連付けられた <see cref="T:System.Messaging.Message" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1045">The <see cref="T:System.Messaging.Message" /> associated with the completed asynchronous operation.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-1046"><xref:System.Messaging.MessageQueue.PeekCompleted> イベントが発生すると、<xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> は <xref:System.Messaging.MessageQueue.BeginPeek%2A> 呼び出しによって開始された操作を完了します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1046">When the <xref:System.Messaging.MessageQueue.PeekCompleted> event is raised, <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> completes the operation that was initiated by the <xref:System.Messaging.MessageQueue.BeginPeek%2A> call.</span></span> <span data-ttu-id="f3a8c-1047">これを行うには、<xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> がメッセージをピークします。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1047">To do so, <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> peeks the message.</span></span>  
  
 <span data-ttu-id="f3a8c-1048"><xref:System.Messaging.MessageQueue.BeginPeek%2A> ではタイムアウトを指定できます。これにより、キューにメッセージが表示される前にタイムアウトが発生した場合に、<xref:System.Messaging.MessageQueue.PeekCompleted> イベントが発生します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1048"><xref:System.Messaging.MessageQueue.BeginPeek%2A> can specify a time-out, which causes the <xref:System.Messaging.MessageQueue.PeekCompleted> event to be raised if the time-out occurs before a message appears in the queue.</span></span> <span data-ttu-id="f3a8c-1049">キューにメッセージが到着せずにタイムアウトが発生すると、<xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> の後続の呼び出しで例外がスローされます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1049">When a time-out occurs without a message arriving in the queue, a subsequent call to <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> throws an exception.</span></span>  
  
 <span data-ttu-id="f3a8c-1050"><xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> は、<xref:System.Messaging.MessageQueue.PeekCompleted> イベントが発生する原因となったメッセージを読み取るために使用されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1050"><xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> is used to read the message that caused the <xref:System.Messaging.MessageQueue.PeekCompleted> event to be raised.</span></span>  
  
 <span data-ttu-id="f3a8c-1051">メッセージを非同期にピークする場合は、<xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29>を呼び出した後に <xref:System.Messaging.MessageQueue.BeginPeek%2A> をもう一度呼び出すことができます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1051">If you want to continue to asynchronously peek messages, you can again call <xref:System.Messaging.MessageQueue.BeginPeek%2A> after calling <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29>.</span></span>  
  
 <span data-ttu-id="f3a8c-1052">次の表に、この方法をさまざまなワークグループモードで使用できるかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1052">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-1053">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1053">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-1054">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1054">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-1055">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1055">Local computer</span></span>|<span data-ttu-id="f3a8c-1056">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1056">Yes</span></span>|  
|<span data-ttu-id="f3a8c-1057">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1057">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-1058">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1058">Yes</span></span>|  
|<span data-ttu-id="f3a8c-1059">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1059">Remote computer</span></span>|<span data-ttu-id="f3a8c-1060">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1060">No</span></span>|  
|<span data-ttu-id="f3a8c-1061">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1061">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-1062">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1062">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-1063">次のコード例では、`MyPeekCompleted`という名前のイベントハンドラーを作成し、それを <xref:System.Messaging.MessageQueue.PeekCompleted> イベントハンドラーデリゲートにアタッチし、<xref:System.Messaging.MessageQueue.BeginPeek%2A> を呼び出して、パス ".\myQueue" にあるキューで非同期のピーク操作を開始します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1063">The following code example creates an event handler named `MyPeekCompleted`, attaches it to the <xref:System.Messaging.MessageQueue.PeekCompleted> event handler delegate, and calls <xref:System.Messaging.MessageQueue.BeginPeek%2A> to initiate an asynchronous peek operation on the queue that is located at the path ".\myQueue".</span></span> <span data-ttu-id="f3a8c-1064"><xref:System.Messaging.MessageQueue.PeekCompleted> イベントが発生すると、この例ではメッセージをピークし、その本文を画面に書き込みます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1064">When a <xref:System.Messaging.MessageQueue.PeekCompleted> event is raised, the example peeks the message and writes its body to the screen.</span></span> <span data-ttu-id="f3a8c-1065">この例では、<xref:System.Messaging.MessageQueue.BeginPeek%2A> を再度呼び出して、新しい非同期ピーク操作を開始します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1065">The example then calls <xref:System.Messaging.MessageQueue.BeginPeek%2A> again to initiate a new asynchronous peek operation.</span></span>  
  
 [!code-cpp[MessageQueue.BeginPeek_noparms#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.BeginPeek_noparms/CPP/mqbeginpeek_noparms.cpp#1)]
 [!code-csharp[MessageQueue.BeginPeek_noparms#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.BeginPeek_noparms/CS/mqbeginpeek_noparms.cs#1)]
 [!code-vb[MessageQueue.BeginPeek_noparms#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.BeginPeek_noparms/VB/mqbeginpeek_noparms.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="f3a8c-1066"><paramref name="asyncResult" /> パラメーターが <see langword="null" /> です。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1066">The <paramref name="asyncResult" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="f3a8c-1067"><paramref name="asyncResult" /> パラメーターの構文が無効です。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1067">The syntax of the <paramref name="asyncResult" /> parameter is not valid.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="f3a8c-1068">メッセージ キューのメソッドにアクセスしたときにエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1068">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="E:System.Messaging.MessageQueue.PeekCompleted" />
      </Docs>
    </Member>
    <Member MemberName="EndReceive">
      <MemberSignature Language="C#" Value="public System.Messaging.Message EndReceive (IAsyncResult asyncResult);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message EndReceive(class System.IAsyncResult asyncResult) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.EndReceive(System.IAsyncResult)" />
      <MemberSignature Language="VB.NET" Value="Public Function EndReceive (asyncResult As IAsyncResult) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ EndReceive(IAsyncResult ^ asyncResult);" />
      <MemberSignature Language="F#" Value="member this.EndReceive : IAsyncResult -&gt; System.Messaging.Message" Usage="messageQueue.EndReceive asyncResult" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="asyncResult" Type="System.IAsyncResult" />
      </Parameters>
      <Docs>
        <param name="asyncResult"><span data-ttu-id="f3a8c-1069">完了する非同期の受信操作を識別する <see cref="T:System.IAsyncResult" />。ここから最終結果が取得されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1069">The <see cref="T:System.IAsyncResult" /> that identifies the asynchronous receive operation to finish and from which to retrieve an end result.</span></span></param>
        <summary><span data-ttu-id="f3a8c-1070">指定した非同期の受信操作を完了します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1070">Completes the specified asynchronous receive operation.</span></span></summary>
        <returns><span data-ttu-id="f3a8c-1071">完了した非同期操作に関連付けられた <see cref="T:System.Messaging.Message" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1071">The <see cref="T:System.Messaging.Message" /> associated with the completed asynchronous operation.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-1072"><xref:System.Messaging.MessageQueue.ReceiveCompleted> イベントが発生すると、<xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> は <xref:System.Messaging.MessageQueue.BeginReceive%2A> 呼び出しによって開始された操作を完了します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1072">When the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event is raised, <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> completes the operation that was initiated by the <xref:System.Messaging.MessageQueue.BeginReceive%2A> call.</span></span> <span data-ttu-id="f3a8c-1073">これを行うには、<xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> がメッセージを受信します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1073">To do so, <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> receives the message.</span></span>  
  
 <span data-ttu-id="f3a8c-1074"><xref:System.Messaging.MessageQueue.BeginReceive%2A> ではタイムアウトを指定できます。これにより、キューにメッセージが表示される前にタイムアウトが発生した場合に、<xref:System.Messaging.MessageQueue.ReceiveCompleted> イベントが発生します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1074"><xref:System.Messaging.MessageQueue.BeginReceive%2A> can specify a time-out, which causes the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event to be raised if the time-out occurs before a message appears in the queue.</span></span> <span data-ttu-id="f3a8c-1075">キューにメッセージが到着せずにタイムアウトが発生すると、<xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> の後続の呼び出しで例外がスローされます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1075">When a time-out occurs without a message arriving in the queue, a subsequent call to <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> throws an exception.</span></span>  
  
 <span data-ttu-id="f3a8c-1076"><xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> は、<xref:System.Messaging.MessageQueue.ReceiveCompleted> イベントの発生原因となったメッセージの読み取り (キューからの削除) に使用されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1076"><xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> is used to read (removing from the queue) the message that caused the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event to be raised.</span></span>  
  
 <span data-ttu-id="f3a8c-1077">引き続き非同期的にメッセージを受信する場合は、<xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29>を呼び出した後に <xref:System.Messaging.MessageQueue.BeginReceive%2A> を再度呼び出すことができます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1077">If you want to continue to asynchronously receive messages, you can again call <xref:System.Messaging.MessageQueue.BeginReceive%2A> after calling <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29>.</span></span>  
  
 <span data-ttu-id="f3a8c-1078">次の表に、この方法をさまざまなワークグループモードで使用できるかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1078">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-1079">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1079">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-1080">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1080">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-1081">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1081">Local computer</span></span>|<span data-ttu-id="f3a8c-1082">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1082">Yes</span></span>|  
|<span data-ttu-id="f3a8c-1083">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1083">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-1084">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1084">Yes</span></span>|  
|<span data-ttu-id="f3a8c-1085">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1085">Remote computer</span></span>|<span data-ttu-id="f3a8c-1086">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1086">No</span></span>|  
|<span data-ttu-id="f3a8c-1087">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1087">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-1088">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1088">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-1089">次のコード例では、非同期要求をチェーンします。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1089">The following code example chains asynchronous requests.</span></span> <span data-ttu-id="f3a8c-1090">これは、"myQueue" という名前のローカルコンピューターにキューがあることを前提としています。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1090">It assumes there is a queue on the local computer called "myQueue".</span></span> <span data-ttu-id="f3a8c-1091">`Main` 関数は、`MyReceiveCompleted` ルーチンによって処理される非同期操作を開始します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1091">The `Main` function begins the asynchronous operation that is handled by the `MyReceiveCompleted` routine.</span></span> <span data-ttu-id="f3a8c-1092">`MyReceiveCompleted` は、現在のメッセージを処理し、新しい非同期の受信操作を開始します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1092">`MyReceiveCompleted` processes the current message and begins a new asynchronous receive operation.</span></span>  
  
 [!code-cpp[MessageQueue.BeginReceive_noparms_combined#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.BeginReceive_noparms_combined/CPP/mqbeginreceive_noparms_mre.cpp#1)]
 [!code-csharp[MessageQueue.BeginReceive_noparms_combined#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.BeginReceive_noparms_combined/CS/mqbeginreceive_noparms_mre.cs#1)]
 [!code-vb[MessageQueue.BeginReceive_noparms_combined#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.BeginReceive_noparms_combined/VB/mqbeginreceive_noparms_mre.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="f3a8c-1093"><paramref name="asyncResult" /> パラメーターが <see langword="null" /> です。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1093">The <paramref name="asyncResult" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="f3a8c-1094"><paramref name="asyncResult" /> パラメーターの構文が無効です。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1094">The syntax of the <paramref name="asyncResult" /> parameter is not valid.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="f3a8c-1095">メッセージ キューのメソッドにアクセスしたときにエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1095">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
        <altmember cref="E:System.Messaging.MessageQueue.ReceiveCompleted" />
      </Docs>
    </Member>
    <Member MemberName="Exists">
      <MemberSignature Language="C#" Value="public static bool Exists (string path);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig bool Exists(string path) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Exists(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function Exists (path As String) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static bool Exists(System::String ^ path);" />
      <MemberSignature Language="F#" Value="static member Exists : string -&gt; bool" Usage="System.Messaging.MessageQueue.Exists path" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="path" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="path"><span data-ttu-id="f3a8c-1096">検索するキューの場所。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1096">The location of the queue to find.</span></span></param>
        <summary><span data-ttu-id="f3a8c-1097">指定したパスにメッセージ キューのキューが存在するかどうかを判断します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1097">Determines whether a Message Queuing queue exists at the specified path.</span></span></summary>
        <returns><span data-ttu-id="f3a8c-1098">指定したパスにキューが存在する場合は <see langword="true" />。それ以外の場合は <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1098"><see langword="true" /> if a queue with the specified path exists; otherwise, <see langword="false" />.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-1099"><xref:System.Messaging.MessageQueue.Exists%28System.String%29> メソッドは、指定されたパスにメッセージキューのキューが存在するかどうかを判断します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1099">The <xref:System.Messaging.MessageQueue.Exists%28System.String%29> method determines whether a Message Queuing queue exists at a specified path.</span></span> <span data-ttu-id="f3a8c-1100">指定された形式名のキューが存在するかどうかを判断するためのメソッドが存在しません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1100">No method exists to determine whether a queue with a specified format name exists.</span></span> <span data-ttu-id="f3a8c-1101">形式名の構文とその他のパス構文形式の詳細については、「<xref:System.Messaging.MessageQueue.Path%2A> プロパティ」を参照してください)。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1101">For more information about the format name syntax and other path syntax forms, see the <xref:System.Messaging.MessageQueue.Path%2A> property.)</span></span>  
  
 <span data-ttu-id="f3a8c-1102"><xref:System.Messaging.MessageQueue.Exists%28System.String%29> は負荷の高い操作です。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1102"><xref:System.Messaging.MessageQueue.Exists%28System.String%29> is an expensive operation.</span></span> <span data-ttu-id="f3a8c-1103">アプリケーション内で必要な場合にのみ使用してください。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1103">Use it only when it is necessary within the application.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="f3a8c-1104"><xref:System.Messaging.MessageQueue.Exists%28System.String%29> メソッドでは、<xref:System.Messaging.MessageQueue.FormatName%2A> プレフィックスはサポートされていません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1104">The <xref:System.Messaging.MessageQueue.Exists%28System.String%29> method does not support the <xref:System.Messaging.MessageQueue.FormatName%2A> prefix.</span></span>  
  
 <span data-ttu-id="f3a8c-1105">`path` パラメーターの構文は、次の表に示すように、キューの種類によって異なります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1105">The syntax for the `path` parameter depends on the type of queue, as shown in the following table.</span></span>  
  
|<span data-ttu-id="f3a8c-1106">[キューの種類]</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1106">Queue type</span></span>|<span data-ttu-id="f3a8c-1107">構文</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1107">Syntax</span></span>|  
|----------------|------------|  
|<span data-ttu-id="f3a8c-1108">パブリックキュー</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1108">Public queue</span></span>|`MachineName`\\`QueueName`|  
  
 <span data-ttu-id="f3a8c-1109">リモート専用キューの存在を確認するために <xref:System.Messaging.MessageQueue.Exists%28System.String%29> を呼び出すことはできません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1109"><xref:System.Messaging.MessageQueue.Exists%28System.String%29> cannot be called to verify the existence of a remote private queue.</span></span>  
  
 <span data-ttu-id="f3a8c-1110">構文の詳細については、<xref:System.Messaging.MessageQueue.Path%2A> プロパティを参照してください。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1110">For more syntax, see the <xref:System.Messaging.MessageQueue.Path%2A> property.</span></span>  
  
 <span data-ttu-id="f3a8c-1111">または、<xref:System.Messaging.MessageQueue.Label%2A> を使用してキューのパスを記述することもできます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1111">Alternatively, you can use the <xref:System.Messaging.MessageQueue.Label%2A> to describe the queue path.</span></span>  
  
|<span data-ttu-id="f3a8c-1112">関連項目</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1112">Reference</span></span>|<span data-ttu-id="f3a8c-1113">構文</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1113">Syntax</span></span>|  
|---------------|------------|  
|<span data-ttu-id="f3a8c-1114">group1</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1114">Label</span></span>|<span data-ttu-id="f3a8c-1115">ラベル: [`label`]</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1115">Label:[ `label` ]</span></span>|  
  
 <span data-ttu-id="f3a8c-1116">次の表に、この方法をさまざまなワークグループモードで使用できるかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1116">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-1117">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1117">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-1118">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1118">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-1119">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1119">Local computer</span></span>|<span data-ttu-id="f3a8c-1120">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1120">Yes</span></span>|  
|<span data-ttu-id="f3a8c-1121">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1121">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-1122">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1122">No</span></span>|  
|<span data-ttu-id="f3a8c-1123">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1123">Remote computer</span></span>|<span data-ttu-id="f3a8c-1124">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1124">No</span></span>|  
|<span data-ttu-id="f3a8c-1125">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1125">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-1126">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1126">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-1127">次のコード例では、メッセージキューのキューが存在するかどうかを確認してから削除します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1127">The following code example verifies whether a Message Queuing queue exists, and then deletes it.</span></span>  
  
 [!code-cpp[MessageQueue.ExistsDelete#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.ExistsDelete/CPP/mqexistsdelete.cpp#1)]
 [!code-csharp[MessageQueue.ExistsDelete#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.ExistsDelete/CS/mqexistsdelete.cs#1)]
 [!code-vb[MessageQueue.ExistsDelete#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.ExistsDelete/VB/mqexistsdelete.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="f3a8c-1128"><paramref name="path" /> 構文が無効です。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1128">The <paramref name="path" /> syntax is not valid.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="f3a8c-1129">メッセージ キューのメソッドにアクセスしたときにエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1129">An error occurred when accessing a Message Queuing method.</span></span>  
  
<span data-ttu-id="f3a8c-1130">- または -</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1130">-or-</span></span> 
<span data-ttu-id="f3a8c-1131"><see cref="M:System.Messaging.MessageQueue.Exists(System.String)" /> メソッドがリモート プライベート キューで呼び出されています。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1131">The <see cref="M:System.Messaging.MessageQueue.Exists(System.String)" /> method is being called on a remote private queue</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="f3a8c-1132">キューの存在を確認するときに、アプリケーションが書式名構文を使用しました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1132">The application used format name syntax when verifying queue existence.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.Path" />
      </Docs>
    </Member>
    <Member MemberName="FormatName">
      <MemberSignature Language="C#" Value="public string FormatName { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string FormatName" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.FormatName" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property FormatName As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ FormatName { System::String ^ get(); };" />
      <MemberSignature Language="F#" Value="member this.FormatName : string" Usage="System.Messaging.MessageQueue.FormatName" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_FormatName")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="f3a8c-1133">キューの作成時にメッセージ キューが生成した一意のキュー名を取得します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1133">Gets the unique queue name that Message Queuing generated at the time of the queue's creation.</span></span></summary>
        <value><span data-ttu-id="f3a8c-1134">ネットワークで一意なキューの名前。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1134">The name for the queue, which is unique on the network.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-1135"><xref:System.Messaging.MessageQueue.FormatName%2A> プロパティには、キューの形式名が格納されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1135">The <xref:System.Messaging.MessageQueue.FormatName%2A> property contains the format name of the queue.</span></span> <span data-ttu-id="f3a8c-1136">メッセージキューは、形式名を使用して、開くキューとアクセス方法を識別します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1136">Message Queuing uses the format name to identify which queue to open and how to access it.</span></span> <span data-ttu-id="f3a8c-1137">キューの特性のほとんどと異なり、形式名はメッセージキューアプリケーションキュープロパティではないため、メッセージキュー管理ツールを使用してアクセスすることはできません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1137">Unlike most of a queue's characteristics, the format name is not a Message Queuing application queue property, so you cannot access it through the Message Queuing management tool.</span></span> <span data-ttu-id="f3a8c-1138">形式名は、キューの一意の名前です。キューを作成するとき、または後でアプリケーションが生成するときに、メッセージキューによって生成されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1138">The format name is simply a unique name for the queue, which Message Queuing generates when it creates the queue or which the application generates later.</span></span>  
  
 <span data-ttu-id="f3a8c-1139">キューに対して読み取りまたは書き込みを行うときに format name 構文を使用するのではなく、パス名の構文 (`myComputer\myQueue`など) を使用してパスを指定した場合、プライマリドメインコントローラー (Active Directory を使用) は、キューにアクセスする前に <xref:System.Messaging.MessageQueue.Path%2A> を関連付けられた <xref:System.Messaging.MessageQueue.FormatName%2A> に変換します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1139">If you specify a path using the path name syntax (such as `myComputer\myQueue`) rather than using the format name syntax when you read or write to the queue, the primary domain controller (which uses Active Directory) translates the <xref:System.Messaging.MessageQueue.Path%2A> into the associated <xref:System.Messaging.MessageQueue.FormatName%2A> before accessing the queue.</span></span> <span data-ttu-id="f3a8c-1140">アプリケーションがオフラインで作業している場合は、形式名の構文を使用する必要があります。そうしないと、プライマリドメインコントローラーはパス変換を実行できなくなります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1140">If your application is working offline, you must use the format name syntax; otherwise, the primary domain controller will not be available to perform the path translation.</span></span>  
  
 <span data-ttu-id="f3a8c-1141">次の表は、このプロパティがさまざまなワークグループモードで使用できるかどうかを示しています。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1141">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-1142">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1142">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-1143">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1143">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-1144">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1144">Local computer</span></span>|<span data-ttu-id="f3a8c-1145">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1145">Yes</span></span>|  
|<span data-ttu-id="f3a8c-1146">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1146">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-1147">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1147">Yes</span></span>|  
|<span data-ttu-id="f3a8c-1148">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1148">Remote computer</span></span>|<span data-ttu-id="f3a8c-1149">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1149">Yes</span></span>|  
|<span data-ttu-id="f3a8c-1150">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1150">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-1151">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1151">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-1152">次のコード例では、メッセージキューの <xref:System.Messaging.MessageQueue.FormatName%2A> プロパティの値を表示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1152">The following code example displays the value of a message queue's <xref:System.Messaging.MessageQueue.FormatName%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#13](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#13)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="f3a8c-1153"><see cref="P:System.Messaging.MessageQueue.Path" /> が設定されていません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1153">The <see cref="P:System.Messaging.MessageQueue.Path" /> is not set.</span></span>  
  
<span data-ttu-id="f3a8c-1154">- または -</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1154">-or-</span></span> 
<span data-ttu-id="f3a8c-1155">メッセージ キューのメソッドにアクセスしたときにエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1155">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.Path" />
        <altmember cref="P:System.Messaging.MessageQueue.Label" />
        <altmember cref="T:System.Messaging.MessageQueue" />
      </Docs>
    </Member>
    <Member MemberName="Formatter">
      <MemberSignature Language="C#" Value="public System.Messaging.IMessageFormatter Formatter { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class System.Messaging.IMessageFormatter Formatter" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.Formatter" />
      <MemberSignature Language="VB.NET" Value="Public Property Formatter As IMessageFormatter" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Messaging::IMessageFormatter ^ Formatter { System::Messaging::IMessageFormatter ^ get(); void set(System::Messaging::IMessageFormatter ^ value); };" />
      <MemberSignature Language="F#" Value="member this.Formatter : System.Messaging.IMessageFormatter with get, set" Usage="System.Messaging.MessageQueue.Formatter" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.DefaultValue(null)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.TypeConverter(typeof(System.Messaging.Design.MessageFormatterConverter))</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_Formatter")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Messaging.IMessageFormatter</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="f3a8c-1156">キューから読み取られるメッセージまたはキューに書き込まれるメッセージの本文とオブジェクトとの間でシリアル化または逆シリアル化を行うために使用する書式指定子を取得または設定します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1156">Gets or sets the formatter used to serialize an object into or deserialize an object from the body of a message read from or written to the queue.</span></span></summary>
        <value><span data-ttu-id="f3a8c-1157">メッセージ本文に書き込むストリーム、またはメッセージ本文から読み取るストリームを生成する <see cref="T:System.Messaging.IMessageFormatter" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1157">The <see cref="T:System.Messaging.IMessageFormatter" /> that produces a stream to be written to or read from the message body.</span></span> <span data-ttu-id="f3a8c-1158">既定値は、<see cref="T:System.Messaging.XmlMessageFormatter" /> です。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1158">The default is <see cref="T:System.Messaging.XmlMessageFormatter" />.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-1159"><xref:System.Messaging.MessageQueue.Formatter%2A> プロパティには、アプリケーションがキューに対して読み取りまたは書き込みを行うときにメッセージを変換するフォーマッタオブジェクトのインスタンスが含まれています。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1159">The <xref:System.Messaging.MessageQueue.Formatter%2A> property contains an instance of a formatter object, which transforms messages when your application reads or writes to the queue.</span></span>  
  
 <span data-ttu-id="f3a8c-1160">アプリケーションがメッセージをキューに送信すると、フォーマッタはオブジェクトをストリームにシリアル化し、メッセージ本文に挿入します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1160">When the application sends message to the queue, the formatter serializes the object into a stream and inserts it into the message body.</span></span> <span data-ttu-id="f3a8c-1161">フォーマッタは、キューから読み取るときに、メッセージデータを <xref:System.Messaging.Message>の <xref:System.Messaging.Message.Body%2A> プロパティに逆シリアル化します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1161">When reading from a queue, the formatter deserializes the message data into the <xref:System.Messaging.Message.Body%2A> property of a <xref:System.Messaging.Message>.</span></span>  
  
 <span data-ttu-id="f3a8c-1162"><xref:System.Messaging.XmlMessageFormatter> は疎結合であるため、この形式を使用する場合、送信側と受信側で同じオブジェクト型を持つ必要はありません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1162">The <xref:System.Messaging.XmlMessageFormatter> is loosely coupled, so it is not necessary to have the same object type on the sender and receiver when using this format.</span></span> <span data-ttu-id="f3a8c-1163"><xref:System.Messaging.ActiveXMessageFormatter> と <xref:System.Messaging.BinaryMessageFormatter> は、データをバイナリ表現にシリアル化します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1163">The <xref:System.Messaging.ActiveXMessageFormatter> and <xref:System.Messaging.BinaryMessageFormatter> serialize the data into binary representation.</span></span> <span data-ttu-id="f3a8c-1164"><xref:System.Messaging.ActiveXMessageFormatter> は、COM コンポーネントを送信または受信するときに使用されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1164">The <xref:System.Messaging.ActiveXMessageFormatter> is used when sending or receiving COM components.</span></span>  
  
 <span data-ttu-id="f3a8c-1165"><xref:System.Messaging.BinaryMessageFormatter> と <xref:System.Messaging.ActiveXMessageFormatter> は <xref:System.Messaging.XmlMessageFormatter>よりも高速なスループットを提供します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1165"><xref:System.Messaging.BinaryMessageFormatter> and <xref:System.Messaging.ActiveXMessageFormatter> provide faster throughput than the <xref:System.Messaging.XmlMessageFormatter>.</span></span> <span data-ttu-id="f3a8c-1166"><xref:System.Messaging.ActiveXMessageFormatter> では、Visual Basic 6.0 メッセージキューアプリケーションとの相互運用が可能です。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1166">The <xref:System.Messaging.ActiveXMessageFormatter> allows interoperability with Visual Basic 6.0 Message Queuing applications.</span></span>  
  
 <span data-ttu-id="f3a8c-1167">アプリケーションがメッセージをキューに送信すると、<xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> は、既定のメッセージプロパティ <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A>を使用するメッセージにのみ適用されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1167">When your application sends messages to the queue, the <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> applies only to those messages that use the default message properties, <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A>.</span></span> <span data-ttu-id="f3a8c-1168"><xref:System.Messaging.Message> をキューに送信する場合、メッセージキューは、<xref:System.Messaging.Message.Formatter%2A?displayProperty=nameWithType> プロパティで定義されているフォーマッタを使用して、代わりに本文をシリアル化します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1168">If you send a <xref:System.Messaging.Message> to the queue, Message Queuing uses the formatter defined in the <xref:System.Messaging.Message.Formatter%2A?displayProperty=nameWithType> property to serialize the body instead.</span></span>  
  
 <span data-ttu-id="f3a8c-1169"><xref:System.Messaging.MessageQueue> クラスは、キューからメッセージを受信またはピークするときに常に <xref:System.Messaging.Message> を使用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1169">The <xref:System.Messaging.MessageQueue> class will always use a <xref:System.Messaging.Message> to receive or peek a message from the queue.</span></span> <span data-ttu-id="f3a8c-1170">メッセージは、<xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> プロパティを使用して逆シリアル化されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1170">The message is deserialized using the <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> property.</span></span>  
  
 <span data-ttu-id="f3a8c-1171">次の表は、このプロパティがさまざまなワークグループモードで使用できるかどうかを示しています。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1171">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-1172">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1172">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-1173">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1173">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-1174">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1174">Local computer</span></span>|<span data-ttu-id="f3a8c-1175">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1175">Yes</span></span>|  
|<span data-ttu-id="f3a8c-1176">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1176">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-1177">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1177">Yes</span></span>|  
|<span data-ttu-id="f3a8c-1178">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1178">Remote computer</span></span>|<span data-ttu-id="f3a8c-1179">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1179">No</span></span>|  
|<span data-ttu-id="f3a8c-1180">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1180">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-1181">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1181">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-1182">次のコード例は、<xref:System.Messaging.BinaryMessageFormatter>を使用してメッセージ本文を書式設定する方法を示しています。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1182">The following code example demonstrates formatting a message body using <xref:System.Messaging.BinaryMessageFormatter>.</span></span>  
  
 [!code-cpp[MessagingBinaryFormatter#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessagingBinaryFormatter/CPP/message_binaryformatter.cpp#1)]
 [!code-csharp[MessagingBinaryFormatter#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessagingBinaryFormatter/CS/message_binaryformatter.cs#1)]
 [!code-vb[MessagingBinaryFormatter#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessagingBinaryFormatter/VB/message_binaryformatter.vb#1)]  
  
 <span data-ttu-id="f3a8c-1183">次のコード例は、<xref:System.Messaging.XmlMessageFormatter>を使用してメッセージ本文を書式設定する方法を示しています。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1183">The following code example demonstrates formatting a message body using <xref:System.Messaging.XmlMessageFormatter>.</span></span>  
  
 [!code-cpp[Message.Body#1](~/samples/snippets/cpp/VS_Snippets_Remoting/Message.Body/CPP/message_sendreceive.cpp#1)]
 [!code-csharp[Message.Body#1](~/samples/snippets/csharp/VS_Snippets_Remoting/Message.Body/CS/message_sendreceive.cs#1)]
 [!code-vb[Message.Body#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/Message.Body/VB/message_sendreceive.vb#1)]  
  
 ]]></format>
        </remarks>
        <altmember cref="T:System.Messaging.XmlMessageFormatter" />
        <altmember cref="T:System.Messaging.ActiveXMessageFormatter" />
        <altmember cref="T:System.Messaging.BinaryMessageFormatter" />
        <altmember cref="P:System.Messaging.Message.Formatter" />
      </Docs>
    </Member>
    <Member MemberName="GetAllMessages">
      <MemberSignature Language="C#" Value="public System.Messaging.Message[] GetAllMessages ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message[] GetAllMessages() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.GetAllMessages" />
      <MemberSignature Language="VB.NET" Value="Public Function GetAllMessages () As Message()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; cli::array &lt;System::Messaging::Message ^&gt; ^ GetAllMessages();" />
      <MemberSignature Language="F#" Value="member this.GetAllMessages : unit -&gt; System.Messaging.Message[]" Usage="messageQueue.GetAllMessages " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message[]</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="f3a8c-1184">キューにあるすべてのメッセージを返します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1184">Returns all the messages that are in the queue.</span></span></summary>
        <returns><span data-ttu-id="f3a8c-1185">キューにあるすべてのメッセージを表す <see cref="T:System.Messaging.Message" /> 型の配列。配列の順序は、メッセージがメッセージ キューのキューに存在する順序と同じです。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1185">An array of type <see cref="T:System.Messaging.Message" /> that represents all the messages in the queue, in the same order as they appear in the Message Queuing queue.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-1186"><xref:System.Messaging.MessageQueue.GetAllMessages%2A> は、キュー内のメッセージの静的スナップショットを返します。これらのメッセージへの動的リンクは返しません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1186"><xref:System.Messaging.MessageQueue.GetAllMessages%2A> returns a static snapshot of the messages in the queue, not dynamic links to those messages.</span></span> <span data-ttu-id="f3a8c-1187">したがって、配列を使用してキュー内のメッセージを変更することはできません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1187">Therefore, you cannot use the array to modify the messages in the queue.</span></span> <span data-ttu-id="f3a8c-1188">キューとの動的な対話 (メッセージを削除する機能など) が必要な場合は、<xref:System.Messaging.MessageQueue.GetMessageEnumerator2%2A> メソッドを呼び出します。このメソッドは、キュー内のメッセージの動的な一覧を返します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1188">If you want real-time, dynamic interaction with the queue (such as the ability to delete messages), call the <xref:System.Messaging.MessageQueue.GetMessageEnumerator2%2A> method, which returns a dynamic list of the messages in the queue.</span></span>  
  
 <span data-ttu-id="f3a8c-1189"><xref:System.Messaging.MessageQueue.GetAllMessages%2A> はメソッドの呼び出し時にキュー内のメッセージのコピーを返すので、配列にはキューに到着した新しいメッセージや、キューから削除されたメッセージは反映されません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1189">Because <xref:System.Messaging.MessageQueue.GetAllMessages%2A> returns a copy of the messages in the queue at the time the method was called, the array does not reflect new messages that arrive in the queue or messages that are removed from the queue.</span></span>  
  
 <span data-ttu-id="f3a8c-1190"><xref:System.Messaging.MessageQueue.GetAllMessages%2A> は、<xref:System.Messaging.MessageQueue.MessageReadPropertyFilter%2A> プロパティによって除外されていないプロパティだけを取得します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1190"><xref:System.Messaging.MessageQueue.GetAllMessages%2A> retrieves only those properties not filtered out by the <xref:System.Messaging.MessageQueue.MessageReadPropertyFilter%2A> property.</span></span>  
  
 <span data-ttu-id="f3a8c-1191">次の表に、この方法をさまざまなワークグループモードで使用できるかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1191">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-1192">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1192">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-1193">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1193">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-1194">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1194">Local computer</span></span>|<span data-ttu-id="f3a8c-1195">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1195">Yes</span></span>|  
|<span data-ttu-id="f3a8c-1196">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1196">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-1197">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1197">Yes</span></span>|  
|<span data-ttu-id="f3a8c-1198">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1198">Remote computer</span></span>|<span data-ttu-id="f3a8c-1199">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1199">No</span></span>|  
|<span data-ttu-id="f3a8c-1200">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1200">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-1201">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1201">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-1202">次のコード例は、<xref:System.Messaging.MessageQueue.GetAllMessages%2A> の使用方法を示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1202">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.GetAllMessages%2A>.</span></span>  
  
 [!code-cpp[MessageQueue2#21](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#21)]
 [!code-csharp[MessageQueue2#21](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#21)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="f3a8c-1203">メッセージ キューのメソッドにアクセスしたときにエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1203">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="T:System.Messaging.Message" />
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageEnumerator2" />
      </Docs>
    </Member>
    <Member MemberName="GetEnumerator">
      <MemberSignature Language="C#" Value="public System.Collections.IEnumerator GetEnumerator ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig newslot virtual instance class System.Collections.IEnumerator GetEnumerator() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.GetEnumerator" />
      <MemberSignature Language="VB.NET" Value="Public Function GetEnumerator () As IEnumerator" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual System::Collections::IEnumerator ^ GetEnumerator();" />
      <MemberSignature Language="F#" Value="abstract member GetEnumerator : unit -&gt; System.Collections.IEnumerator&#xA;override this.GetEnumerator : unit -&gt; System.Collections.IEnumerator" Usage="messageQueue.GetEnumerator " />
      <MemberType>Method</MemberType>
      <Implements>
        <InterfaceMember>M:System.Collections.IEnumerable.GetEnumerator</InterfaceMember>
      </Implements>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.Obsolete</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.Obsolete("This method returns a MessageEnumerator that implements RemoveCurrent family of methods incorrectly. Please use GetMessageEnumerator2 instead.")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Collections.IEnumerator</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="f3a8c-1204">キューに格納されているメッセージを列挙します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1204">Enumerates the messages in a queue.</span></span> <span data-ttu-id="f3a8c-1205"><see cref="M:System.Messaging.MessageQueue.GetEnumerator" /> は使用されなくなりました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1205"><see cref="M:System.Messaging.MessageQueue.GetEnumerator" /> is deprecated.</span></span> <span data-ttu-id="f3a8c-1206">代わりに <see cref="M:System.Messaging.MessageQueue.GetMessageEnumerator2" /> を使用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1206"><see cref="M:System.Messaging.MessageQueue.GetMessageEnumerator2" /> should be used instead.</span></span></summary>
        <returns><span data-ttu-id="f3a8c-1207">キュー内のメッセージへの動的な接続を提供する <see cref="T:System.Collections.IEnumerator" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1207">A <see cref="T:System.Collections.IEnumerator" /> that provides a dynamic connection to the messages in the queue.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-1208">次の表に、この方法をさまざまなワークグループモードで使用できるかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1208">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-1209">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1209">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-1210">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1210">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-1211">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1211">Local computer</span></span>|<span data-ttu-id="f3a8c-1212">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1212">Yes</span></span>|  
|<span data-ttu-id="f3a8c-1213">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1213">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-1214">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1214">Yes</span></span>|  
|<span data-ttu-id="f3a8c-1215">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1215">Remote computer</span></span>|<span data-ttu-id="f3a8c-1216">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1216">No</span></span>|  
|<span data-ttu-id="f3a8c-1217">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1217">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-1218">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1218">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-1219">次のコード例は、<xref:System.Messaging.MessageQueue.GetEnumerator%2A> の使用方法を示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1219">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.GetEnumerator%2A>.</span></span>  
  
 [!code-cpp[MessageQueue2#22](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#22)]
 [!code-csharp[MessageQueue2#22](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#22)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageEnumerator2" />
      </Docs>
    </Member>
    <Member MemberName="GetMachineId">
      <MemberSignature Language="C#" Value="public static Guid GetMachineId (string machineName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig valuetype System.Guid GetMachineId(string machineName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.GetMachineId(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetMachineId (machineName As String) As Guid" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static Guid GetMachineId(System::String ^ machineName);" />
      <MemberSignature Language="F#" Value="static member GetMachineId : string -&gt; Guid" Usage="System.Messaging.MessageQueue.GetMachineId machineName" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Guid</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="machineName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="machineName"><span data-ttu-id="f3a8c-1220">キューを含むコンピューターの名前。先頭に 2 つの円記号 (\\\\) を付けません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1220">The name of the computer that contains the queue, without the two preceding backslashes (\\\\).</span></span></param>
        <summary><span data-ttu-id="f3a8c-1221">この <see cref="T:System.Messaging.MessageQueue" /> が参照するキューが存在するコンピューターの ID を取得します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1221">Gets the identifier of the computer on which the queue referenced by this <see cref="T:System.Messaging.MessageQueue" /> is located.</span></span></summary>
        <returns><span data-ttu-id="f3a8c-1222">キューが存在するコンピューターの一意の ID を表す <see cref="T:System.Guid" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1222">A <see cref="T:System.Guid" /> that represents a unique identifier for the computer on which the queue is located.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-1223">コンピューターの識別子は、コンピューターのジャーナルを読み取り、セキュリティ証明書を設定するために、2つの目的で使用できます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1223">You can use a computer's identifier for two purposes, among others: to read the computer journal and to set security certificates.</span></span> <span data-ttu-id="f3a8c-1224">ただし、オフラインで作業している場合は、アプリケーションがドメインコントローラー上のディレクトリサービスにアクセスできる必要があるため、リモートコンピューターの <xref:System.Messaging.MessageQueue.GetMachineId%28System.String%29> を呼び出すことはできません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1224">However, you cannot call <xref:System.Messaging.MessageQueue.GetMachineId%28System.String%29> for a remote computer when you are working offline because the application must have access to the directory service on the domain controller.</span></span>  
  
 <span data-ttu-id="f3a8c-1225">コンピューター id (またはコンピューター識別子) は、コンピューターが企業に追加されるときにメッセージキューによって作成される <xref:System.Guid> です。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1225">The computer identifier (or machine identifier) is a <xref:System.Guid> that Message Queuing creates when a computer is added to the enterprise.</span></span> <span data-ttu-id="f3a8c-1226">メッセージキューは、コンピューター識別子と `Machine` および `Journal` キーワードを組み合わせて、`Machine=<computeridentifier>;Journal`という構文を持つマシンジャーナルの形式名を作成します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1226">Message Queuing combines the computer identifier with the `Machine` and `Journal` keywords to create the machine journal's format name, which has the syntax `Machine=<computeridentifier>;Journal`.</span></span> <span data-ttu-id="f3a8c-1227">ジャーナルキューとも呼ばれるコンピュータージャーナルは、<xref:System.Messaging.MessageQueue.UseJournalQueue%2A> プロパティが `true`場合に、アプリケーションによって生成されるメッセージのコピーを格納するシステムキューです。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1227">The machine journal, which is also known as the journal queue, is a system queue that stores copies of application-generated messages when the <xref:System.Messaging.MessageQueue.UseJournalQueue%2A> property is `true`.</span></span>  
  
 <span data-ttu-id="f3a8c-1228">ジャーナルのこの構文は、キューの形式名を構築する場合にのみ有効です。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1228">This syntax for the journal is only valid when constructing the format name for the queue.</span></span> <span data-ttu-id="f3a8c-1229">パス名の構文は `Journal$`\\`MachineName`ます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1229">The path name syntax is `MachineName`\\`Journal$`.</span></span>  
  
 <span data-ttu-id="f3a8c-1230">次の表に、この方法をさまざまなワークグループモードで使用できるかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1230">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-1231">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1231">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-1232">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1232">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-1233">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1233">Local computer</span></span>|<span data-ttu-id="f3a8c-1234">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1234">No</span></span>|  
|<span data-ttu-id="f3a8c-1235">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1235">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-1236">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1236">No</span></span>|  
|<span data-ttu-id="f3a8c-1237">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1237">Remote computer</span></span>|<span data-ttu-id="f3a8c-1238">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1238">No</span></span>|  
|<span data-ttu-id="f3a8c-1239">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1239">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-1240">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1240">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-1241"><xref:System.Messaging.MessageQueue.GetMachineId%28System.String%29> を呼び出すコード例を次に示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1241">The following code example calls <xref:System.Messaging.MessageQueue.GetMachineId%28System.String%29>.</span></span>  
  
 [!code-csharp[MessageQueue#14](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#14)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="f3a8c-1242">コンピューターの ID を取得できません。オフラインで作業しているなど、ディレクトリ サービスが利用できないことが原因である可能性があります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1242">The computer identifier could not be retrieved, possibly because the directory service is not available; for example, if you are working offline.</span></span>  
  
 <span data-ttu-id="f3a8c-1243">- または -</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1243">-or-</span></span>  
  
 <span data-ttu-id="f3a8c-1244">メッセージ キューのメソッドにアクセスしたときにエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1244">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.MachineName" />
        <altmember cref="P:System.Messaging.MessageQueue.UseJournalQueue" />
      </Docs>
    </Member>
    <Member MemberName="GetMessageEnumerator">
      <MemberSignature Language="C#" Value="public System.Messaging.MessageEnumerator GetMessageEnumerator ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.MessageEnumerator GetMessageEnumerator() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.GetMessageEnumerator" />
      <MemberSignature Language="VB.NET" Value="Public Function GetMessageEnumerator () As MessageEnumerator" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::MessageEnumerator ^ GetMessageEnumerator();" />
      <MemberSignature Language="F#" Value="member this.GetMessageEnumerator : unit -&gt; System.Messaging.MessageEnumerator" Usage="messageQueue.GetMessageEnumerator " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.Obsolete</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.Obsolete("This method returns a MessageEnumerator that implements RemoveCurrent family of methods incorrectly. Please use GetMessageEnumerator2 instead.")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Messaging.MessageEnumerator</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="f3a8c-1245">キューにあるすべてのメッセージに対して列挙子オブジェクトを作成します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1245">Creates an enumerator object for all the messages in the queue.</span></span> <span data-ttu-id="f3a8c-1246"><see cref="M:System.Messaging.MessageQueue.GetMessageEnumerator" /> は非推奨とされます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1246"><see cref="M:System.Messaging.MessageQueue.GetMessageEnumerator" /> is deprecated.</span></span> <span data-ttu-id="f3a8c-1247">代わりに <see cref="M:System.Messaging.MessageQueue.GetMessageEnumerator2" /> を使用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1247"><see cref="M:System.Messaging.MessageQueue.GetMessageEnumerator2" /> should be used instead.</span></span></summary>
        <returns><span data-ttu-id="f3a8c-1248">キューに含まれるメッセージを保持する <see cref="T:System.Messaging.MessageEnumerator" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1248">The <see cref="T:System.Messaging.MessageEnumerator" /> holding the messages that are contained in the queue.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-1249"><xref:System.Messaging.MessageQueue.GetMessageEnumerator%2A> は、キュー内のすべてのメッセージの動的な一覧を作成します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1249"><xref:System.Messaging.MessageQueue.GetMessageEnumerator%2A> creates a dynamic list of all the messages in a queue.</span></span> <span data-ttu-id="f3a8c-1250"><xref:System.Messaging.MessageQueue.GetMessageEnumerator%2A> が返す <xref:System.Messaging.MessageEnumerator> に対して <xref:System.Messaging.MessageEnumerator.RemoveCurrent%2A> を呼び出すことによって、列挙子の現在位置にあるメッセージをキューから削除できます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1250">You can remove from the queue the message at the enumerator's current position by calling <xref:System.Messaging.MessageEnumerator.RemoveCurrent%2A> for the <xref:System.Messaging.MessageEnumerator> that <xref:System.Messaging.MessageQueue.GetMessageEnumerator%2A> returns.</span></span>  
  
 <span data-ttu-id="f3a8c-1251">カーソルはキュー内のメッセージの動的な一覧に関連付けられているので、メッセージが現在のカーソル位置を超えている場合は、キュー内のメッセージに加えた変更が列挙体に反映されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1251">Because the cursor is associated with the dynamic list of messages in the queue, the enumeration reflects any modification you make to the messages in the queue, if the message is beyond the current cursor position.</span></span> <span data-ttu-id="f3a8c-1252">たとえば、列挙子は、カーソルの現在位置を超えている優先順位の低いメッセージに自動的にアクセスできますが、その位置の前に挿入される優先順位の高いメッセージは自動的には表示されません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1252">For example, the enumerator can automatically access a lower-priority message placed beyond the cursor's current position, but not a higher-priority message inserted before that position.</span></span> <span data-ttu-id="f3a8c-1253">ただし、列挙体をリセットして、<xref:System.Messaging.MessageEnumerator>の <xref:System.Messaging.MessageEnumerator.Reset%2A> を呼び出すことによって、リストの先頭にカーソルを戻すことができます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1253">However, you can reset the enumeration, thereby moving the cursor back to the beginning of the list, by calling <xref:System.Messaging.MessageEnumerator.Reset%2A> for the <xref:System.Messaging.MessageEnumerator>.</span></span>  
  
 <span data-ttu-id="f3a8c-1254">列挙内のメッセージの順序は、キュー内のメッセージの順序に反映されます。そのため、優先順位の低いメッセージは、優先順位の低い方の前に表示されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1254">The order of the messages in the enumeration reflects their order in the queue, so higher-priority messages will appear before lower-priority ones.</span></span>  
  
 <span data-ttu-id="f3a8c-1255">キューに動的に接続するのではなく、キュー内のメッセージの静的スナップショットが必要な場合は、<xref:System.Messaging.MessageQueue.GetAllMessages%2A>を呼び出します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1255">If you want a static snapshot of the messages in the queue rather than a dynamic connection to them, call <xref:System.Messaging.MessageQueue.GetAllMessages%2A>.</span></span> <span data-ttu-id="f3a8c-1256">このメソッドは <xref:System.Messaging.Message> オブジェクトの配列を返します。これは、メソッドが呼び出されたときのメッセージを表します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1256">This method returns an array of <xref:System.Messaging.Message> objects, which represent the messages at the time the method was called.</span></span>  
  
 <span data-ttu-id="f3a8c-1257">次の表に、この方法をさまざまなワークグループモードで使用できるかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1257">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-1258">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1258">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-1259">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1259">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-1260">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1260">Local computer</span></span>|<span data-ttu-id="f3a8c-1261">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1261">Yes</span></span>|  
|<span data-ttu-id="f3a8c-1262">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1262">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-1263">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1263">Yes</span></span>|  
|<span data-ttu-id="f3a8c-1264">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1264">Remote computer</span></span>|<span data-ttu-id="f3a8c-1265">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1265">Yes</span></span>|  
|<span data-ttu-id="f3a8c-1266">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1266">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-1267">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1267">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-1268">次のコード例では、キュー内のメッセージの動的な一覧を取得し、<xref:System.Messaging.Message.Priority%2A> プロパティが <xref:System.Messaging.MessagePriority.Lowest?displayProperty=nameWithType>に設定されているすべてのメッセージをカウントします。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1268">The following code example gets a dynamic list of messages in a queue and counts all messages with the <xref:System.Messaging.Message.Priority%2A> property set to <xref:System.Messaging.MessagePriority.Lowest?displayProperty=nameWithType>.</span></span>  
  
 [!code-cpp[MessageQueue.GetMessageEnumerator#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.GetMessageEnumerator/CPP/mqgetmessageenumerator.cpp#1)]
 [!code-csharp[MessageQueue.GetMessageEnumerator#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.GetMessageEnumerator/CS/mqgetmessageenumerator.cs#1)]
 [!code-vb[MessageQueue.GetMessageEnumerator#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.GetMessageEnumerator/VB/mqgetmessageenumerator.vb#1)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Messaging.MessageQueue.GetAllMessages" />
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageEnumerator2" />
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageQueueEnumerator" />
      </Docs>
    </Member>
    <Member MemberName="GetMessageEnumerator2">
      <MemberSignature Language="C#" Value="public System.Messaging.MessageEnumerator GetMessageEnumerator2 ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.MessageEnumerator GetMessageEnumerator2() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.GetMessageEnumerator2" />
      <MemberSignature Language="VB.NET" Value="Public Function GetMessageEnumerator2 () As MessageEnumerator" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::MessageEnumerator ^ GetMessageEnumerator2();" />
      <MemberSignature Language="F#" Value="member this.GetMessageEnumerator2 : unit -&gt; System.Messaging.MessageEnumerator" Usage="messageQueue.GetMessageEnumerator2 " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.MessageEnumerator</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="f3a8c-1269">キューにあるすべてのメッセージに対して列挙子オブジェクトを作成します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1269">Creates an enumerator object for all the messages in the queue.</span></span></summary>
        <returns><span data-ttu-id="f3a8c-1270">キューに含まれるメッセージを保持する <see cref="T:System.Messaging.MessageEnumerator" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1270">The <see cref="T:System.Messaging.MessageEnumerator" /> holding the messages that are contained in the queue.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-1271"><xref:System.Messaging.MessageQueue.GetMessageEnumerator2%2A> は、キュー内のすべてのメッセージの動的な一覧を作成します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1271"><xref:System.Messaging.MessageQueue.GetMessageEnumerator2%2A> creates a dynamic list of all the messages in a queue.</span></span> <span data-ttu-id="f3a8c-1272"><xref:System.Messaging.MessageQueue.GetMessageEnumerator2%2A> が返す <xref:System.Messaging.MessageEnumerator> に対して <xref:System.Messaging.MessageEnumerator.RemoveCurrent%2A> を呼び出すことによって、列挙子の現在位置にあるメッセージをキューから削除できます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1272">You can remove from the queue the message at the enumerator's current position by calling <xref:System.Messaging.MessageEnumerator.RemoveCurrent%2A> for the <xref:System.Messaging.MessageEnumerator> that <xref:System.Messaging.MessageQueue.GetMessageEnumerator2%2A> returns.</span></span>  
  
 <span data-ttu-id="f3a8c-1273">カーソルはキュー内のメッセージの動的な一覧に関連付けられているので、メッセージが現在のカーソル位置を超えている場合は、キュー内のメッセージに加えた変更が列挙体に反映されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1273">Because the cursor is associated with the dynamic list of messages in the queue, the enumeration reflects any modification you make to the messages in the queue, if the message is beyond the current cursor position.</span></span> <span data-ttu-id="f3a8c-1274">たとえば、列挙子は、カーソルの現在位置を超えている優先順位の低いメッセージに自動的にアクセスできますが、その位置の前に挿入される優先順位の高いメッセージは自動的には表示されません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1274">For example, the enumerator can automatically access a lower-priority message placed beyond the cursor's current position, but not a higher-priority message inserted before that position.</span></span> <span data-ttu-id="f3a8c-1275">ただし、列挙体をリセットして、<xref:System.Messaging.MessageEnumerator>の <xref:System.Messaging.MessageEnumerator.Reset%2A> を呼び出すことによって、リストの先頭にカーソルを戻すことができます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1275">However, you can reset the enumeration, thereby moving the cursor back to the beginning of the list, by calling <xref:System.Messaging.MessageEnumerator.Reset%2A> for the <xref:System.Messaging.MessageEnumerator>.</span></span>  
  
 <span data-ttu-id="f3a8c-1276">列挙内のメッセージの順序は、キュー内のメッセージの順序に反映されます。そのため、優先順位の低いメッセージは、優先順位の低い方の前に表示されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1276">The order of the messages in the enumeration reflects their order in the queue, so higher-priority messages will appear before lower-priority ones.</span></span>  
  
 <span data-ttu-id="f3a8c-1277">キューに動的に接続するのではなく、キュー内のメッセージの静的スナップショットが必要な場合は、<xref:System.Messaging.MessageQueue.GetAllMessages%2A>を呼び出します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1277">If you want a static snapshot of the messages in the queue rather than a dynamic connection to them, call <xref:System.Messaging.MessageQueue.GetAllMessages%2A>.</span></span> <span data-ttu-id="f3a8c-1278">このメソッドは <xref:System.Messaging.Message> オブジェクトの配列を返します。これは、メソッドが呼び出されたときのメッセージを表します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1278">This method returns an array of <xref:System.Messaging.Message> objects, which represent the messages at the time the method was called.</span></span>  
  
 <span data-ttu-id="f3a8c-1279">次の表に、この方法をさまざまなワークグループモードで使用できるかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1279">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-1280">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1280">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-1281">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1281">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-1282">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1282">Local computer</span></span>|<span data-ttu-id="f3a8c-1283">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1283">Yes</span></span>|  
|<span data-ttu-id="f3a8c-1284">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1284">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-1285">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1285">Yes</span></span>|  
|<span data-ttu-id="f3a8c-1286">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1286">Remote computer</span></span>|<span data-ttu-id="f3a8c-1287">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1287">Yes</span></span>|  
|<span data-ttu-id="f3a8c-1288">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1288">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-1289">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1289">Yes</span></span>|  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Messaging.MessageQueue.GetAllMessages" />
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageQueueEnumerator" />
      </Docs>
    </Member>
    <MemberGroup MemberName="GetMessageQueueEnumerator">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="f3a8c-1290">列挙子オブジェクトを作成し、ネットワーク上のパブリック キューの動的リストを作成します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1290">Creates an enumerator object for a dynamic listing of the public queues on the network.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="GetMessageQueueEnumerator">
      <MemberSignature Language="C#" Value="public static System.Messaging.MessageQueueEnumerator GetMessageQueueEnumerator ();" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Messaging.MessageQueueEnumerator GetMessageQueueEnumerator() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.GetMessageQueueEnumerator" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetMessageQueueEnumerator () As MessageQueueEnumerator" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::Messaging::MessageQueueEnumerator ^ GetMessageQueueEnumerator();" />
      <MemberSignature Language="F#" Value="static member GetMessageQueueEnumerator : unit -&gt; System.Messaging.MessageQueueEnumerator" Usage="System.Messaging.MessageQueue.GetMessageQueueEnumerator " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.MessageQueueEnumerator</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="f3a8c-1291">ネットワーク上のすべてのパブリック キューを列挙するための順方向専用カーソル セマンティクスをサポートします。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1291">Provides forward-only cursor semantics to enumerate through all public queues on the network.</span></span></summary>
        <returns><span data-ttu-id="f3a8c-1292">ネットワーク上のすべてのパブリックメッセージ キューの動的リストを作成する <see cref="T:System.Messaging.MessageQueueEnumerator" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1292">A <see cref="T:System.Messaging.MessageQueueEnumerator" /> that provides a dynamic listing of all the public message queues on the network.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-1293">この <xref:System.Messaging.MessageQueue.GetMessageQueueEnumerator%2A> のオーバーロードは、ネットワーク上のすべてのパブリックキューの列挙体を返します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1293">This overload of <xref:System.Messaging.MessageQueue.GetMessageQueueEnumerator%2A> returns an enumeration of all the public queues that are on the network.</span></span>  
  
 <span data-ttu-id="f3a8c-1294">カーソルは動的なリストに関連付けられているので、列挙は、カーソルの現在位置を超えて削除または追加されたキューのキューリストに加えた変更を反映します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1294">Because the cursor is associated with a dynamic listing, the enumeration reflects any modification you make to a queue list for queues deleted or added beyond the cursor's current position.</span></span> <span data-ttu-id="f3a8c-1295">カーソルの現在位置より前にあるキューの追加または削除は反映されません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1295">Additions or deletion of queues located before the cursor's current position are not reflected.</span></span> <span data-ttu-id="f3a8c-1296">たとえば、列挙子はカーソル位置を超えて追加されたキューに自動的にアクセスできますが、その位置の前には挿入されません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1296">For example, the enumerator can automatically access a queue appended beyond the cursor position but not one inserted before that position.</span></span> <span data-ttu-id="f3a8c-1297">ただし、列挙体をリセットして、<xref:System.Messaging.MessageQueueEnumerator>の <xref:System.Messaging.MessageQueueEnumerator.Reset%2A> を呼び出すことによって、リストの先頭にカーソルを戻すことができます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1297">However, you can reset the enumeration, thereby moving the cursor back to the beginning of the list, by calling <xref:System.Messaging.MessageQueueEnumerator.Reset%2A> for the <xref:System.Messaging.MessageQueueEnumerator>.</span></span>  
  
 <span data-ttu-id="f3a8c-1298">ネットワークにキューの順序が定義されていません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1298">There is no defined ordering of queues in a network.</span></span> <span data-ttu-id="f3a8c-1299">列挙子は、コンピューター、ラベル、パブリックまたはプライベートの状態、その他のアクセス可能な条件などによって並べ替えられません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1299">An enumerator does not order them, for example, by computer, label, public or private status, or any other accessible criteria.</span></span>  
  
 <span data-ttu-id="f3a8c-1300">動的に接続するのではなく、ネットワーク上のキューの静的スナップショットが必要な場合は、<xref:System.Messaging.MessageQueue.GetPublicQueues%2A> または <xref:System.Messaging.MessageQueue.GetPrivateQueuesByMachine%28System.String%29>を呼び出します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1300">If you want a static snapshot of the queues on the network rather than a dynamic connection to them, call <xref:System.Messaging.MessageQueue.GetPublicQueues%2A> or <xref:System.Messaging.MessageQueue.GetPrivateQueuesByMachine%28System.String%29>.</span></span> <span data-ttu-id="f3a8c-1301">これらの2つのメソッドは <xref:System.Messaging.MessageQueue> オブジェクトの配列を返します。これは、メソッドが呼び出されたときのキューを表します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1301">Each of these two methods returns an array of <xref:System.Messaging.MessageQueue> objects, which represent the queues at the time the method was called.</span></span>  
  
 <span data-ttu-id="f3a8c-1302">次の表に、この方法をさまざまなワークグループモードで使用できるかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1302">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-1303">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1303">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-1304">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1304">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-1305">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1305">Local computer</span></span>|<span data-ttu-id="f3a8c-1306">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1306">No</span></span>|  
|<span data-ttu-id="f3a8c-1307">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1307">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-1308">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1308">No</span></span>|  
|<span data-ttu-id="f3a8c-1309">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1309">Remote computer</span></span>|<span data-ttu-id="f3a8c-1310">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1310">No</span></span>|  
|<span data-ttu-id="f3a8c-1311">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1311">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-1312">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1312">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-1313">次のコード例では、ネットワーク内のすべてのメッセージキューを反復処理し、各キューのパスを調べます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1313">The following code example iterates through all the message queues in the network, and examines the path for each queue.</span></span> <span data-ttu-id="f3a8c-1314">最後に、ネットワーク上のパブリックキューの数が表示されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1314">Finally, it displays the number of public queues on the network.</span></span>  
  
 [!code-cpp[MessageQueue.GetMessageQueueEnumerator_noparms#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.GetMessageQueueEnumerator_noparms/CPP/mqgetmessagequeueenumerator.cpp#1)]
 [!code-csharp[MessageQueue.GetMessageQueueEnumerator_noparms#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.GetMessageQueueEnumerator_noparms/CS/mqgetmessagequeueenumerator.cs#1)]
 [!code-vb[MessageQueue.GetMessageQueueEnumerator_noparms#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.GetMessageQueueEnumerator_noparms/VB/mqgetmessagequeueenumerator.vb#1)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Messaging.MessageQueue.GetPublicQueues" />
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageEnumerator2" />
      </Docs>
    </Member>
    <Member MemberName="GetMessageQueueEnumerator">
      <MemberSignature Language="C#" Value="public static System.Messaging.MessageQueueEnumerator GetMessageQueueEnumerator (System.Messaging.MessageQueueCriteria criteria);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Messaging.MessageQueueEnumerator GetMessageQueueEnumerator(class System.Messaging.MessageQueueCriteria criteria) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.GetMessageQueueEnumerator(System.Messaging.MessageQueueCriteria)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetMessageQueueEnumerator (criteria As MessageQueueCriteria) As MessageQueueEnumerator" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::Messaging::MessageQueueEnumerator ^ GetMessageQueueEnumerator(System::Messaging::MessageQueueCriteria ^ criteria);" />
      <MemberSignature Language="F#" Value="static member GetMessageQueueEnumerator : System.Messaging.MessageQueueCriteria -&gt; System.Messaging.MessageQueueEnumerator" Usage="System.Messaging.MessageQueue.GetMessageQueueEnumerator criteria" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.MessageQueueEnumerator</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="criteria" Type="System.Messaging.MessageQueueCriteria" />
      </Parameters>
      <Docs>
        <param name="criteria"><span data-ttu-id="f3a8c-1315">利用できるメッセージ キューのフィルター処理に使用する基準が格納されている <see cref="T:System.Messaging.MessageQueueCriteria" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1315">A <see cref="T:System.Messaging.MessageQueueCriteria" /> that contains the criteria used to filter the available message queues.</span></span></param>
        <summary><span data-ttu-id="f3a8c-1316">指定した基準を満たすネットワーク上のすべてのパブリック キューを列挙するための順方向専用カーソル セマンティクスをサポートします。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1316">Provides forward-only cursor semantics to enumerate through all public queues on the network that meet the specified criteria.</span></span></summary>
        <returns><span data-ttu-id="f3a8c-1317"><paramref name="criteria" /> パラメーターで指定された制約を満たすネットワーク上のパブリックメッセージ キューの動的リストを作成する <see cref="T:System.Messaging.MessageQueueEnumerator" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1317">A <see cref="T:System.Messaging.MessageQueueEnumerator" /> that provides a dynamic listing of the public message queues on the network that satisfy the restrictions specified by the <paramref name="criteria" /> parameter.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-1318">この <xref:System.Messaging.MessageQueue.GetMessageQueueEnumerator%2A> のオーバーロードは、アプリケーション条件で定義された条件を満たすネットワーク上のすべてのパブリックキューの一覧を返します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1318">This overload of <xref:System.Messaging.MessageQueue.GetMessageQueueEnumerator%2A> returns a listing of all the public queues on the network that satisfy criteria defined in the application criteria.</span></span> <span data-ttu-id="f3a8c-1319">キューの作成や変更時間、コンピューター名、ラベル、カテゴリ、またはこれらの組み合わせなど、含める条件を指定できます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1319">You can specify the criteria to include, for example, queue creation or modification time, computer name, label, category, or any combination of these.</span></span>  
  
 <span data-ttu-id="f3a8c-1320">カーソルは動的な一覧に関連付けられているので、列挙体には、カーソルの現在位置を超えて発生するキューに対して行った変更が反映されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1320">Because the cursor is associated with a dynamic listing, the enumeration reflects any modification you make to a queue that occurs beyond the cursor's current position.</span></span> <span data-ttu-id="f3a8c-1321">カーソルの現在位置より前にあるキューへの変更は反映されません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1321">Changes to queues located before the cursor's current position are not reflected.</span></span> <span data-ttu-id="f3a8c-1322">たとえば、列挙子はカーソル位置を超えて追加されたキューに自動的にアクセスできますが、その位置の前には挿入されません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1322">For example, the enumerator can automatically access a queue appended beyond the cursor position but not one inserted before that position.</span></span> <span data-ttu-id="f3a8c-1323">ただし、列挙体をリセットして、<xref:System.Messaging.MessageQueueEnumerator>の <xref:System.Messaging.MessageQueueEnumerator.Reset%2A> を呼び出すことによって、リストの先頭にカーソルを戻すことができます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1323">However, you can reset the enumeration, thereby moving the cursor back to the beginning of the list, by calling <xref:System.Messaging.MessageQueueEnumerator.Reset%2A> for the <xref:System.Messaging.MessageQueueEnumerator>.</span></span>  
  
 <span data-ttu-id="f3a8c-1324">ネットワークにキューの順序が定義されていません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1324">There is no defined ordering of queues in a network.</span></span> <span data-ttu-id="f3a8c-1325">列挙子は、コンピューター、ラベル、パブリックまたはプライベートの状態、その他のアクセス可能な条件などによって並べ替えられません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1325">An enumerator does not order them, for example, by computer, label, public or private status, or any other accessible criteria.</span></span>  
  
 <span data-ttu-id="f3a8c-1326">動的に接続するのではなく、ネットワーク上のキューの静的スナップショットが必要な場合は、<xref:System.Messaging.MessageQueue.GetPublicQueues%2A> の条件を指定するか <xref:System.Messaging.MessageQueue.GetPrivateQueuesByMachine%28System.String%29>を呼び出します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1326">If you want a static snapshot of the queues on the network rather than a dynamic connection to them, specify criteria for <xref:System.Messaging.MessageQueue.GetPublicQueues%2A> or call <xref:System.Messaging.MessageQueue.GetPrivateQueuesByMachine%28System.String%29>.</span></span> <span data-ttu-id="f3a8c-1327">これらの2つのメソッドは <xref:System.Messaging.MessageQueue> オブジェクトの配列を返します。これは、メソッドが呼び出されたときのキューを表します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1327">Each of these two methods returns an array of <xref:System.Messaging.MessageQueue> objects, which represent the queues at the time the method was called.</span></span> <span data-ttu-id="f3a8c-1328"><xref:System.Messaging.MessageQueue.GetPublicQueuesByCategory%28System.Guid%29>、<xref:System.Messaging.MessageQueue.GetPublicQueuesByLabel%28System.String%29>、または <xref:System.Messaging.MessageQueue.GetPublicQueuesByMachine%28System.String%29> を呼び出すと、それぞれ <xref:System.Messaging.MessageQueue.Category%2A>、<xref:System.Messaging.MessageQueue.Label%2A>、および <xref:System.Messaging.MessageQueue.MachineName%2A>のフィルター条件を使用して <xref:System.Messaging.MessageQueue.GetPublicQueues%2A> を呼び出す場合と同じ結果が得られます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1328">Calling <xref:System.Messaging.MessageQueue.GetPublicQueuesByCategory%28System.Guid%29>, <xref:System.Messaging.MessageQueue.GetPublicQueuesByLabel%28System.String%29>, or <xref:System.Messaging.MessageQueue.GetPublicQueuesByMachine%28System.String%29> provides the same results as calling <xref:System.Messaging.MessageQueue.GetPublicQueues%2A> with the filtering criteria of <xref:System.Messaging.MessageQueue.Category%2A>, <xref:System.Messaging.MessageQueue.Label%2A>, and <xref:System.Messaging.MessageQueue.MachineName%2A>, respectively.</span></span>  
  
 <span data-ttu-id="f3a8c-1329">次の表に、この方法をさまざまなワークグループモードで使用できるかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1329">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-1330">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1330">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-1331">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1331">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-1332">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1332">Local computer</span></span>|<span data-ttu-id="f3a8c-1333">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1333">No</span></span>|  
|<span data-ttu-id="f3a8c-1334">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1334">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-1335">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1335">No</span></span>|  
|<span data-ttu-id="f3a8c-1336">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1336">Remote computer</span></span>|<span data-ttu-id="f3a8c-1337">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1337">No</span></span>|  
|<span data-ttu-id="f3a8c-1338">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1338">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-1339">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1339">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-1340">次のコード例では、メッセージキューを反復処理し、最後の1日に作成され、コンピューター "MyComputer" に存在する各キューのパスを表示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1340">The following code example iterates through message queues and displays the path of each queue that was created in the last day and that exists on the computer "MyComputer".</span></span>  
  
 [!code-cpp[MessageQueue.GetMessageQueueEnumerator_criteria#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.GetMessageQueueEnumerator_criteria/CPP/mqgetmessagequeueenumerator_criteria.cpp#1)]
 [!code-csharp[MessageQueue.GetMessageQueueEnumerator_criteria#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.GetMessageQueueEnumerator_criteria/CS/mqgetmessagequeueenumerator_criteria.cs#1)]
 [!code-vb[MessageQueue.GetMessageQueueEnumerator_criteria#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.GetMessageQueueEnumerator_criteria/VB/mqgetmessagequeueenumerator_criteria.vb#1)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Messaging.MessageQueue.GetPublicQueues" />
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageEnumerator2" />
      </Docs>
    </Member>
    <Member MemberName="GetPrivateQueuesByMachine">
      <MemberSignature Language="C#" Value="public static System.Messaging.MessageQueue[] GetPrivateQueuesByMachine (string machineName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Messaging.MessageQueue[] GetPrivateQueuesByMachine(string machineName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.GetPrivateQueuesByMachine(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetPrivateQueuesByMachine (machineName As String) As MessageQueue()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static cli::array &lt;System::Messaging::MessageQueue ^&gt; ^ GetPrivateQueuesByMachine(System::String ^ machineName);" />
      <MemberSignature Language="F#" Value="static member GetPrivateQueuesByMachine : string -&gt; System.Messaging.MessageQueue[]" Usage="System.Messaging.MessageQueue.GetPrivateQueuesByMachine machineName" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.MessageQueue[]</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="machineName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="machineName"><span data-ttu-id="f3a8c-1341">プライベート キューを取得するコンピューター。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1341">The computer from which to retrieve the private queues.</span></span></param>
        <summary><span data-ttu-id="f3a8c-1342">指定したコンピューターにあるすべてのプライベート キューを取得します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1342">Retrieves all the private queues on the specified computer.</span></span></summary>
        <returns><span data-ttu-id="f3a8c-1343">取得されたプライベート キューを参照する <see cref="T:System.Messaging.MessageQueue" /> オブジェクトの配列。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1343">An array of <see cref="T:System.Messaging.MessageQueue" /> objects that reference the retrieved private queues.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-1344"><xref:System.Messaging.MessageQueue.GetPrivateQueuesByMachine%28System.String%29> 指定したコンピューター上のキューの静的スナップショットを取得します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1344"><xref:System.Messaging.MessageQueue.GetPrivateQueuesByMachine%28System.String%29> retrieves a static snapshot of the queues on a specified computer.</span></span>  
  
 <span data-ttu-id="f3a8c-1345">次の表に、この方法をさまざまなワークグループモードで使用できるかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1345">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-1346">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1346">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-1347">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1347">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-1348">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1348">Local computer</span></span>|<span data-ttu-id="f3a8c-1349">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1349">Yes</span></span>|  
|<span data-ttu-id="f3a8c-1350">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1350">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-1351">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1351">Yes</span></span>|  
|<span data-ttu-id="f3a8c-1352">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1352">Remote computer</span></span>|<span data-ttu-id="f3a8c-1353">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1353">Yes</span></span>|  
|<span data-ttu-id="f3a8c-1354">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1354">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-1355">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1355">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-1356">次のコード例では、キューのリストを取得します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1356">The following code example retrieves lists of queues.</span></span>  
  
 [!code-cpp[MessageQueue.GetQueueLists#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.GetQueueLists/CPP/mqgetqueuelists.cpp#1)]
 [!code-csharp[MessageQueue.GetQueueLists#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.GetQueueLists/CS/mqgetqueuelists.cs#1)]
 [!code-vb[MessageQueue.GetQueueLists#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.GetQueueLists/VB/mqgetqueuelists.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="f3a8c-1357"><paramref name="machineName" /> パラメーターが <see langword="null" /> または空の文字列 ("") です。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1357">The <paramref name="machineName" /> parameter is <see langword="null" /> or an empty string ("").</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="f3a8c-1358">メッセージ キューのメソッドにアクセスしたときにエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1358">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.MachineName" />
        <altmember cref="M:System.Messaging.MessageQueue.GetPublicQueues" />
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageQueueEnumerator" />
      </Docs>
    </Member>
    <MemberGroup MemberName="GetPublicQueues">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="f3a8c-1359">ネットワーク上のすべてのパブリック キューを取得します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1359">Retrieves all the public queues on the network.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="GetPublicQueues">
      <MemberSignature Language="C#" Value="public static System.Messaging.MessageQueue[] GetPublicQueues ();" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Messaging.MessageQueue[] GetPublicQueues() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.GetPublicQueues" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetPublicQueues () As MessageQueue()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static cli::array &lt;System::Messaging::MessageQueue ^&gt; ^ GetPublicQueues();" />
      <MemberSignature Language="F#" Value="static member GetPublicQueues : unit -&gt; System.Messaging.MessageQueue[]" Usage="System.Messaging.MessageQueue.GetPublicQueues " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.MessageQueue[]</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="f3a8c-1360">ネットワーク上のすべてのパブリック キューを取得します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1360">Retrieves all the public queues on the network.</span></span></summary>
        <returns><span data-ttu-id="f3a8c-1361">取得したパブリック キューを参照する <see cref="T:System.Messaging.MessageQueue" /> オブジェクトの配列。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1361">An array of <see cref="T:System.Messaging.MessageQueue" /> objects that reference the retrieved public queues.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-1362">ネットワーク上のすべてのパブリックキューの完全な一覧が必要な場合は、このオーバーロードを使用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1362">Use this overload if you want a complete list of all the public queues on the network.</span></span> <span data-ttu-id="f3a8c-1363"><xref:System.Messaging.MessageQueue.MachineName%2A>、<xref:System.Messaging.MessageQueue.Category%2A>、最終更新時刻など、特定の条件によってリストを制限する場合は、このメソッドの別のオーバーロードを使用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1363">If you want to restrict the list by certain criteria, such as <xref:System.Messaging.MessageQueue.MachineName%2A>, <xref:System.Messaging.MessageQueue.Category%2A>, or last modified time use another overload of this method.</span></span> <span data-ttu-id="f3a8c-1364">(または、<xref:System.Messaging.MessageQueue.GetPublicQueuesByMachine%28System.String%29>、<xref:System.Messaging.MessageQueue.GetPublicQueuesByCategory%28System.Guid%29>、<xref:System.Messaging.MessageQueue.GetPublicQueuesByLabel%28System.String%29>を使用することもできます)。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1364">(Alternatively, you can use <xref:System.Messaging.MessageQueue.GetPublicQueuesByMachine%28System.String%29>, <xref:System.Messaging.MessageQueue.GetPublicQueuesByCategory%28System.Guid%29>, or <xref:System.Messaging.MessageQueue.GetPublicQueuesByLabel%28System.String%29>.)</span></span>  
  
 <span data-ttu-id="f3a8c-1365"><xref:System.Messaging.MessageQueue.GetPublicQueues%2A> は、キューの静的スナップショットを取得します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1365"><xref:System.Messaging.MessageQueue.GetPublicQueues%2A> retrieves a static snapshot of the queues.</span></span> <span data-ttu-id="f3a8c-1366">キューの動的リストを操作するには、<xref:System.Messaging.MessageQueue.GetMessageQueueEnumerator%2A>を使用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1366">To interact with a dynamic list of the queues, use <xref:System.Messaging.MessageQueue.GetMessageQueueEnumerator%2A>.</span></span>  
  
 <span data-ttu-id="f3a8c-1367">次の表に、この方法をさまざまなワークグループモードで使用できるかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1367">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-1368">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1368">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-1369">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1369">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-1370">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1370">Local computer</span></span>|<span data-ttu-id="f3a8c-1371">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1371">No</span></span>|  
|<span data-ttu-id="f3a8c-1372">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1372">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-1373">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1373">No</span></span>|  
|<span data-ttu-id="f3a8c-1374">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1374">Remote computer</span></span>|<span data-ttu-id="f3a8c-1375">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1375">No</span></span>|  
|<span data-ttu-id="f3a8c-1376">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1376">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-1377">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1377">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-1378">次のコード例では、キューのリストを取得します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1378">The following code example retrieves lists of queues.</span></span>  
  
 [!code-cpp[MessageQueue.GetQueueLists#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.GetQueueLists/CPP/mqgetqueuelists.cpp#1)]
 [!code-csharp[MessageQueue.GetQueueLists#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.GetQueueLists/CS/mqgetqueuelists.cs#1)]
 [!code-vb[MessageQueue.GetQueueLists#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.GetQueueLists/VB/mqgetqueuelists.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="f3a8c-1379">メッセージ キューのメソッドにアクセスしたときにエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1379">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageQueueEnumerator" />
      </Docs>
    </Member>
    <Member MemberName="GetPublicQueues">
      <MemberSignature Language="C#" Value="public static System.Messaging.MessageQueue[] GetPublicQueues (System.Messaging.MessageQueueCriteria criteria);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Messaging.MessageQueue[] GetPublicQueues(class System.Messaging.MessageQueueCriteria criteria) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.GetPublicQueues(System.Messaging.MessageQueueCriteria)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetPublicQueues (criteria As MessageQueueCriteria) As MessageQueue()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static cli::array &lt;System::Messaging::MessageQueue ^&gt; ^ GetPublicQueues(System::Messaging::MessageQueueCriteria ^ criteria);" />
      <MemberSignature Language="F#" Value="static member GetPublicQueues : System.Messaging.MessageQueueCriteria -&gt; System.Messaging.MessageQueue[]" Usage="System.Messaging.MessageQueue.GetPublicQueues criteria" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.MessageQueue[]</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="criteria" Type="System.Messaging.MessageQueueCriteria" />
      </Parameters>
      <Docs>
        <param name="criteria"><span data-ttu-id="f3a8c-1380">キューのフィルター処理に使用する基準が格納されている <see cref="T:System.Messaging.MessageQueueCriteria" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1380">A <see cref="T:System.Messaging.MessageQueueCriteria" /> that contains the criteria used to filter the queues.</span></span></param>
        <summary><span data-ttu-id="f3a8c-1381">指定した基準を満たすネットワーク上のすべてのパブリック キューを取得します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1381">Retrieves all the public queues on the network that meet the specified criteria.</span></span></summary>
        <returns><span data-ttu-id="f3a8c-1382">取得したパブリック キューを参照する <see cref="T:System.Messaging.MessageQueue" /> オブジェクトの配列。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1382">An array of <see cref="T:System.Messaging.MessageQueue" /> objects that reference the retrieved public queues.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-1383">ネットワーク上のすべてのパブリックキューをラベル、カテゴリ、またはコンピューター名でフィルター処理する場合、<xref:System.Messaging.MessageQueue> クラスには、その機能 (<xref:System.Messaging.MessageQueue.GetPublicQueuesByLabel%28System.String%29>、<xref:System.Messaging.MessageQueue.GetPublicQueuesByCategory%28System.Guid%29>、および <xref:System.Messaging.MessageQueue.GetPublicQueuesByMachine%28System.String%29>) を提供する特定のメソッドが含まれています。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1383">If you want to filter all the public queues on the network by label, category, or computer name, the <xref:System.Messaging.MessageQueue> class contains specific methods that provide that functionality (<xref:System.Messaging.MessageQueue.GetPublicQueuesByLabel%28System.String%29>, <xref:System.Messaging.MessageQueue.GetPublicQueuesByCategory%28System.Guid%29>, and <xref:System.Messaging.MessageQueue.GetPublicQueuesByMachine%28System.String%29>, respectively).</span></span> <span data-ttu-id="f3a8c-1384">このオーバーロードを使用して、これらの条件のうちの1つ以上を満たすネットワーク上のすべてのパブリックキューの一覧を取得します (ラベルとカテゴリの両方を指定する場合など)。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1384">Use this overload to get a list of all the public queues on the network that meet more than one of these criteria (for example, if you want to specify both a label and a category).</span></span> <span data-ttu-id="f3a8c-1385"><xref:System.Messaging.MessageQueue.Label%2A>、<xref:System.Messaging.MessageQueue.Category%2A>、および <xref:System.Messaging.MessageQueue.MachineName%2A>以外のメッセージ条件によってフィルター処理することもできます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1385">You can also filter by message criteria other than <xref:System.Messaging.MessageQueue.Label%2A>, <xref:System.Messaging.MessageQueue.Category%2A>, and <xref:System.Messaging.MessageQueue.MachineName%2A>.</span></span> <span data-ttu-id="f3a8c-1386">たとえば、このオーバーロードを使用して、キューの最終更新時刻でフィルター処理します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1386">For example, you use this overload to filter by a queue's last-modified time.</span></span> <span data-ttu-id="f3a8c-1387"><xref:System.Messaging.MessageQueueCriteria> クラスの新しいインスタンスを作成し、インスタンスの適切なプロパティを設定して、そのインスタンスを `criteria` パラメーターとして渡すだけです。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1387">Simply create a new instance of the <xref:System.Messaging.MessageQueueCriteria> class, set the appropriate properties in the instance, and pass the instance as the `criteria` parameter.</span></span>  
  
 <span data-ttu-id="f3a8c-1388"><xref:System.Messaging.MessageQueue.GetPublicQueues%2A> は、キューの静的スナップショットを取得します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1388"><xref:System.Messaging.MessageQueue.GetPublicQueues%2A> retrieves a static snapshot of the queues.</span></span> <span data-ttu-id="f3a8c-1389">キューの動的リストを操作するには、<xref:System.Messaging.MessageQueue.GetMessageQueueEnumerator%2A>を使用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1389">To interact with a dynamic list of the queues, use <xref:System.Messaging.MessageQueue.GetMessageQueueEnumerator%2A>.</span></span>  
  
 <span data-ttu-id="f3a8c-1390">次の表に、この方法をさまざまなワークグループモードで使用できるかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1390">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-1391">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1391">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-1392">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1392">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-1393">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1393">Local computer</span></span>|<span data-ttu-id="f3a8c-1394">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1394">No</span></span>|  
|<span data-ttu-id="f3a8c-1395">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1395">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-1396">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1396">No</span></span>|  
|<span data-ttu-id="f3a8c-1397">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1397">Remote computer</span></span>|<span data-ttu-id="f3a8c-1398">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1398">No</span></span>|  
|<span data-ttu-id="f3a8c-1399">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1399">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-1400">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1400">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-1401">次のコード例では、キューのリストを取得します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1401">The following code example retrieves lists of queues.</span></span>  
  
 [!code-cpp[MessageQueue.GetQueueLists#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.GetQueueLists/CPP/mqgetqueuelists.cpp#1)]
 [!code-csharp[MessageQueue.GetQueueLists#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.GetQueueLists/CS/mqgetqueuelists.cs#1)]
 [!code-vb[MessageQueue.GetQueueLists#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.GetQueueLists/VB/mqgetqueuelists.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="f3a8c-1402">メッセージ キューのメソッドにアクセスしたときにエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1402">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="T:System.Messaging.MessageQueueCriteria" />
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageQueueEnumerator" />
      </Docs>
    </Member>
    <Member MemberName="GetPublicQueuesByCategory">
      <MemberSignature Language="C#" Value="public static System.Messaging.MessageQueue[] GetPublicQueuesByCategory (Guid category);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Messaging.MessageQueue[] GetPublicQueuesByCategory(valuetype System.Guid category) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.GetPublicQueuesByCategory(System.Guid)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetPublicQueuesByCategory (category As Guid) As MessageQueue()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static cli::array &lt;System::Messaging::MessageQueue ^&gt; ^ GetPublicQueuesByCategory(Guid category);" />
      <MemberSignature Language="F#" Value="static member GetPublicQueuesByCategory : Guid -&gt; System.Messaging.MessageQueue[]" Usage="System.Messaging.MessageQueue.GetPublicQueuesByCategory category" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.MessageQueue[]</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="category" Type="System.Guid" />
      </Parameters>
      <Docs>
        <param name="category"><span data-ttu-id="f3a8c-1403">取得するキューのセットをグループ化する <see cref="T:System.Guid" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1403">A <see cref="T:System.Guid" /> that groups the set of queues to be retrieved.</span></span></param>
        <summary><span data-ttu-id="f3a8c-1404">指定したカテゴリに属するネットワーク上のすべてのパブリック キューを取得します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1404">Retrieves all the public queues on the network that belong to the specified category.</span></span></summary>
        <returns><span data-ttu-id="f3a8c-1405">取得したパブリック キューを参照する <see cref="T:System.Messaging.MessageQueue" /> オブジェクトの配列。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1405">An array of <see cref="T:System.Messaging.MessageQueue" /> objects that reference the retrieved public queues.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-1406">このメソッドを使用して、パブリックキューをカテゴリ別にフィルター処理します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1406">Use this method to filter the public queues by category.</span></span> <span data-ttu-id="f3a8c-1407"><xref:System.Messaging.MessageQueue.Category%2A> プロパティは、特定のキューの "メッセージキューの種類 ID" プロパティ (読み取り/書き込み) へのアクセスを提供します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1407">The <xref:System.Messaging.MessageQueue.Category%2A> property provides access to the Message Queuing type ID property (which is read/write) of a particular queue.</span></span> <span data-ttu-id="f3a8c-1408"><xref:System.Guid.NewGuid%2A> を使用して、すべての <xref:System.Guid> 値で一意のカテゴリ値を作成することもできますが、必須ではありません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1408">Although you can use <xref:System.Guid.NewGuid%2A> to create a category value that is unique across all <xref:System.Guid> values, it is not necessary.</span></span> <span data-ttu-id="f3a8c-1409">カテゴリ値は、他のすべての <xref:System.Guid> 値からではなく、他のカテゴリからのみ一意である必要があります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1409">The category value needs to be distinct only from other categories, not from all other <xref:System.Guid> values.</span></span> <span data-ttu-id="f3a8c-1410">たとえば、{00000000-0000-0000-0000-000000000001} を1つのキューセットの <xref:System.Messaging.MessageQueue.Category%2A> として、別のセットの <xref:System.Messaging.MessageQueue.Category%2A> として {00000000-0000-0000-0000-000000000002} を割り当てることができます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1410">For example, you can assign {00000000-0000-0000-0000-000000000001} as the <xref:System.Messaging.MessageQueue.Category%2A> for one set of queues and {00000000-0000-0000-0000-000000000002} as the <xref:System.Messaging.MessageQueue.Category%2A> for another set.</span></span>  
  
 <span data-ttu-id="f3a8c-1411"><xref:System.Messaging.MessageQueue.GetPublicQueuesByCategory%28System.Guid%29> は、キューの静的スナップショットを取得します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1411"><xref:System.Messaging.MessageQueue.GetPublicQueuesByCategory%28System.Guid%29> retrieves a static snapshot of the queues.</span></span> <span data-ttu-id="f3a8c-1412">キューの動的リストを操作するには、<xref:System.Messaging.MessageQueue.GetMessageQueueEnumerator%2A>を使用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1412">To interact with a dynamic list of the queues, use <xref:System.Messaging.MessageQueue.GetMessageQueueEnumerator%2A>.</span></span> <span data-ttu-id="f3a8c-1413">メソッドに渡す <xref:System.Messaging.MessageQueueCriteria> の一部として、カテゴリを指定できます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1413">You can specify the category as part of the <xref:System.Messaging.MessageQueueCriteria> you pass into the method.</span></span>  
  
 <span data-ttu-id="f3a8c-1414">次の表に、この方法をさまざまなワークグループモードで使用できるかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1414">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-1415">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1415">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-1416">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1416">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-1417">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1417">Local computer</span></span>|<span data-ttu-id="f3a8c-1418">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1418">No</span></span>|  
|<span data-ttu-id="f3a8c-1419">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1419">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-1420">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1420">No</span></span>|  
|<span data-ttu-id="f3a8c-1421">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1421">Remote computer</span></span>|<span data-ttu-id="f3a8c-1422">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1422">No</span></span>|  
|<span data-ttu-id="f3a8c-1423">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1423">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-1424">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1424">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-1425">次のコード例では、キューのリストを取得します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1425">The following code example retrieves lists of queues.</span></span>  
  
 [!code-cpp[MessageQueue.GetQueueLists#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.GetQueueLists/CPP/mqgetqueuelists.cpp#1)]
 [!code-csharp[MessageQueue.GetQueueLists#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.GetQueueLists/CS/mqgetqueuelists.cs#1)]
 [!code-vb[MessageQueue.GetQueueLists#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.GetQueueLists/VB/mqgetqueuelists.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="f3a8c-1426">メッセージ キューのメソッドにアクセスしたときにエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1426">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.Category" />
        <altmember cref="M:System.Messaging.MessageQueue.GetPublicQueues" />
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageQueueEnumerator" />
      </Docs>
    </Member>
    <Member MemberName="GetPublicQueuesByLabel">
      <MemberSignature Language="C#" Value="public static System.Messaging.MessageQueue[] GetPublicQueuesByLabel (string label);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Messaging.MessageQueue[] GetPublicQueuesByLabel(string label) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.GetPublicQueuesByLabel(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetPublicQueuesByLabel (label As String) As MessageQueue()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static cli::array &lt;System::Messaging::MessageQueue ^&gt; ^ GetPublicQueuesByLabel(System::String ^ label);" />
      <MemberSignature Language="F#" Value="static member GetPublicQueuesByLabel : string -&gt; System.Messaging.MessageQueue[]" Usage="System.Messaging.MessageQueue.GetPublicQueuesByLabel label" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.MessageQueue[]</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="label" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="label"><span data-ttu-id="f3a8c-1427">取得するキューのセットをグループ化するラベル。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1427">A label that groups the set of queues to be retrieved.</span></span></param>
        <summary><span data-ttu-id="f3a8c-1428">指定したラベルが設定されているネットワーク上のすべてのパブリック キューを取得します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1428">Retrieves all the public queues on the network that carry the specified label.</span></span></summary>
        <returns><span data-ttu-id="f3a8c-1429">取得したパブリック キューを参照する <see cref="T:System.Messaging.MessageQueue" /> オブジェクトの配列。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1429">An array of <see cref="T:System.Messaging.MessageQueue" /> objects that reference the retrieved public queues.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-1430">このメソッドを使用して、パブリックキューをラベルでフィルター処理します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1430">Use this method to filter the public queues by label.</span></span>  
  
 <span data-ttu-id="f3a8c-1431"><xref:System.Messaging.MessageQueue.GetPublicQueuesByLabel%28System.String%29> は、キューの静的スナップショットを取得します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1431"><xref:System.Messaging.MessageQueue.GetPublicQueuesByLabel%28System.String%29> retrieves a static snapshot of the queues.</span></span> <span data-ttu-id="f3a8c-1432">キューの動的リストを操作するには、<xref:System.Messaging.MessageQueue.GetMessageQueueEnumerator%2A>を使用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1432">To interact with a dynamic list of the queues, use <xref:System.Messaging.MessageQueue.GetMessageQueueEnumerator%2A>.</span></span> <span data-ttu-id="f3a8c-1433">メソッドに渡す <xref:System.Messaging.MessageQueueCriteria> の一部として、ラベルを指定できます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1433">You can specify the label as part of the <xref:System.Messaging.MessageQueueCriteria> you pass into the method.</span></span>  
  
 <span data-ttu-id="f3a8c-1434">次の表に、この方法をさまざまなワークグループモードで使用できるかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1434">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-1435">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1435">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-1436">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1436">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-1437">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1437">Local computer</span></span>|<span data-ttu-id="f3a8c-1438">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1438">No</span></span>|  
|<span data-ttu-id="f3a8c-1439">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1439">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-1440">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1440">No</span></span>|  
|<span data-ttu-id="f3a8c-1441">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1441">Remote computer</span></span>|<span data-ttu-id="f3a8c-1442">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1442">No</span></span>|  
|<span data-ttu-id="f3a8c-1443">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1443">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-1444">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1444">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-1445">次のコード例では、キューのリストを取得します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1445">The following code example retrieves lists of queues.</span></span>  
  
 [!code-cpp[MessageQueue.GetQueueLists#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.GetQueueLists/CPP/mqgetqueuelists.cpp#1)]
 [!code-csharp[MessageQueue.GetQueueLists#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.GetQueueLists/CS/mqgetqueuelists.cs#1)]
 [!code-vb[MessageQueue.GetQueueLists#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.GetQueueLists/VB/mqgetqueuelists.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="f3a8c-1446">メッセージ キューのメソッドにアクセスしたときにエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1446">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="f3a8c-1447"><paramref name="label" /> パラメーターが <see langword="null" /> です。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1447">The <paramref name="label" /> parameter is <see langword="null" />.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.Label" />
        <altmember cref="M:System.Messaging.MessageQueue.GetPublicQueues" />
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageQueueEnumerator" />
      </Docs>
    </Member>
    <Member MemberName="GetPublicQueuesByMachine">
      <MemberSignature Language="C#" Value="public static System.Messaging.MessageQueue[] GetPublicQueuesByMachine (string machineName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Messaging.MessageQueue[] GetPublicQueuesByMachine(string machineName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.GetPublicQueuesByMachine(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetPublicQueuesByMachine (machineName As String) As MessageQueue()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static cli::array &lt;System::Messaging::MessageQueue ^&gt; ^ GetPublicQueuesByMachine(System::String ^ machineName);" />
      <MemberSignature Language="F#" Value="static member GetPublicQueuesByMachine : string -&gt; System.Messaging.MessageQueue[]" Usage="System.Messaging.MessageQueue.GetPublicQueuesByMachine machineName" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.MessageQueue[]</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="machineName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="machineName"><span data-ttu-id="f3a8c-1448">取得するパブリック キューのセットが含まれているコンピューターの名前。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1448">The name of the computer that contains the set of public queues to be retrieved.</span></span></param>
        <summary><span data-ttu-id="f3a8c-1449">指定したコンピューターにあるすべてのパブリック キューを取得します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1449">Retrieves all the public queues that reside on the specified computer.</span></span></summary>
        <returns><span data-ttu-id="f3a8c-1450">コンピューターのパブリック キューを参照する <see cref="T:System.Messaging.MessageQueue" /> オブジェクトの配列。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1450">An array of <see cref="T:System.Messaging.MessageQueue" /> objects that reference the public queues on the computer.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-1451">このメソッドを使用して、コンピューター別にパブリックキューをフィルター処理します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1451">Use this method to filter the public queues by computer.</span></span>  
  
 <span data-ttu-id="f3a8c-1452"><xref:System.Messaging.MessageQueue.GetPublicQueuesByMachine%28System.String%29> は、キューの静的スナップショットを取得します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1452"><xref:System.Messaging.MessageQueue.GetPublicQueuesByMachine%28System.String%29> retrieves a static snapshot of the queues.</span></span> <span data-ttu-id="f3a8c-1453">キューの動的リストを操作するには、<xref:System.Messaging.MessageQueue.GetMessageQueueEnumerator%2A>を使用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1453">To interact with a dynamic list of the queues, use <xref:System.Messaging.MessageQueue.GetMessageQueueEnumerator%2A>.</span></span> <span data-ttu-id="f3a8c-1454">メソッドに渡す <xref:System.Messaging.MessageQueueCriteria> の一部として、コンピューター名を指定できます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1454">You can specify the computer name as part of the <xref:System.Messaging.MessageQueueCriteria> you pass into the method.</span></span>  
  
 <span data-ttu-id="f3a8c-1455">次の表に、この方法をさまざまなワークグループモードで使用できるかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1455">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-1456">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1456">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-1457">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1457">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-1458">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1458">Local computer</span></span>|<span data-ttu-id="f3a8c-1459">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1459">No</span></span>|  
|<span data-ttu-id="f3a8c-1460">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1460">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-1461">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1461">No</span></span>|  
|<span data-ttu-id="f3a8c-1462">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1462">Remote computer</span></span>|<span data-ttu-id="f3a8c-1463">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1463">No</span></span>|  
|<span data-ttu-id="f3a8c-1464">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1464">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-1465">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1465">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-1466">次のコード例では、キューのリストを取得します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1466">The following code example retrieves lists of queues.</span></span>  
  
 [!code-cpp[MessageQueue.GetQueueLists#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.GetQueueLists/CPP/mqgetqueuelists.cpp#1)]
 [!code-csharp[MessageQueue.GetQueueLists#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.GetQueueLists/CS/mqgetqueuelists.cs#1)]
 [!code-vb[MessageQueue.GetQueueLists#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.GetQueueLists/VB/mqgetqueuelists.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="f3a8c-1467"><paramref name="machineName" /> パラメーターの構文が正しくありません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1467">The <paramref name="machineName" /> parameter has incorrect syntax.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="f3a8c-1468">メッセージ キューのメソッドにアクセスしたときにエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1468">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.MachineName" />
        <altmember cref="M:System.Messaging.MessageQueue.GetPublicQueues" />
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageQueueEnumerator" />
      </Docs>
    </Member>
    <Member MemberName="GetSecurityContext">
      <MemberSignature Language="C#" Value="public static System.Messaging.SecurityContext GetSecurityContext ();" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Messaging.SecurityContext GetSecurityContext() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.GetSecurityContext" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetSecurityContext () As SecurityContext" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::Messaging::SecurityContext ^ GetSecurityContext();" />
      <MemberSignature Language="F#" Value="static member GetSecurityContext : unit -&gt; System.Messaging.SecurityContext" Usage="System.Messaging.MessageQueue.GetSecurityContext " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.SecurityContext</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="f3a8c-1469">この呼び出しの時点で現在のユーザーが MSMQ によって関連付けられているセキュリティ コンテキスト (スレッド ID) を取得します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1469">Retrieves the security context that MSMQ associates with the current user (thread identity) at the time of this call.</span></span></summary>
        <returns><span data-ttu-id="f3a8c-1470">セキュリティ コンテキストを格納している <see cref="T:System.Messaging.SecurityContext" /> オブジェクト。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1470">A <see cref="T:System.Messaging.SecurityContext" /> object that contains the security context.</span></span></returns>
        <remarks>To be added.</remarks>
        <altmember cref="P:System.Messaging.Message.SecurityContext" />
      </Docs>
    </Member>
    <Member MemberName="Id">
      <MemberSignature Language="C#" Value="public Guid Id { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance valuetype System.Guid Id" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.Id" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property Id As Guid" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property Guid Id { Guid get(); };" />
      <MemberSignature Language="F#" Value="member this.Id : Guid" Usage="System.Messaging.MessageQueue.Id" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_GuidId")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Guid</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="f3a8c-1471">キューの一意なメッセージ キュー ID を取得します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1471">Gets the unique Message Queuing identifier of the queue.</span></span></summary>
        <value><span data-ttu-id="f3a8c-1472">メッセージ キュー アプリケーションが生成したメッセージ ID を表す <see cref="P:System.Messaging.MessageQueue.Id" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1472">A <see cref="P:System.Messaging.MessageQueue.Id" /> that represents the message identifier generated by the Message Queuing application.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-1473">メッセージキューは、キューの作成時に <xref:System.Messaging.MessageQueue.Id%2A> プロパティを設定します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1473">Message Queuing sets the <xref:System.Messaging.MessageQueue.Id%2A> property when it creates the queue.</span></span> <span data-ttu-id="f3a8c-1474">このプロパティは、パブリックキューでのみ使用できます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1474">This property is only available for public queues.</span></span>  
  
 <span data-ttu-id="f3a8c-1475">次の表は、このプロパティがさまざまなワークグループモードで使用できるかどうかを示しています。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1475">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-1476">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1476">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-1477">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1477">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-1478">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1478">Local computer</span></span>|<span data-ttu-id="f3a8c-1479">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1479">Yes</span></span>|  
|<span data-ttu-id="f3a8c-1480">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1480">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-1481">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1481">Yes</span></span>|  
|<span data-ttu-id="f3a8c-1482">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1482">Remote computer</span></span>|<span data-ttu-id="f3a8c-1483">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1483">No</span></span>|  
|<span data-ttu-id="f3a8c-1484">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1484">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-1485">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1485">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-1486">次のコード例では、メッセージキューの <xref:System.Messaging.MessageQueue.Id%2A> プロパティの値を表示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1486">The following code example displays the value of a message queue's <xref:System.Messaging.MessageQueue.Id%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#15](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#15)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="f3a8c-1487">メッセージ キューのメソッドにアクセスしたときにエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1487">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.Category" />
      </Docs>
    </Member>
    <Member MemberName="InfiniteQueueSize">
      <MemberSignature Language="C#" Value="public static readonly long InfiniteQueueSize;" />
      <MemberSignature Language="ILAsm" Value=".field public static initonly int64 InfiniteQueueSize" />
      <MemberSignature Language="DocId" Value="F:System.Messaging.MessageQueue.InfiniteQueueSize" />
      <MemberSignature Language="VB.NET" Value="Public Shared ReadOnly InfiniteQueueSize As Long " />
      <MemberSignature Language="C++ CLI" Value="public: static initonly long InfiniteQueueSize;" />
      <MemberSignature Language="F#" Value=" staticval mutable InfiniteQueueSize : int64" Usage="System.Messaging.MessageQueue.InfiniteQueueSize" />
      <MemberType>Field</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int64</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="f3a8c-1488">キューにサイズ制限が存在しないことを示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1488">Specifies that no size restriction exists for a queue.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-1489">このメンバーは、<xref:System.Messaging.MessageQueue.MaximumJournalSize%2A> または <xref:System.Messaging.MessageQueue.MaximumQueueSize%2A>を設定するときによく使用されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1489">This member is frequently used when setting <xref:System.Messaging.MessageQueue.MaximumJournalSize%2A> or <xref:System.Messaging.MessageQueue.MaximumQueueSize%2A>.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-1490">次のコード例は、<xref:System.Messaging.MessageQueue.InfiniteQueueSize> メンバーの使用方法を示しています。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1490">The following code example demonstrates the use of the <xref:System.Messaging.MessageQueue.InfiniteQueueSize> member.</span></span>  
  
 [!code-csharp[MessageQueue#16](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#16)]  
  
 ]]></format>
        </remarks>
        <altmember cref="P:System.Messaging.MessageQueue.MaximumJournalSize" />
        <altmember cref="P:System.Messaging.MessageQueue.MaximumQueueSize" />
      </Docs>
    </Member>
    <Member MemberName="InfiniteTimeout">
      <MemberSignature Language="C#" Value="public static readonly TimeSpan InfiniteTimeout;" />
      <MemberSignature Language="ILAsm" Value=".field public static initonly valuetype System.TimeSpan InfiniteTimeout" />
      <MemberSignature Language="DocId" Value="F:System.Messaging.MessageQueue.InfiniteTimeout" />
      <MemberSignature Language="VB.NET" Value="Public Shared ReadOnly InfiniteTimeout As TimeSpan " />
      <MemberSignature Language="C++ CLI" Value="public: static initonly TimeSpan InfiniteTimeout;" />
      <MemberSignature Language="F#" Value=" staticval mutable InfiniteTimeout : TimeSpan" Usage="System.Messaging.MessageQueue.InfiniteTimeout" />
      <MemberType>Field</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.TimeSpan</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="f3a8c-1491">メッセージをピークまたは受信するメソッドにタイムアウトが存在しないことを示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1491">Specifies that no time-out exists for methods that peek or receive messages.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-1492"><xref:System.Messaging.MessageQueue> では、同期と非同期の2種類のメッセージ取得がサポートされています。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1492"><xref:System.Messaging.MessageQueue> supports two types of message retrieval: synchronous and asynchronous.</span></span> <span data-ttu-id="f3a8c-1493">同期メソッドである <xref:System.Messaging.MessageQueue.Peek%2A> と <xref:System.Messaging.MessageQueue.Receive%2A>により、プロセススレッドは、新しいメッセージがキューに到着するまで、指定された時間間隔待機します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1493">The synchronous methods, <xref:System.Messaging.MessageQueue.Peek%2A> and <xref:System.Messaging.MessageQueue.Receive%2A>, cause the process thread to wait a specified time interval for a new message to arrive in the queue.</span></span> <span data-ttu-id="f3a8c-1494">指定した時間間隔が <xref:System.Messaging.MessageQueue.InfiniteTimeout>場合、新しいメッセージが使用可能になるまで、プロセススレッドはブロックされたままになります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1494">If the specified time interval is <xref:System.Messaging.MessageQueue.InfiniteTimeout>, the process thread remains blocked until a new message is available.</span></span> <span data-ttu-id="f3a8c-1495">一方、<xref:System.Messaging.MessageQueue.BeginPeek%2A> と <xref:System.Messaging.MessageQueue.BeginReceive%2A> (非同期メソッド) を使用すると、メッセージがキューに到着するまで、メインアプリケーションタスクが別のスレッドで続行されるようにすることができます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1495">On the other hand, <xref:System.Messaging.MessageQueue.BeginPeek%2A> and <xref:System.Messaging.MessageQueue.BeginReceive%2A> (the asynchronous methods), allow the main application tasks to continue in a separate thread until a message arrives in the queue.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-1496">次のコード例は、<xref:System.Messaging.MessageQueue.InfiniteTimeout> メンバーの使用方法を示しています。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1496">The following code example demonstrates the use of the <xref:System.Messaging.MessageQueue.InfiniteTimeout> member.</span></span>  
  
 [!code-csharp[MessageQueue#17](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#17)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="Label">
      <MemberSignature Language="C#" Value="public string Label { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string Label" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.Label" />
      <MemberSignature Language="VB.NET" Value="Public Property Label As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ Label { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberSignature Language="F#" Value="member this.Label : string with get, set" Usage="System.Messaging.MessageQueue.Label" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_Label")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="f3a8c-1497">キューの説明を取得または設定します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1497">Gets or sets the queue description.</span></span></summary>
        <value><span data-ttu-id="f3a8c-1498">メッセージ キューのラベル。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1498">The label for the message queue.</span></span> <span data-ttu-id="f3a8c-1499">既定値は、空の文字列 ("") です。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1499">The default is an empty string ("").</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-1500">メッセージキューラベルの最大長は124文字です。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1500">The maximum length of a message queue label is 124 characters.</span></span>  
  
 <span data-ttu-id="f3a8c-1501"><xref:System.Messaging.MessageQueue.Label%2A> プロパティは、すべてのキューで一意である必要はありません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1501">The <xref:System.Messaging.MessageQueue.Label%2A> property does not need to be unique across all queues.</span></span> <span data-ttu-id="f3a8c-1502">ただし、複数のキューが同じ <xref:System.Messaging.MessageQueue.Label%2A>を共有している場合は、<xref:System.Messaging.MessageQueue.Send%28System.Object%29> メソッドを使用して、そのすべてにメッセージをブロードキャストすることはできません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1502">However, if multiple queues share the same <xref:System.Messaging.MessageQueue.Label%2A>, you cannot use the <xref:System.Messaging.MessageQueue.Send%28System.Object%29> method to broadcast a message to all of them.</span></span> <span data-ttu-id="f3a8c-1503">メッセージを送信するときに <xref:System.Messaging.MessageQueue.Path%2A> プロパティのラベル構文を使用すると、<xref:System.Messaging.MessageQueue.Label%2A> が一意でない場合に例外がスローされます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1503">If you use the label syntax for the <xref:System.Messaging.MessageQueue.Path%2A> property when you send the message, an exception will be thrown if the <xref:System.Messaging.MessageQueue.Label%2A> is not unique.</span></span>  
  
 <span data-ttu-id="f3a8c-1504">次の表は、このプロパティがさまざまなワークグループモードで使用できるかどうかを示しています。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1504">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-1505">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1505">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-1506">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1506">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-1507">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1507">Local computer</span></span>|<span data-ttu-id="f3a8c-1508">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1508">Yes</span></span>|  
|<span data-ttu-id="f3a8c-1509">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1509">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-1510">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1510">Yes</span></span>|  
|<span data-ttu-id="f3a8c-1511">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1511">Remote computer</span></span>|<span data-ttu-id="f3a8c-1512">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1512">No</span></span>|  
|<span data-ttu-id="f3a8c-1513">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1513">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-1514">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1514">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-1515">次のコード例では、メッセージキューの <xref:System.Messaging.MessageQueue.Label%2A> プロパティの値を取得して設定します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1515">The following code example gets and sets the value of a message queue's <xref:System.Messaging.MessageQueue.Label%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#18](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#18)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="f3a8c-1516">ラベルが無効な値が設定されています。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1516">The label was set to an invalid value.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="f3a8c-1517">メッセージ キューのメソッドにアクセスしたときにエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1517">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.Path" />
        <altmember cref="P:System.Messaging.MessageQueue.FormatName" />
        <altmember cref="M:System.Messaging.MessageQueue.GetPublicQueues" />
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageQueueEnumerator" />
      </Docs>
    </Member>
    <Member MemberName="LastModifyTime">
      <MemberSignature Language="C#" Value="public DateTime LastModifyTime { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance valuetype System.DateTime LastModifyTime" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.LastModifyTime" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property LastModifyTime As DateTime" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property DateTime LastModifyTime { DateTime get(); };" />
      <MemberSignature Language="F#" Value="member this.LastModifyTime : DateTime" Usage="System.Messaging.MessageQueue.LastModifyTime" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_LastModifyTime")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.DateTime</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="f3a8c-1518">キューのプロパティが最後に変更された時刻を取得します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1518">Gets the last time the properties of a queue were modified.</span></span></summary>
        <value><span data-ttu-id="f3a8c-1519">キューのプロパティが最後に変更された時刻を示す <see cref="T:System.DateTime" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1519">A <see cref="T:System.DateTime" /> that indicates when the queue properties were last modified.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-1520">最後の変更時刻には、キューが作成された日時と、メッセージキューのキューを変更する <xref:System.Messaging.MessageQueue> プロパティ (<xref:System.Messaging.MessageQueue.BasePriority%2A>など) が含まれます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1520">The last modification time includes when the queue was created and any <xref:System.Messaging.MessageQueue> property that modifies the Message Queuing queue, such as <xref:System.Messaging.MessageQueue.BasePriority%2A>.</span></span> <span data-ttu-id="f3a8c-1521"><xref:System.Messaging.MessageQueue.LastModifyTime%2A> プロパティの値は、ローカルコンピューターのシステム時刻を表します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1521">The value of the <xref:System.Messaging.MessageQueue.LastModifyTime%2A> property represents the system time of the local computer.</span></span>  
  
 <span data-ttu-id="f3a8c-1522"><xref:System.Messaging.MessageQueue.LastModifyTime%2A> プロパティを取得する前に、<xref:System.Messaging.MessageQueue.Refresh%2A> を呼び出す必要があります。それ以外の場合、この <xref:System.Messaging.MessageQueue> に関連付けられている変更時間は最新ではない可能性があります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1522">You must call <xref:System.Messaging.MessageQueue.Refresh%2A> before getting the <xref:System.Messaging.MessageQueue.LastModifyTime%2A> property; otherwise, the modification time associated with this <xref:System.Messaging.MessageQueue> might not be current.</span></span>  
  
 <span data-ttu-id="f3a8c-1523">次の表は、このプロパティがさまざまなワークグループモードで使用できるかどうかを示しています。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1523">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-1524">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1524">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-1525">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1525">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-1526">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1526">Local computer</span></span>|<span data-ttu-id="f3a8c-1527">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1527">Yes</span></span>|  
|<span data-ttu-id="f3a8c-1528">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1528">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-1529">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1529">Yes</span></span>|  
|<span data-ttu-id="f3a8c-1530">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1530">Remote computer</span></span>|<span data-ttu-id="f3a8c-1531">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1531">No</span></span>|  
|<span data-ttu-id="f3a8c-1532">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1532">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-1533">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1533">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-1534">次のコード例では、メッセージキューの <xref:System.Messaging.MessageQueue.LastModifyTime%2A> プロパティの値を表示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1534">The following code example displays the value of a message queue's <xref:System.Messaging.MessageQueue.LastModifyTime%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#19](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#19)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="f3a8c-1535">メッセージ キューのメソッドにアクセスしたときにエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1535">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.CreateTime" />
        <altmember cref="P:System.Messaging.MessageQueue.DenySharedReceive" />
      </Docs>
    </Member>
    <Member MemberName="MachineName">
      <MemberSignature Language="C#" Value="public string MachineName { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string MachineName" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.MachineName" />
      <MemberSignature Language="VB.NET" Value="Public Property MachineName As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ MachineName { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberSignature Language="F#" Value="member this.MachineName : string with get, set" Usage="System.Messaging.MessageQueue.MachineName" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_MachineName")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="f3a8c-1536">メッセージ キューのキューが存在するコンピューターの名前を取得または設定します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1536">Gets or sets the name of the computer where the Message Queuing queue is located.</span></span></summary>
        <value><span data-ttu-id="f3a8c-1537">キューが存在するコンピューターの名前。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1537">The name of the computer where the queue is located.</span></span> <span data-ttu-id="f3a8c-1538">メッセージ キューの既定値は、ローカル コンピューターを表す "." です。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1538">The Message Queuing default is ".", the local computer.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-1539"><xref:System.Messaging.MessageQueue.MachineName%2A> は、キュー <xref:System.Messaging.MessageQueue.Path%2A>のフレンドリ名構文の整数部分です。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1539">The <xref:System.Messaging.MessageQueue.MachineName%2A> is an integral component of the friendly name syntax of the queue <xref:System.Messaging.MessageQueue.Path%2A>.</span></span> <span data-ttu-id="f3a8c-1540">次の表は、表示名を使用してキューのパスを識別する場合に、指定した種類のキューに使用する構文を示しています。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1540">The following table shows the syntax you should use for a queue of a specified type when you want to identify the queue path using its friendly name.</span></span>  
  
|<span data-ttu-id="f3a8c-1541">[キューの種類]</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1541">Queue type</span></span>|<span data-ttu-id="f3a8c-1542">構文</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1542">Syntax</span></span>|  
|----------------|------------|  
|<span data-ttu-id="f3a8c-1543">パブリックキュー</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1543">Public queue</span></span>|`MachineName`\\`QueueName`|  
|<span data-ttu-id="f3a8c-1544">専用キュー</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1544">Private queue</span></span>|`MachineName`\\`Private$`\\`QueueName`|  
|<span data-ttu-id="f3a8c-1545">ジャーナル キュー</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1545">Journal queue</span></span>|`MachineName`\\`QueueName`\\`Journal$`|  
|<span data-ttu-id="f3a8c-1546">マシンジャーナルキュー</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1546">Machine journal queue</span></span>|`MachineName`\\`Journal$`|  
|<span data-ttu-id="f3a8c-1547">コンピューターの配信不能キュー</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1547">Machine dead-letter queue</span></span>|`MachineName`\\`Deadletter$`|  
|<span data-ttu-id="f3a8c-1548">コンピュータートランザクション配信不能キュー</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1548">Machine transactional dead-letter queue</span></span>|`MachineName`\\`XactDeadletter$`|  
  
 <span data-ttu-id="f3a8c-1549"><xref:System.Messaging.MessageQueue.MachineName%2A>を指定する場合は、ローカルコンピューターに "." を使用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1549">Use "." for the local computer when specifying the <xref:System.Messaging.MessageQueue.MachineName%2A>.</span></span> <span data-ttu-id="f3a8c-1550">このプロパティでは、コンピューター名のみが認識されます (たとえば、`Server0`)。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1550">Only the computer name is recognized for this property, for example, `Server0`.</span></span> <span data-ttu-id="f3a8c-1551"><xref:System.Messaging.MessageQueue.MachineName%2A> プロパティは、IP アドレス形式をサポートしていません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1551">The <xref:System.Messaging.MessageQueue.MachineName%2A> property does not support the IP address format.</span></span>  
  
 <span data-ttu-id="f3a8c-1552"><xref:System.Messaging.MessageQueue.MachineName%2A>の観点から <xref:System.Messaging.MessageQueue.Path%2A> を定義すると、パス変換にドメインコントローラーが必要になるため、アプリケーションはオフラインで作業しているときに例外をスローします。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1552">If you define the <xref:System.Messaging.MessageQueue.Path%2A> in terms of the <xref:System.Messaging.MessageQueue.MachineName%2A>, the application throws an exception when working offline because the domain controller is required for path translation.</span></span> <span data-ttu-id="f3a8c-1553">そのため、オフラインで作業する場合は、<xref:System.Messaging.MessageQueue.Path%2A> 構文に <xref:System.Messaging.MessageQueue.FormatName%2A> を使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1553">Therefore, you must use the <xref:System.Messaging.MessageQueue.FormatName%2A> for the <xref:System.Messaging.MessageQueue.Path%2A> syntax when working offline.</span></span>  
  
 <span data-ttu-id="f3a8c-1554"><xref:System.Messaging.MessageQueue.MachineName%2A>、<xref:System.Messaging.MessageQueue.Path%2A>、および <xref:System.Messaging.MessageQueue.QueueName%2A> の各プロパティが関連付けられています。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1554">The <xref:System.Messaging.MessageQueue.MachineName%2A>, <xref:System.Messaging.MessageQueue.Path%2A>, and <xref:System.Messaging.MessageQueue.QueueName%2A> properties are related.</span></span> <span data-ttu-id="f3a8c-1555"><xref:System.Messaging.MessageQueue.MachineName%2A> プロパティを変更すると、<xref:System.Messaging.MessageQueue.Path%2A> プロパティが変更されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1555">Changing the <xref:System.Messaging.MessageQueue.MachineName%2A> property causes the <xref:System.Messaging.MessageQueue.Path%2A> property to change.</span></span> <span data-ttu-id="f3a8c-1556">これは、新しい <xref:System.Messaging.MessageQueue.MachineName%2A> と <xref:System.Messaging.MessageQueue.QueueName%2A>から構築されています。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1556">It is built from the new <xref:System.Messaging.MessageQueue.MachineName%2A> and the <xref:System.Messaging.MessageQueue.QueueName%2A>.</span></span> <span data-ttu-id="f3a8c-1557"><xref:System.Messaging.MessageQueue.Path%2A> を変更する (たとえば、形式名の構文を使用する) と、<xref:System.Messaging.MessageQueue.MachineName%2A> と <xref:System.Messaging.MessageQueue.QueueName%2A> のプロパティが新しいキューを参照するようにリセットされます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1557">Changing the <xref:System.Messaging.MessageQueue.Path%2A> (for example, to use the format name syntax) resets the <xref:System.Messaging.MessageQueue.MachineName%2A> and <xref:System.Messaging.MessageQueue.QueueName%2A> properties to refer to the new queue.</span></span> <span data-ttu-id="f3a8c-1558"><xref:System.Messaging.MessageQueue.QueueName%2A> プロパティが空の場合、<xref:System.Messaging.MessageQueue.Path%2A> は指定したコンピューターのジャーナルキューに設定されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1558">If the <xref:System.Messaging.MessageQueue.QueueName%2A> property is empty, the <xref:System.Messaging.MessageQueue.Path%2A> is set to the Journal queue of the computer you specify.</span></span>  
  
 <span data-ttu-id="f3a8c-1559">次の表は、このプロパティがさまざまなワークグループモードで使用できるかどうかを示しています。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1559">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-1560">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1560">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-1561">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1561">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-1562">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1562">Local computer</span></span>|<span data-ttu-id="f3a8c-1563">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1563">Yes</span></span>|  
|<span data-ttu-id="f3a8c-1564">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1564">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-1565">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1565">Yes</span></span>|  
|<span data-ttu-id="f3a8c-1566">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1566">Remote computer</span></span>|<span data-ttu-id="f3a8c-1567">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1567">Yes</span></span>|  
|<span data-ttu-id="f3a8c-1568">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1568">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-1569">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1569">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-1570">次のコード例では、メッセージキューの <xref:System.Messaging.MessageQueue.MachineName%2A> プロパティの値を取得して設定します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1570">The following code example gets and sets the value of a message queue's <xref:System.Messaging.MessageQueue.MachineName%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#20](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#20)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="f3a8c-1571"><see cref="P:System.Messaging.MessageQueue.MachineName" /> が <see langword="null" /> です。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1571">The <see cref="P:System.Messaging.MessageQueue.MachineName" /> is <see langword="null" />.</span></span>        
<span data-ttu-id="f3a8c-1572">- または -</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1572">-or-</span></span>

<span data-ttu-id="f3a8c-1573">コンピューター名が無効です。構文が間違っているためと考えられます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1573">The name of the computer is not valid, possibly because the syntax is incorrect.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="f3a8c-1574">メッセージ キューのメソッドにアクセスしたときにエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1574">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.QueueName" />
        <altmember cref="P:System.Messaging.MessageQueue.Path" />
        <altmember cref="P:System.Messaging.MessageQueue.FormatName" />
        <altmember cref="M:System.Messaging.MessageQueue.GetPublicQueues" />
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageQueueEnumerator" />
      </Docs>
    </Member>
    <Member MemberName="MaximumJournalSize">
      <MemberSignature Language="C#" Value="public long MaximumJournalSize { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance int64 MaximumJournalSize" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.MaximumJournalSize" />
      <MemberSignature Language="VB.NET" Value="Public Property MaximumJournalSize As Long" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property long MaximumJournalSize { long get(); void set(long value); };" />
      <MemberSignature Language="F#" Value="member this.MaximumJournalSize : int64 with get, set" Usage="System.Messaging.MessageQueue.MaximumJournalSize" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_MaximumJournalSize")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.ComponentModel.TypeConverter(typeof(System.Messaging.Design.SizeConverter))</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Int64</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="f3a8c-1575">履歴キューの最大サイズを取得または設定します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1575">Gets or sets the maximum size of the journal queue.</span></span></summary>
        <value><span data-ttu-id="f3a8c-1576">履歴キューの最大サイズ。単位は KB です。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1576">The maximum size, in kilobytes, of the journal queue.</span></span> <span data-ttu-id="f3a8c-1577">メッセージ キューの既定値は、制限なしです。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1577">The Message Queuing default specifies that no limit exists.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-1578"><xref:System.Messaging.MessageQueue.MaximumJournalSize%2A> を使用すると、メッセージキュージャーナルの記憶域の制限にアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1578"><xref:System.Messaging.MessageQueue.MaximumJournalSize%2A> provides access to the Message Queuing journal storage limit.</span></span> <span data-ttu-id="f3a8c-1579"><xref:System.Messaging.MessageQueue.UseJournalQueue%2A> が `true`場合にのみ関連します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1579">It is relevant only when <xref:System.Messaging.MessageQueue.UseJournalQueue%2A> is `true`.</span></span> <span data-ttu-id="f3a8c-1580">このプロパティを設定すると、メッセージキューのキューが変更されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1580">Setting this property modifies the Message Queuing queue.</span></span> <span data-ttu-id="f3a8c-1581">そのため、その他の <xref:System.Messaging.MessageQueue> インスタンスは変更の影響を受けます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1581">Therefore, any other <xref:System.Messaging.MessageQueue> instances are affected by the change</span></span>  
  
 <span data-ttu-id="f3a8c-1582">メッセージをジャーナルまたは配信不能キューに格納する場合は、不要になったメッセージを削除するために、定期的にキューをクリアする必要があります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1582">If you store messages in a journal or dead-letter queue, you should periodically clear the queue to remove messages that are no longer needed.</span></span> <span data-ttu-id="f3a8c-1583">このようなキュー内のメッセージは、キューが存在するコンピューターのメッセージクォータにカウントされます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1583">Messages in such a queue count toward the message quota for the computer where the queue resides.</span></span> <span data-ttu-id="f3a8c-1584">(管理者は、コンピューターのクォータを設定します)。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1584">(The administrator sets the computer quota.)</span></span>  
  
 <span data-ttu-id="f3a8c-1585">次の表は、このプロパティがさまざまなワークグループモードで使用できるかどうかを示しています。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1585">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-1586">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1586">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-1587">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1587">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-1588">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1588">Local computer</span></span>|<span data-ttu-id="f3a8c-1589">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1589">Yes</span></span>|  
|<span data-ttu-id="f3a8c-1590">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1590">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-1591">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1591">Yes</span></span>|  
|<span data-ttu-id="f3a8c-1592">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1592">Remote computer</span></span>|<span data-ttu-id="f3a8c-1593">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1593">No</span></span>|  
|<span data-ttu-id="f3a8c-1594">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1594">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-1595">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1595">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-1596">次のコード例では、メッセージキューの <xref:System.Messaging.MessageQueue.MaximumJournalSize%2A> プロパティの値を取得して設定します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1596">The following code example gets and sets the value of a message queue's <xref:System.Messaging.MessageQueue.MaximumJournalSize%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#21](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#21)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="f3a8c-1597">最大履歴キューサイズに無効な値が設定されています。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1597">The maximum journal queue size was set to an invalid value.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="f3a8c-1598">メッセージ キューのメソッドにアクセスしたときにエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1598">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.UseJournalQueue" />
        <altmember cref="P:System.Messaging.MessageQueue.MaximumQueueSize" />
        <altmember cref="F:System.Messaging.MessageQueue.InfiniteQueueSize" />
      </Docs>
    </Member>
    <Member MemberName="MaximumQueueSize">
      <MemberSignature Language="C#" Value="public long MaximumQueueSize { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance int64 MaximumQueueSize" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.MaximumQueueSize" />
      <MemberSignature Language="VB.NET" Value="Public Property MaximumQueueSize As Long" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property long MaximumQueueSize { long get(); void set(long value); };" />
      <MemberSignature Language="F#" Value="member this.MaximumQueueSize : int64 with get, set" Usage="System.Messaging.MessageQueue.MaximumQueueSize" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_MaximumQueueSize")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.ComponentModel.TypeConverter(typeof(System.Messaging.Design.SizeConverter))</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Int64</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="f3a8c-1599">キューの最大サイズを取得または設定します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1599">Gets or sets the maximum size of the queue.</span></span></summary>
        <value><span data-ttu-id="f3a8c-1600">キューの最大サイズ。単位は KB です。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1600">The maximum size, in kilobytes, of the queue.</span></span> <span data-ttu-id="f3a8c-1601">メッセージ キューの既定値は、制限なしです。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1601">The Message Queuing default specifies that no limit exists.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-1602"><xref:System.Messaging.MessageQueue.MaximumQueueSize%2A> では、管理者が定義したコンピューターのメッセージクォータとは別の、メッセージキューメッセージの記憶域の制限にアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1602">The <xref:System.Messaging.MessageQueue.MaximumQueueSize%2A> provides access to the Message Queuing message storage limit, which is separate from the computer's message quota that the administrator defines.</span></span> <span data-ttu-id="f3a8c-1603">メッセージクォータの詳細については、「<xref:System.Messaging.MessageQueue.MaximumJournalSize%2A>」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1603">For more information about the message quota, see <xref:System.Messaging.MessageQueue.MaximumJournalSize%2A>.</span></span>  
  
 <span data-ttu-id="f3a8c-1604">このプロパティを設定すると、メッセージキューのキューが変更されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1604">Setting this property modifies the Message Queuing queue.</span></span> <span data-ttu-id="f3a8c-1605">そのため、その他の <xref:System.Messaging.MessageQueue> インスタンスは変更の影響を受けます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1605">Therefore, any other <xref:System.Messaging.MessageQueue> instances are affected by the change</span></span>  
  
 <span data-ttu-id="f3a8c-1606">最大キューサイズまたはコンピューターメッセージクォータを超える試行が行われた場合、メッセージが失われる可能性があります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1606">If an attempt is made to exceed either the maximum queue size or the computer message quota, messages might be lost.</span></span> <span data-ttu-id="f3a8c-1607">キュークォータに達すると、メッセージキューは、送信元アプリケーションの管理キューに、否定受信確認メッセージを返すことによってキューがいっぱいであることを通知します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1607">When the queue quota is reached, Message Queuing notifies the administration queue of the sending application to indicate that the queue is full, by returning a negative acknowledgment message.</span></span> <span data-ttu-id="f3a8c-1608">キュー内のメッセージの合計サイズが制限を下回るまで、メッセージキューは否定受信確認を送信し続けます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1608">Message Queuing continues to send negative acknowledgments until the total size of the messages in the queue drops below the limit.</span></span>  
  
 <span data-ttu-id="f3a8c-1609">次の表は、このプロパティがさまざまなワークグループモードで使用できるかどうかを示しています。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1609">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-1610">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1610">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-1611">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1611">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-1612">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1612">Local computer</span></span>|<span data-ttu-id="f3a8c-1613">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1613">Yes</span></span>|  
|<span data-ttu-id="f3a8c-1614">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1614">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-1615">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1615">Yes</span></span>|  
|<span data-ttu-id="f3a8c-1616">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1616">Remote computer</span></span>|<span data-ttu-id="f3a8c-1617">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1617">No</span></span>|  
|<span data-ttu-id="f3a8c-1618">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1618">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-1619">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1619">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-1620">次のコード例では、メッセージキューの <xref:System.Messaging.MessageQueue.MaximumQueueSize%2A> プロパティの値を取得して設定します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1620">The following code example gets and sets the value of a message queue's <xref:System.Messaging.MessageQueue.MaximumQueueSize%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#22](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#22)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="f3a8c-1621">最大キューサイズに負の値が含まれています。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1621">The maximum queue size contains a negative value.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="f3a8c-1622">メッセージ キューのメソッドにアクセスしたときにエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1622">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.MaximumJournalSize" />
        <altmember cref="F:System.Messaging.MessageQueue.InfiniteQueueSize" />
      </Docs>
    </Member>
    <Member MemberName="MessageReadPropertyFilter">
      <MemberSignature Language="C#" Value="public System.Messaging.MessagePropertyFilter MessageReadPropertyFilter { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class System.Messaging.MessagePropertyFilter MessageReadPropertyFilter" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.MessageReadPropertyFilter" />
      <MemberSignature Language="VB.NET" Value="Public Property MessageReadPropertyFilter As MessagePropertyFilter" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Messaging::MessagePropertyFilter ^ MessageReadPropertyFilter { System::Messaging::MessagePropertyFilter ^ get(); void set(System::Messaging::MessagePropertyFilter ^ value); };" />
      <MemberSignature Language="F#" Value="member this.MessageReadPropertyFilter : System.Messaging.MessagePropertyFilter with get, set" Usage="System.Messaging.MessageQueue.MessageReadPropertyFilter" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_MessageReadPropertyFilter")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Content)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Messaging.MessagePropertyFilter</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="f3a8c-1623">メッセージの受信またはピークに使用するプロパティ フィルターを取得または設定します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1623">Gets or sets the property filter for receiving or peeking messages.</span></span></summary>
        <value><span data-ttu-id="f3a8c-1624">メッセージごとに受信またはピークするプロパティのセットをフィルター処理するためにキューが使用する <see cref="T:System.Messaging.MessagePropertyFilter" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1624">The <see cref="T:System.Messaging.MessagePropertyFilter" /> used by the queue to filter the set of properties it receives or peeks for each message.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-1625">このフィルターは、<xref:System.Messaging.MessageQueue> が受信またはピークするメッセージプロパティを制限するブール値のセットです。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1625">This filter is a set of Boolean values restricting the message properties that the <xref:System.Messaging.MessageQueue> receives or peeks.</span></span> <span data-ttu-id="f3a8c-1626"><xref:System.Messaging.MessageQueue> は、サーバーキューからメッセージを受信またはピークするときに、<xref:System.Messaging.MessageQueue.MessageReadPropertyFilter%2A> 値が `true`されているプロパティのみを取得します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1626">When the <xref:System.Messaging.MessageQueue> receives or peeks a message from the server queue, it retrieves only those properties for which the <xref:System.Messaging.MessageQueue.MessageReadPropertyFilter%2A> value is `true`.</span></span>  
  
 <span data-ttu-id="f3a8c-1627"><xref:System.Messaging.MessageQueue.MessageReadPropertyFilter%2A> プロパティの初期プロパティ値を次に示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1627">The following shows initial property values for the <xref:System.Messaging.MessageQueue.MessageReadPropertyFilter%2A> property.</span></span> <span data-ttu-id="f3a8c-1628">これらの設定は、<xref:System.Messaging.MessagePropertyFilter>で <xref:System.Messaging.MessagePropertyFilter.SetDefaults%2A> を呼び出すことと同じです。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1628">These settings are identical to calling <xref:System.Messaging.MessagePropertyFilter.SetDefaults%2A> on a <xref:System.Messaging.MessagePropertyFilter>.</span></span>  
  
|<span data-ttu-id="f3a8c-1629">プロパティ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1629">Property</span></span>|<span data-ttu-id="f3a8c-1630">既定値</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1630">Default value</span></span>|  
|--------------|-------------------|  
|<xref:System.Messaging.MessagePropertyFilter.Acknowledgment%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.AcknowledgeType%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.AdministrationQueue%2A>|`true`|  
|<xref:System.Messaging.MessagePropertyFilter.AppSpecific%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.ArrivedTime%2A>|`true`|  
|<xref:System.Messaging.MessagePropertyFilter.AttachSenderId%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.Authenticated%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.AuthenticationProviderName%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.AuthenticationProviderType%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.Body%2A>|`true`|  
|<xref:System.Messaging.MessagePropertyFilter.ConnectorType%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.CorrelationId%2A>|`true`|  
|<xref:System.Messaging.MessagePropertyFilter.DefaultBodySize%2A>|<span data-ttu-id="f3a8c-1631">1024 バイト</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1631">1024 bytes</span></span>|  
|<xref:System.Messaging.MessagePropertyFilter.DefaultExtensionSize%2A>|<span data-ttu-id="f3a8c-1632">255バイト</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1632">255 bytes</span></span>|  
|<xref:System.Messaging.MessagePropertyFilter.DefaultLabelSize%2A>|<span data-ttu-id="f3a8c-1633">255バイト</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1633">255 bytes</span></span>|  
|<xref:System.Messaging.MessagePropertyFilter.DestinationQueue%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.DestinationSymmetricKey%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.DigitalSignature%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.EncryptionAlgorithm%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.Extension%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.HashAlgorithm%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.Id%2A>|`true`|  
|<xref:System.Messaging.MessagePropertyFilter.IsFirstInTransaction%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.IsLastInTransaction%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.Label%2A>|`true`|  
|<xref:System.Messaging.MessagePropertyFilter.MessageType%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.Priority%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.Recoverable%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.ResponseQueue%2A>|`true`|  
|<xref:System.Messaging.MessagePropertyFilter.SenderCertificate%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.SenderId%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.SenderVersion%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.SentTime%2A>|`true`|  
|<xref:System.Messaging.MessagePropertyFilter.SourceMachine%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.TimeToBeReceived%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.TimeToReachQueue%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.TransactionId%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.TransactionStatusQueue%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.UseAuthentication%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.UseDeadLetterQueue%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.UseEncryption%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.UseJournalQueue%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.UseTracing%2A>|`false`|  
  
 <span data-ttu-id="f3a8c-1634">次の表は、このプロパティがさまざまなワークグループモードで使用できるかどうかを示しています。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1634">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-1635">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1635">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-1636">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1636">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-1637">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1637">Local computer</span></span>|<span data-ttu-id="f3a8c-1638">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1638">Yes</span></span>|  
|<span data-ttu-id="f3a8c-1639">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1639">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-1640">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1640">Yes</span></span>|  
|<span data-ttu-id="f3a8c-1641">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1641">Remote computer</span></span>|<span data-ttu-id="f3a8c-1642">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1642">Yes</span></span>|  
|<span data-ttu-id="f3a8c-1643">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1643">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-1644">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1644">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-1645">次のコード例では、<xref:System.Messaging.MessageQueue.MessageReadPropertyFilter%2A> を使用して、受信したメッセージプロパティを制限します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1645">The following code example uses the <xref:System.Messaging.MessageQueue.MessageReadPropertyFilter%2A> to restrict the message properties received.</span></span>  
  
 [!code-cpp[MessageQueue.MessageReadPropertyFilter#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.MessageReadPropertyFilter/CPP/mqmessagereadpropertyfilter.cpp#1)]
 [!code-csharp[MessageQueue.MessageReadPropertyFilter#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.MessageReadPropertyFilter/CS/mqmessagereadpropertyfilter.cs#1)]
 [!code-vb[MessageQueue.MessageReadPropertyFilter#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.MessageReadPropertyFilter/VB/mqmessagereadpropertyfilter.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="f3a8c-1646">フィルターが <see langword="null" /> です。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1646">The filter is <see langword="null" />.</span></span></exception>
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="MulticastAddress">
      <MemberSignature Language="C#" Value="public string MulticastAddress { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string MulticastAddress" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.MulticastAddress" />
      <MemberSignature Language="VB.NET" Value="Public Property MulticastAddress As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ MulticastAddress { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberSignature Language="F#" Value="member this.MulticastAddress : string with get, set" Usage="System.Messaging.MessageQueue.MulticastAddress" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.ComponentModel.DefaultValue("")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_MulticastAddress")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="f3a8c-1647">MSMQ 3.0 で導入されました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1647">Introduced in MSMQ 3.0.</span></span> <span data-ttu-id="f3a8c-1648">キューに関連付けられているマルチキャスト アドレスを取得または設定します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1648">Gets or sets the multicast address associated with the queue.</span></span></summary>
        <value><span data-ttu-id="f3a8c-1649">有効なマルチキャスト アドレス (次に示す形式) を格納している <see cref="T:System.String" />、またはキューがマルチキャスト アドレスに関連付けられていないことを示す <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1649">A <see cref="T:System.String" /> that contains a valid multicast address (in the form shown below) or <see langword="null" />, which indicates that the queue is not associated with a multicast address.</span></span>  
  
```  
&lt;address&gt;:&lt;port&gt;  
```</value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-1650"><xref:System.Messaging.MessageQueue.MulticastAddress%2A> プロパティは、メッセージを送信するときに使用できるマルチキャストアドレスに非トランザクションキューを関連付けるために使用されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1650">The <xref:System.Messaging.MessageQueue.MulticastAddress%2A> property is used to associate a non-transactional queue with a multicast address that can be used when sending messages.</span></span> <span data-ttu-id="f3a8c-1651">トランザクションキューをマルチキャストアドレスに関連付けることはできません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1651">You cannot associate a transactional queue with a multicast address.</span></span> <span data-ttu-id="f3a8c-1652">送信元アプリケーションがマルチキャストアドレスにメッセージを送信すると、メッセージキューはそのアドレスに関連付けられているすべてのキューにメッセージのコピーを送信します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1652">When the sending application sends messages to a multicast address, Message Queuing sends a copy of the message to every queue associated with that address.</span></span>  
  
 <span data-ttu-id="f3a8c-1653">IP マルチキャストアドレスは、クラス D の範囲の 224.0.0.0 ~ 239.255.255.255 でなければなりません。これは、最初の4つの上位ビットを1110に設定した場合に対応します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1653">IP multicast addresses must be in the class D range from 224.0.0.0 to 239.255.255.255, which corresponds to setting the first four high-order bits equal to 1110.</span></span> <span data-ttu-id="f3a8c-1654">ただし、この範囲のアドレスの特定の範囲のみが予約されていないため、マルチキャストメッセージの送信に使用できません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1654">However, only certain ranges of addresses in this range are unreserved and available for sending multicast messages.</span></span> <span data-ttu-id="f3a8c-1655">予約されているマルチキャストアドレスの最新の一覧については、[インターネットアドレス指定機関 (IANA) のインターネットマルチキャストアドレス](https://go.microsoft.com/fwlink/?linkid=3859)に関する Web ページを参照してください。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1655">For the latest list of reserved multicast addresses, see the [Internet Assigned Number Authority (IANA) Internet Multicast Addresses](https://go.microsoft.com/fwlink/?linkid=3859) Web page.</span></span> <span data-ttu-id="f3a8c-1656">ポート番号に制限はありません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1656">There are no restrictions on the port number.</span></span>  
  
 <span data-ttu-id="f3a8c-1657">複数のソースコンピューターがマルチキャストメッセージを送信しているときに、特定のキューで1つの送信元コンピューターからのメッセージのみを受信する場合は、各ソースコンピューターで、IP アドレスとポート番号の異なる組み合わせにメッセージを送信する必要があります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1657">If several source computers are sending multicast messages and you want a specific queue to receive messages from only one source computer, each source computer must send messages to a different combination of IP address and port number.</span></span>  
  
 <span data-ttu-id="f3a8c-1658">マルチキャストアドレスからキューの関連付けを解除するには、<xref:System.Messaging.MessageQueue.MulticastAddress%2A> プロパティを長さ0の文字列に設定します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1658">To dissociate a queue from a multicast address, set the <xref:System.Messaging.MessageQueue.MulticastAddress%2A> property to a zero-length string.</span></span> <span data-ttu-id="f3a8c-1659">`null`に設定しないでください。これにより、<xref:System.ArgumentNullException>が発生します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1659">Do not set it to `null`, as this will result in a <xref:System.ArgumentNullException>.</span></span>  
  
 <span data-ttu-id="f3a8c-1660">次の表は、このプロパティがさまざまなワークグループモードで使用できるかどうかを示しています。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1660">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-1661">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1661">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-1662">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1662">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-1663">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1663">Local computer</span></span>|<span data-ttu-id="f3a8c-1664">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1664">Yes</span></span>|  
|<span data-ttu-id="f3a8c-1665">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1665">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-1666">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1666">Yes</span></span>|  
|<span data-ttu-id="f3a8c-1667">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1667">Remote computer</span></span>|<span data-ttu-id="f3a8c-1668">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1668">No</span></span>|  
|<span data-ttu-id="f3a8c-1669">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1669">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-1670">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1670">No</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.PlatformNotSupportedException"><span data-ttu-id="f3a8c-1671">MSMQ 3.0 がインストールされていません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1671">MSMQ 3.0 is not installed.</span></span></exception>
      </Docs>
    </Member>
    <Member MemberName="Path">
      <MemberSignature Language="C#" Value="public string Path { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string Path" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.Path" />
      <MemberSignature Language="VB.NET" Value="Public Property Path As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ Path { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberSignature Language="F#" Value="member this.Path : string with get, set" Usage="System.Messaging.MessageQueue.Path" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.DefaultValue("")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.Editor("System.Messaging.Design.QueuePathEditor", "System.Drawing.Design.UITypeEditor, System.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.TypeConverter("System.Diagnostics.Design.StringValueConverter, System.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_Path")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1">
          <AttributeName>System.ComponentModel.Editor("System.Messaging.Design.QueuePathEditor", "System.Drawing.Design.UITypeEditor, System.Drawing, Version=1.0.5000.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1">
          <AttributeName>System.ComponentModel.RecommendedAsConfigurable(true)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1">
          <AttributeName>System.ComponentModel.TypeConverter("System.Diagnostics.Design.StringValueConverter, System.Design, Version=1.0.5000.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5">
          <AttributeName>System.ComponentModel.Editor("System.Messaging.Design.QueuePathEditor", "System.Drawing.Design.UITypeEditor, System.Drawing, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.ComponentModel.RefreshProperties(System.ComponentModel.RefreshProperties.All)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.ComponentModel.SettingsBindable(true)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5">
          <AttributeName>System.ComponentModel.TypeConverter("System.Diagnostics.Design.StringValueConverter, System.Design, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="f3a8c-1672">キューのパスを取得または設定します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1672">Gets or sets the queue's path.</span></span> <span data-ttu-id="f3a8c-1673"><see cref="P:System.Messaging.MessageQueue.Path" /> を設定すると、<see cref="T:System.Messaging.MessageQueue" /> は新しいキューを指します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1673">Setting the <see cref="P:System.Messaging.MessageQueue.Path" /> causes the <see cref="T:System.Messaging.MessageQueue" /> to point to a new queue.</span></span></summary>
        <value><span data-ttu-id="f3a8c-1674"><see cref="T:System.Messaging.MessageQueue" /> が参照するキュー。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1674">The queue that is referenced by the <see cref="T:System.Messaging.MessageQueue" />.</span></span> <span data-ttu-id="f3a8c-1675">既定値は、使用する <see cref="M:System.Messaging.MessageQueue.#ctor" /> コンストラクターによって異なり、<see langword="null" /> かコンストラクターの <paramref name="path" /> パラメーターで指定された値になります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1675">The default depends on which <see cref="M:System.Messaging.MessageQueue.#ctor" /> constructor you use; it is either <see langword="null" /> or is specified by the constructor's <paramref name="path" /> parameter.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-1676"><xref:System.Messaging.MessageQueue.Path%2A> プロパティの構文は、次の表に示すように、が指すキューの種類によって異なります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1676">The syntax for the <xref:System.Messaging.MessageQueue.Path%2A> property depends on the type of queue it points to, as shown in the following table.</span></span>  
  
|<span data-ttu-id="f3a8c-1677">[キューの種類]</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1677">Queue type</span></span>|<span data-ttu-id="f3a8c-1678">構文</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1678">Syntax</span></span>|  
|----------------|------------|  
|<span data-ttu-id="f3a8c-1679">パブリックキュー</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1679">Public queue</span></span>|`MachineName`\\`QueueName`|  
|<span data-ttu-id="f3a8c-1680">専用キュー</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1680">Private queue</span></span>|`MachineName`\\`Private$`\\`QueueName`|  
|<span data-ttu-id="f3a8c-1681">ジャーナル キュー</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1681">Journal queue</span></span>|`MachineName`\\`QueueName`\\`Journal$`|  
|<span data-ttu-id="f3a8c-1682">マシンジャーナルキュー</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1682">Machine journal queue</span></span>|`MachineName`\\`Journal$`|  
|<span data-ttu-id="f3a8c-1683">コンピューターの配信不能キュー</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1683">Machine dead-letter queue</span></span>|`MachineName`\\`Deadletter$`|  
|<span data-ttu-id="f3a8c-1684">コンピュータートランザクション配信不能キュー</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1684">Machine transactional dead-letter queue</span></span>|`MachineName`\\`XactDeadletter$`|  
  
 <span data-ttu-id="f3a8c-1685">"." を使用してローカルコンピューターを表します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1685">Use "." to represent the local computer.</span></span>  
  
 <span data-ttu-id="f3a8c-1686"><xref:System.Messaging.MessageQueue.MachineName%2A>、<xref:System.Messaging.MessageQueue.Path%2A>、および <xref:System.Messaging.MessageQueue.QueueName%2A> の各プロパティが関連付けられています。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1686">The <xref:System.Messaging.MessageQueue.MachineName%2A>, <xref:System.Messaging.MessageQueue.Path%2A>, and <xref:System.Messaging.MessageQueue.QueueName%2A> properties are related.</span></span> <span data-ttu-id="f3a8c-1687"><xref:System.Messaging.MessageQueue.MachineName%2A> プロパティを変更すると、<xref:System.Messaging.MessageQueue.Path%2A> プロパティが変更されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1687">Changing the <xref:System.Messaging.MessageQueue.MachineName%2A> property causes the <xref:System.Messaging.MessageQueue.Path%2A> property to change.</span></span> <span data-ttu-id="f3a8c-1688">これは、新しい <xref:System.Messaging.MessageQueue.MachineName%2A> と <xref:System.Messaging.MessageQueue.QueueName%2A>から構築されています。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1688">It is built from the new <xref:System.Messaging.MessageQueue.MachineName%2A> and the <xref:System.Messaging.MessageQueue.QueueName%2A>.</span></span> <span data-ttu-id="f3a8c-1689"><xref:System.Messaging.MessageQueue.Path%2A> を変更する (たとえば、形式名の構文を使用する) と、<xref:System.Messaging.MessageQueue.MachineName%2A> と <xref:System.Messaging.MessageQueue.QueueName%2A> のプロパティが新しいキューを参照するようにリセットされます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1689">Changing the <xref:System.Messaging.MessageQueue.Path%2A> (for example, to use the format name syntax) resets the <xref:System.Messaging.MessageQueue.MachineName%2A> and <xref:System.Messaging.MessageQueue.QueueName%2A> properties to refer to the new queue.</span></span>  
  
 <span data-ttu-id="f3a8c-1690">または、次の表に示すように、<xref:System.Messaging.MessageQueue.FormatName%2A> または <xref:System.Messaging.MessageQueue.Label%2A> を使用してキューのパスを記述することもできます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1690">Alternatively, you can use the <xref:System.Messaging.MessageQueue.FormatName%2A> or <xref:System.Messaging.MessageQueue.Label%2A> to describe the queue path, as shown in the following table.</span></span>  
  
|<span data-ttu-id="f3a8c-1691">関連項目</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1691">Reference</span></span>|<span data-ttu-id="f3a8c-1692">構文</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1692">Syntax</span></span>|<span data-ttu-id="f3a8c-1693">例</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1693">Example</span></span>|  
|---------------|------------|-------------|  
|<span data-ttu-id="f3a8c-1694">形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1694">Format name</span></span>|<span data-ttu-id="f3a8c-1695">`FormatName:` [*形式名*]</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1695">`FormatName:` [ *format name* ]</span></span>|<span data-ttu-id="f3a8c-1696">`FormatName:Public=` 5A5F7535-AE9A-41d4-935C-845C2AFF7112</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1696">`FormatName:Public=` 5A5F7535-AE9A-41d4-935C-845C2AFF7112</span></span>|  
|<span data-ttu-id="f3a8c-1697">group1</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1697">Label</span></span>|<span data-ttu-id="f3a8c-1698">`Label:` [*ラベル*]</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1698">`Label:` [ *label* ]</span></span>|<span data-ttu-id="f3a8c-1699">`Label:` TheLabel</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1699">`Label:` TheLabel</span></span>|  
  
 <span data-ttu-id="f3a8c-1700">メッセージを送信するときに <xref:System.Messaging.MessageQueue.Path%2A> プロパティのラベル構文を使用すると、<xref:System.Messaging.MessageQueue.Label%2A> が一意でない場合に例外がスローされます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1700">If you use the label syntax for the <xref:System.Messaging.MessageQueue.Path%2A> property when you send the message, an exception will be thrown if the <xref:System.Messaging.MessageQueue.Label%2A> is not unique.</span></span>  
  
 <span data-ttu-id="f3a8c-1701">オフラインで作業するには、最初のテーブルのフレンドリ名の構文ではなく、形式名の構文を使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1701">To work offline, you must use the format name syntax, rather than the friendly name syntax in the first table.</span></span> <span data-ttu-id="f3a8c-1702">それ以外の場合は、(Active Directory が存在する) プライマリドメインコントローラーが形式名へのパスを解決できないため、例外がスローされます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1702">Otherwise, an exception is thrown because the primary domain controller (on which Active Directory resides) is not available to resolve the path to the format name.</span></span>  
  
 <span data-ttu-id="f3a8c-1703">新しいパスを設定すると、メッセージキューが閉じられ、すべてのハンドルが解放されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1703">Setting a new path closes the message queue and releases all handles.</span></span>  
  
 <span data-ttu-id="f3a8c-1704">次の表は、このプロパティがさまざまなワークグループモードで使用できるかどうかを示しています。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1704">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-1705">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1705">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-1706">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1706">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-1707">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1707">Local computer</span></span>|<span data-ttu-id="f3a8c-1708">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1708">Yes</span></span>|  
|<span data-ttu-id="f3a8c-1709">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1709">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-1710">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1710">Yes</span></span>|  
|<span data-ttu-id="f3a8c-1711">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1711">Remote computer</span></span>|<span data-ttu-id="f3a8c-1712">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1712">Yes</span></span>|  
|<span data-ttu-id="f3a8c-1713">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1713">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-1714">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1714">Yes</span></span>|  
  
> [!NOTE]
>  <span data-ttu-id="f3a8c-1715">ワークグループモードでは、専用キューのみを使用できます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1715">In workgroup mode you can only use private queues.</span></span> <span data-ttu-id="f3a8c-1716">パスは、プライベートキューの構文 `MachineName`\\`Private$`\\`QueueName`を使用して指定します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1716">You specify the path using the private queue syntax `MachineName`\\`Private$`\\`QueueName`.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-1717">次のコード例では、さまざまなパス名の構文型を使用して、新しい <xref:System.Messaging.MessageQueue> オブジェクトを作成します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1717">The following code example creates new <xref:System.Messaging.MessageQueue> objects using various path name syntax types.</span></span> <span data-ttu-id="f3a8c-1718">いずれの場合も、コンストラクターで定義されているパスを持つキューにメッセージを送信します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1718">In each case, it sends a message to the queue whose path is defined in the constructor.</span></span>  
  
 [!code-cpp[MessageQueue.Path#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Path/CPP/mqpath.cpp#1)]
 [!code-csharp[MessageQueue.Path#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Path/CS/mqpath.cs#1)]
 [!code-vb[MessageQueue.Path#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Path/VB/mqpath.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="f3a8c-1719">パスが無効です。構文が無効であるためと考えられます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1719">The path is not valid, possibly because the syntax is not valid.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.QueueName" />
        <altmember cref="P:System.Messaging.MessageQueue.MachineName" />
        <altmember cref="P:System.Messaging.MessageQueue.FormatName" />
        <altmember cref="P:System.Messaging.MessageQueue.Label" />
        <altmember cref="M:System.Messaging.MessageQueue.#ctor" />
        <altmember cref="M:System.Messaging.MessageQueue.Close" />
      </Docs>
    </Member>
    <MemberGroup MemberName="Peek">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <threadsafe><span data-ttu-id="f3a8c-1720">メソッドはスレッドセーフではありません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1720">The method is not thread safe.</span></span></threadsafe>
        <summary><span data-ttu-id="f3a8c-1721">キューにある最初のメッセージのコピーを返します。メッセージはキューから削除されません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1721">Returns a copy of the first message in the queue without removing the message from the queue.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="Peek">
      <MemberSignature Language="C#" Value="public System.Messaging.Message Peek ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message Peek() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Peek" />
      <MemberSignature Language="VB.NET" Value="Public Function Peek () As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ Peek();" />
      <MemberSignature Language="F#" Value="member this.Peek : unit -&gt; System.Messaging.Message" Usage="messageQueue.Peek " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="f3a8c-1722">この <see cref="T:System.Messaging.MessageQueue" /> が参照するキューにある最初のメッセージを、削除せずに返します (ピークします)。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1722">Returns without removing (peeks) the first message in the queue referenced by this <see cref="T:System.Messaging.MessageQueue" />.</span></span> <span data-ttu-id="f3a8c-1723"><see cref="M:System.Messaging.MessageQueue.Peek" /> メソッドは同期メソッドであるため、メッセージが利用可能になるまで、現在のスレッドをブロックします。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1723">The <see cref="M:System.Messaging.MessageQueue.Peek" /> method is synchronous, so it blocks the current thread until a message becomes available.</span></span></summary>
        <returns><span data-ttu-id="f3a8c-1724">キューの最初のメッセージを表す <see cref="T:System.Messaging.Message" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1724">The <see cref="T:System.Messaging.Message" /> that represents the first message in the queue.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-1725">キューをピークしたり、メッセージがキューに存在するまで待機したりするには、このオーバーロードを使用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1725">Use this overload to peek a queue, or to wait until a message exists in the queue.</span></span>  
  
 <span data-ttu-id="f3a8c-1726"><xref:System.Messaging.MessageQueue.Peek%2A> メソッドは、キューから最初のメッセージを読み取りますが、削除しません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1726">The <xref:System.Messaging.MessageQueue.Peek%2A> method reads, but does not remove, the first message from the queue.</span></span> <span data-ttu-id="f3a8c-1727">したがって、キューにある優先順位の高いメッセージが受信されない限り、<xref:System.Messaging.MessageQueue.Peek%2A> を繰り返し呼び出すと、同じメッセージが返されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1727">Therefore, repeated calls to <xref:System.Messaging.MessageQueue.Peek%2A> return the same message, unless a higher priority message arrives in the queue.</span></span> <span data-ttu-id="f3a8c-1728">一方、<xref:System.Messaging.MessageQueue.Receive%2A> メソッドは、キューから最初のメッセージを読み取り、削除します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1728">The <xref:System.Messaging.MessageQueue.Receive%2A> method, on the other hand, both reads and removes the first message from the queue.</span></span> <span data-ttu-id="f3a8c-1729">このため、<xref:System.Messaging.MessageQueue.Receive%2A>を繰り返し呼び出すと、異なるメッセージが返されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1729">Repeated calls to <xref:System.Messaging.MessageQueue.Receive%2A>, therefore, return different messages.</span></span>  
  
 <span data-ttu-id="f3a8c-1730">メッセージキューは、優先度と到着時刻に従ってキュー内のメッセージを並べ替えます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1730">Message Queuing orders messages in the queue according to priority and arrival time.</span></span> <span data-ttu-id="f3a8c-1731">新しいメッセージは、優先順位が高い場合にのみ、古いものよりも前に配置されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1731">A newer message is placed before an older one only if it is of a higher priority.</span></span>  
  
 <span data-ttu-id="f3a8c-1732">キューにメッセージが到達するまで待機する間、現在のスレッドがブロックされてもいい場合は、<xref:System.Messaging.MessageQueue.Peek%2A> を使用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1732">Use <xref:System.Messaging.MessageQueue.Peek%2A> when it is acceptable for the current thread to be blocked while it waits for a message to arrive in the queue.</span></span> <span data-ttu-id="f3a8c-1733">このオーバーロードではタイムアウトが指定されていないため、アプリケーションは無制限に待機する場合があります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1733">Because this overload does not specify a time-out, the application might wait indefinitely.</span></span> <span data-ttu-id="f3a8c-1734">待機せずにアプリケーションの処理を継続する必要がある場合は、非同期の <xref:System.Messaging.MessageQueue.BeginPeek%2A> メソッドを使用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1734">If you need the application processing to continue without waiting, use the asynchronous <xref:System.Messaging.MessageQueue.BeginPeek%2A> method.</span></span> <span data-ttu-id="f3a8c-1735">または、タイムアウトを指定する <xref:System.Messaging.MessageQueue.Peek%2A> のオーバーロードを使用して、メッセージがキューに到着するまでのタイムアウトを指定することもできます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1735">Alternatively, you can specify a time-out for a message to arrive in the queue by using the overload of <xref:System.Messaging.MessageQueue.Peek%2A> that specifies a time-out.</span></span>  
  
 <span data-ttu-id="f3a8c-1736">次の表に、この方法をさまざまなワークグループモードで使用できるかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1736">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-1737">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1737">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-1738">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1738">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-1739">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1739">Local computer</span></span>|<span data-ttu-id="f3a8c-1740">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1740">Yes</span></span>|  
|<span data-ttu-id="f3a8c-1741">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1741">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-1742">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1742">Yes</span></span>|  
|<span data-ttu-id="f3a8c-1743">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1743">Remote computer</span></span>|<span data-ttu-id="f3a8c-1744">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1744">No</span></span>|  
|<span data-ttu-id="f3a8c-1745">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1745">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-1746">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1746">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-1747">次の例では、キューに対して <xref:System.Messaging.MessageQueue.Peek%2A> メソッドを使用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1747">The following examples use the <xref:System.Messaging.MessageQueue.Peek%2A> method on a queue.</span></span>  
  
 <span data-ttu-id="f3a8c-1748">最初の例では、アプリケーションはメッセージがキューで使用可能になるまで待機します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1748">In the first example, the application waits until a message becomes available in the queue.</span></span> <span data-ttu-id="f3a8c-1749">最初の例では、受信したメッセージにアクセスしないことに注意してください。メッセージが到着するまで、処理を一時停止するだけです。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1749">Note that the first example does not access the message that arrives; it merely pauses processing until a message arrives.</span></span> <span data-ttu-id="f3a8c-1750">メッセージが既にキューに存在する場合は、直ちに返されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1750">If a message already exists in the queue, it will return immediately.</span></span>  
  
 <span data-ttu-id="f3a8c-1751">2番目の例では、アプリケーションによって定義された `Order` クラスを含むメッセージがキューに送信され、キューからピークされます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1751">In the second example, a message that contains an application-defined `Order` class is sent to the queue, and then peeked from the queue.</span></span>  
  
 [!code-cpp[MessageQueue.Peek_noparms#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Peek_noparms/CPP/mqpeek_noparms.cpp#1)]
 [!code-csharp[MessageQueue.Peek_noparms#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Peek_noparms/CS/mqpeek_noparms.cs#1)]
 [!code-vb[MessageQueue.Peek_noparms#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Peek_noparms/VB/mqpeek_noparms.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="f3a8c-1752">メッセージ キューのメソッドにアクセスしたときにエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1752">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <threadsafe><span data-ttu-id="f3a8c-1753">メソッドはスレッドセーフではありません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1753">The method is not thread safe.</span></span></threadsafe>
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
      </Docs>
    </Member>
    <Member MemberName="Peek">
      <MemberSignature Language="C#" Value="public System.Messaging.Message Peek (TimeSpan timeout);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message Peek(valuetype System.TimeSpan timeout) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Peek(System.TimeSpan)" />
      <MemberSignature Language="VB.NET" Value="Public Function Peek (timeout As TimeSpan) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ Peek(TimeSpan timeout);" />
      <MemberSignature Language="F#" Value="member this.Peek : TimeSpan -&gt; System.Messaging.Message" Usage="messageQueue.Peek timeout" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" />
      </Parameters>
      <Docs>
        <param name="timeout"><span data-ttu-id="f3a8c-1754">キューにメッセージが格納されるまで待機する最大時間を示す <see cref="T:System.TimeSpan" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1754">A <see cref="T:System.TimeSpan" /> that indicates the maximum time to wait for the queue to contain a message.</span></span></param>
        <summary><span data-ttu-id="f3a8c-1755">この <see cref="T:System.Messaging.MessageQueue" /> が参照するキューにある最初のメッセージを、削除せずに返します (ピークします)。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1755">Returns without removing (peeks) the first message in the queue referenced by this <see cref="T:System.Messaging.MessageQueue" />.</span></span> <span data-ttu-id="f3a8c-1756"><see cref="M:System.Messaging.MessageQueue.Peek" /> メソッドは同期メソッドであるため、メッセージが利用可能になるか、指定したタイムアウトが発生するまで、現在のスレッドをブロックします。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1756">The <see cref="M:System.Messaging.MessageQueue.Peek" /> method is synchronous, so it blocks the current thread until a message becomes available or the specified time-out occurs.</span></span></summary>
        <returns><span data-ttu-id="f3a8c-1757">キューの最初のメッセージを表す <see cref="T:System.Messaging.Message" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1757">The <see cref="T:System.Messaging.Message" /> that represents the first message in the queue.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-1758">キューをピークする場合、またはキューにメッセージが存在するまで指定した期間待機する場合は、このオーバーロードを使用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1758">Use this overload to peek a queue, or to wait a specified period of time until a message exists in the queue.</span></span> <span data-ttu-id="f3a8c-1759">メッセージが既にキューに存在する場合、メソッドは直ちにを返します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1759">The method returns immediately if a message already exists in the queue.</span></span>  
  
 <span data-ttu-id="f3a8c-1760"><xref:System.Messaging.MessageQueue.Peek%2A> メソッドは、キューから最初のメッセージを読み取りますが、削除しません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1760">The <xref:System.Messaging.MessageQueue.Peek%2A> method reads, but does not remove, the first message from the queue.</span></span> <span data-ttu-id="f3a8c-1761">したがって、キューにある優先順位の高いメッセージが受信されない限り、<xref:System.Messaging.MessageQueue.Peek%2A> を繰り返し呼び出すと、同じメッセージが返されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1761">Therefore, repeated calls to <xref:System.Messaging.MessageQueue.Peek%2A> return the same message, unless a higher priority message arrives in the queue.</span></span> <span data-ttu-id="f3a8c-1762">一方、<xref:System.Messaging.MessageQueue.Receive%2A> メソッドは、キューから最初のメッセージを読み取り、削除します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1762">The <xref:System.Messaging.MessageQueue.Receive%2A> method, on the other hand, both reads and removes the first message from the queue.</span></span> <span data-ttu-id="f3a8c-1763">このため、<xref:System.Messaging.MessageQueue.Receive%2A>を繰り返し呼び出すと、異なるメッセージが返されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1763">Repeated calls to <xref:System.Messaging.MessageQueue.Receive%2A>, therefore, return different messages.</span></span>  
  
 <span data-ttu-id="f3a8c-1764">メッセージキューは、優先度と到着時刻に従ってキュー内のメッセージを並べ替えます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1764">Message Queuing orders messages in the queue according to priority and arrival time.</span></span> <span data-ttu-id="f3a8c-1765">新しいメッセージは、優先順位が高い場合にのみ、古いものよりも前に配置されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1765">A newer message is placed before an older one only if it is of a higher priority.</span></span>  
  
 <span data-ttu-id="f3a8c-1766">キューにメッセージが到達するまで待機する間、現在のスレッドがブロックされてもいい場合は、<xref:System.Messaging.MessageQueue.Peek%2A> を使用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1766">Use <xref:System.Messaging.MessageQueue.Peek%2A> when it is acceptable for the current thread to be blocked while it waits for a message to arrive in the queue.</span></span> <span data-ttu-id="f3a8c-1767">スレッドは、指定された期間にわたってブロックされるか、または <xref:System.Messaging.MessageQueue.InfiniteTimeout>を指定した場合は無期限にブロックされます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1767">The thread will be blocked up to the specified period of time, or indefinitely if you indicated <xref:System.Messaging.MessageQueue.InfiniteTimeout>.</span></span> <span data-ttu-id="f3a8c-1768">待機せずにアプリケーションの処理を継続する必要がある場合は、非同期の <xref:System.Messaging.MessageQueue.BeginPeek%2A> メソッドを使用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1768">If you need the application processing to continue without waiting, use the asynchronous <xref:System.Messaging.MessageQueue.BeginPeek%2A> method.</span></span>  
  
 <span data-ttu-id="f3a8c-1769">次の表に、この方法をさまざまなワークグループモードで使用できるかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1769">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-1770">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1770">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-1771">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1771">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-1772">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1772">Local computer</span></span>|<span data-ttu-id="f3a8c-1773">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1773">Yes</span></span>|  
|<span data-ttu-id="f3a8c-1774">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1774">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-1775">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1775">Yes</span></span>|  
|<span data-ttu-id="f3a8c-1776">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1776">Remote computer</span></span>|<span data-ttu-id="f3a8c-1777">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1777">No</span></span>|  
|<span data-ttu-id="f3a8c-1778">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1778">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-1779">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1779">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-1780">次のコード例では、<xref:System.Messaging.MessageQueue.Peek%2A> メソッドを0のタイムアウトと共に使用して、キューが空かどうかを確認します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1780">The following code example uses the <xref:System.Messaging.MessageQueue.Peek%2A> method with a time-out of zero to check whether the queue is empty.</span></span>  
  
 [!code-cpp[MessageQueue.Peek_timeout#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Peek_timeout/CPP/mqpeek_timeout.cpp#1)]
 [!code-csharp[MessageQueue.Peek_timeout#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Peek_timeout/CS/mqpeek_timeout.cs#1)]
 [!code-vb[MessageQueue.Peek_timeout#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Peek_timeout/VB/mqpeek_timeout.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="f3a8c-1781"><paramref name="timeout" /> パラメーターに指定した値が無効です。<paramref name="timeout" /> が <see cref="F:System.TimeSpan.Zero" /> よりも小さいか、<see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" /> よりも大きい可能性があります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1781">The value specified for the <paramref name="timeout" /> parameter is not valid, possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="f3a8c-1782">メッセージ キューのメソッドにアクセスしたときにエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1782">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <threadsafe><span data-ttu-id="f3a8c-1783">メソッドはスレッドセーフではありません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1783">The method is not thread safe.</span></span></threadsafe>
        <altmember cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
      </Docs>
    </Member>
    <Member MemberName="Peek">
      <MemberSignature Language="C#" Value="public System.Messaging.Message Peek (TimeSpan timeout, System.Messaging.Cursor cursor, System.Messaging.PeekAction action);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message Peek(valuetype System.TimeSpan timeout, class System.Messaging.Cursor cursor, valuetype System.Messaging.PeekAction action) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Peek(System.TimeSpan,System.Messaging.Cursor,System.Messaging.PeekAction)" />
      <MemberSignature Language="VB.NET" Value="Public Function Peek (timeout As TimeSpan, cursor As Cursor, action As PeekAction) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ Peek(TimeSpan timeout, System::Messaging::Cursor ^ cursor, System::Messaging::PeekAction action);" />
      <MemberSignature Language="F#" Value="member this.Peek : TimeSpan * System.Messaging.Cursor * System.Messaging.PeekAction -&gt; System.Messaging.Message" Usage="messageQueue.Peek (timeout, cursor, action)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="cursor" Type="System.Messaging.Cursor" Index="1" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="action" Type="System.Messaging.PeekAction" Index="2" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="timeout"><span data-ttu-id="f3a8c-1784">キューにメッセージが格納されるまで待機する最大時間を示す <see cref="T:System.TimeSpan" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1784">A <see cref="T:System.TimeSpan" /> that indicates the maximum time to wait for the queue to contain a message.</span></span></param>
        <param name="cursor"><span data-ttu-id="f3a8c-1785">メッセージ キュー内の特定の位置を維持する <see cref="T:System.Messaging.Cursor" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1785">A <see cref="T:System.Messaging.Cursor" /> that maintains a specific position in the message queue.</span></span></param>
        <param name="action"><span data-ttu-id="f3a8c-1786"><see cref="T:System.Messaging.PeekAction" /> 値のいずれか 1 つ。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1786">One of the <see cref="T:System.Messaging.PeekAction" /> values.</span></span> <span data-ttu-id="f3a8c-1787">キュー内の現在のメッセージと次のメッセージのどちらをピークするかを示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1787">Indicates whether to peek at the current message in the queue, or the next message.</span></span></param>
        <summary><span data-ttu-id="f3a8c-1788">指定されたカーソルを使用して、キュー内の現在のメッセージまたは次のメッセージを、削除せずに返します (ピークします)。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1788">Returns without removing (peeks) the current or next message in the queue, using the specified cursor.</span></span> <span data-ttu-id="f3a8c-1789"><see cref="M:System.Messaging.MessageQueue.Peek" /> メソッドは同期メソッドであるため、メッセージが利用可能になるか、指定したタイムアウトが発生するまで、現在のスレッドをブロックします。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1789">The <see cref="M:System.Messaging.MessageQueue.Peek" /> method is synchronous, so it blocks the current thread until a message becomes available or the specified time-out occurs.</span></span></summary>
        <returns><span data-ttu-id="f3a8c-1790">キュー内のメッセージを表す <see cref="T:System.Messaging.Message" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1790">A <see cref="T:System.Messaging.Message" /> that represents a message in the queue.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-1791">キューをピークする場合、またはキューにメッセージが存在するまで指定した期間待機する場合は、このオーバーロードを使用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1791">Use this overload to peek a queue, or to wait a specified period of time until a message exists in the queue.</span></span> <span data-ttu-id="f3a8c-1792">メッセージが既にキューに存在する場合、メソッドは直ちにを返します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1792">The method returns immediately if a message already exists in the queue.</span></span>  
  
 <span data-ttu-id="f3a8c-1793"><xref:System.Messaging.MessageQueue.Peek%2A> メソッドは、キューからメッセージを読み取りますが、削除しません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1793">The <xref:System.Messaging.MessageQueue.Peek%2A> method reads, but does not remove, a message from the queue.</span></span> <span data-ttu-id="f3a8c-1794">一方、<xref:System.Messaging.MessageQueue.Receive%2A> メソッドでは、キューからメッセージを読み取り、削除することができます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1794">The <xref:System.Messaging.MessageQueue.Receive%2A> method, on the other hand, both reads and removes a message from the queue.</span></span>  
  
 <span data-ttu-id="f3a8c-1795">キューにメッセージが到達するまで待機する間、現在のスレッドがブロックされてもいい場合は、<xref:System.Messaging.MessageQueue.Peek%2A> を使用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1795">Use <xref:System.Messaging.MessageQueue.Peek%2A> when it is acceptable for the current thread to be blocked while it waits for a message to arrive in the queue.</span></span> <span data-ttu-id="f3a8c-1796">スレッドは、指定された期間にわたってブロックされるか、または <xref:System.Messaging.MessageQueue.InfiniteTimeout>を指定した場合は無期限にブロックされます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1796">The thread is blocked up to the specified period of time, or indefinitely if you indicated <xref:System.Messaging.MessageQueue.InfiniteTimeout>.</span></span> <span data-ttu-id="f3a8c-1797">待機せずにアプリケーションの処理を継続する必要がある場合は、非同期の <xref:System.Messaging.MessageQueue.BeginPeek%2A> メソッドを使用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1797">If you need the application processing to continue without waiting, use the asynchronous <xref:System.Messaging.MessageQueue.BeginPeek%2A> method.</span></span>  
  
 <span data-ttu-id="f3a8c-1798">次の表に、この方法をさまざまなワークグループモードで使用できるかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1798">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-1799">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1799">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-1800">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1800">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-1801">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1801">Local computer</span></span>|<span data-ttu-id="f3a8c-1802">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1802">Yes</span></span>|  
|<span data-ttu-id="f3a8c-1803">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1803">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-1804">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1804">Yes</span></span>|  
|<span data-ttu-id="f3a8c-1805">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1805">Remote computer</span></span>|<span data-ttu-id="f3a8c-1806">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1806">No</span></span>|  
|<span data-ttu-id="f3a8c-1807">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1807">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-1808">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1808">Yes</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentOutOfRangeException"><span data-ttu-id="f3a8c-1809"><paramref name="action" /> パラメーターに <see langword="PeekAction.Current" /> または <see langword="PeekAction.Next" /> 以外の値が指定されました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1809">A value other than <see langword="PeekAction.Current" /> or <see langword="PeekAction.Next" /> was specified for the <paramref name="action" /> parameter.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="f3a8c-1810"><paramref name="cursor" /> パラメーターが <see langword="null" /> です。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1810">The <paramref name="cursor" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="f3a8c-1811"><paramref name="timeout" /> パラメーターに指定された値が無効です。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1811">The value specified for the <paramref name="timeout" /> parameter is not valid.</span></span> <span data-ttu-id="f3a8c-1812"><paramref name="timeout" /> が <see cref="F:System.TimeSpan.Zero" /> より小さい値か、<see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" /> より大きい値である可能性があります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1812">Possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="f3a8c-1813">メッセージ キューのメソッドにアクセスしたときにエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1813">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <threadsafe><span data-ttu-id="f3a8c-1814">メソッドはスレッドセーフではありません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1814">The method is not thread safe.</span></span></threadsafe>
        <altmember cref="T:System.Messaging.Cursor" />
        <altmember cref="T:System.Messaging.PeekAction" />
        <altmember cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
      </Docs>
    </Member>
    <MemberGroup MemberName="PeekByCorrelationId">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="f3a8c-1815">指定した相関 ID と一致するメッセージをピークします。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1815">Peeks a message that matches a given correlation identifier.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="PeekByCorrelationId">
      <MemberSignature Language="C#" Value="public System.Messaging.Message PeekByCorrelationId (string correlationId);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message PeekByCorrelationId(string correlationId) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.PeekByCorrelationId(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Function PeekByCorrelationId (correlationId As String) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ PeekByCorrelationId(System::String ^ correlationId);" />
      <MemberSignature Language="F#" Value="member this.PeekByCorrelationId : string -&gt; System.Messaging.Message" Usage="messageQueue.PeekByCorrelationId correlationId" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="correlationId" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="correlationId"><span data-ttu-id="f3a8c-1816">ピークするメッセージの <see cref="P:System.Messaging.Message.CorrelationId" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1816">The <see cref="P:System.Messaging.Message.CorrelationId" /> of the message to peek.</span></span></param>
        <summary><span data-ttu-id="f3a8c-1817">指定した相関 ID と一致するメッセージをピークします。現在、指定した相関 ID と一致するメッセージがキューに存在しない場合は、すぐに例外を発生させます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1817">Peeks the message that matches the given correlation identifier and immediately raises an exception if no message with the specified correlation identifier currently exists in the queue.</span></span></summary>
        <returns><span data-ttu-id="f3a8c-1818">渡された <paramref name="correlationId" /> パラメーターと一致する <see cref="P:System.Messaging.Message.CorrelationId" /> を持つ <see cref="T:System.Messaging.Message" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1818">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.CorrelationId" /> matches the <paramref name="correlationId" /> parameter passed in.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-1819">このメソッドは、指定された `correlationId` パラメーターに一致する <xref:System.Messaging.Message.CorrelationId%2A> を持つメッセージの <xref:System.Messaging.MessageQueue> によって参照されるキューを検索します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1819">This method looks in the queue referenced by the <xref:System.Messaging.MessageQueue> for a message whose <xref:System.Messaging.Message.CorrelationId%2A> matches the specified `correlationId` parameter.</span></span> <span data-ttu-id="f3a8c-1820">`correlationID` パラメーターと一致するメッセージが見つからない場合は、例外がスローされます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1820">If no message is found that matches the `correlationID` parameter, an exception is thrown.</span></span>  
  
 <span data-ttu-id="f3a8c-1821"><xref:System.Messaging.Message.CorrelationId%2A> プロパティは、キューに送信されたメッセージを、関連付けられている応答、レポート、または受信確認メッセージに関連付けるために使用されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1821">The <xref:System.Messaging.Message.CorrelationId%2A> property is used to tie a message sent to the queue to associated response, report, or acknowledgment messages.</span></span>  
  
 <span data-ttu-id="f3a8c-1822">他の2つの方法では、キュー内のメッセージをピークすることができます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1822">Two other methods allow you to peek messages in a queue.</span></span> <span data-ttu-id="f3a8c-1823"><xref:System.Messaging.MessageQueue.Peek%2A> メソッドは、キュー内の最初のメッセージを返し、<xref:System.Messaging.MessageQueue.PeekById%28System.String%29> メソッドを使用して、一意の識別子を指定することによってメッセージを取得します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1823">The <xref:System.Messaging.MessageQueue.Peek%2A> method returns the first message in the queue, and the <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> method is used to retrieve a message by specifying its unique identifier.</span></span>  
  
 <span data-ttu-id="f3a8c-1824">次の表に、この方法をさまざまなワークグループモードで使用できるかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1824">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-1825">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1825">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-1826">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1826">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-1827">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1827">Local computer</span></span>|<span data-ttu-id="f3a8c-1828">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1828">Yes</span></span>|  
|<span data-ttu-id="f3a8c-1829">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1829">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-1830">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1830">Yes</span></span>|  
|<span data-ttu-id="f3a8c-1831">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1831">Remote computer</span></span>|<span data-ttu-id="f3a8c-1832">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1832">No</span></span>|  
|<span data-ttu-id="f3a8c-1833">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1833">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-1834">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1834">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-1835">次のコード例では、キューとの間で注文を含むメッセージを送受信します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1835">The following code example sends and receives a message that contains an order to and from a queue.</span></span> <span data-ttu-id="f3a8c-1836">これは、元のメッセージがキューに到達するか、キューから取得されるときに肯定受信確認を要求します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1836">It specifically requests a positive acknowledgment when the original message reaches or is retrieved from the queue.</span></span>  
  
 [!code-cpp[Message.Acknowledgment#1](~/samples/snippets/cpp/VS_Snippets_Remoting/Message.Acknowledgment/CPP/message_acknowledgment.cpp#1)]
 [!code-csharp[Message.Acknowledgment#1](~/samples/snippets/csharp/VS_Snippets_Remoting/Message.Acknowledgment/CS/message_acknowledgment.cs#1)]
 [!code-vb[Message.Acknowledgment#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/Message.Acknowledgment/VB/message_acknowledgment.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="f3a8c-1837"><paramref name="correlationId" /> パラメーターが <see langword="null" /> です。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1837">The <paramref name="correlationId" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="f3a8c-1838">指定した <paramref name="correlationId" /> を持つメッセージは見つかりませんでした。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1838">The message with the specified <paramref name="correlationId" /> could not be found.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="f3a8c-1839">メッセージ キューのメソッドにアクセスしたときにエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1839">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.Message.CorrelationId" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
      </Docs>
    </Member>
    <Member MemberName="PeekByCorrelationId">
      <MemberSignature Language="C#" Value="public System.Messaging.Message PeekByCorrelationId (string correlationId, TimeSpan timeout);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message PeekByCorrelationId(string correlationId, valuetype System.TimeSpan timeout) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.PeekByCorrelationId(System.String,System.TimeSpan)" />
      <MemberSignature Language="VB.NET" Value="Public Function PeekByCorrelationId (correlationId As String, timeout As TimeSpan) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ PeekByCorrelationId(System::String ^ correlationId, TimeSpan timeout);" />
      <MemberSignature Language="F#" Value="member this.PeekByCorrelationId : string * TimeSpan -&gt; System.Messaging.Message" Usage="messageQueue.PeekByCorrelationId (correlationId, timeout)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="correlationId" Type="System.String" />
        <Parameter Name="timeout" Type="System.TimeSpan" />
      </Parameters>
      <Docs>
        <param name="correlationId"><span data-ttu-id="f3a8c-1840">ピークするメッセージの <see cref="P:System.Messaging.Message.CorrelationId" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1840">The <see cref="P:System.Messaging.Message.CorrelationId" /> of the message to peek.</span></span></param>
        <param name="timeout"><span data-ttu-id="f3a8c-1841">新しいメッセージを検査できるようになるまでの待機時間を示す <see cref="T:System.TimeSpan" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1841">A <see cref="T:System.TimeSpan" /> that indicates the time to wait until a new message is available for inspection.</span></span></param>
        <summary><span data-ttu-id="f3a8c-1842">指定した相関 ID と一致するメッセージをピークします。指定した相関 ID のメッセージがキューで利用可能になるか、タイムアウトが経過するまで待機します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1842">Peeks the message that matches the given correlation identifier and waits until either a message with the specified correlation identifier is available in the queue, or the time-out expires.</span></span></summary>
        <returns><span data-ttu-id="f3a8c-1843">渡された <paramref name="correlationId" /> パラメーターと一致する <see cref="P:System.Messaging.Message.CorrelationId" /> を持つ <see cref="T:System.Messaging.Message" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1843">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.CorrelationId" /> matches the <paramref name="correlationId" /> parameter passed in.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-1844">このメソッドは、指定された `correlationId` パラメーターに一致する <xref:System.Messaging.Message.CorrelationId%2A> を持つメッセージの <xref:System.Messaging.MessageQueue> によって参照されるキューを検索します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1844">This method looks in the queue referenced by the <xref:System.Messaging.MessageQueue> for a message whose <xref:System.Messaging.Message.CorrelationId%2A> matches the specified `correlationId` parameter.</span></span> <span data-ttu-id="f3a8c-1845">`correlationID` パラメーターと一致するメッセージが見つからず、`timeout` パラメーターで指定された期間内に新しいメッセージがキューに到着しなかった場合は、例外がスローされます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1845">If no message is found that matches the `correlationID` parameter, and no new message arrives in the queue within the period specified by the `timeout` parameter, an exception is thrown.</span></span>  
  
 <span data-ttu-id="f3a8c-1846">`timeout` パラメーターでは、このメソッドの合計実行時間が指定されていません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1846">The `timeout` parameter does not specify the total running time for this method.</span></span> <span data-ttu-id="f3a8c-1847">代わりに、キューに新しいメッセージが到着するまで待機する時間を指定します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1847">Rather, it specifies the time to wait for a new message to arrive in the queue.</span></span> <span data-ttu-id="f3a8c-1848">このメソッドは、新しいメッセージが到着するたびに、新しいメッセージの <xref:System.Messaging.Message.CorrelationId%2A> を調べて、`correlationId` パラメーターと一致するかどうかを確認します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1848">Each time a new message arrives, this method examines the <xref:System.Messaging.Message.CorrelationId%2A> of the new message to see if it matches the `correlationId` parameter.</span></span> <span data-ttu-id="f3a8c-1849">それ以外の場合、このメソッドはタイムアウト期間を開始し、別の新しいメッセージが到着するまで待機します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1849">If not, this method starts the time-out period over and waits for another new message to arrive.</span></span> <span data-ttu-id="f3a8c-1850">したがって、タイムアウト期間内に新しいメッセージが引き続き到着する場合、このメソッドは、タイムアウト期間が新しいメッセージを受信せずに期限切れになるか、または <xref:System.Messaging.Message.CorrelationId%2A> が `correlationId` パラメーターと一致するメッセージが到着するまで、無期限に実行を継続することができます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1850">Therefore, if new messages continue to arrive within the time-out period, it is possible for this method to continue running indefinitely, either until the time-out period expires without any new messages arriving, or until a message arrives whose <xref:System.Messaging.Message.CorrelationId%2A> matches the `correlationId` parameter.</span></span>  
  
 <span data-ttu-id="f3a8c-1851"><xref:System.Messaging.Message.CorrelationId%2A> プロパティは、キューに送信されたメッセージを、関連付けられている応答、レポート、または受信確認メッセージに関連付けるために使用されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1851">The <xref:System.Messaging.Message.CorrelationId%2A> property is used to tie a message sent to the queue to associated response, report, or acknowledgment messages.</span></span>  
  
 <span data-ttu-id="f3a8c-1852">他の2つの方法では、キュー内のメッセージをピークすることができます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1852">Two other methods allow you to peek messages in a queue.</span></span> <span data-ttu-id="f3a8c-1853"><xref:System.Messaging.MessageQueue.Peek%2A> メソッドは、キュー内の最初のメッセージを返し、<xref:System.Messaging.MessageQueue.PeekById%28System.String%29> メソッドを使用して、一意の識別子を指定することによってメッセージを取得します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1853">The <xref:System.Messaging.MessageQueue.Peek%2A> method returns the first message in the queue, and the <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> method is used to retrieve a message by specifying its unique identifier.</span></span>  
  
 <span data-ttu-id="f3a8c-1854">次の表に、この方法をさまざまなワークグループモードで使用できるかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1854">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-1855">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1855">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-1856">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1856">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-1857">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1857">Local computer</span></span>|<span data-ttu-id="f3a8c-1858">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1858">Yes</span></span>|  
|<span data-ttu-id="f3a8c-1859">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1859">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-1860">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1860">Yes</span></span>|  
|<span data-ttu-id="f3a8c-1861">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1861">Remote computer</span></span>|<span data-ttu-id="f3a8c-1862">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1862">No</span></span>|  
|<span data-ttu-id="f3a8c-1863">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1863">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-1864">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1864">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-1865">次のコード例は、<xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%2CSystem.TimeSpan%29> の使用方法を示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1865">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%2CSystem.TimeSpan%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#5](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#5)]
 [!code-csharp[MessageQueue2#5](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#5)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="f3a8c-1866"><paramref name="correlationId" /> パラメーターが <see langword="null" /> です。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1866">The <paramref name="correlationId" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="f3a8c-1867"><paramref name="timeout" /> パラメーターに指定した値が無効です。<paramref name="timeout" /> が <see cref="F:System.TimeSpan.Zero" /> よりも小さいか、<see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" /> よりも大きい可能性があります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1867">The value specified for the <paramref name="timeout" /> parameter is not valid, possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="f3a8c-1868">指定した <paramref name="correlationId" /> を持つメッセージがキューに存在せず、タイムアウトが経過する前にキューに到達することもありませんでした。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1868">The message with the specified <paramref name="correlationId" /> does not exist in the queue and did not arrive before the time-out expired.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="f3a8c-1869">タイムアウトが経過する前にメッセージが到達しませんでした。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1869">A message did not arrive before the time-out expired.</span></span>  
  
 <span data-ttu-id="f3a8c-1870">- または -</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1870">-or-</span></span>  
  
 <span data-ttu-id="f3a8c-1871">メッセージ キューのメソッドにアクセスしたときにエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1871">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />
        <altmember cref="P:System.Messaging.Message.CorrelationId" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
      </Docs>
    </Member>
    <MemberGroup MemberName="PeekById">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="f3a8c-1872">指定したメッセージ ID を持つメッセージのコピーを返します。メッセージはキューから削除されません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1872">Returns a copy of the message that has the specified message identifier without removing the message from the queue.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="PeekById">
      <MemberSignature Language="C#" Value="public System.Messaging.Message PeekById (string id);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message PeekById(string id) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.PeekById(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Function PeekById (id As String) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ PeekById(System::String ^ id);" />
      <MemberSignature Language="F#" Value="member this.PeekById : string -&gt; System.Messaging.Message" Usage="messageQueue.PeekById id" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="id" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="id"><span data-ttu-id="f3a8c-1873">ピークするメッセージの <see cref="P:System.Messaging.Message.Id" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1873">The <see cref="P:System.Messaging.Message.Id" /> of the message to peek.</span></span></param>
        <summary><span data-ttu-id="f3a8c-1874">メッセージ ID が <paramref name="id" /> パラメーターと一致するメッセージをピークします。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1874">Peeks the message whose message identifier matches the <paramref name="id" /> parameter.</span></span></summary>
        <returns><span data-ttu-id="f3a8c-1875"><paramref name="id" /> パラメーターと一致する <see cref="P:System.Messaging.Message.Id" /> プロパティを持つ <see cref="T:System.Messaging.Message" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1875">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.Id" /> property matches the <paramref name="id" /> parameter.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-1876"><xref:System.Messaging.MessageQueue.PeekById%28System.String%29> を使用すると、既知のメッセージ識別子を持つメッセージをキューから削除せずに読み取ることができます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1876">Use <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> to read, without removing from the queue, a message that has a known message identifier.</span></span> <span data-ttu-id="f3a8c-1877">メッセージの識別子はメッセージキューエンタープライズ全体で一意であるため、指定された `id` パラメーターと一致するメッセージがキューに1つだけ存在します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1877">The identifier of a message is unique across the Message Queuing enterprise, so there will be at most one message in the queue that matches the given `id` parameter.</span></span> <span data-ttu-id="f3a8c-1878">現在、キューにメッセージが含まれていない場合、このオーバーロードは例外をスローします。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1878">This overload throws an exception if the queue does not currently contain the message.</span></span>  
  
 <span data-ttu-id="f3a8c-1879">2つの追加のメソッドを使用すると、キュー内のメッセージをピークすることができます。 <xref:System.Messaging.MessageQueue.Peek%2A> と <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29>です。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1879">Two additional methods allow you to peek messages in a queue: <xref:System.Messaging.MessageQueue.Peek%2A> and <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29>.</span></span> <span data-ttu-id="f3a8c-1880"><xref:System.Messaging.MessageQueue.Peek%2A> メソッドは、キュー内の最初のメッセージを返します。<xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> は、メッセージがキューに送信された結果として作成された、受信確認、レポート、またはアプリケーションで生成された応答メッセージを返します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1880">The <xref:System.Messaging.MessageQueue.Peek%2A> method returns the first message in the queue; <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> returns an acknowledgment, report, or application-generated response message that was created as a result of a message sent to the queue.</span></span>  
  
 <span data-ttu-id="f3a8c-1881">次の表に、この方法をさまざまなワークグループモードで使用できるかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1881">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-1882">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1882">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-1883">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1883">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-1884">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1884">Local computer</span></span>|<span data-ttu-id="f3a8c-1885">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1885">Yes</span></span>|  
|<span data-ttu-id="f3a8c-1886">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1886">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-1887">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1887">Yes</span></span>|  
|<span data-ttu-id="f3a8c-1888">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1888">Remote computer</span></span>|<span data-ttu-id="f3a8c-1889">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1889">No</span></span>|  
|<span data-ttu-id="f3a8c-1890">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1890">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-1891">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1891">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-1892">次のコード例は、<xref:System.Messaging.MessageQueue.PeekById%28System.String%29> の使用方法を示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1892">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.PeekById%28System.String%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#6](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#6)]
 [!code-csharp[MessageQueue2#6](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#6)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="f3a8c-1893"><paramref name="id" /> パラメーターが <see langword="null" /> です。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1893">The <paramref name="id" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="f3a8c-1894">指定した <paramref name="id" /> を持つメッセージが存在しません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1894">No message with the specified <paramref name="id" /> exists.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="f3a8c-1895">メッセージ キューのメソッドにアクセスしたときにエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1895">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.Message.Id" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
      </Docs>
    </Member>
    <Member MemberName="PeekById">
      <MemberSignature Language="C#" Value="public System.Messaging.Message PeekById (string id, TimeSpan timeout);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message PeekById(string id, valuetype System.TimeSpan timeout) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.PeekById(System.String,System.TimeSpan)" />
      <MemberSignature Language="VB.NET" Value="Public Function PeekById (id As String, timeout As TimeSpan) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ PeekById(System::String ^ id, TimeSpan timeout);" />
      <MemberSignature Language="F#" Value="member this.PeekById : string * TimeSpan -&gt; System.Messaging.Message" Usage="messageQueue.PeekById (id, timeout)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="id" Type="System.String" />
        <Parameter Name="timeout" Type="System.TimeSpan" />
      </Parameters>
      <Docs>
        <param name="id"><span data-ttu-id="f3a8c-1896">ピークするメッセージの <see cref="P:System.Messaging.Message.Id" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1896">The <see cref="P:System.Messaging.Message.Id" /> of the message to peek.</span></span></param>
        <param name="timeout"><span data-ttu-id="f3a8c-1897">新しいメッセージを検査できるようになるまでの待機時間を示す <see cref="T:System.TimeSpan" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1897">A <see cref="T:System.TimeSpan" /> that indicates the time to wait until a new message is available for inspection.</span></span></param>
        <summary><span data-ttu-id="f3a8c-1898">メッセージ ID が <paramref name="id" /> パラメーターと一致するメッセージをピークします。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1898">Peeks the message whose message identifier matches the <paramref name="id" /> parameter.</span></span> <span data-ttu-id="f3a8c-1899">メッセージがキューに出現するか、タイムアウトが発生するまで待機します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1899">Waits until the message appears in the queue or a time-out occurs.</span></span></summary>
        <returns><span data-ttu-id="f3a8c-1900"><paramref name="id" /> パラメーターと一致する <see cref="P:System.Messaging.Message.Id" /> プロパティを持つ <see cref="T:System.Messaging.Message" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1900">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.Id" /> property matches the <paramref name="id" /> parameter.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-1901"><xref:System.Messaging.MessageQueue.PeekById%28System.String%29> を使用すると、既知のメッセージ識別子を持つメッセージをキューから削除せずに読み取ることができます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1901">Use <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> to read, without removing from the queue, a message that has a known message identifier.</span></span> <span data-ttu-id="f3a8c-1902">メッセージの識別子はメッセージキューエンタープライズ全体で一意であるため、指定された `id` パラメーターと一致するメッセージがキューに1つだけ存在します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1902">The identifier of a message is unique across the Message Queuing enterprise, so there will be at most one message in the queue that matches the given `id` parameter.</span></span> <span data-ttu-id="f3a8c-1903">現在キューにメッセージが含まれておらず、タイムアウトが発生する前に新しいメッセージが到着しなかった場合、このオーバーロードは例外をスローします。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1903">This overload throws an exception if the queue does not currently contain the message and a new message does not arrive before the time-out occurs.</span></span>  
  
 <span data-ttu-id="f3a8c-1904">`timeout` パラメーターでは、このメソッドの合計実行時間が指定されていません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1904">The `timeout` parameter does not specify the total running time for this method.</span></span> <span data-ttu-id="f3a8c-1905">代わりに、キューに新しいメッセージが到着するまで待機する時間を指定します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1905">Rather, it specifies the time to wait for a new message to arrive in the queue.</span></span> <span data-ttu-id="f3a8c-1906">このメソッドは、新しいメッセージが到着するたびに、新しいメッセージの <xref:System.Messaging.Message.Id%2A> を調べて、`id` パラメーターと一致するかどうかを確認します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1906">Each time a new message arrives, this method examines the <xref:System.Messaging.Message.Id%2A> of the new message to see if it matches the `id` parameter.</span></span> <span data-ttu-id="f3a8c-1907">それ以外の場合、このメソッドはタイムアウト期間を開始し、別の新しいメッセージが到着するまで待機します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1907">If not, this method starts the time-out period over and waits for another new message to arrive.</span></span> <span data-ttu-id="f3a8c-1908">したがって、タイムアウト期間内に新しいメッセージが引き続き到着する場合、このメソッドは、タイムアウト期間が新しいメッセージを受信せずに期限切れになるか、または <xref:System.Messaging.Message.Id%2A> が `id` パラメーターと一致するメッセージが到着するまで、無期限に実行を継続することができます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1908">Therefore, if new messages continue to arrive within the time-out period, it is possible for this method to continue running indefinitely, either until the time-out period expires without any new messages arriving, or until a message arrives whose <xref:System.Messaging.Message.Id%2A> matches the `id` parameter.</span></span>  
  
 <span data-ttu-id="f3a8c-1909">2つの追加のメソッドを使用すると、キュー内のメッセージをピークすることができます。 <xref:System.Messaging.MessageQueue.Peek%2A> と <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29>です。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1909">Two additional methods allow you to peek messages in a queue: <xref:System.Messaging.MessageQueue.Peek%2A> and <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29>.</span></span> <span data-ttu-id="f3a8c-1910"><xref:System.Messaging.MessageQueue.Peek%2A> メソッドは、キュー内の最初のメッセージを返します。<xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> は、メッセージがキューに送信された結果として作成された、受信確認、レポート、またはアプリケーションで生成された応答メッセージを返します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1910">The <xref:System.Messaging.MessageQueue.Peek%2A> method returns the first message in the queue; <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> returns an acknowledgment, report, or application-generated response message that was created as a result of a message sent to the queue.</span></span>  
  
 <span data-ttu-id="f3a8c-1911">次の表に、この方法をさまざまなワークグループモードで使用できるかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1911">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-1912">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1912">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-1913">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1913">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-1914">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1914">Local computer</span></span>|<span data-ttu-id="f3a8c-1915">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1915">Yes</span></span>|  
|<span data-ttu-id="f3a8c-1916">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1916">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-1917">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1917">Yes</span></span>|  
|<span data-ttu-id="f3a8c-1918">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1918">Remote computer</span></span>|<span data-ttu-id="f3a8c-1919">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1919">No</span></span>|  
|<span data-ttu-id="f3a8c-1920">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1920">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-1921">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1921">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-1922">次のコード例は、<xref:System.Messaging.MessageQueue.PeekById%28System.String%2CSystem.TimeSpan%29> の使用方法を示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1922">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.PeekById%28System.String%2CSystem.TimeSpan%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#7](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#7)]
 [!code-csharp[MessageQueue2#7](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#7)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="f3a8c-1923"><paramref name="id" /> パラメーターが <see langword="null" /> です。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1923">The <paramref name="id" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="f3a8c-1924"><paramref name="timeout" /> パラメーターに指定した値が無効です。<paramref name="timeout" /> が <see cref="F:System.TimeSpan.Zero" /> よりも小さいか、<see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" /> よりも大きい可能性があります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1924">The value specified for the <paramref name="timeout" /> parameter is not valid, possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="f3a8c-1925">指定した <paramref name="id" /> のメッセージがキューに存在せず、<paramref name="timeout" /> パラメーターで指定した時間が経過する前にキューに到達しませんでした。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1925">The message with the specified <paramref name="id" /> does not exist in the queue and did not arrive before the period specified by the <paramref name="timeout" /> parameter expired.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="f3a8c-1926">メッセージ キューのメソッドにアクセスしたときにエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1926">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />
        <altmember cref="P:System.Messaging.Message.Id" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
      </Docs>
    </Member>
    <MemberGroup MemberName="PeekByLookupId">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="f3a8c-1927">MSMQ 3.0 で導入されました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1927">Introduced in MSMQ 3.0.</span></span> <span data-ttu-id="f3a8c-1928">キュー内の特定のメッセージをピークします。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1928">Peeks at a specific message from the queue.</span></span> <span data-ttu-id="f3a8c-1929">メッセージは、参照識別子で指定することも、キューの前後の位置関係で指定することもできます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1929">The message can be specified by a lookup identifier or by its position at the front or end of the queue.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="PeekByLookupId">
      <MemberSignature Language="C#" Value="public System.Messaging.Message PeekByLookupId (long lookupId);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message PeekByLookupId(int64 lookupId) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.PeekByLookupId(System.Int64)" />
      <MemberSignature Language="VB.NET" Value="Public Function PeekByLookupId (lookupId As Long) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ PeekByLookupId(long lookupId);" />
      <MemberSignature Language="F#" Value="member this.PeekByLookupId : int64 -&gt; System.Messaging.Message" Usage="messageQueue.PeekByLookupId lookupId" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="lookupId" Type="System.Int64" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="lookupId"><span data-ttu-id="f3a8c-1930">ピークするメッセージの <see cref="P:System.Messaging.Message.LookupId" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1930">The <see cref="P:System.Messaging.Message.LookupId" /> of the message to peek at.</span></span></param>
        <summary><span data-ttu-id="f3a8c-1931">MSMQ 3.0 で導入されました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1931">Introduced in MSMQ 3.0.</span></span> <span data-ttu-id="f3a8c-1932">非トランザクション キュー内の指定した参照識別子に一致するメッセージをピークします。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1932">Peeks at the message that matches the given lookup identifier from a non-transactional queue.</span></span></summary>
        <returns><span data-ttu-id="f3a8c-1933">渡された <paramref name="lookupId" /> パラメーターと一致する <see cref="P:System.Messaging.Message.LookupId" /> プロパティを持つ <see cref="T:System.Messaging.Message" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1933">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.LookupId" /> property matches the <paramref name="lookupId" /> parameter passed in.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-1934">このメソッドを使用して、既知の参照識別子を持つメッセージをキューから削除せずに読み取ります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1934">Use this method to read a message with a known lookup identifier without removing it from the queue.</span></span> <span data-ttu-id="f3a8c-1935">このメソッドは、メッセージがキューに存在しない場合、すぐに例外をスローします。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1935">This method throws an exception immediately if the message is not in the queue.</span></span>  
  
 <span data-ttu-id="f3a8c-1936">メッセージの <xref:System.Messaging.Message.LookupId%2A> プロパティは、メッセージが存在するキューに対して一意であるため、指定された `lookupId` パラメーターに一致するメッセージがキューに1つだけ存在します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1936">The <xref:System.Messaging.Message.LookupId%2A> property of a message is unique to the queue where the message resides, so there will be at most one message in the queue that matches the given `lookupId` parameter.</span></span>  
  
 <span data-ttu-id="f3a8c-1937">指定された参照識別子を持つメッセージを読み取り、キューから削除するには、<xref:System.Messaging.MessageQueue.ReceiveByLookupId%2A> メソッドを使用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1937">To read a message with a specified lookup identifier and remove it from the queue, use the <xref:System.Messaging.MessageQueue.ReceiveByLookupId%2A> method.</span></span>  
  
 <span data-ttu-id="f3a8c-1938">次の表に、この方法をさまざまなワークグループモードで使用できるかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1938">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-1939">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1939">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-1940">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1940">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-1941">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1941">Local computer</span></span>|<span data-ttu-id="f3a8c-1942">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1942">Yes</span></span>|  
|<span data-ttu-id="f3a8c-1943">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1943">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-1944">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1944">Yes</span></span>|  
|<span data-ttu-id="f3a8c-1945">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1945">Remote computer</span></span>|<span data-ttu-id="f3a8c-1946">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1946">No</span></span>|  
|<span data-ttu-id="f3a8c-1947">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1947">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-1948">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1948">Yes</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.PlatformNotSupportedException"><span data-ttu-id="f3a8c-1949">MSMQ 3.0 がインストールされていません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1949">MSMQ 3.0 is not installed.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="f3a8c-1950">指定した <paramref name="lookupId" /> を持つメッセージは見つかりませんでした。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1950">The message with the specified <paramref name="lookupId" /> could not be found.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="f3a8c-1951">メッセージ キューのメソッドにアクセスしたときにエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1951">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.Message.LookupId" />
        <altmember cref="Overload:System.Messaging.MessageQueue.ReceiveByLookupId" />
      </Docs>
    </Member>
    <Member MemberName="PeekByLookupId">
      <MemberSignature Language="C#" Value="public System.Messaging.Message PeekByLookupId (System.Messaging.MessageLookupAction action, long lookupId);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message PeekByLookupId(valuetype System.Messaging.MessageLookupAction action, int64 lookupId) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.PeekByLookupId(System.Messaging.MessageLookupAction,System.Int64)" />
      <MemberSignature Language="VB.NET" Value="Public Function PeekByLookupId (action As MessageLookupAction, lookupId As Long) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ PeekByLookupId(System::Messaging::MessageLookupAction action, long lookupId);" />
      <MemberSignature Language="F#" Value="member this.PeekByLookupId : System.Messaging.MessageLookupAction * int64 -&gt; System.Messaging.Message" Usage="messageQueue.PeekByLookupId (action, lookupId)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="action" Type="System.Messaging.MessageLookupAction" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="lookupId" Type="System.Int64" Index="1" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="action"><span data-ttu-id="f3a8c-1952">キュー内のメッセージを読み取る方法を指定する <see cref="T:System.Messaging.MessageLookupAction" /> のいずれか 1 つ。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1952">One of the <see cref="T:System.Messaging.MessageLookupAction" /> values, specifying how the message is read in the queue.</span></span> <span data-ttu-id="f3a8c-1953">次のいずれかを指定します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1953">Specify one of the following:</span></span> 
 <span data-ttu-id="f3a8c-1954"><see langword="MessageLookupAction.Current" />:<paramref name="lookupId" /> で指定されたメッセージをピークします。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1954"><see langword="MessageLookupAction.Current" />: Peeks at the message specified by <paramref name="lookupId" />.</span></span>  
  
 <span data-ttu-id="f3a8c-1955"><see langword="MessageLookupAction.Next" />:<paramref name="lookupId" /> で指定されたメッセージの次のメッセージをピークします。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1955"><see langword="MessageLookupAction.Next" />: Peeks at the message following the message specified by <paramref name="lookupId" />.</span></span>  
  
 <span data-ttu-id="f3a8c-1956"><see langword="MessageLookupAction.Previous" />:<paramref name="lookupId" /> で指定されたメッセージの前のメッセージをピークします。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1956"><see langword="MessageLookupAction.Previous" />: Peeks at the message preceding the message specified by <paramref name="lookupId" />.</span></span>  
  
 <span data-ttu-id="f3a8c-1957"><see langword="MessageLookupAction.First" />:キューの最初のメッセージをピークします。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1957"><see langword="MessageLookupAction.First" />: Peeks at the first message in the queue.</span></span> <span data-ttu-id="f3a8c-1958"><paramref name="lookupId" /> パラメーターは、0 に設定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1958">The <paramref name="lookupId" /> parameter must be set to 0.</span></span>  
  
 <span data-ttu-id="f3a8c-1959"><see langword="MessageLookupAction.Last" />:キューの最後のメッセージをピークします。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1959"><see langword="MessageLookupAction.Last" />: Peeks at the last message in the queue.</span></span> <span data-ttu-id="f3a8c-1960"><paramref name="lookupId" /> パラメーターは、0 に設定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1960">The <paramref name="lookupId" /> parameter must be set to 0.</span></span></param>
        <param name="lookupId"><span data-ttu-id="f3a8c-1961">ピークするメッセージの <see cref="P:System.Messaging.Message.LookupId" /> か、0。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1961">The <see cref="P:System.Messaging.Message.LookupId" /> of the message to peek at, or 0.</span></span> <span data-ttu-id="f3a8c-1962">キューの最初または最後のメッセージにアクセスする場合は 0 を使用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1962">0 is used when accessing the first or last message in the queue.</span></span></param>
        <summary><span data-ttu-id="f3a8c-1963">MSMQ 3.0 で導入されました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1963">Introduced in MSMQ 3.0.</span></span> <span data-ttu-id="f3a8c-1964">キュー内の特定のメッセージをピークします。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1964">Peeks at a specific message from the queue.</span></span> <span data-ttu-id="f3a8c-1965">メッセージは、参照識別子で指定することも、キューの前後の位置関係で指定することもできます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1965">The message can be specified by a lookup identifier or by its position at the front or end of the queue.</span></span></summary>
        <returns><span data-ttu-id="f3a8c-1966">渡された <paramref name="action" /> パラメーターおよび <paramref name="lookupId" /> パラメーターで指定された <see cref="T:System.Messaging.Message" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1966">The <see cref="T:System.Messaging.Message" /> specified by the <paramref name="action" /> and <paramref name="lookupId" /> parameters passed in.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-1967">このメソッドを使用して、既知の参照識別子を持つメッセージをキューから削除せずに読み取ります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1967">Use this method to read a message with a known lookup identifier without removing it from the queue.</span></span> <span data-ttu-id="f3a8c-1968">このメソッドは、メッセージがキューに存在しない場合、すぐに例外をスローします。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1968">This method throws an exception immediately if the message is not in the queue.</span></span>  
  
 <span data-ttu-id="f3a8c-1969">メッセージの <xref:System.Messaging.Message.LookupId%2A> プロパティは、メッセージが存在するキューに対して一意であるため、指定された `lookupId` パラメーターに一致するメッセージがキューに1つだけ存在します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1969">The <xref:System.Messaging.Message.LookupId%2A> property of a message is unique to the queue where the message resides, so there will be at most one message in the queue that matches the given `lookupId` parameter.</span></span>  
  
 <span data-ttu-id="f3a8c-1970">指定された id を持つメッセージを読み取り、キューから削除するには、<xref:System.Messaging.MessageQueue.ReceiveByLookupId%2A> メソッドを使用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1970">To read a message with a specified identifier and remove it from the queue, use the <xref:System.Messaging.MessageQueue.ReceiveByLookupId%2A> method.</span></span>  
  
 <span data-ttu-id="f3a8c-1971">次の表に、この方法をさまざまなワークグループモードで使用できるかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1971">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-1972">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1972">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-1973">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1973">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-1974">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1974">Local computer</span></span>|<span data-ttu-id="f3a8c-1975">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1975">Yes</span></span>|  
|<span data-ttu-id="f3a8c-1976">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1976">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-1977">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1977">Yes</span></span>|  
|<span data-ttu-id="f3a8c-1978">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1978">Remote computer</span></span>|<span data-ttu-id="f3a8c-1979">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1979">No</span></span>|  
|<span data-ttu-id="f3a8c-1980">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1980">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-1981">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1981">Yes</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.PlatformNotSupportedException"><span data-ttu-id="f3a8c-1982">MSMQ 3.0 がインストールされていません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1982">MSMQ 3.0 is not installed.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="f3a8c-1983">指定した <paramref name="lookupId" /> を持つメッセージは見つかりませんでした。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1983">The message with the specified <paramref name="lookupId" /> could not be found.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="f3a8c-1984">メッセージ キューのメソッドにアクセスしたときにエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1984">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException"><span data-ttu-id="f3a8c-1985"><paramref name="action" /> パラメーターが、<see cref="T:System.Messaging.MessageLookupAction" /> メンバーの 1 つではありません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1985">The <paramref name="action" /> parameter is not one of the <see cref="T:System.Messaging.MessageLookupAction" /> members.</span></span></exception>
        <altmember cref="P:System.Messaging.Message.LookupId" />
        <altmember cref="Overload:System.Messaging.MessageQueue.ReceiveByLookupId" />
      </Docs>
    </Member>
    <Member MemberName="PeekCompleted">
      <MemberSignature Language="C#" Value="public event System.Messaging.PeekCompletedEventHandler PeekCompleted;" />
      <MemberSignature Language="ILAsm" Value=".event class System.Messaging.PeekCompletedEventHandler PeekCompleted" />
      <MemberSignature Language="DocId" Value="E:System.Messaging.MessageQueue.PeekCompleted" />
      <MemberSignature Language="VB.NET" Value="Public Custom Event PeekCompleted As PeekCompletedEventHandler " />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; event System::Messaging::PeekCompletedEventHandler ^ PeekCompleted;" />
      <MemberSignature Language="F#" Value="member this.PeekCompleted : System.Messaging.PeekCompletedEventHandler " Usage="member this.PeekCompleted : System.Messaging.PeekCompletedEventHandler " />
      <MemberType>Event</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_PeekCompleted")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Messaging.PeekCompletedEventHandler</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="f3a8c-1986">キューから削除せずにメッセージを読み取ると発生します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1986">Occurs when a message is read without being removed from the queue.</span></span> <span data-ttu-id="f3a8c-1987">この発生は、非同期操作 <see cref="M:System.Messaging.MessageQueue.BeginPeek" /> の結果です。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1987">This is a result of the asynchronous operation, <see cref="M:System.Messaging.MessageQueue.BeginPeek" />.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-1988"><xref:System.Messaging.MessageQueue.BeginPeek%2A> は、メッセージがキューで利用可能な場合に、非同期処理で <xref:System.Messaging.MessageQueue.PeekCompleted> イベントを発生させるために使用されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1988"><xref:System.Messaging.MessageQueue.BeginPeek%2A> is used in asynchronous processing to raise the <xref:System.Messaging.MessageQueue.PeekCompleted> event when a message is available in the queue.</span></span>  
  
 <span data-ttu-id="f3a8c-1989"><xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> は、<xref:System.Messaging.MessageQueue.BeginPeek%2A> の呼び出しによって開始される操作を完了し、<xref:System.Messaging.MessageQueue.PeekCompleted> イベントが発生したときにメッセージをピークするために使用されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1989"><xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> is used to complete the operation initiated by a call to <xref:System.Messaging.MessageQueue.BeginPeek%2A> and peek the message when the <xref:System.Messaging.MessageQueue.PeekCompleted> event is raised.</span></span>  
  
 <span data-ttu-id="f3a8c-1990"><xref:System.Messaging.PeekCompletedEventHandler> デリゲートを作成する場合は、イベントを処理するメソッドを指定します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1990">When you create a <xref:System.Messaging.PeekCompletedEventHandler> delegate, you identify the method that will handle the event.</span></span> <span data-ttu-id="f3a8c-1991">イベントをイベント ハンドラーに関連付けるには、デリゲートのインスタンスをイベントに追加します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1991">To associate the event with your event handler, add an instance of the delegate to the event.</span></span> <span data-ttu-id="f3a8c-1992">デリゲートを削除しない限り、そのイベントが発生すると常にイベント ハンドラーが呼び出されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1992">The event handler is called whenever the event occurs, unless you remove the delegate.</span></span> <span data-ttu-id="f3a8c-1993">イベントハンドラーデリゲートの詳細については、「[イベントの処理と発生](~/docs/standard/events/index.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1993">For more information about event handler delegates, see [Handling and Raising Events](~/docs/standard/events/index.md).</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-1994">次のコード例では、`MyPeekCompleted`という名前のイベントハンドラーを作成し、それを <xref:System.Messaging.MessageQueue.PeekCompleted> イベントハンドラーデリゲートにアタッチし、<xref:System.Messaging.MessageQueue.BeginPeek%2A> を呼び出して、パス ".\myQueue" にあるキューで非同期のピーク操作を開始します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1994">The following code example creates an event handler named `MyPeekCompleted`, attaches it to the <xref:System.Messaging.MessageQueue.PeekCompleted> event handler delegate, and calls <xref:System.Messaging.MessageQueue.BeginPeek%2A> to initiate an asynchronous peek operation on the queue that is located at the path ".\myQueue".</span></span> <span data-ttu-id="f3a8c-1995"><xref:System.Messaging.MessageQueue.PeekCompleted> イベントが発生すると、この例ではメッセージをピークし、その本文を画面に書き込みます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1995">When a <xref:System.Messaging.MessageQueue.PeekCompleted> event is raised, the example peeks the message and writes its body to the screen.</span></span> <span data-ttu-id="f3a8c-1996">この例では、<xref:System.Messaging.MessageQueue.BeginPeek%2A> を再度呼び出して、新しい非同期ピーク操作を開始します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1996">The example then calls <xref:System.Messaging.MessageQueue.BeginPeek%2A> again to initiate a new asynchronous peek operation</span></span>  
  
 [!code-cpp[MessageQueue.BeginPeek_noparms#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.BeginPeek_noparms/CPP/mqbeginpeek_noparms.cpp#1)]
 [!code-csharp[MessageQueue.BeginPeek_noparms#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.BeginPeek_noparms/CS/mqbeginpeek_noparms.cs#1)]
 [!code-vb[MessageQueue.BeginPeek_noparms#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.BeginPeek_noparms/VB/mqbeginpeek_noparms.vb#1)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="E:System.Messaging.MessageQueue.ReceiveCompleted" />
        <altmember cref="T:System.TimeSpan" />
        <altmember cref="T:System.AsyncCallback" />
        <altmember cref="T:System.IAsyncResult" />
      </Docs>
    </Member>
    <Member MemberName="Purge">
      <MemberSignature Language="C#" Value="public void Purge ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void Purge() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Purge" />
      <MemberSignature Language="VB.NET" Value="Public Sub Purge ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void Purge();" />
      <MemberSignature Language="F#" Value="member this.Purge : unit -&gt; unit" Usage="messageQueue.Purge " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="f3a8c-1997">キューに含まれるすべてのメッセージを削除します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1997">Deletes all the messages contained in the queue.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-1998">キューを削除すると、メッセージキューによってキューの変更フラグが設定され、<xref:System.Messaging.MessageQueue.LastModifyTime%2A> のプロパティに影響します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1998">Purging the queue causes Message Queuing to set the queue modification flag, which affects the <xref:System.Messaging.MessageQueue.LastModifyTime%2A> property.</span></span> <span data-ttu-id="f3a8c-1999">キューから削除されたメッセージは失われます。これらのメッセージは、配信不能キューまたはジャーナルキューには送信されません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-1999">Messages that are purged from the queue are lost; they are not sent to the dead-letter queue or the journal queue.</span></span>  
  
 <span data-ttu-id="f3a8c-2000">次の表に、この方法をさまざまなワークグループモードで使用できるかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2000">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-2001">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2001">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-2002">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2002">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-2003">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2003">Local computer</span></span>|<span data-ttu-id="f3a8c-2004">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2004">Yes</span></span>|  
|<span data-ttu-id="f3a8c-2005">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2005">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-2006">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2006">Yes</span></span>|  
|<span data-ttu-id="f3a8c-2007">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2007">Remote computer</span></span>|<span data-ttu-id="f3a8c-2008">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2008">No</span></span>|  
|<span data-ttu-id="f3a8c-2009">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2009">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-2010">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2010">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-2011">次のコード例は、<xref:System.Messaging.MessageQueue.Purge%2A> の使用方法を示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2011">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.Purge%2A>.</span></span>  
  
 [!code-cpp[MessageQueue2#29](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#29)]
 [!code-csharp[MessageQueue2#29](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#29)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="f3a8c-2012">メッセージ キューのメソッドにアクセスしたときにエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2012">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="M:System.Messaging.MessageQueue.Close" />
        <altmember cref="M:System.Messaging.MessageQueue.Refresh" />
      </Docs>
    </Member>
    <Member MemberName="QueueName">
      <MemberSignature Language="C#" Value="public string QueueName { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string QueueName" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.QueueName" />
      <MemberSignature Language="VB.NET" Value="Public Property QueueName As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ QueueName { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberSignature Language="F#" Value="member this.QueueName : string with get, set" Usage="System.Messaging.MessageQueue.QueueName" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_QueueName")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="f3a8c-2013">キューを識別する表示名を取得または設定します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2013">Gets or sets the friendly name that identifies the queue.</span></span></summary>
        <value><span data-ttu-id="f3a8c-2014">この <see cref="T:System.Messaging.MessageQueue" /> が参照するキューを識別する名前。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2014">The name that identifies the queue referenced by this <see cref="T:System.Messaging.MessageQueue" />.</span></span> <span data-ttu-id="f3a8c-2015">値を <see langword="null" /> にすることはできません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2015">The value cannot be <see langword="null" />.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-2016"><xref:System.Messaging.MessageQueue.QueueName%2A> と <xref:System.Messaging.MessageQueue.MachineName%2A> を組み合わせて、キューのフレンドリ <xref:System.Messaging.MessageQueue.Path%2A> 名を作成できます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2016">You can combine the <xref:System.Messaging.MessageQueue.QueueName%2A> with the <xref:System.Messaging.MessageQueue.MachineName%2A> to create a friendly <xref:System.Messaging.MessageQueue.Path%2A> name for the queue.</span></span> <span data-ttu-id="f3a8c-2017"><xref:System.Messaging.MessageQueue.Path%2A> プロパティのフレンドリ名のバリエーションの構文は、次の表に示すように、キューの種類によって異なります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2017">The syntax for the friendly name variation of the <xref:System.Messaging.MessageQueue.Path%2A> property depends on the type of queue, as shown in the following table.</span></span>  
  
|<span data-ttu-id="f3a8c-2018">[キューの種類]</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2018">Queue type</span></span>|<span data-ttu-id="f3a8c-2019">構文</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2019">Syntax</span></span>|  
|----------------|------------|  
|<span data-ttu-id="f3a8c-2020">パブリックキュー</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2020">Public queue</span></span>|`MachineName`\\`QueueName`|  
|<span data-ttu-id="f3a8c-2021">専用キュー</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2021">Private queue</span></span>|`MachineName`\\`Private$`\\`QueueName`|  
|<span data-ttu-id="f3a8c-2022">ジャーナル キュー</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2022">Journal queue</span></span>|`MachineName`\\`QueueName`\\`Journal$`|  
  
 <span data-ttu-id="f3a8c-2023">"." を使用してローカルコンピューターを表します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2023">Use "." to represent the local computer.</span></span>  
  
 <span data-ttu-id="f3a8c-2024"><xref:System.Messaging.MessageQueue.QueueName%2A> プロパティを変更すると、<xref:System.Messaging.MessageQueue.Path%2A> プロパティに影響します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2024">Changing the <xref:System.Messaging.MessageQueue.QueueName%2A> property affects the <xref:System.Messaging.MessageQueue.Path%2A> property.</span></span> <span data-ttu-id="f3a8c-2025"><xref:System.Messaging.MessageQueue.MachineName%2A> プロパティを設定せずに <xref:System.Messaging.MessageQueue.QueueName%2A> を設定した場合、<xref:System.Messaging.MessageQueue.Path%2A> プロパティはになります。`QueueName`を\\します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2025">If you set the <xref:System.Messaging.MessageQueue.QueueName%2A> without setting the <xref:System.Messaging.MessageQueue.MachineName%2A> property, the <xref:System.Messaging.MessageQueue.Path%2A> property becomes .\\`QueueName`.</span></span> <span data-ttu-id="f3a8c-2026">それ以外の場合、<xref:System.Messaging.MessageQueue.Path%2A> は `QueueName`\\`MachineName`になります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2026">Otherwise, the <xref:System.Messaging.MessageQueue.Path%2A> becomes `MachineName`\\`QueueName`.</span></span>  
  
 <span data-ttu-id="f3a8c-2027">次の表は、このプロパティがさまざまなワークグループモードで使用できるかどうかを示しています。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2027">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-2028">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2028">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-2029">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2029">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-2030">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2030">Local computer</span></span>|<span data-ttu-id="f3a8c-2031">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2031">Yes</span></span>|  
|<span data-ttu-id="f3a8c-2032">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2032">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-2033">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2033">Yes</span></span>|  
|<span data-ttu-id="f3a8c-2034">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2034">Remote computer</span></span>|<span data-ttu-id="f3a8c-2035">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2035">Yes</span></span>|  
|<span data-ttu-id="f3a8c-2036">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2036">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-2037">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2037">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-2038">次のコード例では、メッセージキューの <xref:System.Messaging.MessageQueue.QueueName%2A> プロパティの値を取得して設定します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2038">The following code example gets and sets the value of a message queue's <xref:System.Messaging.MessageQueue.QueueName%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#24](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#24)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="f3a8c-2039">キュー名が <see langword="null" /> です。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2039">The queue name is <see langword="null" />.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.Path" />
        <altmember cref="P:System.Messaging.MessageQueue.MachineName" />
      </Docs>
    </Member>
    <Member MemberName="ReadHandle">
      <MemberSignature Language="C#" Value="public IntPtr ReadHandle { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance native int ReadHandle" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.ReadHandle" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property ReadHandle As IntPtr" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property IntPtr ReadHandle { IntPtr get(); };" />
      <MemberSignature Language="F#" Value="member this.ReadHandle : nativeint" Usage="System.Messaging.MessageQueue.ReadHandle" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_ReadHandle")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.IntPtr</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="f3a8c-2040">メッセージ キューからメッセージを読み取るときに使用するネイティブ ハンドルを取得します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2040">Gets the native handle used to read messages from the message queue.</span></span></summary>
        <value><span data-ttu-id="f3a8c-2041">キューからメッセージをピークおよび受信するときに使用するネイティブ キューオブジェクトへのハンドル。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2041">A handle to the native queue object that you use for peeking and receiving messages from the queue.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-2042"><xref:System.Messaging.MessageQueue.ReadHandle%2A> は、キューからメッセージをピークおよび受信するために使用されるメッセージキューオブジェクトへのネイティブ Windows ハンドルを提供します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2042">The <xref:System.Messaging.MessageQueue.ReadHandle%2A> provides a native Windows handle to the message queue object that is used for peeking and receiving messages from the queue.</span></span> <span data-ttu-id="f3a8c-2043">キューのパスを変更すると、ハンドルは閉じられ、新しい値で再び開かれます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2043">If you change the path of the queue, the handle is closed and reopened with a new value.</span></span>  
  
 <span data-ttu-id="f3a8c-2044">次の表は、このプロパティがさまざまなワークグループモードで使用できるかどうかを示しています。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2044">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-2045">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2045">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-2046">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2046">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-2047">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2047">Local computer</span></span>|<span data-ttu-id="f3a8c-2048">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2048">Yes</span></span>|  
|<span data-ttu-id="f3a8c-2049">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2049">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-2050">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2050">Yes</span></span>|  
|<span data-ttu-id="f3a8c-2051">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2051">Remote computer</span></span>|<span data-ttu-id="f3a8c-2052">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2052">No</span></span>|  
|<span data-ttu-id="f3a8c-2053">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2053">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-2054">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2054">Yes</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="f3a8c-2055">メッセージ キューのメソッドにアクセスしたときにエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2055">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.CanRead" />
        <altmember cref="P:System.Messaging.MessageQueue.WriteHandle" />
      </Docs>
    </Member>
    <MemberGroup MemberName="Receive">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <threadsafe><span data-ttu-id="f3a8c-2056">メソッドはスレッドセーフではありません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2056">The method is not thread safe.</span></span></threadsafe>
        <summary><span data-ttu-id="f3a8c-2057">キューにある最初のメッセージを受信し、キューから削除します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2057">Receives the first message in the queue, removing it from the queue.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="Receive">
      <MemberSignature Language="C#" Value="public System.Messaging.Message Receive ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message Receive() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Receive" />
      <MemberSignature Language="VB.NET" Value="Public Function Receive () As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ Receive();" />
      <MemberSignature Language="F#" Value="member this.Receive : unit -&gt; System.Messaging.Message" Usage="messageQueue.Receive " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="f3a8c-2058"><see cref="T:System.Messaging.MessageQueue" /> で参照されるキューで利用できる最初のメッセージを受信します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2058">Receives the first message available in the queue referenced by the <see cref="T:System.Messaging.MessageQueue" />.</span></span> <span data-ttu-id="f3a8c-2059">この呼び出しは同期呼び出しであるため、メッセージが利用可能になるまで、現在のスレッドの実行をブロックします。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2059">This call is synchronous, and blocks the current thread of execution until a message is available.</span></span></summary>
        <returns><span data-ttu-id="f3a8c-2060">キューで利用できる最初のメッセージを参照する <see cref="T:System.Messaging.Message" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2060">A <see cref="T:System.Messaging.Message" /> that references the first message available in the queue.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-2061">このオーバーロードを使用して、キューからメッセージを受信するか、キュー内にメッセージが存在するまで待機します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2061">Use this overload to receive a message from a queue, or wait until there are messages in the queue.</span></span>  
  
 <span data-ttu-id="f3a8c-2062"><xref:System.Messaging.MessageQueue.Receive%2A> メソッドを使用すると、メッセージを同期的に読み取ることができ、それによってキューからメッセージが削除されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2062">The <xref:System.Messaging.MessageQueue.Receive%2A> method allows for the synchronous reading of a message, thereby removing it from the queue.</span></span> <span data-ttu-id="f3a8c-2063">後続の <xref:System.Messaging.MessageQueue.Receive%2A> を呼び出すと、キューにあるメッセージ、または新しい優先順位のメッセージが返されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2063">Subsequent calls to <xref:System.Messaging.MessageQueue.Receive%2A> will return the messages that follow in the queue, or new, higher priority messages.</span></span>  
  
 <span data-ttu-id="f3a8c-2064">キューの最初のメッセージをキューから削除せずに読み取るには、<xref:System.Messaging.MessageQueue.Peek%2A> メソッドを使用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2064">To read the first message in a queue without removing it from the queue, use the <xref:System.Messaging.MessageQueue.Peek%2A> method.</span></span> <span data-ttu-id="f3a8c-2065"><xref:System.Messaging.MessageQueue.Peek%2A> メソッドは常にキュー内の最初のメッセージを返します。そのため、後続のメソッドの呼び出しでは、優先順位の高いメッセージがキューに到着しない限り、同じメッセージが返されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2065">The <xref:System.Messaging.MessageQueue.Peek%2A> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span>  
  
 <span data-ttu-id="f3a8c-2066">メッセージがキューに到着するのを待機している間に、現在のスレッドがブロックされてもかまわない場合は、<xref:System.Messaging.MessageQueue.Receive%2A> の呼び出しを使用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2066">Use a call to <xref:System.Messaging.MessageQueue.Receive%2A> when it is acceptable for the current thread to be blocked while it waits for a message to arrive in the queue.</span></span> <span data-ttu-id="f3a8c-2067"><xref:System.Messaging.MessageQueue.Receive%2A> メソッドのこのオーバーロードは無限のタイムアウトを指定するため、アプリケーションは無制限に待機する可能性があります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2067">Because this overload of the <xref:System.Messaging.MessageQueue.Receive%2A> method specifies an infinite time-out, the application might wait indefinitely.</span></span> <span data-ttu-id="f3a8c-2068">メッセージを待たずにアプリケーションの処理を続行する場合は、非同期メソッドを使用することを検討してください <xref:System.Messaging.MessageQueue.BeginReceive%2A>。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2068">If the application processing should continue without waiting for the message, consider using the asynchronous method, <xref:System.Messaging.MessageQueue.BeginReceive%2A>.</span></span>  
  
 <span data-ttu-id="f3a8c-2069">次の表に、この方法をさまざまなワークグループモードで使用できるかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2069">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-2070">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2070">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-2071">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2071">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-2072">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2072">Local computer</span></span>|<span data-ttu-id="f3a8c-2073">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2073">Yes</span></span>|  
|<span data-ttu-id="f3a8c-2074">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2074">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-2075">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2075">Yes</span></span>|  
|<span data-ttu-id="f3a8c-2076">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2076">Remote computer</span></span>|<span data-ttu-id="f3a8c-2077">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2077">No</span></span>|  
|<span data-ttu-id="f3a8c-2078">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2078">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-2079">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2079">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-2080">次のコード例では、キューからメッセージを受信し、そのメッセージに関する情報を画面に出力します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2080">The following code example receives a message from a queue and outputs information about that message to the screen.</span></span>  
  
 [!code-cpp[MessageQueue.Receive_noparms#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Receive_noparms/CPP/mqreceive_noparms.cpp#1)]
 [!code-csharp[MessageQueue.Receive_noparms#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Receive_noparms/CS/mqreceive_noparms.cs#1)]
 [!code-vb[MessageQueue.Receive_noparms#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Receive_noparms/VB/mqreceive_noparms.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="f3a8c-2081">メッセージ キューのメソッドにアクセスしたときにエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2081">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="Receive">
      <MemberSignature Language="C#" Value="public System.Messaging.Message Receive (System.Messaging.MessageQueueTransaction transaction);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message Receive(class System.Messaging.MessageQueueTransaction transaction) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Receive(System.Messaging.MessageQueueTransaction)" />
      <MemberSignature Language="VB.NET" Value="Public Function Receive (transaction As MessageQueueTransaction) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ Receive(System::Messaging::MessageQueueTransaction ^ transaction);" />
      <MemberSignature Language="F#" Value="member this.Receive : System.Messaging.MessageQueueTransaction -&gt; System.Messaging.Message" Usage="messageQueue.Receive transaction" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="transaction" Type="System.Messaging.MessageQueueTransaction" />
      </Parameters>
      <Docs>
        <param name="transaction"><span data-ttu-id="f3a8c-2082"><see cref="T:System.Messaging.MessageQueueTransaction" /> オブジェクト。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2082">The <see cref="T:System.Messaging.MessageQueueTransaction" /> object.</span></span></param>
        <summary><span data-ttu-id="f3a8c-2083"><see cref="T:System.Messaging.MessageQueue" /> で参照されるトランザクション キューで利用できる最初のメッセージを受信します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2083">Receives the first message available in the transactional queue referenced by the <see cref="T:System.Messaging.MessageQueue" />.</span></span> <span data-ttu-id="f3a8c-2084">この呼び出しは同期呼び出しであるため、メッセージが利用可能になるまで、現在のスレッドの実行をブロックします。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2084">This call is synchronous, and blocks the current thread of execution until a message is available.</span></span></summary>
        <returns><span data-ttu-id="f3a8c-2085">キューで利用できる最初のメッセージを参照する <see cref="T:System.Messaging.Message" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2085">A <see cref="T:System.Messaging.Message" /> that references the first message available in the queue.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-2086">このオーバーロードを使用して、`transaction` パラメーターで定義された内部トランザクションコンテキストを使用してトランザクションキューからメッセージを受信するか、キュー内にメッセージが存在するまで待機します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2086">Use this overload to receive a message from a transactional queue using the internal transaction context defined by the `transaction` parameter, or wait until there are messages in the queue.</span></span>  
  
 <span data-ttu-id="f3a8c-2087"><xref:System.Messaging.MessageQueue.Receive%2A> メソッドを使用すると、メッセージを同期的に読み取ることができ、それによってキューからメッセージが削除されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2087">The <xref:System.Messaging.MessageQueue.Receive%2A> method allows for the synchronous reading of a message, thereby removing it from the queue.</span></span> <span data-ttu-id="f3a8c-2088">後続の <xref:System.Messaging.MessageQueue.Receive%2A> を呼び出すと、キュー内の次のメッセージが返されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2088">Subsequent calls to <xref:System.Messaging.MessageQueue.Receive%2A> will return the messages that follow in the queue.</span></span>  
  
 <span data-ttu-id="f3a8c-2089">このメソッドはトランザクションキューで呼び出されるため、トランザクションが中止されると、受信したメッセージがキューに返されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2089">Because this method is called on a transactional queue, the message that is received would be returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="f3a8c-2090">トランザクションがコミットされるまで、メッセージはキューから完全に削除されません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2090">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="f3a8c-2091">キューの最初のメッセージをキューから削除せずに読み取るには、<xref:System.Messaging.MessageQueue.Peek%2A> メソッドを使用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2091">To read the first message in a queue without removing it from the queue, use the <xref:System.Messaging.MessageQueue.Peek%2A> method.</span></span> <span data-ttu-id="f3a8c-2092"><xref:System.Messaging.MessageQueue.Peek%2A> メソッドは常にキュー内の最初のメッセージを返します。そのため、後続のメソッドの呼び出しでは、優先順位の高いメッセージがキューに到着しない限り、同じメッセージが返されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2092">The <xref:System.Messaging.MessageQueue.Peek%2A> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span> <span data-ttu-id="f3a8c-2093"><xref:System.Messaging.MessageQueue.Peek%2A>への呼び出しによって返されたメッセージに関連付けられたトランザクションコンテキストがありません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2093">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.Peek%2A>.</span></span> <span data-ttu-id="f3a8c-2094"><xref:System.Messaging.MessageQueue.Peek%2A> によってキュー内のメッセージは削除されないため、<xref:System.Messaging.MessageQueueTransaction.Abort%2A>の呼び出しによってロールバックするものはありません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2094">Because <xref:System.Messaging.MessageQueue.Peek%2A> does not remove any messages in the queue, there would be nothing to roll back by a call to <xref:System.Messaging.MessageQueueTransaction.Abort%2A>.</span></span>  
  
 <span data-ttu-id="f3a8c-2095">メッセージがキューに到着するのを待機している間に、現在のスレッドがブロックされてもかまわない場合は、<xref:System.Messaging.MessageQueue.Receive%2A> の呼び出しを使用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2095">Use a call to <xref:System.Messaging.MessageQueue.Receive%2A> when it is acceptable for the current thread to be blocked while it waits for a message to arrive in the queue.</span></span> <span data-ttu-id="f3a8c-2096"><xref:System.Messaging.MessageQueue.Receive%2A> メソッドのこのオーバーロードは無限のタイムアウトを指定するため、アプリケーションは無制限に待機する可能性があります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2096">Because this overload of the <xref:System.Messaging.MessageQueue.Receive%2A> method specifies an infinite time-out, the application might wait indefinitely.</span></span> <span data-ttu-id="f3a8c-2097">メッセージを待たずにアプリケーションの処理を続行する場合は、非同期メソッドを使用することを検討してください <xref:System.Messaging.MessageQueue.BeginReceive%2A>。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2097">If the application processing should continue without waiting for the message, consider using the asynchronous method, <xref:System.Messaging.MessageQueue.BeginReceive%2A>.</span></span>  
  
 <span data-ttu-id="f3a8c-2098">次の表に、この方法をさまざまなワークグループモードで使用できるかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2098">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-2099">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2099">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-2100">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2100">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-2101">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2101">Local computer</span></span>|<span data-ttu-id="f3a8c-2102">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2102">Yes</span></span>|  
|<span data-ttu-id="f3a8c-2103">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2103">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-2104">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2104">Yes</span></span>|  
|<span data-ttu-id="f3a8c-2105">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2105">Remote computer</span></span>|<span data-ttu-id="f3a8c-2106">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2106">No</span></span>|  
|<span data-ttu-id="f3a8c-2107">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2107">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-2108">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2108">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-2109">次のコード例では、ローカルコンピューター上のトランザクションキューに接続し、メッセージをキューに送信します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2109">The following code example connects to a transactional queue on the local computer and sends a message to the queue.</span></span> <span data-ttu-id="f3a8c-2110">次に、注文を含むメッセージを受信します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2110">It then receives the message that contains an order.</span></span> <span data-ttu-id="f3a8c-2111">トランザクション以外のキューが検出されると、例外がスローされ、トランザクションがロールバックされます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2111">If it encounters a non-transactional queue, it will throw and exception and rollback the transaction.</span></span>  
  
 [!code-cpp[MessageQueue.Receive_transaction#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Receive_transaction/CPP/mqreceive_transaction.cpp#1)]
 [!code-csharp[MessageQueue.Receive_transaction#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Receive_transaction/CS/mqreceive_transaction.cs#1)]
 [!code-vb[MessageQueue.Receive_transaction#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Receive_transaction/VB/mqreceive_transaction.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="f3a8c-2112">メッセージ キューのメソッドにアクセスしたときにエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2112">An error occurred when accessing a Message Queuing method.</span></span>  
  
 <span data-ttu-id="f3a8c-2113">- または -</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2113">-or-</span></span>  
  
 <span data-ttu-id="f3a8c-2114">キューが非トランザクション キューです。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2114">The queue is non-transactional.</span></span></exception>
        <threadsafe><span data-ttu-id="f3a8c-2115">メソッドはスレッドセーフではありません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2115">The method is not thread safe.</span></span></threadsafe>
        <altmember cref="T:System.Messaging.MessageQueueTransaction" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="Receive">
      <MemberSignature Language="C#" Value="public System.Messaging.Message Receive (System.Messaging.MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message Receive(valuetype System.Messaging.MessageQueueTransactionType transactionType) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Receive(System.Messaging.MessageQueueTransactionType)" />
      <MemberSignature Language="VB.NET" Value="Public Function Receive (transactionType As MessageQueueTransactionType) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ Receive(System::Messaging::MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="F#" Value="member this.Receive : System.Messaging.MessageQueueTransactionType -&gt; System.Messaging.Message" Usage="messageQueue.Receive transactionType" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="transactionType" Type="System.Messaging.MessageQueueTransactionType" />
      </Parameters>
      <Docs>
        <param name="transactionType"><span data-ttu-id="f3a8c-2116">メッセージと関連付けるトランザクション コンテキストの種類を示す、<see cref="T:System.Messaging.MessageQueueTransactionType" /> 値の 1 つ。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2116">One of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> values, describing the type of transaction context to associate with the message.</span></span></param>
        <summary><span data-ttu-id="f3a8c-2117"><see cref="T:System.Messaging.MessageQueue" /> で参照されるキューで利用できる最初のメッセージを受信します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2117">Receives the first message available in the queue referenced by the <see cref="T:System.Messaging.MessageQueue" />.</span></span> <span data-ttu-id="f3a8c-2118">この呼び出しは同期呼び出しであるため、メッセージが利用可能になるまで、現在のスレッドの実行をブロックします。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2118">This call is synchronous, and blocks the current thread of execution until a message is available.</span></span></summary>
        <returns><span data-ttu-id="f3a8c-2119">キューで利用できる最初のメッセージを参照する <see cref="T:System.Messaging.Message" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2119">A <see cref="T:System.Messaging.Message" /> that references the first message available in the queue.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-2120">このオーバーロードを使用して、`transactionType` パラメーターで定義されたトランザクションコンテキストを使用してキューからメッセージを受信するか、キュー内にメッセージが存在するまで待機します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2120">Use this overload to receive a message from a queue using a transaction context defined by the `transactionType` parameter, or wait until there are messages in the queue.</span></span>  
  
 <span data-ttu-id="f3a8c-2121">メッセージの受信に使用するスレッドに既に外部トランザクションコンテキストがアタッチされている場合は、`transactionType` パラメーターに `Automatic` を指定します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2121">Specify `Automatic` for the `transactionType` parameter if there is already an external transaction context attached to the thread that you want to use to receive the message.</span></span> <span data-ttu-id="f3a8c-2122">メッセージを1つの内部トランザクションとして受信する場合は、`Single` を指定します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2122">Specify `Single` if you want to receive the message as a single internal transaction.</span></span> <span data-ttu-id="f3a8c-2123">トランザクションコンテキストの外部にあるトランザクションキューからメッセージを受信する場合は、`None` を指定できます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2123">You can specify `None` if you want to receive a message from a transactional queue outside of a transaction context.</span></span>  
  
 <span data-ttu-id="f3a8c-2124"><xref:System.Messaging.MessageQueue.Receive%2A> メソッドを使用すると、メッセージを同期的に読み取ることができ、それによってキューからメッセージが削除されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2124">The <xref:System.Messaging.MessageQueue.Receive%2A> method allows for the synchronous reading of a message, thereby removing it from the queue.</span></span> <span data-ttu-id="f3a8c-2125">後続の <xref:System.Messaging.MessageQueue.Receive%2A> を呼び出すと、キュー内の次のメッセージが返されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2125">Subsequent calls to <xref:System.Messaging.MessageQueue.Receive%2A> will return the messages that follow in the queue.</span></span>  
  
 <span data-ttu-id="f3a8c-2126">トランザクションキューからメッセージを受信するためにこのメソッドが呼び出された場合、トランザクションが中止されると、受信したメッセージがキューに返されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2126">If this method is called to receive a message from a transactional queue, the message that is received would be returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="f3a8c-2127">トランザクションがコミットされるまで、メッセージはキューから完全に削除されません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2127">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="f3a8c-2128">キューの最初のメッセージをキューから削除せずに読み取るには、<xref:System.Messaging.MessageQueue.Peek%2A> メソッドを使用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2128">To read the first message in a queue without removing it from the queue, use the <xref:System.Messaging.MessageQueue.Peek%2A> method.</span></span> <span data-ttu-id="f3a8c-2129"><xref:System.Messaging.MessageQueue.Peek%2A> メソッドは常にキュー内の最初のメッセージを返します。そのため、後続のメソッドの呼び出しでは、優先順位の高いメッセージがキューに到着しない限り、同じメッセージが返されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2129">The <xref:System.Messaging.MessageQueue.Peek%2A> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span> <span data-ttu-id="f3a8c-2130"><xref:System.Messaging.MessageQueue.Peek%2A>への呼び出しによって返されたメッセージに関連付けられたトランザクションコンテキストがありません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2130">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.Peek%2A>.</span></span> <span data-ttu-id="f3a8c-2131"><xref:System.Messaging.MessageQueue.Peek%2A> によってキュー内のメッセージは削除されないため、<xref:System.Messaging.MessageQueueTransaction.Abort%2A>の呼び出しによってロールバックするものはありません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2131">Because <xref:System.Messaging.MessageQueue.Peek%2A> does not remove any messages in the queue, there would be nothing to roll back by a call to <xref:System.Messaging.MessageQueueTransaction.Abort%2A>.</span></span>  
  
 <span data-ttu-id="f3a8c-2132">メッセージがキューに到着するのを待機している間に、現在のスレッドがブロックされてもかまわない場合は、<xref:System.Messaging.MessageQueue.Receive%2A> の呼び出しを使用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2132">Use a call to <xref:System.Messaging.MessageQueue.Receive%2A> when it is acceptable for the current thread to be blocked while it waits for a message to arrive in the queue.</span></span> <span data-ttu-id="f3a8c-2133"><xref:System.Messaging.MessageQueue.Receive%2A> メソッドのこのオーバーロードは無限のタイムアウトを指定するため、アプリケーションは無制限に待機する可能性があります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2133">Because this overload of the <xref:System.Messaging.MessageQueue.Receive%2A> method specifies an infinite time-out, the application might wait indefinitely.</span></span> <span data-ttu-id="f3a8c-2134">メッセージを待たずにアプリケーションの処理を続行する場合は、非同期メソッドを使用することを検討してください <xref:System.Messaging.MessageQueue.BeginReceive%2A>。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2134">If the application processing should continue without waiting for the message, consider using the asynchronous method, <xref:System.Messaging.MessageQueue.BeginReceive%2A>.</span></span>  
  
 <span data-ttu-id="f3a8c-2135">次の表に、この方法をさまざまなワークグループモードで使用できるかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2135">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-2136">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2136">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-2137">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2137">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-2138">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2138">Local computer</span></span>|<span data-ttu-id="f3a8c-2139">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2139">Yes</span></span>|  
|<span data-ttu-id="f3a8c-2140">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2140">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-2141">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2141">Yes</span></span>|  
|<span data-ttu-id="f3a8c-2142">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2142">Remote computer</span></span>|<span data-ttu-id="f3a8c-2143">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2143">No</span></span>|  
|<span data-ttu-id="f3a8c-2144">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2144">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-2145">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2145">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-2146">次のコード例は、<xref:System.Messaging.MessageQueue.Receive%28System.Messaging.MessageQueueTransactionType%29> の使用方法を示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2146">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.Receive%28System.Messaging.MessageQueueTransactionType%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#9](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#9)]
 [!code-csharp[MessageQueue2#9](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#9)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="f3a8c-2147">メッセージ キューのメソッドにアクセスしたときにエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2147">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException"><span data-ttu-id="f3a8c-2148"><paramref name="transactionType" /> パラメーターが、<see cref="T:System.Messaging.MessageQueueTransactionType" /> メンバーの 1 つではありません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2148">The <paramref name="transactionType" /> parameter is not one of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> members.</span></span></exception>
        <threadsafe><span data-ttu-id="f3a8c-2149">メソッドはスレッドセーフではありません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2149">The method is not thread safe.</span></span></threadsafe>
        <altmember cref="T:System.Messaging.MessageQueueTransactionType" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="Receive">
      <MemberSignature Language="C#" Value="public System.Messaging.Message Receive (TimeSpan timeout);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message Receive(valuetype System.TimeSpan timeout) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Receive(System.TimeSpan)" />
      <MemberSignature Language="VB.NET" Value="Public Function Receive (timeout As TimeSpan) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ Receive(TimeSpan timeout);" />
      <MemberSignature Language="F#" Value="member this.Receive : TimeSpan -&gt; System.Messaging.Message" Usage="messageQueue.Receive timeout" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" />
      </Parameters>
      <Docs>
        <param name="timeout"><span data-ttu-id="f3a8c-2150">新しいメッセージを検査できるようになるまでの待機時間を示す <see cref="T:System.TimeSpan" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2150">A <see cref="T:System.TimeSpan" /> that indicates the time to wait until a new message is available for inspection.</span></span></param>
        <summary><span data-ttu-id="f3a8c-2151"><see cref="T:System.Messaging.MessageQueue" /> が参照するキューで利用できる最初のメッセージを受信します。キューでメッセージが利用可能になるか、タイムアウトの時間が経過するまで待機します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2151">Receives the first message available in the queue referenced by the <see cref="T:System.Messaging.MessageQueue" /> and waits until either a message is available in the queue, or the time-out expires.</span></span></summary>
        <returns><span data-ttu-id="f3a8c-2152">キューで利用できる最初のメッセージを参照する <see cref="T:System.Messaging.Message" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2152">A <see cref="T:System.Messaging.Message" /> that references the first message available in the queue.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-2153">このオーバーロードを使用して、キューからメッセージを受信します。キューにメッセージがない場合は、指定した時間が経過した後で制御が戻ります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2153">Use this overload to receive a message and return in a specified period of time if there are no messages in the queue.</span></span>  
  
 <span data-ttu-id="f3a8c-2154"><xref:System.Messaging.MessageQueue.Receive%2A> メソッドを使用すると、メッセージを同期的に読み取り、キューから削除できます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2154">The <xref:System.Messaging.MessageQueue.Receive%2A> method allows for the synchronous reading of a message, removing it from the queue.</span></span> <span data-ttu-id="f3a8c-2155">後続の <xref:System.Messaging.MessageQueue.Receive%2A> を呼び出すと、キューにあるメッセージ、または新しい優先順位のメッセージが返されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2155">Subsequent calls to <xref:System.Messaging.MessageQueue.Receive%2A> will return the messages that follow in the queue, or new, higher priority messages.</span></span>  
  
 <span data-ttu-id="f3a8c-2156">キューの最初のメッセージをキューから削除せずに読み取るには、<xref:System.Messaging.MessageQueue.Peek%2A> メソッドを使用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2156">To read the first message in a queue without removing it from the queue, use the <xref:System.Messaging.MessageQueue.Peek%2A> method.</span></span> <span data-ttu-id="f3a8c-2157"><xref:System.Messaging.MessageQueue.Peek%2A> メソッドは常にキュー内の最初のメッセージを返します。そのため、後続のメソッドの呼び出しでは、優先順位の高いメッセージがキューに到着しない限り、同じメッセージが返されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2157">The <xref:System.Messaging.MessageQueue.Peek%2A> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span>  
  
 <span data-ttu-id="f3a8c-2158">メッセージがキューに到着するのを待機している間に、現在のスレッドがブロックされてもかまわない場合は、<xref:System.Messaging.MessageQueue.Receive%2A> の呼び出しを使用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2158">Use a call to <xref:System.Messaging.MessageQueue.Receive%2A> when it is acceptable for the current thread to be blocked while it waits for a message to arrive in the queue.</span></span> <span data-ttu-id="f3a8c-2159">スレッドは、指定した期間にわたってブロックされます。 `timeout` パラメーターに <xref:System.Messaging.MessageQueue.InfiniteTimeout> 値を指定した場合は、無期限にブロックされます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2159">The thread will be blocked for the given period of time, or indefinitely if you specified the value <xref:System.Messaging.MessageQueue.InfiniteTimeout> for the `timeout` parameter.</span></span> <span data-ttu-id="f3a8c-2160">メッセージを待機せずにアプリケーションの処理を続行する場合は、非同期メソッドを使用することを検討してください <xref:System.Messaging.MessageQueue.BeginReceive%2A>。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2160">If the application processing should continue without waiting for a message, consider using the asynchronous method, <xref:System.Messaging.MessageQueue.BeginReceive%2A>.</span></span>  
  
 <span data-ttu-id="f3a8c-2161">次の表に、この方法をさまざまなワークグループモードで使用できるかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2161">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-2162">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2162">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-2163">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2163">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-2164">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2164">Local computer</span></span>|<span data-ttu-id="f3a8c-2165">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2165">Yes</span></span>|  
|<span data-ttu-id="f3a8c-2166">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2166">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-2167">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2167">Yes</span></span>|  
|<span data-ttu-id="f3a8c-2168">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2168">Remote computer</span></span>|<span data-ttu-id="f3a8c-2169">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2169">No</span></span>|  
|<span data-ttu-id="f3a8c-2170">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2170">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-2171">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2171">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-2172">次のコード例では、キューからメッセージを受信し、そのメッセージに関する情報を画面に出力します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2172">The following code example receives a message from a queue and outputs information about that message to the screen.</span></span> <span data-ttu-id="f3a8c-2173">この例では、キューにメッセージが到着するのを待機している間、最大5秒間、実行を一時停止します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2173">The example pauses execution for up to five seconds while waiting for a message to arrive in the queue.</span></span>  
  
 [!code-cpp[MessageQueue.Receive_timeout#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Receive_timeout/CPP/mqreceive_timeout.cpp#1)]
 [!code-csharp[MessageQueue.Receive_timeout#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Receive_timeout/CS/mqreceive_timeout.cs#1)]
 [!code-vb[MessageQueue.Receive_timeout#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Receive_timeout/VB/mqreceive_timeout.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="f3a8c-2174"><paramref name="timeout" /> パラメーターに指定した値が無効です。<paramref name="timeout" /> が <see cref="F:System.TimeSpan.Zero" /> よりも小さいか、<see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" /> よりも大きい可能性があります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2174">The value specified for the <paramref name="timeout" /> parameter is not valid, possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="f3a8c-2175">タイムアウトが経過する前に、キューにメッセージが到達しませんでした。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2175">A message did not arrive in the queue before the time-out expired.</span></span>  
  
 <span data-ttu-id="f3a8c-2176">- または -</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2176">-or-</span></span>  
  
 <span data-ttu-id="f3a8c-2177">メッセージ キューのメソッドにアクセスしたときにエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2177">An error occurred when accessing a Message Queuing method</span></span></exception>
        <threadsafe><span data-ttu-id="f3a8c-2178">メソッドはスレッドセーフではありません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2178">The method is not thread safe.</span></span></threadsafe>
        <altmember cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="Receive">
      <MemberSignature Language="C#" Value="public System.Messaging.Message Receive (TimeSpan timeout, System.Messaging.Cursor cursor);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message Receive(valuetype System.TimeSpan timeout, class System.Messaging.Cursor cursor) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Receive(System.TimeSpan,System.Messaging.Cursor)" />
      <MemberSignature Language="VB.NET" Value="Public Function Receive (timeout As TimeSpan, cursor As Cursor) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ Receive(TimeSpan timeout, System::Messaging::Cursor ^ cursor);" />
      <MemberSignature Language="F#" Value="member this.Receive : TimeSpan * System.Messaging.Cursor -&gt; System.Messaging.Message" Usage="messageQueue.Receive (timeout, cursor)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="cursor" Type="System.Messaging.Cursor" Index="1" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="timeout"><span data-ttu-id="f3a8c-2179">新しいメッセージを検査できるようになるまでの待機時間を示す <see cref="T:System.TimeSpan" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2179">A <see cref="T:System.TimeSpan" /> that indicates the time to wait until a new message is available for inspection.</span></span></param>
        <param name="cursor"><span data-ttu-id="f3a8c-2180">メッセージ キュー内の特定の位置を維持する <see cref="T:System.Messaging.Cursor" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2180">A <see cref="T:System.Messaging.Cursor" /> that maintains a specific position in the message queue.</span></span></param>
        <summary><span data-ttu-id="f3a8c-2181">指定したカーソルを使用して、キューの現在のメッセージを受信します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2181">Receives the current message in the queue, using a specified cursor.</span></span> <span data-ttu-id="f3a8c-2182">利用可能なメッセージがない場合、このメソッドは、メッセージが利用可能になるまで、またはタイムアウトが発生するまで待機します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2182">If no message is available, this method waits until either a message is available, or the time-out expires.</span></span></summary>
        <returns><span data-ttu-id="f3a8c-2183">キューで利用できる最初のメッセージを参照する <see cref="T:System.Messaging.Message" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2183">A <see cref="T:System.Messaging.Message" /> that references the first message available in the queue.</span></span></returns>
        <remarks>To be added.</remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="f3a8c-2184"><paramref name="timeout" /> パラメーターに指定した値が無効です。<paramref name="timeout" /> が <see cref="F:System.TimeSpan.Zero" /> よりも小さいか、<see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" /> よりも大きい可能性があります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2184">The value specified for the <paramref name="timeout" /> parameter is not valid, possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="f3a8c-2185">タイムアウトが経過する前に、キューにメッセージが到達しませんでした。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2185">A message did not arrive in the queue before the time-out expired.</span></span>  
  
 <span data-ttu-id="f3a8c-2186">- または -</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2186">-or-</span></span>  
  
 <span data-ttu-id="f3a8c-2187">メッセージ キューのメソッドにアクセスしたときにエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2187">An error occurred when accessing a Message Queuing method</span></span>  
  
 <span data-ttu-id="f3a8c-2188">このオーバーロードを使用して、キューからメッセージを受信します。キューにメッセージがない場合は、指定した時間が経過した後で制御が戻ります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2188">Use this overload to receive a message and return in a specified period of time if there are no messages in the queue.</span></span></exception>
        <threadsafe><span data-ttu-id="f3a8c-2189">メソッドはスレッドセーフではありません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2189">The method is not thread safe.</span></span></threadsafe>
      </Docs>
    </Member>
    <Member MemberName="Receive">
      <MemberSignature Language="C#" Value="public System.Messaging.Message Receive (TimeSpan timeout, System.Messaging.MessageQueueTransaction transaction);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message Receive(valuetype System.TimeSpan timeout, class System.Messaging.MessageQueueTransaction transaction) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Receive(System.TimeSpan,System.Messaging.MessageQueueTransaction)" />
      <MemberSignature Language="VB.NET" Value="Public Function Receive (timeout As TimeSpan, transaction As MessageQueueTransaction) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ Receive(TimeSpan timeout, System::Messaging::MessageQueueTransaction ^ transaction);" />
      <MemberSignature Language="F#" Value="member this.Receive : TimeSpan * System.Messaging.MessageQueueTransaction -&gt; System.Messaging.Message" Usage="messageQueue.Receive (timeout, transaction)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" />
        <Parameter Name="transaction" Type="System.Messaging.MessageQueueTransaction" />
      </Parameters>
      <Docs>
        <param name="timeout"><span data-ttu-id="f3a8c-2190">新しいメッセージを検査できるようになるまでの待機時間を示す <see cref="T:System.TimeSpan" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2190">A <see cref="T:System.TimeSpan" /> that indicates the time to wait until a new message is available for inspection.</span></span></param>
        <param name="transaction"><span data-ttu-id="f3a8c-2191"><see cref="T:System.Messaging.MessageQueueTransaction" /> オブジェクト。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2191">The <see cref="T:System.Messaging.MessageQueueTransaction" /> object.</span></span></param>
        <summary><span data-ttu-id="f3a8c-2192"><see cref="T:System.Messaging.MessageQueue" /> が参照するトランザクション キューで利用できる最初のメッセージを受信します。キューでメッセージが利用可能になるか、タイムアウトの時間が経過するまで待機します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2192">Receives the first message available in the transactional queue referenced by the <see cref="T:System.Messaging.MessageQueue" /> and waits until either a message is available in the queue, or the time-out expires.</span></span></summary>
        <returns><span data-ttu-id="f3a8c-2193">キューで利用できる最初のメッセージを参照する <see cref="T:System.Messaging.Message" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2193">A <see cref="T:System.Messaging.Message" /> that references the first message available in the queue.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-2194">このオーバーロードを使用して、`transaction` パラメーターで定義された内部トランザクションコンテキストを使用してトランザクションキューからメッセージを受信し、キューにメッセージがない場合は指定した時間内にを返します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2194">Use this overload to receive a message from a transactional queue using the internal transaction context defined by the `transaction` parameter, and return within a specified period of time if there are no messages in the queue.</span></span>  
  
 <span data-ttu-id="f3a8c-2195"><xref:System.Messaging.MessageQueue.Receive%2A> メソッドを使用すると、メッセージを同期的に読み取ることができ、それによってキューからメッセージが削除されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2195">The <xref:System.Messaging.MessageQueue.Receive%2A> method allows for the synchronous reading of a message, thereby removing it from the queue.</span></span> <span data-ttu-id="f3a8c-2196">後続の <xref:System.Messaging.MessageQueue.Receive%2A> を呼び出すと、キュー内の次のメッセージが返されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2196">Subsequent calls to <xref:System.Messaging.MessageQueue.Receive%2A> will return the messages that follow in the queue.</span></span>  
  
 <span data-ttu-id="f3a8c-2197">このメソッドはトランザクションキューで呼び出されるため、トランザクションが中止されると、受信したメッセージがキューに返されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2197">Because this method is called on a transactional queue, the message that is received would be returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="f3a8c-2198">トランザクションがコミットされるまで、メッセージはキューから完全に削除されません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2198">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="f3a8c-2199">キューの最初のメッセージをキューから削除せずに読み取るには、<xref:System.Messaging.MessageQueue.Peek%2A> メソッドを使用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2199">To read the first message in a queue without removing it from the queue, use the <xref:System.Messaging.MessageQueue.Peek%2A> method.</span></span> <span data-ttu-id="f3a8c-2200"><xref:System.Messaging.MessageQueue.Peek%2A> メソッドは常にキュー内の最初のメッセージを返します。そのため、後続のメソッドの呼び出しでは、優先順位の高いメッセージがキューに到着しない限り、同じメッセージが返されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2200">The <xref:System.Messaging.MessageQueue.Peek%2A> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span> <span data-ttu-id="f3a8c-2201"><xref:System.Messaging.MessageQueue.Peek%2A>への呼び出しによって返されたメッセージに関連付けられたトランザクションコンテキストがありません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2201">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.Peek%2A>.</span></span> <span data-ttu-id="f3a8c-2202"><xref:System.Messaging.MessageQueue.Peek%2A> によってキュー内のメッセージは削除されないため、<xref:System.Messaging.MessageQueueTransaction.Abort%2A>の呼び出しによってロールバックするものはありません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2202">Because <xref:System.Messaging.MessageQueue.Peek%2A> does not remove any messages in the queue, there would be nothing to roll back by a call to <xref:System.Messaging.MessageQueueTransaction.Abort%2A>.</span></span>  
  
 <span data-ttu-id="f3a8c-2203">メッセージがキューに到着するのを待機している間に、現在のスレッドがブロックされてもかまわない場合は、<xref:System.Messaging.MessageQueue.Receive%2A> の呼び出しを使用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2203">Use a call to <xref:System.Messaging.MessageQueue.Receive%2A> when it is acceptable for the current thread to be blocked while it waits for a message to arrive in the queue.</span></span> <span data-ttu-id="f3a8c-2204">スレッドは、指定した期間にわたってブロックされます。 `timeout` パラメーターに <xref:System.Messaging.MessageQueue.InfiniteTimeout> 値を指定した場合は、無期限にブロックされます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2204">The thread will be blocked for the given period of time, or indefinitely if you specified the value <xref:System.Messaging.MessageQueue.InfiniteTimeout> for the `timeout` parameter.</span></span> <span data-ttu-id="f3a8c-2205">メッセージを待機せずにアプリケーションの処理を続行する場合は、非同期メソッドを使用することを検討してください <xref:System.Messaging.MessageQueue.BeginReceive%2A>。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2205">If the application processing should continue without waiting for a message, consider using the asynchronous method, <xref:System.Messaging.MessageQueue.BeginReceive%2A>.</span></span>  
  
 <span data-ttu-id="f3a8c-2206">次の表に、この方法をさまざまなワークグループモードで使用できるかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2206">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-2207">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2207">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-2208">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2208">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-2209">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2209">Local computer</span></span>|<span data-ttu-id="f3a8c-2210">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2210">Yes</span></span>|  
|<span data-ttu-id="f3a8c-2211">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2211">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-2212">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2212">Yes</span></span>|  
|<span data-ttu-id="f3a8c-2213">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2213">Remote computer</span></span>|<span data-ttu-id="f3a8c-2214">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2214">No</span></span>|  
|<span data-ttu-id="f3a8c-2215">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2215">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-2216">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2216">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-2217">次のコード例は、このメソッドの使用方法を示しています。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2217">The following code example demonstrates the use of this method.</span></span>  
  
 [!code-cpp[MessageQueue.Receive_TimeoutTransaction#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Receive_TimeoutTransaction/CPP/mqreceive_timeouttransaction.cpp#1)]
 [!code-csharp[MessageQueue.Receive_TimeoutTransaction#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Receive_TimeoutTransaction/CS/mqreceive_timeouttransaction.cs#1)]
 [!code-vb[MessageQueue.Receive_TimeoutTransaction#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Receive_TimeoutTransaction/VB/mqreceive_timeouttransaction.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="f3a8c-2218"><paramref name="timeout" /> パラメーターに指定した値が無効です。<paramref name="timeout" /> が <see cref="F:System.TimeSpan.Zero" /> よりも小さいか、<see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" /> よりも大きい可能性があります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2218">The value specified for the <paramref name="timeout" /> parameter is not valid, possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="f3a8c-2219">タイムアウトが経過する前に、キューにメッセージが到達しませんでした。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2219">A message did not arrive in the queue before the time-out expired.</span></span>  
  
 <span data-ttu-id="f3a8c-2220">- または -</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2220">-or-</span></span>  
  
 <span data-ttu-id="f3a8c-2221">キューが非トランザクション キューです。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2221">The queue is non-transactional.</span></span>  
  
 <span data-ttu-id="f3a8c-2222">- または -</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2222">-or-</span></span>  
  
 <span data-ttu-id="f3a8c-2223">メッセージ キューのメソッドにアクセスしたときにエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2223">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <threadsafe><span data-ttu-id="f3a8c-2224">メソッドはスレッドセーフではありません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2224">The method is not thread safe.</span></span></threadsafe>
        <altmember cref="T:System.Messaging.MessageQueueTransaction" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="Receive">
      <MemberSignature Language="C#" Value="public System.Messaging.Message Receive (TimeSpan timeout, System.Messaging.MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message Receive(valuetype System.TimeSpan timeout, valuetype System.Messaging.MessageQueueTransactionType transactionType) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Receive(System.TimeSpan,System.Messaging.MessageQueueTransactionType)" />
      <MemberSignature Language="VB.NET" Value="Public Function Receive (timeout As TimeSpan, transactionType As MessageQueueTransactionType) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ Receive(TimeSpan timeout, System::Messaging::MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="F#" Value="member this.Receive : TimeSpan * System.Messaging.MessageQueueTransactionType -&gt; System.Messaging.Message" Usage="messageQueue.Receive (timeout, transactionType)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" />
        <Parameter Name="transactionType" Type="System.Messaging.MessageQueueTransactionType" />
      </Parameters>
      <Docs>
        <param name="timeout"><span data-ttu-id="f3a8c-2225">新しいメッセージを検査できるようになるまでの待機時間を示す <see cref="T:System.TimeSpan" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2225">A <see cref="T:System.TimeSpan" /> that indicates the time to wait until a new message is available for inspection.</span></span></param>
        <param name="transactionType"><span data-ttu-id="f3a8c-2226">メッセージと関連付けるトランザクション コンテキストの種類を示す、<see cref="T:System.Messaging.MessageQueueTransactionType" /> 値の 1 つ。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2226">One of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> values, describing the type of transaction context to associate with the message.</span></span></param>
        <summary><span data-ttu-id="f3a8c-2227"><see cref="T:System.Messaging.MessageQueue" /> で参照されるキューで利用できる最初のメッセージを受信します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2227">Receives the first message available in the queue referenced by the <see cref="T:System.Messaging.MessageQueue" />.</span></span> <span data-ttu-id="f3a8c-2228">この呼び出しは同期的に実行され、メッセージがキューで使用できるようになるか、タイムアウトが経過するまで待機します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2228">This call is synchronous, and waits until either a message is available in the queue, or the time-out expires.</span></span></summary>
        <returns><span data-ttu-id="f3a8c-2229">キューで利用できる最初のメッセージを参照する <see cref="T:System.Messaging.Message" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2229">A <see cref="T:System.Messaging.Message" /> that references the first message available in the queue.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-2230">このオーバーロードを使用して、`transactionType` パラメーターで定義されたトランザクションコンテキストを使用してキューからメッセージを受信し、キューにメッセージが存在しない場合は、指定された時間を返します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2230">Use this overload to receive a message from a queue using a transaction context defined by the `transactionType` parameter, and return in a specified period of time if there are no messages in the queue.</span></span>  
  
 <span data-ttu-id="f3a8c-2231">メッセージの受信に使用するスレッドに既に外部トランザクションコンテキストがアタッチされている場合は、`transactionType` パラメーターに `Automatic` を指定します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2231">Specify `Automatic` for the `transactionType` parameter if there is already an external transaction context attached to the thread that you want to use to receive the message.</span></span> <span data-ttu-id="f3a8c-2232">メッセージを1つの内部トランザクションとして受信する場合は、`Single` を指定します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2232">Specify `Single` if you want to receive the message as a single internal transaction.</span></span> <span data-ttu-id="f3a8c-2233">トランザクションコンテキストの外部にあるトランザクションキューからメッセージを受信する場合は、`None` を指定できます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2233">You can specify `None` if you want to receive a message from a transactional queue outside of a transaction context.</span></span>  
  
 <span data-ttu-id="f3a8c-2234"><xref:System.Messaging.MessageQueue.Receive%2A> メソッドを使用すると、メッセージを同期的に読み取ることができ、それによってキューからメッセージが削除されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2234">The <xref:System.Messaging.MessageQueue.Receive%2A> method allows for the synchronous reading of a message, thereby removing it from the queue.</span></span> <span data-ttu-id="f3a8c-2235">後続の <xref:System.Messaging.MessageQueue.Receive%2A> を呼び出すと、キュー内の次のメッセージが返されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2235">Subsequent calls to <xref:System.Messaging.MessageQueue.Receive%2A> will return the messages that follow in the queue.</span></span>  
  
 <span data-ttu-id="f3a8c-2236">トランザクションキューからメッセージを受信するためにこのメソッドが呼び出された場合、トランザクションが中止されると、受信したメッセージがキューに返されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2236">If this method is called to receive a message from a transactional queue, the message that is received would be returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="f3a8c-2237">トランザクションがコミットされるまで、メッセージはキューから完全に削除されません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2237">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="f3a8c-2238">キューの最初のメッセージをキューから削除せずに読み取るには、<xref:System.Messaging.MessageQueue.Peek%2A> メソッドを使用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2238">To read the first message in a queue without removing it from the queue, use the <xref:System.Messaging.MessageQueue.Peek%2A> method.</span></span> <span data-ttu-id="f3a8c-2239"><xref:System.Messaging.MessageQueue.Peek%2A> メソッドは常にキュー内の最初のメッセージを返します。そのため、後続のメソッドの呼び出しでは、優先順位の高いメッセージがキューに到着しない限り、同じメッセージが返されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2239">The <xref:System.Messaging.MessageQueue.Peek%2A> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span> <span data-ttu-id="f3a8c-2240"><xref:System.Messaging.MessageQueue.Peek%2A>への呼び出しによって返されたメッセージに関連付けられたトランザクションコンテキストがありません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2240">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.Peek%2A>.</span></span> <span data-ttu-id="f3a8c-2241"><xref:System.Messaging.MessageQueue.Peek%2A> によってキュー内のメッセージは削除されないため、<xref:System.Messaging.MessageQueueTransaction.Abort%2A>の呼び出しによってロールバックするものはありません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2241">Because <xref:System.Messaging.MessageQueue.Peek%2A> does not remove any messages in the queue, there would be nothing to roll back by a call to <xref:System.Messaging.MessageQueueTransaction.Abort%2A>.</span></span>  
  
 <span data-ttu-id="f3a8c-2242">メッセージがキューに到着するのを待機している間に、現在のスレッドがブロックされてもかまわない場合は、<xref:System.Messaging.MessageQueue.Receive%2A> の呼び出しを使用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2242">Use a call to <xref:System.Messaging.MessageQueue.Receive%2A> when it is acceptable for the current thread to be blocked while it waits for a message to arrive in the queue.</span></span> <span data-ttu-id="f3a8c-2243">スレッドは、指定した期間にわたってブロックされます。 `timeout` パラメーターに <xref:System.Messaging.MessageQueue.InfiniteTimeout> 値を指定した場合は、無期限にブロックされます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2243">The thread will be blocked for the given period of time, or indefinitely if you specified the value <xref:System.Messaging.MessageQueue.InfiniteTimeout> for the `timeout` parameter.</span></span> <span data-ttu-id="f3a8c-2244">メッセージを待機せずにアプリケーションの処理を続行する場合は、非同期メソッドを使用することを検討してください <xref:System.Messaging.MessageQueue.BeginReceive%2A>。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2244">If the application processing should continue without waiting for a message, consider using the asynchronous method, <xref:System.Messaging.MessageQueue.BeginReceive%2A>.</span></span>  
  
 <span data-ttu-id="f3a8c-2245">次の表に、この方法をさまざまなワークグループモードで使用できるかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2245">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-2246">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2246">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-2247">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2247">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-2248">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2248">Local computer</span></span>|<span data-ttu-id="f3a8c-2249">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2249">Yes</span></span>|  
|<span data-ttu-id="f3a8c-2250">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2250">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-2251">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2251">Yes</span></span>|  
|<span data-ttu-id="f3a8c-2252">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2252">Remote computer</span></span>|<span data-ttu-id="f3a8c-2253">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2253">No</span></span>|  
|<span data-ttu-id="f3a8c-2254">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2254">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-2255">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2255">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-2256">次のコード例は、このメソッドの使用方法を示しています。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2256">The following code example demonstrates the use of this method.</span></span>  
  
 [!code-cpp[MessageQueue2#8](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#8)]
 [!code-csharp[MessageQueue2#8](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#8)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="f3a8c-2257"><paramref name="timeout" /> パラメーターに指定した値が無効です。<paramref name="timeout" /> が <see cref="F:System.TimeSpan.Zero" /> よりも小さいか、<see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" /> よりも大きい可能性があります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2257">The value specified for the <paramref name="timeout" /> parameter is not valid, possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span></span></exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException"><span data-ttu-id="f3a8c-2258"><paramref name="transactionType" /> パラメーターが、<see cref="T:System.Messaging.MessageQueueTransactionType" /> メンバーの 1 つではありません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2258">The <paramref name="transactionType" /> parameter is not one of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> members.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="f3a8c-2259">タイムアウトが経過する前に、キューにメッセージが到達しませんでした。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2259">A message did not arrive in the queue before the time-out expired.</span></span>  
  
 <span data-ttu-id="f3a8c-2260">- または -</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2260">-or-</span></span>  
  
 <span data-ttu-id="f3a8c-2261">メッセージ キューのメソッドにアクセスしたときにエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2261">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <threadsafe><span data-ttu-id="f3a8c-2262">メソッドはスレッドセーフではありません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2262">The method is not thread safe.</span></span></threadsafe>
        <altmember cref="T:System.Messaging.MessageQueueTransactionType" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="Receive">
      <MemberSignature Language="C#" Value="public System.Messaging.Message Receive (TimeSpan timeout, System.Messaging.Cursor cursor, System.Messaging.MessageQueueTransaction transaction);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message Receive(valuetype System.TimeSpan timeout, class System.Messaging.Cursor cursor, class System.Messaging.MessageQueueTransaction transaction) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Receive(System.TimeSpan,System.Messaging.Cursor,System.Messaging.MessageQueueTransaction)" />
      <MemberSignature Language="VB.NET" Value="Public Function Receive (timeout As TimeSpan, cursor As Cursor, transaction As MessageQueueTransaction) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ Receive(TimeSpan timeout, System::Messaging::Cursor ^ cursor, System::Messaging::MessageQueueTransaction ^ transaction);" />
      <MemberSignature Language="F#" Value="member this.Receive : TimeSpan * System.Messaging.Cursor * System.Messaging.MessageQueueTransaction -&gt; System.Messaging.Message" Usage="messageQueue.Receive (timeout, cursor, transaction)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="cursor" Type="System.Messaging.Cursor" Index="1" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="transaction" Type="System.Messaging.MessageQueueTransaction" Index="2" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="timeout"><span data-ttu-id="f3a8c-2263">新しいメッセージを検査できるようになるまでの待機時間を示す <see cref="T:System.TimeSpan" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2263">A <see cref="T:System.TimeSpan" /> that indicates the time to wait until a new message is available for inspection.</span></span></param>
        <param name="cursor"><span data-ttu-id="f3a8c-2264">メッセージ キュー内の特定の位置を維持する <see cref="T:System.Messaging.Cursor" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2264">A <see cref="T:System.Messaging.Cursor" /> that maintains a specific position in the message queue.</span></span></param>
        <param name="transaction"><span data-ttu-id="f3a8c-2265"><see cref="T:System.Messaging.MessageQueueTransaction" /> オブジェクト。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2265">The <see cref="T:System.Messaging.MessageQueueTransaction" /> object.</span></span></param>
        <summary><span data-ttu-id="f3a8c-2266">指定したカーソルを使用して、キューの現在のメッセージを受信します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2266">Receives the current message in the queue, using a specified cursor.</span></span> <span data-ttu-id="f3a8c-2267">利用可能なメッセージがない場合、このメソッドは、メッセージが利用可能になるまで、またはタイムアウトが発生するまで待機します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2267">If no message is available, this method waits until either a message is available, or the time-out expires.</span></span></summary>
        <returns><span data-ttu-id="f3a8c-2268">キューのメッセージを参照する <see cref="T:System.Messaging.Message" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2268">A <see cref="T:System.Messaging.Message" /> that references a message in the queue.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-2269">このオーバーロードを使用して、`transaction` パラメーターで定義された内部トランザクションコンテキストを使用してトランザクションキューからメッセージを受信し、キューにメッセージがない場合は指定した時間内にを返します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2269">Use this overload to receive a message from a transactional queue using the internal transaction context defined by the `transaction` parameter, and return within a specified period of time if there are no messages in the queue.</span></span>  
  
 <span data-ttu-id="f3a8c-2270"><xref:System.Messaging.MessageQueue.Receive%2A> メソッドを使用すると、メッセージを同期的に読み取ることができ、それによってキューからメッセージが削除されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2270">The <xref:System.Messaging.MessageQueue.Receive%2A> method allows for the synchronous reading of a message, thereby removing it from the queue.</span></span> <span data-ttu-id="f3a8c-2271">後続の <xref:System.Messaging.MessageQueue.Receive%2A> を呼び出すと、キュー内の次のメッセージが返されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2271">Subsequent calls to <xref:System.Messaging.MessageQueue.Receive%2A> return the messages that follow in the queue.</span></span>  
  
 <span data-ttu-id="f3a8c-2272">このメソッドはトランザクションキューで呼び出されるため、トランザクションが中止されると、受信したメッセージがキューに返されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2272">Because this method is called on a transactional queue, the message that is received is returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="f3a8c-2273">トランザクションがコミットされるまで、メッセージはキューから完全に削除されません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2273">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="f3a8c-2274">キューからメッセージを削除せずに、キュー内のメッセージを読み取るには、<xref:System.Messaging.MessageQueue.Peek%2A> メソッドを使用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2274">To read a message in a queue without removing it from the queue, use the <xref:System.Messaging.MessageQueue.Peek%2A> method.</span></span> <span data-ttu-id="f3a8c-2275"><xref:System.Messaging.MessageQueue.Peek%2A>への呼び出しによって返されたメッセージに関連付けられたトランザクションコンテキストがありません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2275">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.Peek%2A>.</span></span> <span data-ttu-id="f3a8c-2276"><xref:System.Messaging.MessageQueue.Peek%2A> によってキュー内のメッセージは削除されないため、<xref:System.Messaging.MessageQueueTransaction.Abort%2A>を呼び出すことによってロールバックするものはありません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2276">Because <xref:System.Messaging.MessageQueue.Peek%2A> does not remove any messages in the queue, there is nothing to roll back by a call to <xref:System.Messaging.MessageQueueTransaction.Abort%2A>.</span></span>  
  
 <span data-ttu-id="f3a8c-2277">メッセージがキューに到着するのを待機している間に、現在のスレッドがブロックされてもかまわない場合は、<xref:System.Messaging.MessageQueue.Receive%2A> の呼び出しを使用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2277">Use a call to <xref:System.Messaging.MessageQueue.Receive%2A> when it is acceptable for the current thread to be blocked while it waits for a message to arrive in the queue.</span></span> <span data-ttu-id="f3a8c-2278">スレッドは、指定された期間にわたってブロックされます。または、`timeout` パラメーターに <xref:System.Messaging.MessageQueue.InfiniteTimeout> 値を指定した場合は、無期限にブロックされます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2278">The thread is blocked for the given period of time, or indefinitely if you specified the value <xref:System.Messaging.MessageQueue.InfiniteTimeout> for the `timeout` parameter.</span></span> <span data-ttu-id="f3a8c-2279">メッセージを待機せずにアプリケーションの処理を続行する場合は、非同期メソッドを使用することを検討してください <xref:System.Messaging.MessageQueue.BeginReceive%2A>。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2279">If the application processing should continue without waiting for a message, consider using the asynchronous method, <xref:System.Messaging.MessageQueue.BeginReceive%2A>.</span></span>  
  
 <span data-ttu-id="f3a8c-2280">次の表に、この方法をさまざまなワークグループモードで使用できるかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2280">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-2281">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2281">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-2282">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2282">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-2283">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2283">Local computer</span></span>|<span data-ttu-id="f3a8c-2284">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2284">Yes</span></span>|  
|<span data-ttu-id="f3a8c-2285">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2285">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-2286">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2286">Yes</span></span>|  
|<span data-ttu-id="f3a8c-2287">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2287">Remote computer</span></span>|<span data-ttu-id="f3a8c-2288">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2288">No</span></span>|  
|<span data-ttu-id="f3a8c-2289">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2289">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-2290">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2290">Yes</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="f3a8c-2291"><paramref name="cursor" /> パラメーターが <see langword="null" /> です。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2291">The <paramref name="cursor" /> parameter is <see langword="null" />.</span></span>  
  
<span data-ttu-id="f3a8c-2292">- または -</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2292">-or-</span></span> 
<span data-ttu-id="f3a8c-2293"><paramref name="transaction" /> パラメーターが <see langword="null" /> です。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2293">The <paramref name="transaction" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="f3a8c-2294"><paramref name="timeout" /> パラメーターに指定された値が無効です。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2294">The value specified for the <paramref name="timeout" /> parameter is not valid.</span></span> <span data-ttu-id="f3a8c-2295"><paramref name="timeout" /> が <see cref="F:System.TimeSpan.Zero" /> より小さい値か、<see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" /> より大きい値である可能性があります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2295">Possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="f3a8c-2296">タイムアウトが経過する前に、キューにメッセージが到達しませんでした。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2296">A message did not arrive in the queue before the time-out expired.</span></span>  
  
 <span data-ttu-id="f3a8c-2297">- または -</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2297">-or-</span></span>  
  
 <span data-ttu-id="f3a8c-2298">キューが非トランザクション キューです。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2298">The queue is non-transactional.</span></span>  
  
 <span data-ttu-id="f3a8c-2299">- または -</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2299">-or-</span></span>  
  
 <span data-ttu-id="f3a8c-2300">メッセージ キューのメソッドにアクセスしたときにエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2300">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <threadsafe><span data-ttu-id="f3a8c-2301">メソッドはスレッドセーフではありません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2301">The method is not thread safe.</span></span></threadsafe>
        <altmember cref="T:System.Messaging.Cursor" />
        <altmember cref="T:System.Messaging.MessageQueueTransaction" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="Receive">
      <MemberSignature Language="C#" Value="public System.Messaging.Message Receive (TimeSpan timeout, System.Messaging.Cursor cursor, System.Messaging.MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message Receive(valuetype System.TimeSpan timeout, class System.Messaging.Cursor cursor, valuetype System.Messaging.MessageQueueTransactionType transactionType) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Receive(System.TimeSpan,System.Messaging.Cursor,System.Messaging.MessageQueueTransactionType)" />
      <MemberSignature Language="VB.NET" Value="Public Function Receive (timeout As TimeSpan, cursor As Cursor, transactionType As MessageQueueTransactionType) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ Receive(TimeSpan timeout, System::Messaging::Cursor ^ cursor, System::Messaging::MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="F#" Value="member this.Receive : TimeSpan * System.Messaging.Cursor * System.Messaging.MessageQueueTransactionType -&gt; System.Messaging.Message" Usage="messageQueue.Receive (timeout, cursor, transactionType)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="cursor" Type="System.Messaging.Cursor" Index="1" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="transactionType" Type="System.Messaging.MessageQueueTransactionType" Index="2" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="timeout"><span data-ttu-id="f3a8c-2302">新しいメッセージを検査できるようになるまでの待機時間を示す <see cref="T:System.TimeSpan" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2302">A <see cref="T:System.TimeSpan" /> that indicates the time to wait until a new message is available for inspection.</span></span></param>
        <param name="cursor"><span data-ttu-id="f3a8c-2303">メッセージ キュー内の特定の位置を維持する <see cref="T:System.Messaging.Cursor" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2303">A <see cref="T:System.Messaging.Cursor" /> that maintains a specific position in the message queue.</span></span></param>
        <param name="transactionType"><span data-ttu-id="f3a8c-2304">メッセージと関連付けるトランザクション コンテキストの種類を示す、<see cref="T:System.Messaging.MessageQueueTransactionType" /> 値の 1 つ。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2304">One of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> values that describes the type of transaction context to associate with the message.</span></span></param>
        <summary><span data-ttu-id="f3a8c-2305">指定したカーソルを使用して、キューの現在のメッセージを受信します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2305">Receives the current message in the queue, using a specified cursor.</span></span> <span data-ttu-id="f3a8c-2306">利用可能なメッセージがない場合、このメソッドは、メッセージが利用可能になるまで、またはタイムアウトが発生するまで待機します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2306">If no message is available, this method waits until either a message is available, or the time-out expires.</span></span></summary>
        <returns><span data-ttu-id="f3a8c-2307">キューのメッセージを参照する <see cref="T:System.Messaging.Message" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2307">A <see cref="T:System.Messaging.Message" /> that references a message in the queue.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-2308">このオーバーロードを使用して、`transactionType` パラメーターで定義されたトランザクションコンテキストを使用してキューからメッセージを受信し、キューにメッセージが存在しない場合は、指定された時間を返します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2308">Use this overload to receive a message from a queue using a transaction context defined by the `transactionType` parameter, and return in a specified period of time if there are no messages in the queue.</span></span>  
  
 <span data-ttu-id="f3a8c-2309">メッセージの受信に使用するスレッドに既に外部トランザクションコンテキストがアタッチされている場合は、`transactionType` パラメーターに `Automatic` を指定します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2309">Specify `Automatic` for the `transactionType` parameter if there is already an external transaction context attached to the thread that you want to use to receive the message.</span></span> <span data-ttu-id="f3a8c-2310">メッセージを1つの内部トランザクションとして受信する場合は、`Single` を指定します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2310">Specify `Single` if you want to receive the message as a single internal transaction.</span></span> <span data-ttu-id="f3a8c-2311">トランザクションコンテキストの外部にあるトランザクションキューからメッセージを受信する場合は、`None` を指定できます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2311">You can specify `None` if you want to receive a message from a transactional queue outside of a transaction context.</span></span>  
  
 <span data-ttu-id="f3a8c-2312"><xref:System.Messaging.MessageQueue.Receive%2A> メソッドを使用すると、メッセージを同期的に読み取ることができ、それによってキューからメッセージが削除されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2312">The <xref:System.Messaging.MessageQueue.Receive%2A> method allows for the synchronous reading of a message, thereby removing it from the queue.</span></span> <span data-ttu-id="f3a8c-2313">後続の <xref:System.Messaging.MessageQueue.Receive%2A> を呼び出すと、キュー内の次のメッセージが返されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2313">Subsequent calls to <xref:System.Messaging.MessageQueue.Receive%2A> return the messages that follow in the queue.</span></span>  
  
 <span data-ttu-id="f3a8c-2314">トランザクションキューからメッセージを受信するためにこのメソッドが呼び出された場合、トランザクションが中止されると、受信されたメッセージがキューに返されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2314">If this method is called to receive a message from a transactional queue, the message that is received is returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="f3a8c-2315">トランザクションがコミットされるまで、メッセージはキューから完全に削除されません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2315">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="f3a8c-2316">キューからメッセージを削除せずに、キュー内のメッセージを読み取るには、<xref:System.Messaging.MessageQueue.Peek%2A> メソッドを使用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2316">To read a message in a queue without removing it from the queue, use the <xref:System.Messaging.MessageQueue.Peek%2A> method.</span></span> <span data-ttu-id="f3a8c-2317"><xref:System.Messaging.MessageQueue.Peek%2A>への呼び出しによって返されたメッセージに関連付けられたトランザクションコンテキストがありません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2317">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.Peek%2A>.</span></span> <span data-ttu-id="f3a8c-2318"><xref:System.Messaging.MessageQueue.Peek%2A> によってキュー内のメッセージは削除されないため、<xref:System.Messaging.MessageQueueTransaction.Abort%2A>を呼び出すことによってロールバックするものはありません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2318">Because <xref:System.Messaging.MessageQueue.Peek%2A> does not remove any messages in the queue, there is nothing to roll back by a call to <xref:System.Messaging.MessageQueueTransaction.Abort%2A>.</span></span>  
  
 <span data-ttu-id="f3a8c-2319">メッセージがキューに到着するのを待機している間に、現在のスレッドがブロックされてもかまわない場合は、<xref:System.Messaging.MessageQueue.Receive%2A> の呼び出しを使用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2319">Use a call to <xref:System.Messaging.MessageQueue.Receive%2A> when it is acceptable for the current thread to be blocked while it waits for a message to arrive in the queue.</span></span> <span data-ttu-id="f3a8c-2320">スレッドは、指定された期間にわたってブロックされます。または、`timeout` パラメーターに <xref:System.Messaging.MessageQueue.InfiniteTimeout> 値を指定した場合は、無期限にブロックされます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2320">The thread is blocked for the given period of time, or indefinitely if you specified the value <xref:System.Messaging.MessageQueue.InfiniteTimeout> for the `timeout` parameter.</span></span> <span data-ttu-id="f3a8c-2321">メッセージを待機せずにアプリケーションの処理を続行する場合は、非同期メソッドを使用することを検討してください <xref:System.Messaging.MessageQueue.BeginReceive%2A>。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2321">If the application processing should continue without waiting for a message, consider using the asynchronous method, <xref:System.Messaging.MessageQueue.BeginReceive%2A>.</span></span>  
  
 <span data-ttu-id="f3a8c-2322">次の表に、この方法をさまざまなワークグループモードで使用できるかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2322">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-2323">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2323">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-2324">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2324">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-2325">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2325">Local computer</span></span>|<span data-ttu-id="f3a8c-2326">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2326">Yes</span></span>|  
|<span data-ttu-id="f3a8c-2327">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2327">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-2328">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2328">Yes</span></span>|  
|<span data-ttu-id="f3a8c-2329">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2329">Remote computer</span></span>|<span data-ttu-id="f3a8c-2330">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2330">No</span></span>|  
|<span data-ttu-id="f3a8c-2331">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2331">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-2332">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2332">Yes</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="f3a8c-2333"><paramref name="cursor" /> パラメーターが <see langword="null" /> です。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2333">The <paramref name="cursor" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="f3a8c-2334"><paramref name="timeout" /> パラメーターに指定された値が無効です。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2334">The value specified for the <paramref name="timeout" /> parameter is not valid.</span></span> <span data-ttu-id="f3a8c-2335"><paramref name="timeout" /> が <see cref="F:System.TimeSpan.Zero" /> より小さい値か、<see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" /> より大きい値である可能性があります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2335">Possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span></span></exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException"><span data-ttu-id="f3a8c-2336"><paramref name="transactionType" /> パラメーターが、<see cref="T:System.Messaging.MessageQueueTransactionType" /> メンバーの 1 つではありません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2336">The <paramref name="transactionType" /> parameter is not one of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> members.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="f3a8c-2337">タイムアウトが経過する前に、キューにメッセージが到達しませんでした。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2337">A message did not arrive in the queue before the time-out expired.</span></span>  
  
 <span data-ttu-id="f3a8c-2338">- または -</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2338">-or-</span></span>  
  
 <span data-ttu-id="f3a8c-2339">メッセージ キューのメソッドにアクセスしたときにエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2339">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <threadsafe><span data-ttu-id="f3a8c-2340">メソッドはスレッドセーフではありません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2340">The method is not thread safe.</span></span></threadsafe>
        <altmember cref="T:System.Messaging.Cursor" />
        <altmember cref="T:System.Messaging.MessageQueueTransactionType" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <MemberGroup MemberName="ReceiveByCorrelationId">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="f3a8c-2341">指定した相関 ID と一致するメッセージを受信します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2341">Receives a message that matches a given correlation identifier.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="ReceiveByCorrelationId">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveByCorrelationId (string correlationId);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveByCorrelationId(string correlationId) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveByCorrelationId(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveByCorrelationId (correlationId As String) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveByCorrelationId(System::String ^ correlationId);" />
      <MemberSignature Language="F#" Value="member this.ReceiveByCorrelationId : string -&gt; System.Messaging.Message" Usage="messageQueue.ReceiveByCorrelationId correlationId" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="correlationId" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="correlationId"><span data-ttu-id="f3a8c-2342">受信するメッセージの <see cref="P:System.Messaging.Message.CorrelationId" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2342">The <see cref="P:System.Messaging.Message.CorrelationId" /> of the message to receive.</span></span></param>
        <summary><span data-ttu-id="f3a8c-2343">指定した相関 ID と一致するメッセージを (非トランザクション キューから) 受信します。現在、指定した相関 ID と一致するメッセージがキューに存在しない場合は、すぐに例外を発生させます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2343">Receives the message that matches the given correlation identifier (from a non-transactional queue) and immediately raises an exception if no message with the specified correlation identifier currently exists in the queue.</span></span></summary>
        <returns><span data-ttu-id="f3a8c-2344">渡された <paramref name="correlationId" /> パラメーターと一致する <see cref="P:System.Messaging.Message.CorrelationId" /> を持つ <see cref="T:System.Messaging.Message" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2344">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.CorrelationId" /> matches the <paramref name="correlationId" /> parameter passed in.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-2345">このメソッドは、指定された `correlationId` パラメーターに一致する <xref:System.Messaging.Message.CorrelationId%2A> を持つメッセージの <xref:System.Messaging.MessageQueue> によって参照される非トランザクションキューを検索します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2345">This method looks in the non-transactional queue referenced by the <xref:System.Messaging.MessageQueue> for a message whose <xref:System.Messaging.Message.CorrelationId%2A> matches the specified `correlationId` parameter.</span></span> <span data-ttu-id="f3a8c-2346">`correlationID` パラメーターと一致するメッセージが見つからない場合は、例外がスローされます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2346">If no message is found that matches the `correlationID` parameter, an exception is thrown.</span></span> <span data-ttu-id="f3a8c-2347">それ以外の場合、メッセージはキューから削除され、アプリケーションに返されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2347">Otherwise, the message is removed from the queue and returned to the application.</span></span>  
  
 <span data-ttu-id="f3a8c-2348"><xref:System.Messaging.Message.CorrelationId%2A> プロパティは、キューに送信されたメッセージを、関連付けられている応答、レポート、または受信確認メッセージに関連付けるために使用されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2348">The <xref:System.Messaging.Message.CorrelationId%2A> property is used to tie a message sent to the queue to associated response, report, or acknowledgment messages.</span></span>  
  
 <span data-ttu-id="f3a8c-2349">他の2つの方法では、キューからメッセージを受信できます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2349">Two other methods allow you to receive messages from a queue.</span></span> <span data-ttu-id="f3a8c-2350"><xref:System.Messaging.MessageQueue.Receive%2A> メソッドは、キュー内の最初のメッセージを返し、<xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> メソッドは、一意の識別子を指定することによってメッセージを取得します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2350">The <xref:System.Messaging.MessageQueue.Receive%2A> method returns the first message in the queue, and the <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> method retrieves a message by specifying its unique identifier.</span></span>  
  
 <span data-ttu-id="f3a8c-2351">指定された相関 id を持つメッセージをキューから削除せずに読み取るには、<xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> メソッドを使用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2351">To read a message with a specified correlation identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> method.</span></span> <span data-ttu-id="f3a8c-2352"><xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> メソッドは常にキュー内の最初のメッセージを返します。そのため、後続のメソッドの呼び出しでは、優先順位の高いメッセージがキューに到着しない限り、同じメッセージが返されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2352">The <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span>  
  
 <span data-ttu-id="f3a8c-2353">次の表に、この方法をさまざまなワークグループモードで使用できるかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2353">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-2354">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2354">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-2355">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2355">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-2356">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2356">Local computer</span></span>|<span data-ttu-id="f3a8c-2357">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2357">Yes</span></span>|  
|<span data-ttu-id="f3a8c-2358">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2358">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-2359">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2359">Yes</span></span>|  
|<span data-ttu-id="f3a8c-2360">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2360">Remote computer</span></span>|<span data-ttu-id="f3a8c-2361">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2361">No</span></span>|  
|<span data-ttu-id="f3a8c-2362">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2362">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-2363">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2363">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-2364">次のコード例では、キューとの間で注文を含むメッセージを送受信します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2364">The following code example sends and receives a message that contains an order to and from a queue.</span></span> <span data-ttu-id="f3a8c-2365">これは、元のメッセージがキューに到達するか、キューから取得されるときに肯定受信確認を要求します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2365">It specifically requests a positive acknowledgment when the original message reaches or is retrieved from the queue.</span></span>  
  
 [!code-cpp[Message.Acknowledgment#1](~/samples/snippets/cpp/VS_Snippets_Remoting/Message.Acknowledgment/CPP/message_acknowledgment.cpp#1)]
 [!code-csharp[Message.Acknowledgment#1](~/samples/snippets/csharp/VS_Snippets_Remoting/Message.Acknowledgment/CS/message_acknowledgment.cs#1)]
 [!code-vb[Message.Acknowledgment#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/Message.Acknowledgment/VB/message_acknowledgment.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="f3a8c-2366"><paramref name="correlationId" /> パラメーターが <see langword="null" /> です。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2366">The <paramref name="correlationId" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="f3a8c-2367">指定した <paramref name="correlationId" /> を持つメッセージは見つかりませんでした。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2367">The message with the specified <paramref name="correlationId" /> could not be found.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="f3a8c-2368">メッセージ キューのメソッドにアクセスしたときにエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2368">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="ReceiveByCorrelationId">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveByCorrelationId (string correlationId, System.Messaging.MessageQueueTransaction transaction);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveByCorrelationId(string correlationId, class System.Messaging.MessageQueueTransaction transaction) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveByCorrelationId(System.String,System.Messaging.MessageQueueTransaction)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveByCorrelationId (correlationId As String, transaction As MessageQueueTransaction) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveByCorrelationId(System::String ^ correlationId, System::Messaging::MessageQueueTransaction ^ transaction);" />
      <MemberSignature Language="F#" Value="member this.ReceiveByCorrelationId : string * System.Messaging.MessageQueueTransaction -&gt; System.Messaging.Message" Usage="messageQueue.ReceiveByCorrelationId (correlationId, transaction)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="correlationId" Type="System.String" />
        <Parameter Name="transaction" Type="System.Messaging.MessageQueueTransaction" />
      </Parameters>
      <Docs>
        <param name="correlationId"><span data-ttu-id="f3a8c-2369">受信するメッセージの <see cref="P:System.Messaging.Message.CorrelationId" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2369">The <see cref="P:System.Messaging.Message.CorrelationId" /> of the message to receive.</span></span></param>
        <param name="transaction"><span data-ttu-id="f3a8c-2370"><see cref="T:System.Messaging.MessageQueueTransaction" /> オブジェクト。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2370">The <see cref="T:System.Messaging.MessageQueueTransaction" /> object.</span></span></param>
        <summary><span data-ttu-id="f3a8c-2371">指定した相関 ID と一致するメッセージを (トランザクション キューから) 受信します。現在、指定した相関 ID と一致するメッセージがキューに存在しない場合は、すぐに例外を発生させます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2371">Receives the message that matches the given correlation identifier (from a transactional queue) and immediately raises an exception if no message with the specified correlation identifier currently exists in the queue.</span></span></summary>
        <returns><span data-ttu-id="f3a8c-2372">渡された <paramref name="correlationId" /> パラメーターと一致する <see cref="P:System.Messaging.Message.CorrelationId" /> を持つ <see cref="T:System.Messaging.Message" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2372">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.CorrelationId" /> matches the <paramref name="correlationId" /> parameter passed in.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-2373">このメソッドは、指定された `correlationId` パラメーターに一致する <xref:System.Messaging.Message.CorrelationId%2A> を持つメッセージの <xref:System.Messaging.MessageQueue> によって参照されるトランザクションキューを検索します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2373">This method looks in the transactional queue referenced by the <xref:System.Messaging.MessageQueue> for a message whose <xref:System.Messaging.Message.CorrelationId%2A> matches the specified `correlationId` parameter.</span></span> <span data-ttu-id="f3a8c-2374">`correlationID` パラメーターと一致するメッセージが見つからない場合は、例外がスローされます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2374">If no message is found that matches the `correlationID` parameter, an exception is thrown.</span></span> <span data-ttu-id="f3a8c-2375">それ以外の場合、メッセージはキューから削除され、`transaction` パラメーターによって定義された内部トランザクションコンテキストを使用してアプリケーションに返されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2375">Otherwise, the message is removed from the queue and returned to the application using the internal transaction context defined by the `transaction` parameter.</span></span>  
  
 <span data-ttu-id="f3a8c-2376">このメソッドはトランザクションキューで呼び出されるため、トランザクションが中止されると、受信したメッセージがキューに返されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2376">Because this method is called on a transactional queue, the message that is received would be returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="f3a8c-2377">トランザクションがコミットされるまで、メッセージはキューから完全に削除されません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2377">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="f3a8c-2378"><xref:System.Messaging.Message.CorrelationId%2A> プロパティは、キューに送信されたメッセージを、関連付けられている応答、レポート、または受信確認メッセージに関連付けるために使用されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2378">The <xref:System.Messaging.Message.CorrelationId%2A> property is used to tie a message sent to the queue to associated response, report, or acknowledgment messages.</span></span>  
  
 <span data-ttu-id="f3a8c-2379">他の2つの方法では、キューからメッセージを受信できます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2379">Two other methods allow you to receive messages from a queue.</span></span> <span data-ttu-id="f3a8c-2380"><xref:System.Messaging.MessageQueue.Receive%2A> メソッドは、キュー内の最初のメッセージを返し、<xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> メソッドを使用して、一意の識別子を指定することによってメッセージを取得します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2380">The <xref:System.Messaging.MessageQueue.Receive%2A> method returns the first message in the queue, and the <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> method is used to retrieve a message by specifying its unique identifier.</span></span>  
  
 <span data-ttu-id="f3a8c-2381">指定された相関 id を持つメッセージをキューから削除せずに読み取るには、<xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> メソッドを使用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2381">To read a message with a specified correlation identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> method.</span></span> <span data-ttu-id="f3a8c-2382"><xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> メソッドは常にキュー内の最初のメッセージを返します。そのため、後続のメソッドの呼び出しでは、優先順位の高いメッセージがキューに到着しない限り、同じメッセージが返されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2382">The <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span> <span data-ttu-id="f3a8c-2383"><xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29>への呼び出しによって返されたメッセージに関連付けられたトランザクションコンテキストがありません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2383">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29>.</span></span> <span data-ttu-id="f3a8c-2384"><xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> はキュー内のメッセージを削除しないため、トランザクションが中止された場合、ロールバックする必要はありません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2384">Because <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> does not remove any messages in the queue, there would be nothing to roll back if the transaction were aborted.</span></span>  
  
 <span data-ttu-id="f3a8c-2385">次の表に、この方法をさまざまなワークグループモードで使用できるかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2385">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-2386">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2386">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-2387">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2387">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-2388">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2388">Local computer</span></span>|<span data-ttu-id="f3a8c-2389">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2389">Yes</span></span>|  
|<span data-ttu-id="f3a8c-2390">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2390">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-2391">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2391">Yes</span></span>|  
|<span data-ttu-id="f3a8c-2392">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2392">Remote computer</span></span>|<span data-ttu-id="f3a8c-2393">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2393">No</span></span>|  
|<span data-ttu-id="f3a8c-2394">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2394">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-2395">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2395">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-2396">次のコード例は、<xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%2CSystem.Messaging.MessageQueueTransaction%29> の使用方法を示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2396">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%2CSystem.Messaging.MessageQueueTransaction%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#14](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#14)]
 [!code-csharp[MessageQueue2#14](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#14)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="f3a8c-2397"><paramref name="correlationId" /> パラメーターが <see langword="null" /> です。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2397">The <paramref name="correlationId" /> parameter is <see langword="null" />.</span></span>  
  
<span data-ttu-id="f3a8c-2398">- または -</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2398">-or-</span></span> 
<span data-ttu-id="f3a8c-2399"><paramref name="transaction" /> パラメーターが <see langword="null" /> です。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2399">The <paramref name="transaction" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="f3a8c-2400">指定した <paramref name="correlationId" /> を持つメッセージは見つかりませんでした。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2400">The message with the specified <paramref name="correlationId" /> could not be found.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="f3a8c-2401">キューが非トランザクション キューです。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2401">The queue is non-transactional.</span></span>  
  
 <span data-ttu-id="f3a8c-2402">- または -</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2402">-or-</span></span>  
  
 <span data-ttu-id="f3a8c-2403">メッセージ キューのメソッドにアクセスしたときにエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2403">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="T:System.Messaging.MessageQueueTransaction" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="ReceiveByCorrelationId">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveByCorrelationId (string correlationId, System.Messaging.MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveByCorrelationId(string correlationId, valuetype System.Messaging.MessageQueueTransactionType transactionType) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveByCorrelationId(System.String,System.Messaging.MessageQueueTransactionType)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveByCorrelationId (correlationId As String, transactionType As MessageQueueTransactionType) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveByCorrelationId(System::String ^ correlationId, System::Messaging::MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="F#" Value="member this.ReceiveByCorrelationId : string * System.Messaging.MessageQueueTransactionType -&gt; System.Messaging.Message" Usage="messageQueue.ReceiveByCorrelationId (correlationId, transactionType)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="correlationId" Type="System.String" />
        <Parameter Name="transactionType" Type="System.Messaging.MessageQueueTransactionType" />
      </Parameters>
      <Docs>
        <param name="correlationId"><span data-ttu-id="f3a8c-2404">受信するメッセージの <see cref="P:System.Messaging.Message.CorrelationId" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2404">The <see cref="P:System.Messaging.Message.CorrelationId" /> of the message to receive.</span></span></param>
        <param name="transactionType"><span data-ttu-id="f3a8c-2405">メッセージと関連付けるトランザクション コンテキストの種類を示す、<see cref="T:System.Messaging.MessageQueueTransactionType" /> 値の 1 つ。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2405">One of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> values, describing the type of transaction context to associate with the message.</span></span></param>
        <summary><span data-ttu-id="f3a8c-2406">指定した相関 ID と一致するメッセージを受信します。現在、指定した相関 ID と一致するメッセージがキューに存在しない場合は、すぐに例外を発生させます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2406">Receives the message that matches the given correlation identifier and immediately raises an exception if no message with the specified correlation identifier currently exists in the queue.</span></span></summary>
        <returns><span data-ttu-id="f3a8c-2407">渡された <paramref name="correlationId" /> パラメーターと一致する <see cref="P:System.Messaging.Message.CorrelationId" /> を持つ <see cref="T:System.Messaging.Message" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2407">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.CorrelationId" /> matches the <paramref name="correlationId" /> parameter passed in.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-2408">このメソッドは、指定された `correlationId` パラメーターに一致する <xref:System.Messaging.Message.CorrelationId%2A> を持つメッセージの <xref:System.Messaging.MessageQueue> によって参照されるキューを検索します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2408">This method looks in the queue referenced by the <xref:System.Messaging.MessageQueue> for a message whose <xref:System.Messaging.Message.CorrelationId%2A> matches the specified `correlationId` parameter.</span></span> <span data-ttu-id="f3a8c-2409">`correlationID` パラメーターと一致するメッセージが見つからない場合は、例外がスローされます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2409">If no message is found that matches the `correlationID` parameter, an exception is thrown.</span></span> <span data-ttu-id="f3a8c-2410">それ以外の場合、メッセージはキューから削除され、`transactionType` パラメーターによって定義されたトランザクションコンテキストを使用してアプリケーションに返されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2410">Otherwise, the message is removed from the queue and returned to the application using a transaction context defined by the `transactionType` parameter.</span></span>  
  
 <span data-ttu-id="f3a8c-2411">メッセージの受信に使用するスレッドに既に外部トランザクションコンテキストがアタッチされている場合は、`transactionType` パラメーターに `Automatic` を指定します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2411">Specify `Automatic` for the `transactionType` parameter if there is already an external transaction context attached to the thread that you want to use to receive the message.</span></span> <span data-ttu-id="f3a8c-2412">メッセージを1つの内部トランザクションとして受信する場合は、`Single` を指定します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2412">Specify `Single` if you want to receive the message as a single internal transaction.</span></span> <span data-ttu-id="f3a8c-2413">トランザクションコンテキストの外部にあるトランザクションキューからメッセージを受信する場合は、`None` を指定できます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2413">You can specify `None` if you want to receive a message from a transactional queue outside of a transaction context.</span></span>  
  
 <span data-ttu-id="f3a8c-2414">トランザクションキューからメッセージを受信するためにこのメソッドが呼び出された場合、トランザクションが中止されると、受信したメッセージがキューに返されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2414">If this method is called to receive a message from a transactional queue, the message that is received would be returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="f3a8c-2415">トランザクションがコミットされるまで、メッセージはキューから完全に削除されません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2415">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="f3a8c-2416"><xref:System.Messaging.Message.CorrelationId%2A> プロパティは、キューに送信されたメッセージを、関連付けられている応答、レポート、または受信確認メッセージに関連付けるために使用されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2416">The <xref:System.Messaging.Message.CorrelationId%2A> property is used to tie a message sent to the queue to associated response, report, or acknowledgment messages.</span></span>  
  
 <span data-ttu-id="f3a8c-2417">他の2つの方法では、キューからメッセージを受信できます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2417">Two other methods allow you to receive messages from a queue.</span></span> <span data-ttu-id="f3a8c-2418"><xref:System.Messaging.MessageQueue.Receive%2A> メソッドは、キュー内の最初のメッセージを返し、<xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> メソッドを使用して、一意の識別子を指定することによってメッセージを取得します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2418">The <xref:System.Messaging.MessageQueue.Receive%2A> method returns the first message in the queue, and the <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> method is used to retrieve a message by specifying its unique identifier.</span></span>  
  
 <span data-ttu-id="f3a8c-2419">指定された相関 id を持つメッセージをキューから削除せずに読み取るには、<xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> メソッドを使用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2419">To read a message with a specified correlation identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> method.</span></span> <span data-ttu-id="f3a8c-2420"><xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> メソッドは常にキュー内の最初のメッセージを返します。そのため、後続のメソッドの呼び出しでは、優先順位の高いメッセージがキューに到着しない限り、同じメッセージが返されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2420">The <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span> <span data-ttu-id="f3a8c-2421"><xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29>への呼び出しによって返されたメッセージに関連付けられたトランザクションコンテキストがありません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2421">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29>.</span></span> <span data-ttu-id="f3a8c-2422"><xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> はキュー内のメッセージを削除しないため、トランザクションが中止された場合、ロールバックする必要はありません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2422">Because <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> does not remove any messages in the queue, there would be nothing to roll back if the transaction were aborted.</span></span>  
  
 <span data-ttu-id="f3a8c-2423">次の表に、この方法をさまざまなワークグループモードで使用できるかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2423">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-2424">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2424">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-2425">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2425">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-2426">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2426">Local computer</span></span>|<span data-ttu-id="f3a8c-2427">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2427">Yes</span></span>|  
|<span data-ttu-id="f3a8c-2428">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2428">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-2429">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2429">Yes</span></span>|  
|<span data-ttu-id="f3a8c-2430">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2430">Remote computer</span></span>|<span data-ttu-id="f3a8c-2431">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2431">No</span></span>|  
|<span data-ttu-id="f3a8c-2432">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2432">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-2433">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2433">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-2434">次のコード例は、<xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%2CSystem.Messaging.MessageQueueTransactionType%29> の使用方法を示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2434">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%2CSystem.Messaging.MessageQueueTransactionType%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#11](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#11)]
 [!code-csharp[MessageQueue2#11](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#11)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="f3a8c-2435"><paramref name="correlationId" /> パラメーターが <see langword="null" /> です。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2435">The <paramref name="correlationId" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="f3a8c-2436">指定した <paramref name="correlationId" /> を持つメッセージは見つかりませんでした。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2436">The message with the specified <paramref name="correlationId" /> could not be found.</span></span></exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException"><span data-ttu-id="f3a8c-2437"><paramref name="transactionType" /> パラメーターが、<see cref="T:System.Messaging.MessageQueueTransactionType" /> メンバーの 1 つではありません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2437">The <paramref name="transactionType" /> parameter is not one of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> members.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="f3a8c-2438">メッセージ キューのメソッドにアクセスしたときにエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2438">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="T:System.Messaging.MessageQueueTransactionType" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="ReceiveByCorrelationId">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveByCorrelationId (string correlationId, TimeSpan timeout);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveByCorrelationId(string correlationId, valuetype System.TimeSpan timeout) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveByCorrelationId(System.String,System.TimeSpan)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveByCorrelationId (correlationId As String, timeout As TimeSpan) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveByCorrelationId(System::String ^ correlationId, TimeSpan timeout);" />
      <MemberSignature Language="F#" Value="member this.ReceiveByCorrelationId : string * TimeSpan -&gt; System.Messaging.Message" Usage="messageQueue.ReceiveByCorrelationId (correlationId, timeout)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="correlationId" Type="System.String" />
        <Parameter Name="timeout" Type="System.TimeSpan" />
      </Parameters>
      <Docs>
        <param name="correlationId"><span data-ttu-id="f3a8c-2439">受信するメッセージの <see cref="P:System.Messaging.Message.CorrelationId" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2439">The <see cref="P:System.Messaging.Message.CorrelationId" /> of the message to receive.</span></span></param>
        <param name="timeout"><span data-ttu-id="f3a8c-2440">新しいメッセージを検査できるようになるまでの待機時間を示す <see cref="T:System.TimeSpan" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2440">A <see cref="T:System.TimeSpan" /> that indicates the time to wait until a new message is available for inspection.</span></span></param>
        <summary><span data-ttu-id="f3a8c-2441">指定した相関 ID と一致するメッセージを (非トランザクション キューから) 受信します。指定した相関 ID のメッセージがキューで利用可能になるか、タイムアウトの時間が経過するまで待機します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2441">Receives the message that matches the given correlation identifier (from a non-transactional queue) and waits until either a message with the specified correlation identifier is available in the queue, or the time-out expires.</span></span></summary>
        <returns><span data-ttu-id="f3a8c-2442">渡された <paramref name="correlationId" /> パラメーターと一致する <see cref="P:System.Messaging.Message.CorrelationId" /> を持つ <see cref="T:System.Messaging.Message" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2442">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.CorrelationId" /> matches the <paramref name="correlationId" /> parameter passed in.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-2443">このメソッドは、指定された `correlationId` パラメーターに一致する <xref:System.Messaging.Message.CorrelationId%2A> を持つメッセージの <xref:System.Messaging.MessageQueue> によって参照される非トランザクションキューを検索します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2443">This method looks in the non-transactional queue referenced by the <xref:System.Messaging.MessageQueue> for a message whose <xref:System.Messaging.Message.CorrelationId%2A> matches the specified `correlationId` parameter.</span></span> <span data-ttu-id="f3a8c-2444">`correlationId` パラメーターによって指定された相関 id を持つメッセージがキューにある場合、このメソッドは直ちにを返します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2444">This method returns immediately if the message with the correlation identifier specified by the `correlationId` parameter is in the queue.</span></span> <span data-ttu-id="f3a8c-2445">それ以外の場合、メソッドは、新しいメッセージが到着するまで、指定された期間待機します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2445">Otherwise, the method waits the given period of time for a new message to arrive.</span></span> <span data-ttu-id="f3a8c-2446">タイムアウトの期限が切れる前に新しいメッセージが到着しなかった場合は、例外がスローされます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2446">If a new message does not arrive before the time-out expires, an exception is thrown.</span></span>  
  
 <span data-ttu-id="f3a8c-2447">`timeout` パラメーターでは、このメソッドの合計実行時間が指定されていません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2447">The `timeout` parameter does not specify the total running time for this method.</span></span> <span data-ttu-id="f3a8c-2448">代わりに、キューに新しいメッセージが到着するまで待機する時間を指定します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2448">Rather, it specifies the time to wait for a new message to arrive in the queue.</span></span> <span data-ttu-id="f3a8c-2449">このメソッドは、新しいメッセージが到着するたびに、新しいメッセージの <xref:System.Messaging.Message.CorrelationId%2A> を調べて、`correlationId` パラメーターと一致するかどうかを確認します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2449">Each time a new message arrives, this method examines the <xref:System.Messaging.Message.CorrelationId%2A> of the new message to see if it matches the `correlationId` parameter.</span></span> <span data-ttu-id="f3a8c-2450">それ以外の場合、このメソッドはタイムアウト期間を開始し、別の新しいメッセージが到着するまで待機します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2450">If not, this method starts the time-out period over and waits for another new message to arrive.</span></span> <span data-ttu-id="f3a8c-2451">したがって、タイムアウト期間内に新しいメッセージが引き続き到着する場合、このメソッドは、タイムアウト期間が新しいメッセージを受信せずに期限切れになるか、または <xref:System.Messaging.Message.CorrelationId%2A> が `correlationId` パラメーターと一致するメッセージが到着するまで、無期限に実行を継続することができます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2451">Therefore, if new messages continue to arrive within the time-out period, it is possible for this method to continue running indefinitely, either until the time-out period expires without any new messages arriving, or until a message arrives whose <xref:System.Messaging.Message.CorrelationId%2A> matches the `correlationId` parameter.</span></span>  
  
 <span data-ttu-id="f3a8c-2452"><xref:System.Messaging.Message.CorrelationId%2A> プロパティは、キューに送信されたメッセージを、関連付けられている応答、レポート、または受信確認メッセージに関連付けるために使用されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2452">The <xref:System.Messaging.Message.CorrelationId%2A> property is used to tie a message sent to the queue to associated response, report, or acknowledgment messages.</span></span>  
  
 <span data-ttu-id="f3a8c-2453">他の2つの方法では、キューからメッセージを受信できます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2453">Two other methods allow you to receive messages from a queue.</span></span> <span data-ttu-id="f3a8c-2454"><xref:System.Messaging.MessageQueue.Receive%2A> メソッドは、キュー内の最初のメッセージを返し、<xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> メソッドを使用して、一意の識別子を指定することによってメッセージを取得します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2454">The <xref:System.Messaging.MessageQueue.Receive%2A> method returns the first message in the queue, and the <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> method is used to retrieve a message by specifying its unique identifier.</span></span>  
  
 <span data-ttu-id="f3a8c-2455">指定された相関 id を持つメッセージをキューから削除せずに読み取るには、<xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> メソッドを使用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2455">To read a message with a specified correlation identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> method.</span></span> <span data-ttu-id="f3a8c-2456"><xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> メソッドは常にキュー内の最初のメッセージを返します。そのため、後続のメソッドの呼び出しでは、優先順位の高いメッセージがキューに到着しない限り、同じメッセージが返されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2456">The <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span>  
  
 <span data-ttu-id="f3a8c-2457">次の表に、この方法をさまざまなワークグループモードで使用できるかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2457">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-2458">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2458">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-2459">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2459">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-2460">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2460">Local computer</span></span>|<span data-ttu-id="f3a8c-2461">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2461">Yes</span></span>|  
|<span data-ttu-id="f3a8c-2462">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2462">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-2463">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2463">Yes</span></span>|  
|<span data-ttu-id="f3a8c-2464">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2464">Remote computer</span></span>|<span data-ttu-id="f3a8c-2465">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2465">No</span></span>|  
|<span data-ttu-id="f3a8c-2466">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2466">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-2467">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2467">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-2468">次のコード例は、<xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%2CSystem.TimeSpan%29> の使用方法を示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2468">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%2CSystem.TimeSpan%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#10](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#10)]
 [!code-csharp[MessageQueue2#10](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#10)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="f3a8c-2469"><paramref name="correlationId" /> パラメーターが <see langword="null" /> です。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2469">The <paramref name="correlationId" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="f3a8c-2470"><paramref name="timeout" /> パラメーターに指定した値が無効です。<paramref name="timeout" /> が <see cref="F:System.TimeSpan.Zero" /> よりも小さいか、<see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" /> よりも大きい可能性があります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2470">The value specified for the <paramref name="timeout" /> parameter is not valid, possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="f3a8c-2471">指定した <paramref name="correlationId" /> を持つメッセージがキューに存在せず、タイムアウトが経過する前にキューに到達することもありませんでした。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2471">The message with the specified <paramref name="correlationId" /> does not exist in the queue and did not arrive before the time-out expired.</span></span>  
  
<span data-ttu-id="f3a8c-2472">- または -</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2472">-or-</span></span> 
<span data-ttu-id="f3a8c-2473">メッセージ キューのメソッドにアクセスしたときにエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2473">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="ReceiveByCorrelationId">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveByCorrelationId (string correlationId, TimeSpan timeout, System.Messaging.MessageQueueTransaction transaction);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveByCorrelationId(string correlationId, valuetype System.TimeSpan timeout, class System.Messaging.MessageQueueTransaction transaction) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveByCorrelationId(System.String,System.TimeSpan,System.Messaging.MessageQueueTransaction)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveByCorrelationId (correlationId As String, timeout As TimeSpan, transaction As MessageQueueTransaction) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveByCorrelationId(System::String ^ correlationId, TimeSpan timeout, System::Messaging::MessageQueueTransaction ^ transaction);" />
      <MemberSignature Language="F#" Value="member this.ReceiveByCorrelationId : string * TimeSpan * System.Messaging.MessageQueueTransaction -&gt; System.Messaging.Message" Usage="messageQueue.ReceiveByCorrelationId (correlationId, timeout, transaction)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="correlationId" Type="System.String" />
        <Parameter Name="timeout" Type="System.TimeSpan" />
        <Parameter Name="transaction" Type="System.Messaging.MessageQueueTransaction" />
      </Parameters>
      <Docs>
        <param name="correlationId"><span data-ttu-id="f3a8c-2474">受信するメッセージの <see cref="P:System.Messaging.Message.CorrelationId" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2474">The <see cref="P:System.Messaging.Message.CorrelationId" /> of the message to receive.</span></span></param>
        <param name="timeout"><span data-ttu-id="f3a8c-2475">新しいメッセージを検査できるようになるまでの待機時間を示す <see cref="T:System.TimeSpan" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2475">A <see cref="T:System.TimeSpan" /> that indicates the time to wait until a new message is available for inspection.</span></span></param>
        <param name="transaction"><span data-ttu-id="f3a8c-2476"><see cref="T:System.Messaging.MessageQueueTransaction" /> オブジェクト。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2476">The <see cref="T:System.Messaging.MessageQueueTransaction" /> object.</span></span></param>
        <summary><span data-ttu-id="f3a8c-2477">指定した相関 ID と一致するメッセージを (トランザクション キューから) 受信します。指定した相関 ID のメッセージがキューで利用可能になるか、タイムアウトの時間が経過するまで待機します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2477">Receives the message that matches the given correlation identifier (from a transactional queue) and waits until either a message with the specified correlation identifier is available in the queue, or the time-out expires.</span></span></summary>
        <returns><span data-ttu-id="f3a8c-2478">渡された <paramref name="correlationId" /> パラメーターと一致する <see cref="P:System.Messaging.Message.CorrelationId" /> を持つ <see cref="T:System.Messaging.Message" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2478">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.CorrelationId" /> matches the <paramref name="correlationId" /> parameter passed in.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-2479">このメソッドは、指定された `correlationId` パラメーターに一致する <xref:System.Messaging.Message.CorrelationId%2A> を持つメッセージの <xref:System.Messaging.MessageQueue> によって参照されるトランザクションキューを検索します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2479">This method looks in the transactional queue referenced by the <xref:System.Messaging.MessageQueue> for a message whose <xref:System.Messaging.Message.CorrelationId%2A> matches the specified `correlationId` parameter.</span></span> <span data-ttu-id="f3a8c-2480">このメソッドは、`transaction` パラメーターによって定義された内部トランザクションコンテキストを使用して、`correlationId` パラメーターによって指定された相関 id を持つメッセージがキューにある場合に、直ちに戻ります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2480">This method returns immediately if the message with the correlation identifier specified by the `correlationId` parameter is in the queue, using the internal transaction context defined by the `transaction` parameter.</span></span> <span data-ttu-id="f3a8c-2481">それ以外の場合、メソッドは、新しいメッセージが到着するまで、指定された期間待機します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2481">Otherwise, the method waits the given period of time for a new message to arrive.</span></span> <span data-ttu-id="f3a8c-2482">タイムアウトの期限が切れる前に新しいメッセージが到着しなかった場合は、例外がスローされます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2482">If a new message does not arrive before the time-out expires, an exception is thrown.</span></span>  
  
 <span data-ttu-id="f3a8c-2483">`timeout` パラメーターでは、このメソッドの合計実行時間が指定されていません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2483">The `timeout` parameter does not specify the total running time for this method.</span></span> <span data-ttu-id="f3a8c-2484">代わりに、キューに新しいメッセージが到着するまで待機する時間を指定します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2484">Rather, it specifies the time to wait for a new message to arrive in the queue.</span></span> <span data-ttu-id="f3a8c-2485">このメソッドは、新しいメッセージが到着するたびに、新しいメッセージの <xref:System.Messaging.Message.CorrelationId%2A> を調べて、`correlationId` パラメーターと一致するかどうかを確認します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2485">Each time a new message arrives, this method examines the <xref:System.Messaging.Message.CorrelationId%2A> of the new message to see if it matches the `correlationId` parameter.</span></span> <span data-ttu-id="f3a8c-2486">それ以外の場合、このメソッドはタイムアウト期間を開始し、別の新しいメッセージが到着するまで待機します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2486">If not, this method starts the time-out period over and waits for another new message to arrive.</span></span> <span data-ttu-id="f3a8c-2487">したがって、タイムアウト期間内に新しいメッセージが引き続き到着する場合、このメソッドは、タイムアウト期間が新しいメッセージを受信せずに期限切れになるか、または <xref:System.Messaging.Message.CorrelationId%2A> が `correlationId` パラメーターと一致するメッセージが到着するまで、無期限に実行を継続することができます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2487">Therefore, if new messages continue to arrive within the time-out period, it is possible for this method to continue running indefinitely, either until the time-out period expires without any new messages arriving, or until a message arrives whose <xref:System.Messaging.Message.CorrelationId%2A> matches the `correlationId` parameter.</span></span>  
  
 <span data-ttu-id="f3a8c-2488">このメソッドはトランザクションキューで呼び出されるため、トランザクションが中止されると、受信したメッセージがキューに返されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2488">Because this method is called on a transactional queue, the message that is received would be returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="f3a8c-2489">トランザクションがコミットされるまで、メッセージはキューから完全に削除されません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2489">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="f3a8c-2490"><xref:System.Messaging.Message.CorrelationId%2A> プロパティは、キューに送信されたメッセージを、関連付けられている応答、レポート、または受信確認メッセージに関連付けるために使用されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2490">The <xref:System.Messaging.Message.CorrelationId%2A> property is used to tie a message sent to the queue to associated response, report, or acknowledgment messages.</span></span>  
  
 <span data-ttu-id="f3a8c-2491">他の2つの方法では、キューからメッセージを受信できます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2491">Two other methods allow you to receive messages from a queue.</span></span> <span data-ttu-id="f3a8c-2492"><xref:System.Messaging.MessageQueue.Receive%2A> メソッドは、キュー内の最初のメッセージを返し、<xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> メソッドを使用して、一意の識別子を指定することによってメッセージを取得します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2492">The <xref:System.Messaging.MessageQueue.Receive%2A> method returns the first message in the queue, and the <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> method is used to retrieve a message by specifying its unique identifier.</span></span>  
  
 <span data-ttu-id="f3a8c-2493">指定された相関 id を持つメッセージをキューから削除せずに読み取るには、<xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> メソッドを使用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2493">To read a message with a specified correlation identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> method.</span></span> <span data-ttu-id="f3a8c-2494"><xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> メソッドは常にキュー内の最初のメッセージを返します。そのため、後続のメソッドの呼び出しでは、優先順位の高いメッセージがキューに到着しない限り、同じメッセージが返されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2494">The <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span> <span data-ttu-id="f3a8c-2495"><xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29>への呼び出しによって返されたメッセージに関連付けられたトランザクションコンテキストがありません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2495">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29>.</span></span> <span data-ttu-id="f3a8c-2496"><xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> はキュー内のメッセージを削除しないため、トランザクションが中止された場合、ロールバックする必要はありません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2496">Because <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> does not remove any messages in the queue, there would be nothing to roll back if the transaction were aborted.</span></span>  
  
 <span data-ttu-id="f3a8c-2497">次の表に、この方法をさまざまなワークグループモードで使用できるかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2497">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-2498">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2498">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-2499">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2499">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-2500">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2500">Local computer</span></span>|<span data-ttu-id="f3a8c-2501">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2501">Yes</span></span>|  
|<span data-ttu-id="f3a8c-2502">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2502">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-2503">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2503">Yes</span></span>|  
|<span data-ttu-id="f3a8c-2504">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2504">Remote computer</span></span>|<span data-ttu-id="f3a8c-2505">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2505">No</span></span>|  
|<span data-ttu-id="f3a8c-2506">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2506">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-2507">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2507">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-2508">次のコード例は、<xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%2CSystem.TimeSpan%2CSystem.Messaging.MessageQueueTransaction%29> の使用方法を示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2508">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%2CSystem.TimeSpan%2CSystem.Messaging.MessageQueueTransaction%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#13](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#13)]
 [!code-csharp[MessageQueue2#13](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#13)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="f3a8c-2509"><paramref name="correlationId" /> パラメーターが <see langword="null" /> です。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2509">The <paramref name="correlationId" /> parameter is <see langword="null" />.</span></span>  
  
<span data-ttu-id="f3a8c-2510">- または -</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2510">-or-</span></span> 
<span data-ttu-id="f3a8c-2511"><paramref name="transaction" /> パラメーターが <see langword="null" /> です。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2511">The <paramref name="transaction" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="f3a8c-2512"><paramref name="timeout" /> パラメーターに指定した値が無効です。<paramref name="timeout" /> が <see cref="F:System.TimeSpan.Zero" /> よりも小さいか、<see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" /> よりも大きい可能性があります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2512">The value specified for the <paramref name="timeout" /> parameter is not valid, possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="f3a8c-2513">指定した <paramref name="correlationId" /> を持つメッセージがキューに存在せず、タイムアウトが経過する前にキューに到達することもありませんでした。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2513">The message with the specified <paramref name="correlationId" /> does not exist in the queue and did not arrive before the time-out expired.</span></span>  
  
<span data-ttu-id="f3a8c-2514">- または -</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2514">-or-</span></span> 
<span data-ttu-id="f3a8c-2515">キューが非トランザクション キューです。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2515">The queue is non-transactional.</span></span>  
  
<span data-ttu-id="f3a8c-2516">- または -</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2516">-or-</span></span> 
<span data-ttu-id="f3a8c-2517">メッセージ キューのメソッドにアクセスしたときにエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2517">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="T:System.Messaging.MessageQueueTransaction" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="ReceiveByCorrelationId">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveByCorrelationId (string correlationId, TimeSpan timeout, System.Messaging.MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveByCorrelationId(string correlationId, valuetype System.TimeSpan timeout, valuetype System.Messaging.MessageQueueTransactionType transactionType) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveByCorrelationId(System.String,System.TimeSpan,System.Messaging.MessageQueueTransactionType)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveByCorrelationId (correlationId As String, timeout As TimeSpan, transactionType As MessageQueueTransactionType) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveByCorrelationId(System::String ^ correlationId, TimeSpan timeout, System::Messaging::MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="F#" Value="member this.ReceiveByCorrelationId : string * TimeSpan * System.Messaging.MessageQueueTransactionType -&gt; System.Messaging.Message" Usage="messageQueue.ReceiveByCorrelationId (correlationId, timeout, transactionType)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="correlationId" Type="System.String" />
        <Parameter Name="timeout" Type="System.TimeSpan" />
        <Parameter Name="transactionType" Type="System.Messaging.MessageQueueTransactionType" />
      </Parameters>
      <Docs>
        <param name="correlationId"><span data-ttu-id="f3a8c-2518">受信するメッセージの <see cref="P:System.Messaging.Message.CorrelationId" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2518">The <see cref="P:System.Messaging.Message.CorrelationId" /> of the message to receive.</span></span></param>
        <param name="timeout"><span data-ttu-id="f3a8c-2519">新しいメッセージを検査できるようになるまでの待機時間を示す <see cref="T:System.TimeSpan" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2519">A <see cref="T:System.TimeSpan" /> that indicates the time to wait until a new message is available for inspection.</span></span></param>
        <param name="transactionType"><span data-ttu-id="f3a8c-2520">メッセージと関連付けるトランザクション コンテキストの種類を示す、<see cref="T:System.Messaging.MessageQueueTransactionType" /> 値の 1 つ。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2520">One of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> values, describing the type of transaction context to associate with the message.</span></span></param>
        <summary><span data-ttu-id="f3a8c-2521">指定した相関 ID と一致するメッセージを受信します。指定した相関 ID のメッセージがキューで利用可能になるか、タイムアウトの時間が経過するまで待機します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2521">Receives the message that matches the given correlation identifier and waits until either a message with the specified correlation identifier is available in the queue, or the time-out expires.</span></span></summary>
        <returns><span data-ttu-id="f3a8c-2522">渡された <paramref name="correlationId" /> パラメーターと一致する <see cref="P:System.Messaging.Message.CorrelationId" /> を持つ <see cref="T:System.Messaging.Message" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2522">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.CorrelationId" /> matches the <paramref name="correlationId" /> parameter passed in.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-2523">このメソッドは、指定された `correlationId` パラメーターに一致する <xref:System.Messaging.Message.CorrelationId%2A> を持つメッセージの <xref:System.Messaging.MessageQueue> によって参照されるキューを検索します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2523">This method looks in the queue referenced by the <xref:System.Messaging.MessageQueue> for a message whose <xref:System.Messaging.Message.CorrelationId%2A> matches the specified `correlationId` parameter.</span></span> <span data-ttu-id="f3a8c-2524">このメソッドは、`transactionType` パラメーターで定義されているトランザクションコンテキストを使用して、`correlationId` パラメーターによって指定された相関 id を持つメッセージがキューにある場合に、直ちに戻ります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2524">This method returns immediately if the message with the correlation identifier specified by the `correlationId` parameter is in the queue, using a transaction context defined by the `transactionType` parameter.</span></span> <span data-ttu-id="f3a8c-2525">それ以外の場合、メソッドは、新しいメッセージが到着するまで、指定された期間待機します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2525">Otherwise, the method waits the given period of time for a new message to arrive.</span></span> <span data-ttu-id="f3a8c-2526">タイムアウトの期限が切れる前に新しいメッセージが到着しなかった場合は、例外がスローされます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2526">If a new message does not arrive before the time-out expires, an exception is thrown.</span></span>  
  
 <span data-ttu-id="f3a8c-2527">`timeout` パラメーターでは、このメソッドの合計実行時間が指定されていません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2527">The `timeout` parameter does not specify the total running time for this method.</span></span> <span data-ttu-id="f3a8c-2528">代わりに、キューに新しいメッセージが到着するまで待機する時間を指定します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2528">Rather, it specifies the time to wait for a new message to arrive in the queue.</span></span> <span data-ttu-id="f3a8c-2529">このメソッドは、新しいメッセージが到着するたびに、新しいメッセージの <xref:System.Messaging.Message.CorrelationId%2A> を調べて、`correlationId` パラメーターと一致するかどうかを確認します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2529">Each time a new message arrives, this method examines the <xref:System.Messaging.Message.CorrelationId%2A> of the new message to see if it matches the `correlationId` parameter.</span></span> <span data-ttu-id="f3a8c-2530">それ以外の場合、このメソッドはタイムアウト期間を開始し、別の新しいメッセージが到着するまで待機します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2530">If not, this method starts the time-out period over and waits for another new message to arrive.</span></span> <span data-ttu-id="f3a8c-2531">したがって、タイムアウト期間内に新しいメッセージが引き続き到着する場合、このメソッドは、タイムアウト期間が新しいメッセージを受信せずに期限切れになるか、または <xref:System.Messaging.Message.CorrelationId%2A> が `correlationId` パラメーターと一致するメッセージが到着するまで、無期限に実行を継続することができます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2531">Therefore, if new messages continue to arrive within the time-out period, it is possible for this method to continue running indefinitely, either until the time-out period expires without any new messages arriving, or until a message arrives whose <xref:System.Messaging.Message.CorrelationId%2A> matches the `correlationId` parameter.</span></span> <span data-ttu-id="f3a8c-2532">メッセージの受信に使用するスレッドに既に外部トランザクションコンテキストがアタッチされている場合は、`transactionType` パラメーターに `Automatic` を指定します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2532">Specify `Automatic` for the `transactionType` parameter if there is already an external transaction context attached to the thread that you want to use to receive the message.</span></span> <span data-ttu-id="f3a8c-2533">メッセージを1つの内部トランザクションとして受信する場合は、`Single` を指定します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2533">Specify `Single` if you want to receive the message as a single internal transaction.</span></span> <span data-ttu-id="f3a8c-2534">トランザクションコンテキストの外部にあるトランザクションキューからメッセージを受信する場合は、`None` を指定できます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2534">You can specify `None` if you want to receive a message from a transactional queue outside of a transaction context.</span></span>  
  
 <span data-ttu-id="f3a8c-2535">トランザクションキューからメッセージを受信するためにこのメソッドが呼び出された場合、トランザクションが中止されると、受信したメッセージがキューに返されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2535">If this method is called to receive a message from a transactional queue, the message that is received would be returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="f3a8c-2536">トランザクションがコミットされるまで、メッセージはキューから完全に削除されません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2536">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="f3a8c-2537"><xref:System.Messaging.Message.CorrelationId%2A> プロパティは、キューに送信されたメッセージを、関連付けられている応答、レポート、または受信確認メッセージに関連付けるために使用されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2537">The <xref:System.Messaging.Message.CorrelationId%2A> property is used to tie a message sent to the queue to associated response, report, or acknowledgment messages.</span></span>  
  
 <span data-ttu-id="f3a8c-2538">他の2つの方法では、キューからメッセージを受信できます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2538">Two other methods allow you to receive messages from a queue.</span></span> <span data-ttu-id="f3a8c-2539"><xref:System.Messaging.MessageQueue.Receive%2A> メソッドは、キュー内の最初のメッセージを返し、<xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> メソッドを使用して、一意の識別子を指定することによってメッセージを取得します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2539">The <xref:System.Messaging.MessageQueue.Receive%2A> method returns the first message in the queue, and the <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> method is used to retrieve a message by specifying its unique identifier.</span></span>  
  
 <span data-ttu-id="f3a8c-2540">指定された相関 id を持つメッセージをキューから削除せずに読み取るには、<xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> メソッドを使用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2540">To read a message with a specified correlation identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> method.</span></span> <span data-ttu-id="f3a8c-2541"><xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> メソッドは常にキュー内の最初のメッセージを返します。そのため、後続のメソッドの呼び出しでは、優先順位の高いメッセージがキューに到着しない限り、同じメッセージが返されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2541">The <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span> <span data-ttu-id="f3a8c-2542"><xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29>への呼び出しによって返されたメッセージに関連付けられたトランザクションコンテキストがありません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2542">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29>.</span></span> <span data-ttu-id="f3a8c-2543"><xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> はキュー内のメッセージを削除しないため、トランザクションが中止された場合、ロールバックする必要はありません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2543">Because <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> does not remove any messages in the queue, there would be nothing to roll back if the transaction were aborted.</span></span>  
  
 <span data-ttu-id="f3a8c-2544">次の表に、この方法をさまざまなワークグループモードで使用できるかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2544">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-2545">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2545">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-2546">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2546">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-2547">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2547">Local computer</span></span>|<span data-ttu-id="f3a8c-2548">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2548">Yes</span></span>|  
|<span data-ttu-id="f3a8c-2549">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2549">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-2550">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2550">Yes</span></span>|  
|<span data-ttu-id="f3a8c-2551">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2551">Remote computer</span></span>|<span data-ttu-id="f3a8c-2552">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2552">No</span></span>|  
|<span data-ttu-id="f3a8c-2553">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2553">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-2554">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2554">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-2555">次のコード例は、<xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%2CSystem.TimeSpan%2CSystem.Messaging.MessageQueueTransactionType%29> の使用方法を示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2555">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%2CSystem.TimeSpan%2CSystem.Messaging.MessageQueueTransactionType%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#12](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#12)]
 [!code-csharp[MessageQueue2#12](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#12)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="f3a8c-2556"><paramref name="correlationId" /> パラメーターが <see langword="null" /> です。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2556">The <paramref name="correlationId" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="f3a8c-2557">指定した <paramref name="correlationId" /> を持つメッセージは見つかりませんでした。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2557">The message with the specified <paramref name="correlationId" /> could not be found.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="f3a8c-2558"><paramref name="timeout" /> パラメーターに指定した値が無効です。<paramref name="timeout" /> が <see cref="F:System.TimeSpan.Zero" /> よりも小さいか、<see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" /> よりも大きい可能性があります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2558">The value specified for the <paramref name="timeout" /> parameter is not valid, possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span></span></exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException"><span data-ttu-id="f3a8c-2559"><paramref name="transactionType" /> パラメーターが、<see cref="T:System.Messaging.MessageQueueTransactionType" /> メンバーの 1 つではありません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2559">The <paramref name="transactionType" /> parameter is not one of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> members.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="f3a8c-2560">指定した <paramref name="correlationId" /> を持つメッセージがキューに存在せず、タイムアウトが経過する前にキューに到達することもありませんでした。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2560">The message with the specified <paramref name="correlationId" /> does not exist in the queue and did not arrive before the time-out expired.</span></span>  
  
<span data-ttu-id="f3a8c-2561">- または -</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2561">-or-</span></span> 
<span data-ttu-id="f3a8c-2562">メッセージ キューのメソッドにアクセスしたときにエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2562">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="T:System.Messaging.MessageQueueTransactionType" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <MemberGroup MemberName="ReceiveById">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="f3a8c-2563">指定した ID と一致するメッセージを受信し、キューから削除します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2563">Receives the message that matches the given identifier, removing it from the queue.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="ReceiveById">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveById (string id);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveById(string id) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveById(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveById (id As String) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveById(System::String ^ id);" />
      <MemberSignature Language="F#" Value="member this.ReceiveById : string -&gt; System.Messaging.Message" Usage="messageQueue.ReceiveById id" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="id" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="id"><span data-ttu-id="f3a8c-2564">受信するメッセージの <see cref="P:System.Messaging.Message.Id" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2564">The <see cref="P:System.Messaging.Message.Id" /> of the message to receive.</span></span></param>
        <summary><span data-ttu-id="f3a8c-2565">指定した ID と一致するメッセージを非トランザクション キューから受信します。現在、指定した ID と一致するメッセージがキューに存在しない場合は、すぐに例外を発生させます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2565">Receives the message that matches the given identifier from a non-transactional queue and immediately raises an exception if no message with the specified identifier currently exists in the queue.</span></span></summary>
        <returns><span data-ttu-id="f3a8c-2566">渡された <paramref name="id" /> パラメーターと一致する <see cref="P:System.Messaging.Message.Id" /> プロパティを持つ <see cref="T:System.Messaging.Message" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2566">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.Id" /> property matches the <paramref name="id" /> parameter passed in.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-2567">このメソッドを使用して、既知の識別子を持つメッセージを読み取り、キューから削除します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2567">Use this method to read a message with a known identifier and remove it from the queue.</span></span> <span data-ttu-id="f3a8c-2568">このメソッドは、メッセージがキューに存在しない場合、すぐに例外をスローします。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2568">This method throws an exception immediately if the message is not in the queue.</span></span>  
  
 <span data-ttu-id="f3a8c-2569">メッセージの <xref:System.Messaging.Message.Id%2A> プロパティは、メッセージキューエンタープライズ全体で一意であるため、指定された `id` パラメーターに一致するメッセージがキューに1つだけ存在します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2569">The <xref:System.Messaging.Message.Id%2A> property of a message is unique across the Message Queuing enterprise, so there will be at most one message in the queue that matches the given `id` parameter.</span></span>  
  
 <span data-ttu-id="f3a8c-2570">他の2つの方法では、キューからメッセージを受信できます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2570">Two other methods allow you to receive messages from a queue.</span></span> <span data-ttu-id="f3a8c-2571"><xref:System.Messaging.MessageQueue.Receive%2A> メソッドは、キュー内の最初のメッセージを返します。また、<xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%29> メソッドを使用して、キューに送信されたメッセージの結果として作成された確認メッセージ、レポートメッセージ、またはアプリケーションで生成された応答メッセージを取得します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2571">The <xref:System.Messaging.MessageQueue.Receive%2A> method returns the first message in the queue, and the <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%29> method is used to retrieve an acknowledgment, report, or application-generated response message that was created as a result of a message sent to the queue.</span></span>  
  
 <span data-ttu-id="f3a8c-2572">指定された id を持つメッセージをキューから削除せずに読み取るには、<xref:System.Messaging.MessageQueue.PeekById%28System.String%29> メソッドを使用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2572">To read a message with a specified identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> method.</span></span> <span data-ttu-id="f3a8c-2573"><xref:System.Messaging.MessageQueue.PeekById%28System.String%29> メソッドは常にキュー内の最初のメッセージを返します。そのため、後続のメソッドの呼び出しでは、優先順位の高いメッセージがキューに到着しない限り、同じメッセージが返されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2573">The <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span>  
  
 <span data-ttu-id="f3a8c-2574">次の表に、この方法をさまざまなワークグループモードで使用できるかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2574">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-2575">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2575">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-2576">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2576">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-2577">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2577">Local computer</span></span>|<span data-ttu-id="f3a8c-2578">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2578">Yes</span></span>|  
|<span data-ttu-id="f3a8c-2579">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2579">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-2580">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2580">Yes</span></span>|  
|<span data-ttu-id="f3a8c-2581">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2581">Remote computer</span></span>|<span data-ttu-id="f3a8c-2582">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2582">No</span></span>|  
|<span data-ttu-id="f3a8c-2583">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2583">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-2584">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2584">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-2585">次のコード例は、<xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> の使用方法を示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2585">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#16](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#16)]
 [!code-csharp[MessageQueue2#16](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#16)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="f3a8c-2586"><paramref name="id" /> パラメーターが <see langword="null" /> です。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2586">The <paramref name="id" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="f3a8c-2587">指定した <paramref name="id" /> を持つメッセージは見つかりませんでした。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2587">The message with the specified <paramref name="id" /> could not be found.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="f3a8c-2588">メッセージ キューのメソッドにアクセスしたときにエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2588">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="ReceiveById">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveById (string id, System.Messaging.MessageQueueTransaction transaction);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveById(string id, class System.Messaging.MessageQueueTransaction transaction) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveById(System.String,System.Messaging.MessageQueueTransaction)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveById (id As String, transaction As MessageQueueTransaction) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveById(System::String ^ id, System::Messaging::MessageQueueTransaction ^ transaction);" />
      <MemberSignature Language="F#" Value="member this.ReceiveById : string * System.Messaging.MessageQueueTransaction -&gt; System.Messaging.Message" Usage="messageQueue.ReceiveById (id, transaction)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="id" Type="System.String" />
        <Parameter Name="transaction" Type="System.Messaging.MessageQueueTransaction" />
      </Parameters>
      <Docs>
        <param name="id"><span data-ttu-id="f3a8c-2589">受信するメッセージの <see cref="P:System.Messaging.Message.Id" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2589">The <see cref="P:System.Messaging.Message.Id" /> of the message to receive.</span></span></param>
        <param name="transaction"><span data-ttu-id="f3a8c-2590"><see cref="T:System.Messaging.MessageQueueTransaction" /> オブジェクト。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2590">The <see cref="T:System.Messaging.MessageQueueTransaction" /> object.</span></span></param>
        <summary><span data-ttu-id="f3a8c-2591">指定した ID と一致するメッセージを (トランザクション キューから) 受信します。現在、指定した ID と一致するメッセージがキューに存在しない場合は、すぐに例外を発生させます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2591">Receives the message that matches the given identifier (from a transactional queue) and immediately raises an exception if no message with the specified identifier currently exists in the queue.</span></span></summary>
        <returns><span data-ttu-id="f3a8c-2592">渡された <paramref name="id" /> パラメーターと一致する <see cref="P:System.Messaging.Message.Id" /> プロパティを持つ <see cref="T:System.Messaging.Message" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2592">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.Id" /> property matches the <paramref name="id" /> parameter passed in.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-2593">このメソッドを使用して、既知の識別子を持つメッセージを読み取り、`transaction` パラメーターで定義された内部トランザクションコンテキストを使用してキューから削除します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2593">Use this method to read a message with a known identifier and remove it from the queue, using the internal transaction context defined by the `transaction` parameter.</span></span> <span data-ttu-id="f3a8c-2594">このメソッドは、メッセージがキューに存在しない場合、直ちに例外をスローします。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2594">This method throws an exception immediately if the message is not in the queue</span></span>  
  
 <span data-ttu-id="f3a8c-2595">メッセージの <xref:System.Messaging.Message.Id%2A> プロパティは、メッセージキューエンタープライズ全体で一意であるため、指定された `id` パラメーターに一致するメッセージがキューに1つだけ存在します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2595">The <xref:System.Messaging.Message.Id%2A> property of a message is unique across the Message Queuing enterprise, so there will be at most one message in the queue that matches the given `id` parameter.</span></span>  
  
 <span data-ttu-id="f3a8c-2596">このメソッドはトランザクションキューで呼び出されるため、トランザクションが中止されると、受信したメッセージがキューに返されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2596">Because this method is called on a transactional queue, the message that is received would be returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="f3a8c-2597">トランザクションがコミットされるまで、メッセージはキューから完全に削除されません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2597">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="f3a8c-2598">他の2つの方法では、キューからメッセージを受信できます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2598">Two other methods allow you to receive messages from a queue.</span></span> <span data-ttu-id="f3a8c-2599"><xref:System.Messaging.MessageQueue.Receive%2A> メソッドは、キュー内の最初のメッセージを返します。また、<xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%29> メソッドを使用して、キューに送信されたメッセージの結果として作成された確認メッセージ、レポートメッセージ、またはアプリケーションで生成された応答メッセージを取得します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2599">The <xref:System.Messaging.MessageQueue.Receive%2A> method returns the first message in the queue, and the <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%29> method is used to retrieve an acknowledgment, report, or application-generated response message that was created as a result of a message sent to the queue.</span></span>  
  
 <span data-ttu-id="f3a8c-2600">指定された id を持つメッセージをキューから削除せずに読み取るには、<xref:System.Messaging.MessageQueue.PeekById%28System.String%29> メソッドを使用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2600">To read a message with a specified identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> method.</span></span> <span data-ttu-id="f3a8c-2601"><xref:System.Messaging.MessageQueue.PeekById%28System.String%29> メソッドは常にキュー内の最初のメッセージを返します。そのため、後続のメソッドの呼び出しでは、優先順位の高いメッセージがキューに到着しない限り、同じメッセージが返されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2601">The <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span> <span data-ttu-id="f3a8c-2602"><xref:System.Messaging.MessageQueue.PeekById%28System.String%29>への呼び出しによって返されたメッセージに関連付けられたトランザクションコンテキストがありません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2602">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.PeekById%28System.String%29>.</span></span> <span data-ttu-id="f3a8c-2603"><xref:System.Messaging.MessageQueue.PeekById%28System.String%29> はキュー内のメッセージを削除しないため、トランザクションが中止された場合、ロールバックする必要はありません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2603">Because <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> does not remove any messages in the queue, there would be nothing to roll back if the transaction were aborted.</span></span>  
  
 <span data-ttu-id="f3a8c-2604">次の表に、この方法をさまざまなワークグループモードで使用できるかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2604">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-2605">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2605">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-2606">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2606">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-2607">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2607">Local computer</span></span>|<span data-ttu-id="f3a8c-2608">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2608">Yes</span></span>|  
|<span data-ttu-id="f3a8c-2609">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2609">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-2610">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2610">Yes</span></span>|  
|<span data-ttu-id="f3a8c-2611">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2611">Remote computer</span></span>|<span data-ttu-id="f3a8c-2612">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2612">No</span></span>|  
|<span data-ttu-id="f3a8c-2613">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2613">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-2614">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2614">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-2615">次のコード例は、<xref:System.Messaging.MessageQueue.ReceiveById%28System.String%2CSystem.Messaging.MessageQueueTransaction%29> の使用方法を示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2615">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%2CSystem.Messaging.MessageQueueTransaction%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#17](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#17)]
 [!code-csharp[MessageQueue2#17](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#17)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="f3a8c-2616"><paramref name="id" /> パラメーターが <see langword="null" /> です。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2616">The <paramref name="id" /> parameter is <see langword="null" />.</span></span>  
  
<span data-ttu-id="f3a8c-2617">- または -</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2617">-or-</span></span> 
<span data-ttu-id="f3a8c-2618"><paramref name="transaction" /> パラメーターが <see langword="null" /> です。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2618">The <paramref name="transaction" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="f3a8c-2619">指定した <paramref name="id" /> を持つメッセージは見つかりませんでした。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2619">The message with the specified <paramref name="id" /> could not be found.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="f3a8c-2620">キューが非トランザクション キューです。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2620">The queue is non-transactional.</span></span>  
  
 <span data-ttu-id="f3a8c-2621">- または -</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2621">-or-</span></span>  
  
 <span data-ttu-id="f3a8c-2622">メッセージ キューのメソッドにアクセスしたときにエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2622">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="T:System.Messaging.MessageQueueTransaction" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="ReceiveById">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveById (string id, System.Messaging.MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveById(string id, valuetype System.Messaging.MessageQueueTransactionType transactionType) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveById(System.String,System.Messaging.MessageQueueTransactionType)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveById (id As String, transactionType As MessageQueueTransactionType) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveById(System::String ^ id, System::Messaging::MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="F#" Value="member this.ReceiveById : string * System.Messaging.MessageQueueTransactionType -&gt; System.Messaging.Message" Usage="messageQueue.ReceiveById (id, transactionType)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="id" Type="System.String" />
        <Parameter Name="transactionType" Type="System.Messaging.MessageQueueTransactionType" />
      </Parameters>
      <Docs>
        <param name="id"><span data-ttu-id="f3a8c-2623">受信するメッセージの <see cref="P:System.Messaging.Message.Id" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2623">The <see cref="P:System.Messaging.Message.Id" /> of the message to receive.</span></span></param>
        <param name="transactionType"><span data-ttu-id="f3a8c-2624">メッセージと関連付けるトランザクション コンテキストの種類を示す、<see cref="T:System.Messaging.MessageQueueTransactionType" /> 値の 1 つ。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2624">One of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> values, describing the type of transaction context to associate with the message.</span></span></param>
        <summary><span data-ttu-id="f3a8c-2625">指定した ID と一致するメッセージを受信します。現在、指定した ID と一致するメッセージがキューに存在しない場合は、すぐに例外を発生させます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2625">Receives the message that matches the given identifier and immediately raises an exception if no message with the specified identifier currently exists in the queue.</span></span></summary>
        <returns><span data-ttu-id="f3a8c-2626">渡された <paramref name="id" /> パラメーターと一致する <see cref="P:System.Messaging.Message.Id" /> プロパティを持つ <see cref="T:System.Messaging.Message" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2626">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.Id" /> property matches the <paramref name="id" /> parameter passed in.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-2627">このメソッドを使用して、既知の識別子を持つメッセージを読み取り、キューから削除します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2627">Use this method to read a message with a known identifier and remove it from the queue.</span></span> <span data-ttu-id="f3a8c-2628">このメソッドは、メッセージがキューに存在しない場合、すぐに例外をスローします。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2628">This method throws an exception immediately if the message is not in the queue.</span></span> <span data-ttu-id="f3a8c-2629">それ以外の場合、メッセージはキューから削除され、`transactionType` パラメーターによって定義されたトランザクションコンテキストを使用してアプリケーションに返されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2629">Otherwise, the message is removed from the queue and returned to the application using a transaction context defined by the `transactionType` parameter.</span></span>  
  
 <span data-ttu-id="f3a8c-2630">メッセージの受信に使用するスレッドに既に外部トランザクションコンテキストがアタッチされている場合は、`transactionType` パラメーターに `Automatic` を指定します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2630">Specify `Automatic` for the `transactionType` parameter if there is already an external transaction context attached to the thread that you want to use to receive the message.</span></span> <span data-ttu-id="f3a8c-2631">メッセージを1つの内部トランザクションとして受信する場合は、`Single` を指定します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2631">Specify `Single` if you want to receive the message as a single internal transaction.</span></span> <span data-ttu-id="f3a8c-2632">トランザクションコンテキストの外部にあるトランザクションキューからメッセージを受信する場合は、`None` を指定できます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2632">You can specify `None` if you want to receive a message from a transactional queue outside of a transaction context.</span></span>  
  
 <span data-ttu-id="f3a8c-2633">メッセージの <xref:System.Messaging.Message.Id%2A> プロパティは、メッセージキューエンタープライズ全体で一意であるため、指定された `id` パラメーターに一致するメッセージがキューに1つだけ存在します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2633">The <xref:System.Messaging.Message.Id%2A> property of a message is unique across the Message Queuing enterprise, so there will be at most one message in the queue that matches the given `id` parameter.</span></span> <span data-ttu-id="f3a8c-2634">指定した識別子を持つメッセージが、この <xref:System.Messaging.MessageQueue> インスタンスに関連付けられているキュー以外のキューにある場合、メッセージは見つかりません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2634">If the message with the specified identifier is in a queue other than the one associated with this <xref:System.Messaging.MessageQueue> instance, the message will not be found.</span></span>  
  
 <span data-ttu-id="f3a8c-2635">トランザクションキューからメッセージを受信するためにこのメソッドが呼び出された場合、トランザクションが中止されると、受信したメッセージがキューに返されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2635">If this method is called to receive a message from a transactional queue, the message that is received would be returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="f3a8c-2636">トランザクションがコミットされるまで、メッセージはキューから完全に削除されません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2636">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="f3a8c-2637">他の2つの方法では、キューからメッセージを受信できます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2637">Two other methods allow you to receive messages from a queue.</span></span> <span data-ttu-id="f3a8c-2638"><xref:System.Messaging.MessageQueue.Receive%2A> メソッドは、キュー内の最初のメッセージを返します。また、<xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%29> メソッドを使用して、キューに送信されたメッセージの結果として作成された確認メッセージ、レポートメッセージ、またはアプリケーションで生成された応答メッセージを取得します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2638">The <xref:System.Messaging.MessageQueue.Receive%2A> method returns the first message in the queue, and the <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%29> method is used to retrieve an acknowledgment, report, or application-generated response message that was created as a result of a message sent to the queue.</span></span>  
  
 <span data-ttu-id="f3a8c-2639">指定された id を持つメッセージをキューから削除せずに読み取るには、<xref:System.Messaging.MessageQueue.PeekById%28System.String%29> メソッドを使用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2639">To read a message with a specified identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> method.</span></span> <span data-ttu-id="f3a8c-2640"><xref:System.Messaging.MessageQueue.PeekById%28System.String%29> メソッドは常にキュー内の最初のメッセージを返します。そのため、後続のメソッドの呼び出しでは、優先順位の高いメッセージがキューに到着しない限り、同じメッセージが返されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2640">The <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span> <span data-ttu-id="f3a8c-2641"><xref:System.Messaging.MessageQueue.PeekById%28System.String%29>への呼び出しによって返されたメッセージに関連付けられたトランザクションコンテキストがありません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2641">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.PeekById%28System.String%29>.</span></span> <span data-ttu-id="f3a8c-2642"><xref:System.Messaging.MessageQueue.PeekById%28System.String%29> はキュー内のメッセージを削除しないため、トランザクションが中止された場合、ロールバックする必要はありません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2642">Because <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> does not remove any messages in the queue, there would be nothing to roll back if the transaction were aborted.</span></span>  
  
 <span data-ttu-id="f3a8c-2643">次の表に、この方法をさまざまなワークグループモードで使用できるかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2643">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-2644">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2644">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-2645">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2645">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-2646">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2646">Local computer</span></span>|<span data-ttu-id="f3a8c-2647">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2647">Yes</span></span>|  
|<span data-ttu-id="f3a8c-2648">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2648">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-2649">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2649">Yes</span></span>|  
|<span data-ttu-id="f3a8c-2650">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2650">Remote computer</span></span>|<span data-ttu-id="f3a8c-2651">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2651">No</span></span>|  
|<span data-ttu-id="f3a8c-2652">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2652">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-2653">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2653">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-2654">次のコード例は、<xref:System.Messaging.MessageQueue.ReceiveById%28System.String%2CSystem.Messaging.MessageQueueTransactionType%29> の使用方法を示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2654">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%2CSystem.Messaging.MessageQueueTransactionType%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#15](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#15)]
 [!code-csharp[MessageQueue2#15](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#15)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="f3a8c-2655"><paramref name="id" /> パラメーターが <see langword="null" /> です。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2655">The <paramref name="id" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="f3a8c-2656">指定した <paramref name="id" /> を持つメッセージは見つかりませんでした。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2656">The message with the specified <paramref name="id" /> could not be found.</span></span></exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException"><span data-ttu-id="f3a8c-2657"><paramref name="transactionType" /> パラメーターが、<see cref="T:System.Messaging.MessageQueueTransactionType" /> メンバーの 1 つではありません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2657">The <paramref name="transactionType" /> parameter is not one of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> members.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="f3a8c-2658">メッセージ キューのメソッドにアクセスしたときにエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2658">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="T:System.Messaging.MessageQueueTransactionType" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="ReceiveById">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveById (string id, TimeSpan timeout);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveById(string id, valuetype System.TimeSpan timeout) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveById(System.String,System.TimeSpan)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveById (id As String, timeout As TimeSpan) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveById(System::String ^ id, TimeSpan timeout);" />
      <MemberSignature Language="F#" Value="member this.ReceiveById : string * TimeSpan -&gt; System.Messaging.Message" Usage="messageQueue.ReceiveById (id, timeout)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="id" Type="System.String" />
        <Parameter Name="timeout" Type="System.TimeSpan" />
      </Parameters>
      <Docs>
        <param name="id"><span data-ttu-id="f3a8c-2659">受信するメッセージの <see cref="P:System.Messaging.Message.Id" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2659">The <see cref="P:System.Messaging.Message.Id" /> of the message to receive.</span></span></param>
        <param name="timeout"><span data-ttu-id="f3a8c-2660">新しいメッセージを検査できるようになるまでの待機時間を示す <see cref="T:System.TimeSpan" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2660">A <see cref="T:System.TimeSpan" /> that indicates the time to wait until a new message is available for inspection.</span></span></param>
        <summary><span data-ttu-id="f3a8c-2661">指定した ID と一致するメッセージを (非トランザクション キューから) 受信します。指定した ID のメッセージがキューで利用可能になるか、タイムアウトの時間が経過するまで待機します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2661">Receives the message that matches the given identifier (from a non-transactional queue) and waits until either a message with the specified identifier is available in the queue or the time-out expires.</span></span></summary>
        <returns><span data-ttu-id="f3a8c-2662">渡された <paramref name="id" /> パラメーターと一致する <see cref="P:System.Messaging.Message.Id" /> プロパティを持つ <see cref="T:System.Messaging.Message" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2662">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.Id" /> property matches the <paramref name="id" /> parameter passed in.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-2663">このメソッドを使用して、既知の識別子を持つメッセージを読み取り、キューから削除します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2663">Use this method to read a message with a known identifier and remove it from the queue.</span></span> <span data-ttu-id="f3a8c-2664">`id` パラメーターによって指定された識別子を持つメッセージがキューにある場合、このメソッドは直ちにを返します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2664">This method returns immediately if the message with the identifier specified by the `id` parameter is in the queue.</span></span> <span data-ttu-id="f3a8c-2665">それ以外の場合、メソッドは、新しいメッセージが到着するまで、指定された期間待機します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2665">Otherwise, the method waits the given period of time for a new message to arrive.</span></span> <span data-ttu-id="f3a8c-2666">タイムアウトの期限が切れる前に新しいメッセージが到着しなかった場合は、例外がスローされます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2666">If a new message does not arrive before the time-out expires, an exception is thrown.</span></span>  
  
 <span data-ttu-id="f3a8c-2667">`timeout` パラメーターでは、このメソッドの合計実行時間が指定されていません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2667">The `timeout` parameter does not specify the total running time for this method.</span></span> <span data-ttu-id="f3a8c-2668">代わりに、キューに新しいメッセージが到着するまで待機する時間を指定します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2668">Rather, it specifies the time to wait for a new message to arrive in the queue.</span></span> <span data-ttu-id="f3a8c-2669">このメソッドは、新しいメッセージが到着するたびに、新しいメッセージの <xref:System.Messaging.Message.Id%2A> を調べて、`id` パラメーターと一致するかどうかを確認します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2669">Each time a new message arrives, this method examines the <xref:System.Messaging.Message.Id%2A> of the new message to see if it matches the `id` parameter.</span></span> <span data-ttu-id="f3a8c-2670">それ以外の場合、このメソッドはタイムアウト期間を開始し、別の新しいメッセージが到着するまで待機します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2670">If not, this method starts the time-out period over and waits for another new message to arrive.</span></span> <span data-ttu-id="f3a8c-2671">したがって、タイムアウト期間内に新しいメッセージが引き続き到着する場合、このメソッドは、タイムアウト期間が新しいメッセージを受信せずに期限切れになるか、または <xref:System.Messaging.Message.Id%2A> が `id` パラメーターと一致するメッセージが到着するまで、無期限に実行を継続することができます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2671">Therefore, if new messages continue to arrive within the time-out period, it is possible for this method to continue running indefinitely, either until the time-out period expires without any new messages arriving, or until a message arrives whose <xref:System.Messaging.Message.Id%2A> matches the `id` parameter.</span></span>  
  
 <span data-ttu-id="f3a8c-2672">メッセージの <xref:System.Messaging.Message.Id%2A> プロパティは、メッセージキューエンタープライズ全体で一意であるため、指定された `id` パラメーターに一致するメッセージがキューに1つだけ存在します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2672">The <xref:System.Messaging.Message.Id%2A> property of a message is unique across the Message Queuing enterprise, so there will be at most one message in the queue that matches the given `id` parameter.</span></span>  
  
 <span data-ttu-id="f3a8c-2673">`timeout` パラメーターで指定されたタイムアウト期間内に新しいメッセージがキューに到着している限り、現在のスレッドがブロックされてもかまわない場合は、<xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> のこのオーバーロードを使用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2673">Use this overload of <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> when it is acceptable for the current thread to be blocked as long as new messages continue to arrive in the queue within the time-out period specified by the `timeout` parameter.</span></span> <span data-ttu-id="f3a8c-2674">スレッドは、少なくとも指定した期間、または `timeout` パラメーターに <xref:System.Messaging.MessageQueue.InfiniteTimeout> 値を指定した場合は無期限にブロックされます。また、`timeout` パラメーターで指定されたタイムアウト期間内に新しいメッセージがキューに到着する場合は、無制限になります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2674">The thread will be blocked for at least the given period of time, or indefinitely if you specified the value <xref:System.Messaging.MessageQueue.InfiniteTimeout> for the `timeout` parameter, or if new messages continue to arrive in the queue within the time-out period specified by the `timeout` parameter.</span></span>  
  
 <span data-ttu-id="f3a8c-2675">他の2つの方法では、キューからメッセージを受信できます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2675">Two other methods allow you to receive messages from a queue.</span></span> <span data-ttu-id="f3a8c-2676"><xref:System.Messaging.MessageQueue.Receive%2A> メソッドは、キュー内の最初のメッセージを返します。また、<xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%29> メソッドを使用して、キューに送信されたメッセージの結果として作成された確認メッセージ、レポートメッセージ、またはアプリケーションで生成された応答メッセージを取得します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2676">The <xref:System.Messaging.MessageQueue.Receive%2A> method returns the first message in the queue, and the <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%29> method is used to retrieve an acknowledgment, report, or application-generated response message that was created as a result of a message sent to the queue.</span></span>  
  
 <span data-ttu-id="f3a8c-2677">指定された id を持つメッセージをキューから削除せずに読み取るには、<xref:System.Messaging.MessageQueue.PeekById%28System.String%29> メソッドを使用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2677">To read a message with a specified identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> method.</span></span> <span data-ttu-id="f3a8c-2678"><xref:System.Messaging.MessageQueue.PeekById%28System.String%29> メソッドは常にキュー内の最初のメッセージを返します。そのため、後続のメソッドの呼び出しでは、優先順位の高いメッセージがキューに到着しない限り、同じメッセージが返されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2678">The <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span>  
  
 <span data-ttu-id="f3a8c-2679">次の表に、この方法をさまざまなワークグループモードで使用できるかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2679">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-2680">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2680">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-2681">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2681">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-2682">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2682">Local computer</span></span>|<span data-ttu-id="f3a8c-2683">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2683">Yes</span></span>|  
|<span data-ttu-id="f3a8c-2684">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2684">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-2685">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2685">Yes</span></span>|  
|<span data-ttu-id="f3a8c-2686">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2686">Remote computer</span></span>|<span data-ttu-id="f3a8c-2687">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2687">No</span></span>|  
|<span data-ttu-id="f3a8c-2688">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2688">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-2689">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2689">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-2690">次のコード例は、<xref:System.Messaging.MessageQueue.ReceiveById%28System.String%2CSystem.TimeSpan%29> の使用方法を示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2690">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%2CSystem.TimeSpan%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#20](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#20)]
 [!code-csharp[MessageQueue2#20](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#20)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="f3a8c-2691"><paramref name="id" /> パラメーターが <see langword="null" /> です。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2691">The <paramref name="id" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="f3a8c-2692"><paramref name="timeout" /> パラメーターに指定した値が無効です。<paramref name="timeout" /> が <see cref="F:System.TimeSpan.Zero" /> よりも小さいか、<see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" /> よりも大きい可能性があります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2692">The value specified for the <paramref name="timeout" /> parameter is not valid, possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="f3a8c-2693">タイムアウトが経過する前に、指定された <paramref name="id" /> を持つメッセージがキューに到達しませんでした。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2693">A message with the specified <paramref name="id" /> did not arrive in the queue before the time-out expired.</span></span>  
  
<span data-ttu-id="f3a8c-2694">- または -</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2694">-or-</span></span> 
<span data-ttu-id="f3a8c-2695">メッセージ キューのメソッドにアクセスしたときにエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2695">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="ReceiveById">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveById (string id, TimeSpan timeout, System.Messaging.MessageQueueTransaction transaction);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveById(string id, valuetype System.TimeSpan timeout, class System.Messaging.MessageQueueTransaction transaction) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveById(System.String,System.TimeSpan,System.Messaging.MessageQueueTransaction)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveById (id As String, timeout As TimeSpan, transaction As MessageQueueTransaction) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveById(System::String ^ id, TimeSpan timeout, System::Messaging::MessageQueueTransaction ^ transaction);" />
      <MemberSignature Language="F#" Value="member this.ReceiveById : string * TimeSpan * System.Messaging.MessageQueueTransaction -&gt; System.Messaging.Message" Usage="messageQueue.ReceiveById (id, timeout, transaction)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="id" Type="System.String" />
        <Parameter Name="timeout" Type="System.TimeSpan" />
        <Parameter Name="transaction" Type="System.Messaging.MessageQueueTransaction" />
      </Parameters>
      <Docs>
        <param name="id"><span data-ttu-id="f3a8c-2696">受信するメッセージの <see cref="P:System.Messaging.Message.Id" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2696">The <see cref="P:System.Messaging.Message.Id" /> of the message to receive.</span></span></param>
        <param name="timeout"><span data-ttu-id="f3a8c-2697">新しいメッセージを検査できるようになるまでの待機時間を示す <see cref="T:System.TimeSpan" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2697">A <see cref="T:System.TimeSpan" /> that indicates the time to wait until a new message is available for inspection.</span></span></param>
        <param name="transaction"><span data-ttu-id="f3a8c-2698"><see cref="T:System.Messaging.MessageQueueTransaction" /> オブジェクト。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2698">The <see cref="T:System.Messaging.MessageQueueTransaction" /> object.</span></span></param>
        <summary><span data-ttu-id="f3a8c-2699">指定した ID と一致するメッセージを (トランザクション キューから) 受信します。指定した ID のメッセージがキューで利用可能になるか、タイムアウトの時間が経過するまで待機します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2699">Receives the message that matches the given identifier (from a transactional queue) and waits until either a message with the specified identifier is available in the queue or the time-out expires.</span></span></summary>
        <returns><span data-ttu-id="f3a8c-2700">渡された <paramref name="id" /> パラメーターと一致する <see cref="P:System.Messaging.Message.Id" /> プロパティを持つ <see cref="T:System.Messaging.Message" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2700">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.Id" /> property matches the <paramref name="id" /> parameter passed in.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-2701">このメソッドを使用して、既知の識別子を持つメッセージを読み取り、`transaction` パラメーターで定義された内部トランザクションコンテキストを使用してキューから削除します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2701">Use this method to read a message with a known identifier and remove it from the queue, using the internal transaction context defined by the `transaction` parameter.</span></span> <span data-ttu-id="f3a8c-2702">`id` パラメーターによって指定された識別子を持つメッセージがキューにある場合、このメソッドは直ちにを返します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2702">This method returns immediately if the message with the identifier specified by the `id` parameter is in the queue.</span></span> <span data-ttu-id="f3a8c-2703">それ以外の場合、メソッドは、新しいメッセージが到着するまで、指定された期間待機します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2703">Otherwise, the method waits the given period of time for a new message to arrive.</span></span> <span data-ttu-id="f3a8c-2704">タイムアウトの期限が切れる前に新しいメッセージが到着しなかった場合は、例外がスローされます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2704">If a new message does not arrive before the time-out expires, an exception is thrown.</span></span>  
  
 <span data-ttu-id="f3a8c-2705">`timeout` パラメーターでは、このメソッドの合計実行時間が指定されていません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2705">The `timeout` parameter does not specify the total running time for this method.</span></span> <span data-ttu-id="f3a8c-2706">代わりに、キューに新しいメッセージが到着するまで待機する時間を指定します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2706">Rather, it specifies the time to wait for a new message to arrive in the queue.</span></span> <span data-ttu-id="f3a8c-2707">このメソッドは、新しいメッセージが到着するたびに、新しいメッセージの <xref:System.Messaging.Message.Id%2A> を調べて、`id` パラメーターと一致するかどうかを確認します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2707">Each time a new message arrives, this method examines the <xref:System.Messaging.Message.Id%2A> of the new message to see if it matches the `id` parameter.</span></span> <span data-ttu-id="f3a8c-2708">それ以外の場合、このメソッドはタイムアウト期間を開始し、別の新しいメッセージが到着するまで待機します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2708">If not, this method starts the time-out period over and waits for another new message to arrive.</span></span> <span data-ttu-id="f3a8c-2709">したがって、タイムアウト期間内に新しいメッセージが引き続き到着する場合、このメソッドは、タイムアウト期間が新しいメッセージを受信せずに期限切れになるか、または <xref:System.Messaging.Message.Id%2A> が `id` パラメーターと一致するメッセージが到着するまで、無期限に実行を継続することができます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2709">Therefore, if new messages continue to arrive within the time-out period, it is possible for this method to continue running indefinitely, either until the time-out period expires without any new messages arriving, or until a message arrives whose <xref:System.Messaging.Message.Id%2A> matches the `id` parameter.</span></span>  
  
 <span data-ttu-id="f3a8c-2710">メッセージの <xref:System.Messaging.Message.Id%2A> プロパティは、メッセージキューエンタープライズ全体で一意であるため、指定された `id` パラメーターに一致するメッセージがキューに1つだけ存在します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2710">The <xref:System.Messaging.Message.Id%2A> property of a message is unique across the Message Queuing enterprise, so there will be at most one message in the queue that matches the given `id` parameter.</span></span>  
  
 <span data-ttu-id="f3a8c-2711">`timeout` パラメーターで指定されたタイムアウト期間内に新しいメッセージがキューに到着している限り、現在のスレッドがブロックされてもかまわない場合は、<xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> のこのオーバーロードを使用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2711">Use this overload of <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> when it is acceptable for the current thread to be blocked as long as new messages continue to arrive in the queue within the time-out period specified by the `timeout` parameter.</span></span> <span data-ttu-id="f3a8c-2712">スレッドは、少なくとも指定した期間にわたってブロックされるか、`timeout` パラメーターに <xref:System.Messaging.MessageQueue.InfiniteTimeout> 値を指定した場合は無期限にブロックされます。また、`timeout` パラメーターで指定されたタイムアウト期間内に新しいメッセージがキューに到着し続ける場合は、無期限にブロックされます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2712">The thread will be blocked for at least the given period of time, or indefinitely if you specified the value <xref:System.Messaging.MessageQueue.InfiniteTimeout> for the `timeout` parameter, or if new messages continue to arrive in the queue within the timeout period specified by the `timeout` parameter.</span></span>  
  
 <span data-ttu-id="f3a8c-2713">このメソッドはトランザクションキューで呼び出されるため、トランザクションが中止されると、受信したメッセージがキューに返されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2713">Because this method is called on a transactional queue, the message that is received would be returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="f3a8c-2714">トランザクションがコミットされるまで、メッセージはキューから完全に削除されません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2714">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="f3a8c-2715">他の2つの方法では、キューからメッセージを受信できます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2715">Two other methods allow you to receive messages from a queue.</span></span> <span data-ttu-id="f3a8c-2716"><xref:System.Messaging.MessageQueue.Receive%2A> メソッドは、キュー内の最初のメッセージを返します。また、<xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%29> メソッドを使用して、キューに送信されたメッセージの結果として作成された確認メッセージ、レポートメッセージ、またはアプリケーションで生成された応答メッセージを取得します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2716">The <xref:System.Messaging.MessageQueue.Receive%2A> method returns the first message in the queue, and the <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%29> method is used to retrieve an acknowledgment, report, or application-generated response message that was created as a result of a message sent to the queue.</span></span>  
  
 <span data-ttu-id="f3a8c-2717">指定された id を持つメッセージをキューから削除せずに読み取るには、<xref:System.Messaging.MessageQueue.PeekById%28System.String%29> メソッドを使用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2717">To read a message with a specified identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> method.</span></span> <span data-ttu-id="f3a8c-2718"><xref:System.Messaging.MessageQueue.PeekById%28System.String%29> メソッドは常にキュー内の最初のメッセージを返します。そのため、キューにある優先順位の高いメッセージが受信されない限り、後続のメソッドの呼び出しは同じメッセージを返します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2718">The <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> method always returns the first message in the queue, so subsequent calls to the method return the same message, unless a higher priority message arrives in the queue.</span></span> <span data-ttu-id="f3a8c-2719"><xref:System.Messaging.MessageQueue.PeekById%28System.String%29>への呼び出しによって返されたメッセージに関連付けられたトランザクションコンテキストがありません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2719">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.PeekById%28System.String%29>.</span></span> <span data-ttu-id="f3a8c-2720"><xref:System.Messaging.MessageQueue.PeekById%28System.String%29> はキュー内のメッセージを削除しないため、トランザクションが中止された場合、ロールバックする必要はありません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2720">Because <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> does not remove any messages in the queue, there would be nothing to roll back if the transaction were aborted.</span></span>  
  
 <span data-ttu-id="f3a8c-2721">次の表に、この方法をさまざまなワークグループモードで使用できるかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2721">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-2722">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2722">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-2723">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2723">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-2724">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2724">Local computer</span></span>|<span data-ttu-id="f3a8c-2725">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2725">Yes</span></span>|  
|<span data-ttu-id="f3a8c-2726">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2726">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-2727">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2727">Yes</span></span>|  
|<span data-ttu-id="f3a8c-2728">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2728">Remote computer</span></span>|<span data-ttu-id="f3a8c-2729">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2729">No</span></span>|  
|<span data-ttu-id="f3a8c-2730">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2730">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-2731">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2731">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-2732">次のコード例は、<xref:System.Messaging.MessageQueue.ReceiveById%28System.String%2CSystem.TimeSpan%2CSystem.Messaging.MessageQueueTransaction%29> の使用方法を示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2732">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%2CSystem.TimeSpan%2CSystem.Messaging.MessageQueueTransaction%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#18](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#18)]
 [!code-csharp[MessageQueue2#18](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#18)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="f3a8c-2733"><paramref name="id" /> パラメーターが <see langword="null" /> です。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2733">The <paramref name="id" /> parameter is <see langword="null" />.</span></span>  
  
<span data-ttu-id="f3a8c-2734">- または -</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2734">-or-</span></span> 
<span data-ttu-id="f3a8c-2735"><paramref name="transaction" /> パラメーターが <see langword="null" /> です。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2735">The <paramref name="transaction" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="f3a8c-2736"><paramref name="timeout" /> パラメーターに指定した値が無効です。<paramref name="timeout" /> が <see cref="F:System.TimeSpan.Zero" /> よりも小さいか、<see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" /> よりも大きい可能性があります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2736">The value specified for the <paramref name="timeout" /> parameter is not valid, possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="f3a8c-2737">タイムアウトが経過する前に、指定された <paramref name="id" /> を持つメッセージがキューに到達しませんでした。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2737">A message with the specified <paramref name="id" /> did not arrive in the queue before the time-out expired.</span></span>  
  
<span data-ttu-id="f3a8c-2738">- または -</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2738">-or-</span></span> 
<span data-ttu-id="f3a8c-2739">キューが非トランザクション キューです。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2739">The queue is non-transactional.</span></span>  
  
<span data-ttu-id="f3a8c-2740">- または -</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2740">-or-</span></span> 
<span data-ttu-id="f3a8c-2741">メッセージ キューのメソッドにアクセスしたときにエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2741">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="T:System.Messaging.MessageQueueTransaction" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="ReceiveById">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveById (string id, TimeSpan timeout, System.Messaging.MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveById(string id, valuetype System.TimeSpan timeout, valuetype System.Messaging.MessageQueueTransactionType transactionType) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveById(System.String,System.TimeSpan,System.Messaging.MessageQueueTransactionType)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveById (id As String, timeout As TimeSpan, transactionType As MessageQueueTransactionType) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveById(System::String ^ id, TimeSpan timeout, System::Messaging::MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="F#" Value="member this.ReceiveById : string * TimeSpan * System.Messaging.MessageQueueTransactionType -&gt; System.Messaging.Message" Usage="messageQueue.ReceiveById (id, timeout, transactionType)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="id" Type="System.String" />
        <Parameter Name="timeout" Type="System.TimeSpan" />
        <Parameter Name="transactionType" Type="System.Messaging.MessageQueueTransactionType" />
      </Parameters>
      <Docs>
        <param name="id"><span data-ttu-id="f3a8c-2742">受信するメッセージの <see cref="P:System.Messaging.Message.Id" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2742">The <see cref="P:System.Messaging.Message.Id" /> of the message to receive.</span></span></param>
        <param name="timeout"><span data-ttu-id="f3a8c-2743">新しいメッセージを検査できるようになるまでの待機時間を示す <see cref="T:System.TimeSpan" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2743">A <see cref="T:System.TimeSpan" /> that indicates the time to wait until a new message is available for inspection.</span></span></param>
        <param name="transactionType"><span data-ttu-id="f3a8c-2744">メッセージと関連付けるトランザクション コンテキストの種類を示す、<see cref="T:System.Messaging.MessageQueueTransactionType" /> 値の 1 つ。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2744">One of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> values, describing the type of transaction context to associate with the message.</span></span></param>
        <summary><span data-ttu-id="f3a8c-2745">指定した ID と一致するメッセージを受信します。指定した ID のメッセージがキューで利用可能になるか、タイムアウトの時間が経過するまで待機します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2745">Receives the message that matches the given identifier and waits until either a message with the specified identifier is available in the queue or the time-out expires.</span></span></summary>
        <returns><span data-ttu-id="f3a8c-2746">渡された <paramref name="id" /> パラメーターと一致する <see cref="P:System.Messaging.Message.Id" /> プロパティを持つ <see cref="T:System.Messaging.Message" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2746">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.Id" /> property matches the <paramref name="id" /> parameter passed in.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-2747">このメソッドを使用して、既知の識別子を持つメッセージを読み取り、キューから削除します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2747">Use this method to read a message with a known identifier and remove it from the queue.</span></span> <span data-ttu-id="f3a8c-2748">このメソッドは、`transactionType` パラメーターで定義されているトランザクションコンテキストを使用して、`id` パラメーターによって指定された識別子を持つメッセージがキューにある場合に、直ちに戻ります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2748">This method returns immediately if the message with the identifier specified by the `id` parameter is in the queue, using a transaction context defined by the `transactionType` parameter.</span></span> <span data-ttu-id="f3a8c-2749">それ以外の場合、メソッドは、新しいメッセージが到着するまで、指定された期間待機します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2749">Otherwise, the method waits the given period of time for a new message to arrive.</span></span> <span data-ttu-id="f3a8c-2750">タイムアウトの期限が切れる前に新しいメッセージが到着しなかった場合は、例外がスローされます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2750">If a new message does not arrive before the time-out expires, an exception is thrown.</span></span>  
  
 <span data-ttu-id="f3a8c-2751">`timeout` パラメーターでは、このメソッドの合計実行時間が指定されていません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2751">The `timeout` parameter does not specify the total running time for this method.</span></span> <span data-ttu-id="f3a8c-2752">代わりに、キューに新しいメッセージが到着するまで待機する時間を指定します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2752">Rather, it specifies the time to wait for a new message to arrive in the queue.</span></span> <span data-ttu-id="f3a8c-2753">このメソッドは、新しいメッセージが到着するたびに、新しいメッセージの <xref:System.Messaging.Message.Id%2A> を調べて、`id` パラメーターと一致するかどうかを確認します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2753">Each time a new message arrives, this method examines the <xref:System.Messaging.Message.Id%2A> of the new message to see if it matches the `id` parameter.</span></span> <span data-ttu-id="f3a8c-2754">それ以外の場合、このメソッドはタイムアウト期間を開始し、別の新しいメッセージが到着するまで待機します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2754">If not, this method starts the time-out period over and waits for another new message to arrive.</span></span> <span data-ttu-id="f3a8c-2755">したがって、タイムアウト期間内に新しいメッセージが引き続き到着する場合、このメソッドは、タイムアウト期間が新しいメッセージを受信せずに期限切れになるか、または <xref:System.Messaging.Message.Id%2A> が `id` パラメーターと一致するメッセージが到着するまで、無期限に実行を継続することができます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2755">Therefore, if new messages continue to arrive within the time-out period, it is possible for this method to continue running indefinitely, either until the time-out period expires without any new messages arriving, or until a message arrives whose <xref:System.Messaging.Message.Id%2A> matches the `id` parameter.</span></span>  
  
 <span data-ttu-id="f3a8c-2756">メッセージの受信に使用するスレッドに既に外部トランザクションコンテキストがアタッチされている場合は、`transactionType` パラメーターに `Automatic` を指定します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2756">Specify `Automatic` for the `transactionType` parameter if there is already an external transaction context attached to the thread that you want to use to receive the message.</span></span> <span data-ttu-id="f3a8c-2757">メッセージを1つの内部トランザクションとして受信する場合は、`Single` を指定します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2757">Specify `Single` if you want to receive the message as a single internal transaction.</span></span> <span data-ttu-id="f3a8c-2758">トランザクションコンテキストの外部にあるトランザクションキューからメッセージを受信する場合は、`None` を指定できます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2758">You can specify `None` if you want to receive a message from a transactional queue outside of a transaction context.</span></span>  
  
 <span data-ttu-id="f3a8c-2759">メッセージの <xref:System.Messaging.Message.Id%2A> プロパティは、メッセージキューエンタープライズ全体で一意であるため、指定された `id` パラメーターに一致するメッセージがキューに1つだけ存在します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2759">The <xref:System.Messaging.Message.Id%2A> property of a message is unique across the Message Queuing enterprise, so there will be at most one message in the queue that matches the given `id` parameter.</span></span> <span data-ttu-id="f3a8c-2760">指定した識別子を持つメッセージが、この <xref:System.Messaging.MessageQueue> インスタンスに関連付けられているキュー以外のキューにある場合、メッセージは見つかりません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2760">If the message with the specified identifier is in a queue other than the one associated with this <xref:System.Messaging.MessageQueue> instance, the message will not be found.</span></span>  
  
 <span data-ttu-id="f3a8c-2761">`timeout` パラメーターで指定されたタイムアウト期間内に新しいメッセージがキューに到着している限り、現在のスレッドがブロックされてもかまわない場合は、<xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> のこのオーバーロードを使用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2761">Use this overload of <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> when it is acceptable for the current thread to be blocked as long as new messages continue to arrive in the queue within the time-out period specified by the `timeout` parameter.</span></span> <span data-ttu-id="f3a8c-2762">スレッドは、少なくとも指定した期間、または `timeout` パラメーターに <xref:System.Messaging.MessageQueue.InfiniteTimeout> 値を指定した場合は無期限にブロックされます。また、`timeout` パラメーターで指定されたタイムアウト期間内に新しいメッセージがキューに到着する場合は、無制限になります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2762">The thread will be blocked for at least the given period of time, or indefinitely if you specified the value <xref:System.Messaging.MessageQueue.InfiniteTimeout> for the `timeout` parameter, or if new messages continue to arrive in the queue within the time-out period specified by the `timeout` parameter.</span></span>  
  
 <span data-ttu-id="f3a8c-2763">トランザクションキューからメッセージを受信するためにこのメソッドが呼び出された場合、トランザクションが中止されると、受信したメッセージがキューに返されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2763">If this method is called to receive a message from a transactional queue, the message that is received would be returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="f3a8c-2764">トランザクションがコミットされるまで、メッセージはキューから完全に削除されません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2764">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="f3a8c-2765">他の2つの方法では、キューからメッセージを受信できます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2765">Two other methods allow you to receive messages from a queue.</span></span> <span data-ttu-id="f3a8c-2766"><xref:System.Messaging.MessageQueue.Receive%2A> メソッドは、キュー内の最初のメッセージを返します。また、<xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%29> メソッドを使用して、キューに送信されたメッセージの結果として作成された確認メッセージ、レポートメッセージ、またはアプリケーションで生成された応答メッセージを取得します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2766">The <xref:System.Messaging.MessageQueue.Receive%2A> method returns the first message in the queue, and the <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%29> method is used to retrieve an acknowledgment, report, or application-generated response message that was created as a result of a message sent to the queue.</span></span>  
  
 <span data-ttu-id="f3a8c-2767">指定された id を持つメッセージをキューから削除せずに読み取るには、<xref:System.Messaging.MessageQueue.PeekById%28System.String%29> メソッドを使用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2767">To read a message with a specified identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> method.</span></span> <span data-ttu-id="f3a8c-2768"><xref:System.Messaging.MessageQueue.PeekById%28System.String%29> メソッドは常にキュー内の最初のメッセージを返します。そのため、後続のメソッドの呼び出しでは、優先順位の高いメッセージがキューに到着しない限り、同じメッセージが返されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2768">The <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span> <span data-ttu-id="f3a8c-2769"><xref:System.Messaging.MessageQueue.PeekById%28System.String%29>への呼び出しによって返されたメッセージに関連付けられたトランザクションコンテキストがありません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2769">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.PeekById%28System.String%29>.</span></span> <span data-ttu-id="f3a8c-2770"><xref:System.Messaging.MessageQueue.PeekById%28System.String%29> はキュー内のメッセージを削除しないため、トランザクションが中止された場合、ロールバックする必要はありません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2770">Because <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> does not remove any messages in the queue, there would be nothing to roll back if the transaction were aborted.</span></span>  
  
 <span data-ttu-id="f3a8c-2771">次の表に、この方法をさまざまなワークグループモードで使用できるかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2771">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-2772">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2772">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-2773">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2773">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-2774">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2774">Local computer</span></span>|<span data-ttu-id="f3a8c-2775">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2775">Yes</span></span>|  
|<span data-ttu-id="f3a8c-2776">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2776">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-2777">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2777">Yes</span></span>|  
|<span data-ttu-id="f3a8c-2778">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2778">Remote computer</span></span>|<span data-ttu-id="f3a8c-2779">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2779">No</span></span>|  
|<span data-ttu-id="f3a8c-2780">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2780">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-2781">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2781">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-2782">次のコード例は、<xref:System.Messaging.MessageQueue.ReceiveById%28System.String%2CSystem.TimeSpan%2CSystem.Messaging.MessageQueueTransactionType%29> の使用方法を示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2782">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%2CSystem.TimeSpan%2CSystem.Messaging.MessageQueueTransactionType%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#19](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#19)]
 [!code-csharp[MessageQueue2#19](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#19)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="f3a8c-2783"><paramref name="id" /> パラメーターが <see langword="null" /> です。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2783">The <paramref name="id" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="f3a8c-2784"><paramref name="timeout" /> パラメーターに指定した値が無効です。<paramref name="timeout" /> が <see cref="F:System.TimeSpan.Zero" /> よりも小さいか、<see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" /> よりも大きい可能性があります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2784">The value specified for the <paramref name="timeout" /> parameter is not valid, possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="f3a8c-2785">タイムアウトが経過する前に、指定された <paramref name="id" /> を持つメッセージがキューに到達しませんでした。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2785">A message with the specified <paramref name="id" /> did not arrive in the queue before the time-out expired.</span></span>  
  
<span data-ttu-id="f3a8c-2786">- または -</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2786">-or-</span></span> 
<span data-ttu-id="f3a8c-2787">メッセージ キューのメソッドにアクセスしたときにエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2787">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException"><span data-ttu-id="f3a8c-2788"><paramref name="transactionType" /> パラメーターが、<see cref="T:System.Messaging.MessageQueueTransactionType" /> メンバーの 1 つではありません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2788">The <paramref name="transactionType" /> parameter is not one of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> members.</span></span></exception>
        <altmember cref="T:System.Messaging.MessageQueueTransactionType" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <MemberGroup MemberName="ReceiveByLookupId">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="f3a8c-2789">MSMQ 3.0 で導入されました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2789">Introduced in MSMQ 3.0.</span></span> <span data-ttu-id="f3a8c-2790">特定のメッセージをキューから受信します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2790">Receives a specific message from the queue.</span></span> <span data-ttu-id="f3a8c-2791">メッセージは、参照識別子で指定することも、キューの前後の位置関係で指定することもできます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2791">The message can be specified by a lookup identifier or by its position at the front or end of the queue.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="ReceiveByLookupId">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveByLookupId (long lookupId);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveByLookupId(int64 lookupId) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveByLookupId(System.Int64)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveByLookupId (lookupId As Long) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveByLookupId(long lookupId);" />
      <MemberSignature Language="F#" Value="member this.ReceiveByLookupId : int64 -&gt; System.Messaging.Message" Usage="messageQueue.ReceiveByLookupId lookupId" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="lookupId" Type="System.Int64" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="lookupId"><span data-ttu-id="f3a8c-2792">受信するメッセージの <see cref="P:System.Messaging.Message.LookupId" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2792">The <see cref="P:System.Messaging.Message.LookupId" /> of the message to receive.</span></span></param>
        <summary><span data-ttu-id="f3a8c-2793">MSMQ 3.0 で導入されました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2793">Introduced in MSMQ 3.0.</span></span> <span data-ttu-id="f3a8c-2794">非トランザクション キュー内の指定した参照識別子に一致するメッセージを受信します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2794">Receives the message that matches the given lookup identifier from a non-transactional queue.</span></span></summary>
        <returns><span data-ttu-id="f3a8c-2795">渡された <paramref name="lookupId" /> パラメーターと一致する <see cref="P:System.Messaging.Message.LookupId" /> プロパティを持つ <see cref="T:System.Messaging.Message" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2795">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.LookupId" /> property matches the <paramref name="lookupId" /> parameter passed in.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-2796">このメソッドを使用して、既知の参照識別子を持つメッセージを読み取り、キューから削除します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2796">Use this method to read a message with a known lookup identifier and remove it from the queue.</span></span> <span data-ttu-id="f3a8c-2797">このメソッドは、メッセージがキューに存在しない場合、すぐに例外をスローします。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2797">This method throws an exception immediately if the message is not in the queue.</span></span>  
  
 <span data-ttu-id="f3a8c-2798">メッセージの <xref:System.Messaging.Message.LookupId%2A> プロパティは、メッセージが存在するキューに対して一意であるため、指定された `lookupId` パラメーターに一致するメッセージがキューに1つだけ存在します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2798">The <xref:System.Messaging.Message.LookupId%2A> property of a message is unique to the queue where the message resides, so there will be at most one message in the queue that matches the given `lookupId` parameter.</span></span>  
  
 <span data-ttu-id="f3a8c-2799">指定された参照識別子を持つメッセージをキューから削除せずに読み取るには、<xref:System.Messaging.MessageQueue.PeekByLookupId%2A> メソッドを使用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2799">To read a message with a specified lookup identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekByLookupId%2A> method.</span></span>  
  
 <span data-ttu-id="f3a8c-2800">次の表に、この方法をさまざまなワークグループモードで使用できるかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2800">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-2801">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2801">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-2802">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2802">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-2803">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2803">Local computer</span></span>|<span data-ttu-id="f3a8c-2804">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2804">Yes</span></span>|  
|<span data-ttu-id="f3a8c-2805">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2805">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-2806">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2806">Yes</span></span>|  
|<span data-ttu-id="f3a8c-2807">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2807">Remote computer</span></span>|<span data-ttu-id="f3a8c-2808">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2808">No</span></span>|  
|<span data-ttu-id="f3a8c-2809">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2809">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-2810">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2810">Yes</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.PlatformNotSupportedException"><span data-ttu-id="f3a8c-2811">MSMQ 3.0 がインストールされていません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2811">MSMQ 3.0 is not installed.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="f3a8c-2812">指定した <paramref name="lookupId" /> を持つメッセージは見つかりませんでした。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2812">The message with the specified <paramref name="lookupId" /> could not be found.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="f3a8c-2813">メッセージ キューのメソッドにアクセスしたときにエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2813">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.Message.LookupId" />
        <altmember cref="Overload:System.Messaging.MessageQueue.PeekByLookupId" />
      </Docs>
    </Member>
    <Member MemberName="ReceiveByLookupId">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveByLookupId (System.Messaging.MessageLookupAction action, long lookupId, System.Messaging.MessageQueueTransaction transaction);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveByLookupId(valuetype System.Messaging.MessageLookupAction action, int64 lookupId, class System.Messaging.MessageQueueTransaction transaction) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveByLookupId(System.Messaging.MessageLookupAction,System.Int64,System.Messaging.MessageQueueTransaction)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveByLookupId (action As MessageLookupAction, lookupId As Long, transaction As MessageQueueTransaction) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveByLookupId(System::Messaging::MessageLookupAction action, long lookupId, System::Messaging::MessageQueueTransaction ^ transaction);" />
      <MemberSignature Language="F#" Value="member this.ReceiveByLookupId : System.Messaging.MessageLookupAction * int64 * System.Messaging.MessageQueueTransaction -&gt; System.Messaging.Message" Usage="messageQueue.ReceiveByLookupId (action, lookupId, transaction)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="action" Type="System.Messaging.MessageLookupAction" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="lookupId" Type="System.Int64" Index="1" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="transaction" Type="System.Messaging.MessageQueueTransaction" Index="2" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="action"><span data-ttu-id="f3a8c-2814">キュー内のメッセージを読み取る方法を指定する <see cref="T:System.Messaging.MessageLookupAction" /> のいずれか 1 つ。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2814">One of the <see cref="T:System.Messaging.MessageLookupAction" /> values, specifying how the message is read in the queue.</span></span> <span data-ttu-id="f3a8c-2815">次のいずれかを指定します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2815">Specify one of the following:</span></span> 
 <span data-ttu-id="f3a8c-2816"><see langword="MessageLookupAction.Current" />:<paramref name="lookupId" /> で指定されたメッセージを受信し、キューから削除します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2816"><see langword="MessageLookupAction.Current" />: Receives the message specified by <paramref name="lookupId" /> and removes it from the queue.</span></span>  
  
 <span data-ttu-id="f3a8c-2817"><see langword="MessageLookupAction.Next" />:<paramref name="lookupId" /> で指定されたメッセージの次のメッセージを受信し、キューから削除します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2817"><see langword="MessageLookupAction.Next" />: Receives the message following the message specified by <paramref name="lookupId" /> and removes it from the queue.</span></span>  
  
 <span data-ttu-id="f3a8c-2818"><see langword="MessageLookupAction.Previous" />:<paramref name="lookupId" /> で指定されたメッセージの前のメッセージを受信し、キューから削除します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2818"><see langword="MessageLookupAction.Previous" />: Receives the message preceding the message specified by <paramref name="lookupId" /> and removes it from the queue.</span></span>  
  
 <span data-ttu-id="f3a8c-2819"><see langword="MessageLookupAction.First" />:キューの最初のメッセージを受信し、キューから削除します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2819"><see langword="MessageLookupAction.First" />: Receives the first message in the queue and removes it from the queue.</span></span> <span data-ttu-id="f3a8c-2820"><paramref name="lookupId" /> パラメーターは、0 に設定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2820">The <paramref name="lookupId" /> parameter must be set to 0.</span></span>  
  
 <span data-ttu-id="f3a8c-2821"><see langword="MessageLookupAction.Last" />:キューの最後のメッセージを受信し、キューから削除します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2821"><see langword="MessageLookupAction.Last" />: Receives the last message in the queue and removes it from the queue.</span></span> <span data-ttu-id="f3a8c-2822"><paramref name="lookupId" /> パラメーターは、0 に設定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2822">The <paramref name="lookupId" /> parameter must be set to 0.</span></span></param>
        <param name="lookupId"><span data-ttu-id="f3a8c-2823">受信するメッセージの <see cref="P:System.Messaging.Message.LookupId" /> か、0。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2823">The <see cref="P:System.Messaging.Message.LookupId" /> of the message to receive, or 0.</span></span> <span data-ttu-id="f3a8c-2824">キューの最初または最後のメッセージにアクセスする場合は 0 を使用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2824">0 is used when accessing the first or last message in the queue.</span></span></param>
        <param name="transaction"><span data-ttu-id="f3a8c-2825"><see cref="T:System.Messaging.MessageQueueTransaction" /> オブジェクト。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2825">The <see cref="T:System.Messaging.MessageQueueTransaction" /> object.</span></span></param>
        <summary><span data-ttu-id="f3a8c-2826">MSMQ 3.0 で導入されました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2826">Introduced in MSMQ 3.0.</span></span> <span data-ttu-id="f3a8c-2827">特定のメッセージをトランザクション キューから受信します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2827">Receives a specific message from a transactional queue.</span></span> <span data-ttu-id="f3a8c-2828">メッセージは、参照識別子で指定することも、キューの前後の位置関係で指定することもできます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2828">The message can be specified by a lookup identifier or by its position at the front or end of the queue.</span></span></summary>
        <returns><span data-ttu-id="f3a8c-2829">渡された <paramref name="lookupId" /> パラメーターおよび <paramref name="action" /> パラメーターで指定された <see cref="T:System.Messaging.Message" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2829">The <see cref="T:System.Messaging.Message" /> specified by the <paramref name="lookupId" /> and <paramref name="action" /> parameters passed in.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-2830">このメソッドを使用して、既知の参照識別子を持つメッセージを読み取り、`transaction` パラメーターで定義されたトランザクションコンテキストを使用してキューから削除します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2830">Use this method to read a message with a known lookup identifier and remove it from the queue, using a transaction context defined by the `transaction` parameter.</span></span> <span data-ttu-id="f3a8c-2831">このメソッドは、メッセージがキューに存在しない場合、すぐに例外をスローします。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2831">This method throws an exception immediately if the message is not in the queue.</span></span>  
  
 <span data-ttu-id="f3a8c-2832">メッセージの <xref:System.Messaging.Message.LookupId%2A> プロパティは、メッセージが存在するキューに対して一意であるため、指定された `lookupId` パラメーターに一致するメッセージがキューに1つだけ存在します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2832">The <xref:System.Messaging.Message.LookupId%2A> property of a message is unique to the queue where the message resides, so there will be at most one message in the queue that matches the given `lookupId` parameter.</span></span>  
  
 <span data-ttu-id="f3a8c-2833">このメソッドはトランザクションキューで呼び出されるため、トランザクションが中止されると、受信したメッセージがキューに返されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2833">Because this method is called on a transactional queue, the message that is received would be returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="f3a8c-2834">トランザクションがコミットされるまで、メッセージはキューから完全に削除されません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2834">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="f3a8c-2835">指定された id を持つメッセージをキューから削除せずに読み取るには、<xref:System.Messaging.MessageQueue.PeekByLookupId%2A> メソッドを使用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2835">To read a message with a specified identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekByLookupId%2A> method.</span></span> <span data-ttu-id="f3a8c-2836"><xref:System.Messaging.MessageQueue.PeekByLookupId%2A>への呼び出しによって返されたメッセージに関連付けられたトランザクションコンテキストがありません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2836">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.PeekByLookupId%2A>.</span></span> <span data-ttu-id="f3a8c-2837"><xref:System.Messaging.MessageQueue.PeekByLookupId%2A> はキューからメッセージを削除しないため、トランザクションが中止された場合、ロールバックすることはできません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2837">Because <xref:System.Messaging.MessageQueue.PeekByLookupId%2A> does not remove any messages from the queue, there would be nothing to roll back if the transaction were aborted.</span></span>  
  
 <span data-ttu-id="f3a8c-2838">次の表に、この方法をさまざまなワークグループモードで使用できるかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2838">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-2839">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2839">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-2840">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2840">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-2841">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2841">Local computer</span></span>|<span data-ttu-id="f3a8c-2842">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2842">Yes</span></span>|  
|<span data-ttu-id="f3a8c-2843">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2843">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-2844">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2844">Yes</span></span>|  
|<span data-ttu-id="f3a8c-2845">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2845">Remote computer</span></span>|<span data-ttu-id="f3a8c-2846">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2846">No</span></span>|  
|<span data-ttu-id="f3a8c-2847">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2847">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-2848">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2848">Yes</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.PlatformNotSupportedException"><span data-ttu-id="f3a8c-2849">MSMQ 3.0 がインストールされていません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2849">MSMQ 3.0 is not installed.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="f3a8c-2850">指定した <paramref name="lookupId" /> を持つメッセージは見つかりませんでした。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2850">The message with the specified <paramref name="lookupId" /> could not be found.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="f3a8c-2851">メッセージ キューのメソッドにアクセスしたときにエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2851">An error occurred when accessing a Message Queuing method.</span></span>  
  
 <span data-ttu-id="f3a8c-2852">- または -</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2852">-or-</span></span>  
  
 <span data-ttu-id="f3a8c-2853">キューが非トランザクション キューです。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2853">The queue is non-transactional.</span></span></exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException"><span data-ttu-id="f3a8c-2854"><paramref name="action" /> パラメーターが、<see cref="T:System.Messaging.MessageLookupAction" /> メンバーの 1 つではありません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2854">The <paramref name="action" /> parameter is not one of the <see cref="T:System.Messaging.MessageLookupAction" /> members.</span></span></exception>
        <altmember cref="P:System.Messaging.Message.LookupId" />
        <altmember cref="Overload:System.Messaging.MessageQueue.PeekByLookupId" />
      </Docs>
    </Member>
    <Member MemberName="ReceiveByLookupId">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveByLookupId (System.Messaging.MessageLookupAction action, long lookupId, System.Messaging.MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveByLookupId(valuetype System.Messaging.MessageLookupAction action, int64 lookupId, valuetype System.Messaging.MessageQueueTransactionType transactionType) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveByLookupId(System.Messaging.MessageLookupAction,System.Int64,System.Messaging.MessageQueueTransactionType)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveByLookupId (action As MessageLookupAction, lookupId As Long, transactionType As MessageQueueTransactionType) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveByLookupId(System::Messaging::MessageLookupAction action, long lookupId, System::Messaging::MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="F#" Value="member this.ReceiveByLookupId : System.Messaging.MessageLookupAction * int64 * System.Messaging.MessageQueueTransactionType -&gt; System.Messaging.Message" Usage="messageQueue.ReceiveByLookupId (action, lookupId, transactionType)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="action" Type="System.Messaging.MessageLookupAction" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="lookupId" Type="System.Int64" Index="1" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="transactionType" Type="System.Messaging.MessageQueueTransactionType" Index="2" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="action"><span data-ttu-id="f3a8c-2855">キュー内のメッセージを読み取る方法を指定する <see cref="T:System.Messaging.MessageLookupAction" /> のいずれか 1 つ。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2855">One of the <see cref="T:System.Messaging.MessageLookupAction" /> values, specifying how the message is read in the queue.</span></span> <span data-ttu-id="f3a8c-2856">次のいずれかを指定します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2856">Specify one of the following:</span></span> 
 <span data-ttu-id="f3a8c-2857"><see langword="MessageLookupAction.Current" />:<paramref name="lookupId" /> で指定されたメッセージを受信し、キューから削除します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2857"><see langword="MessageLookupAction.Current" />: Receives the message specified by <paramref name="lookupId" /> and removes it from the queue.</span></span>  
  
 <span data-ttu-id="f3a8c-2858"><see langword="MessageLookupAction.Next" />:<paramref name="lookupId" /> で指定されたメッセージの次のメッセージを受信し、キューから削除します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2858"><see langword="MessageLookupAction.Next" />: Receives the message following the message specified by <paramref name="lookupId" /> and removes it from the queue.</span></span>  
  
 <span data-ttu-id="f3a8c-2859"><see langword="MessageLookupAction.Previous" />:<paramref name="lookupId" /> で指定されたメッセージの前のメッセージを受信し、キューから削除します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2859"><see langword="MessageLookupAction.Previous" />: Receives the message preceding the message specified by <paramref name="lookupId" /> and removes it from the queue.</span></span>  
  
 <span data-ttu-id="f3a8c-2860"><see langword="MessageLookupAction.First" />:キューの最初のメッセージを受信し、キューから削除します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2860"><see langword="MessageLookupAction.First" />: Receives the first message in the queue and removes it from the queue.</span></span> <span data-ttu-id="f3a8c-2861"><paramref name="lookupId" /> パラメーターは、0 に設定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2861">The <paramref name="lookupId" /> parameter must be set to 0.</span></span>  
  
 <span data-ttu-id="f3a8c-2862"><see langword="MessageLookupAction.Last" />:キューの最後のメッセージを受信し、キューから削除します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2862"><see langword="MessageLookupAction.Last" />: Receives the last message in the queue and removes it from the queue.</span></span> <span data-ttu-id="f3a8c-2863"><paramref name="lookupId" /> パラメーターは、0 に設定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2863">The <paramref name="lookupId" /> parameter must be set to 0.</span></span></param>
        <param name="lookupId"><span data-ttu-id="f3a8c-2864">受信するメッセージの <see cref="P:System.Messaging.Message.LookupId" /> か、0。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2864">The <see cref="P:System.Messaging.Message.LookupId" /> of the message to receive, or 0.</span></span> <span data-ttu-id="f3a8c-2865">キューの最初または最後のメッセージにアクセスする場合は 0 を使用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2865">0 is used when accessing the first or last message in the queue.</span></span></param>
        <param name="transactionType"><span data-ttu-id="f3a8c-2866">メッセージと関連付けるトランザクション コンテキストの種類を示す、<see cref="T:System.Messaging.MessageQueueTransactionType" /> 値の 1 つ。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2866">One of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> values, describing the type of transaction context to associate with the message.</span></span></param>
        <summary><span data-ttu-id="f3a8c-2867">MSMQ 3.0 で導入されました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2867">Introduced in MSMQ 3.0.</span></span> <span data-ttu-id="f3a8c-2868">トランザクション コンテキストを指定して、特定のメッセージをキューから受信します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2868">Receives a specific message from the queue, using the specified transaction context.</span></span> <span data-ttu-id="f3a8c-2869">メッセージは、参照識別子で指定することも、キューの前後の位置関係で指定することもできます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2869">The message can be specified by a lookup identifier or by its position at the front or end of the queue.</span></span></summary>
        <returns><span data-ttu-id="f3a8c-2870">渡された <paramref name="action" /> パラメーターおよび <paramref name="lookupId" /> パラメーターで指定された <see cref="T:System.Messaging.Message" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2870">The <see cref="T:System.Messaging.Message" /> specified by the <paramref name="action" /> and <paramref name="lookupId" /> parameters passed in.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-2871">このメソッドを使用して、既知の参照識別子を持つメッセージを読み取り、`transactionType` パラメーターで定義されたトランザクションコンテキストを使用してキューから削除します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2871">Use this method to read a message with a known lookup identifier and remove it from the queue, using a transaction context defined by the `transactionType` parameter.</span></span> <span data-ttu-id="f3a8c-2872">このメソッドは、メッセージがキューに存在しない場合、すぐに例外をスローします。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2872">This method throws an exception immediately if the message is not in the queue.</span></span>  
  
 <span data-ttu-id="f3a8c-2873">メッセージの <xref:System.Messaging.Message.LookupId%2A> プロパティは、メッセージが存在するキューに対して一意であるため、指定された `lookupId` パラメーターに一致するメッセージがキューに1つだけ存在します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2873">The <xref:System.Messaging.Message.LookupId%2A> property of a message is unique to the queue where the message resides, so there will be at most one message in the queue that matches the given `lookupId` parameter.</span></span>  
  
 <span data-ttu-id="f3a8c-2874">指定された id を持つメッセージをキューから削除せずに読み取るには、<xref:System.Messaging.MessageQueue.PeekByLookupId%2A> メソッドを使用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2874">To read a message with a specified identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekByLookupId%2A> method.</span></span> <span data-ttu-id="f3a8c-2875"><xref:System.Messaging.MessageQueue.PeekByLookupId%2A>への呼び出しによって返されたメッセージに関連付けられたトランザクションコンテキストがありません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2875">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.PeekByLookupId%2A>.</span></span> <span data-ttu-id="f3a8c-2876"><xref:System.Messaging.MessageQueue.PeekByLookupId%2A> はキューからメッセージを削除しないため、トランザクションが中止された場合、ロールバックすることはできません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2876">Because <xref:System.Messaging.MessageQueue.PeekByLookupId%2A> does not remove any messages from the queue, there would be nothing to roll back if the transaction were aborted.</span></span>  
  
 <span data-ttu-id="f3a8c-2877">メッセージの受信に使用するスレッドに既に外部トランザクションコンテキストがアタッチされている場合は、`transactionType` パラメーターに `Automatic` を指定します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2877">Specify `Automatic` for the `transactionType` parameter if there is already an external transaction context attached to the thread that you want to use to receive the message.</span></span> <span data-ttu-id="f3a8c-2878">メッセージを1つの内部トランザクションとして受信する場合は、`Single` を指定します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2878">Specify `Single` if you want to receive the message as a single internal transaction.</span></span> <span data-ttu-id="f3a8c-2879">トランザクションコンテキストの外部にあるトランザクションキューからメッセージを受信する場合は、`None` を指定できます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2879">You can specify `None` if you want to receive a message from a transactional queue outside of a transaction context.</span></span>  
  
 <span data-ttu-id="f3a8c-2880">トランザクションキューからメッセージを受信するためにこのメソッドが呼び出された場合、トランザクションが中止されると、受信したメッセージがキューに返されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2880">If this method is called to receive a message from a transactional queue, the message that is received would be returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="f3a8c-2881">トランザクションがコミットされるまで、メッセージはキューから完全に削除されません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2881">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="f3a8c-2882">次の表に、この方法をさまざまなワークグループモードで使用できるかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2882">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-2883">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2883">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-2884">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2884">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-2885">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2885">Local computer</span></span>|<span data-ttu-id="f3a8c-2886">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2886">Yes</span></span>|  
|<span data-ttu-id="f3a8c-2887">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2887">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-2888">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2888">Yes</span></span>|  
|<span data-ttu-id="f3a8c-2889">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2889">Remote computer</span></span>|<span data-ttu-id="f3a8c-2890">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2890">No</span></span>|  
|<span data-ttu-id="f3a8c-2891">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2891">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-2892">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2892">Yes</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.PlatformNotSupportedException"><span data-ttu-id="f3a8c-2893">MSMQ 3.0 がインストールされていません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2893">MSMQ 3.0 is not installed.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="f3a8c-2894">指定した <paramref name="lookupId" /> を持つメッセージは見つかりませんでした。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2894">The message with the specified <paramref name="lookupId" /> could not be found.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="f3a8c-2895">メッセージ キューのメソッドにアクセスしたときにエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2895">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException"><span data-ttu-id="f3a8c-2896"><paramref name="action" /> パラメーターが、<see cref="T:System.Messaging.MessageLookupAction" /> メンバーの 1 つではありません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2896">The <paramref name="action" /> parameter is not one of the <see cref="T:System.Messaging.MessageLookupAction" /> members.</span></span>  
  
<span data-ttu-id="f3a8c-2897">- または -</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2897">-or-</span></span> 
<span data-ttu-id="f3a8c-2898"><paramref name="transactionType" /> パラメーターが、<see cref="T:System.Messaging.MessageQueueTransactionType" /> メンバーの 1 つではありません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2898">The <paramref name="transactionType" /> parameter is not one of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> members.</span></span></exception>
        <altmember cref="P:System.Messaging.Message.LookupId" />
        <altmember cref="Overload:System.Messaging.MessageQueue.PeekByLookupId" />
      </Docs>
    </Member>
    <Member MemberName="ReceiveCompleted">
      <MemberSignature Language="C#" Value="public event System.Messaging.ReceiveCompletedEventHandler ReceiveCompleted;" />
      <MemberSignature Language="ILAsm" Value=".event class System.Messaging.ReceiveCompletedEventHandler ReceiveCompleted" />
      <MemberSignature Language="DocId" Value="E:System.Messaging.MessageQueue.ReceiveCompleted" />
      <MemberSignature Language="VB.NET" Value="Public Custom Event ReceiveCompleted As ReceiveCompletedEventHandler " />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; event System::Messaging::ReceiveCompletedEventHandler ^ ReceiveCompleted;" />
      <MemberSignature Language="F#" Value="member this.ReceiveCompleted : System.Messaging.ReceiveCompletedEventHandler " Usage="member this.ReceiveCompleted : System.Messaging.ReceiveCompletedEventHandler " />
      <MemberType>Event</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_ReceiveCompleted")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Messaging.ReceiveCompletedEventHandler</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="f3a8c-2899">メッセージがキューから削除されると発生します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2899">Occurs when a message has been removed from the queue.</span></span> <span data-ttu-id="f3a8c-2900">このイベントは、非同期操作 <see cref="M:System.Messaging.MessageQueue.BeginReceive" /> によって発生します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2900">This event is raised by the asynchronous operation, <see cref="M:System.Messaging.MessageQueue.BeginReceive" />.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-2901"><xref:System.Messaging.MessageQueue.BeginReceive%2A> は、メッセージがキューで利用可能な場合に、非同期処理で <xref:System.Messaging.MessageQueue.ReceiveCompleted> イベントを発生させるために使用されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2901"><xref:System.Messaging.MessageQueue.BeginReceive%2A> is used in asynchronous processing to raise the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event when a message is available in the queue.</span></span>  
  
 <span data-ttu-id="f3a8c-2902"><xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> は、<xref:System.Messaging.MessageQueue.BeginReceive%2A> の呼び出しによって開始される操作を完了し、<xref:System.Messaging.MessageQueue.ReceiveCompleted> イベントが発生したときにメッセージをピークするために使用されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2902"><xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> is used to complete the operation initiated by a call to <xref:System.Messaging.MessageQueue.BeginReceive%2A> and peek the message when the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event is raised.</span></span>  
  
 <span data-ttu-id="f3a8c-2903"><xref:System.Messaging.ReceiveCompletedEventHandler> デリゲートを作成する場合は、イベントを処理するメソッドを指定します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2903">When you create a <xref:System.Messaging.ReceiveCompletedEventHandler> delegate, you identify the method that will handle the event.</span></span> <span data-ttu-id="f3a8c-2904">イベントをイベント ハンドラーに関連付けるには、デリゲートのインスタンスをイベントに追加します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2904">To associate the event with your event handler, add an instance of the delegate to the event.</span></span> <span data-ttu-id="f3a8c-2905">デリゲートを削除しない限り、そのイベントが発生すると常にイベント ハンドラーが呼び出されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2905">The event handler is called whenever the event occurs, unless you remove the delegate.</span></span> <span data-ttu-id="f3a8c-2906">イベントハンドラーデリゲートの詳細については、「[イベントの処理と発生](~/docs/standard/events/index.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2906">For more information about event handler delegates, see [Handling and Raising Events](~/docs/standard/events/index.md).</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-2907">次のコード例では、`MyReceiveCompleted`という名前のイベントハンドラーを作成し、それを <xref:System.Messaging.MessageQueue.ReceiveCompleted> イベントハンドラーデリゲートにアタッチし、<xref:System.Messaging.MessageQueue.BeginReceive%2A> を呼び出して、パス ".\myQueue" にあるキューで非同期の受信操作を開始します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2907">The following code example creates an event handler named `MyReceiveCompleted`, attaches it to the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event handler delegate, and calls <xref:System.Messaging.MessageQueue.BeginReceive%2A> to initiate an asynchronous receive operation on the queue that is located at the path ".\myQueue".</span></span> <span data-ttu-id="f3a8c-2908"><xref:System.Messaging.MessageQueue.ReceiveCompleted> イベントが発生すると、この例ではメッセージを受信し、その本文を画面に書き込みます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2908">When a <xref:System.Messaging.MessageQueue.ReceiveCompleted> event is raised, the example receives the message and writes its body to the screen.</span></span> <span data-ttu-id="f3a8c-2909">この例では、<xref:System.Messaging.MessageQueue.BeginReceive%2A> を再度呼び出して、新しい非同期の受信操作を開始します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2909">The example then calls <xref:System.Messaging.MessageQueue.BeginReceive%2A> again to initiate a new asynchronous receive operation.</span></span>  
  
 [!code-cpp[MessageQueue.ReceiveCompleted#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.ReceiveCompleted/CPP/mqreceivecompletedeventhandler.cpp#1)]
 [!code-csharp[MessageQueue.ReceiveCompleted#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.ReceiveCompleted/CS/mqreceivecompletedeventhandler.cs#1)]
 [!code-vb[MessageQueue.ReceiveCompleted#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.ReceiveCompleted/VB/mqreceivecompletedeventhandler.vb#1)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
        <altmember cref="E:System.Messaging.MessageQueue.PeekCompleted" />
        <altmember cref="T:System.TimeSpan" />
        <altmember cref="T:System.AsyncCallback" />
        <altmember cref="T:System.IAsyncResult" />
      </Docs>
    </Member>
    <Member MemberName="Refresh">
      <MemberSignature Language="C#" Value="public void Refresh ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void Refresh() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Refresh" />
      <MemberSignature Language="VB.NET" Value="Public Sub Refresh ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void Refresh();" />
      <MemberSignature Language="F#" Value="member this.Refresh : unit -&gt; unit" Usage="messageQueue.Refresh " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="f3a8c-2910">リソースの現在の状態を反映するには、<see cref="T:System.Messaging.MessageQueue" /> で表されるプロパティを更新します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2910">Refreshes the properties presented by the <see cref="T:System.Messaging.MessageQueue" /> to reflect the current state of the resource.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-2911"><xref:System.Messaging.MessageQueue.Refresh%2A> は、<xref:System.Messaging.MessageQueue> のプロパティを、関連付けられているメッセージキューサーバーリソースと同期します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2911"><xref:System.Messaging.MessageQueue.Refresh%2A> synchronizes the properties of a <xref:System.Messaging.MessageQueue> with its associated Message Queuing server resource.</span></span> <span data-ttu-id="f3a8c-2912"><xref:System.Messaging.MessageQueue> の作成時以降にサーバー上で <xref:System.Messaging.MessageQueue.Label%2A> や <xref:System.Messaging.MessageQueue.Category%2A>などのプロパティが変更された場合、<xref:System.Messaging.MessageQueue.Refresh%2A> は新しい情報で <xref:System.Messaging.MessageQueue> を更新します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2912">If any property, such as <xref:System.Messaging.MessageQueue.Label%2A> or <xref:System.Messaging.MessageQueue.Category%2A>, has changed on the server since the time the <xref:System.Messaging.MessageQueue> was created, <xref:System.Messaging.MessageQueue.Refresh%2A> updates the <xref:System.Messaging.MessageQueue> with the new information.</span></span>  
  
 <span data-ttu-id="f3a8c-2913">次の表に、この方法をさまざまなワークグループモードで使用できるかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2913">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-2914">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2914">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-2915">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2915">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-2916">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2916">Local computer</span></span>|<span data-ttu-id="f3a8c-2917">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2917">Yes</span></span>|  
|<span data-ttu-id="f3a8c-2918">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2918">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-2919">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2919">Yes</span></span>|  
|<span data-ttu-id="f3a8c-2920">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2920">Remote computer</span></span>|<span data-ttu-id="f3a8c-2921">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2921">No</span></span>|  
|<span data-ttu-id="f3a8c-2922">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2922">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-2923">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2923">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-2924">次のコード例は、<xref:System.Messaging.MessageQueue.Refresh%2A> の使用方法を示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2924">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.Refresh%2A>.</span></span>  
  
 [!code-cpp[MessageQueue2#28](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#28)]
 [!code-csharp[MessageQueue2#28](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#28)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Messaging.MessageQueue.GetPublicQueues" />
      </Docs>
    </Member>
    <Member MemberName="ResetPermissions">
      <MemberSignature Language="C#" Value="public void ResetPermissions ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void ResetPermissions() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ResetPermissions" />
      <MemberSignature Language="VB.NET" Value="Public Sub ResetPermissions ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void ResetPermissions();" />
      <MemberSignature Language="F#" Value="member this.ResetPermissions : unit -&gt; unit" Usage="messageQueue.ResetPermissions " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="f3a8c-2925">アクセス許可リストをオペレーティング システムの既定値にリセットします。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2925">Resets the permission list to the operating system's default values.</span></span> <span data-ttu-id="f3a8c-2926">既定のリストに追加したキューのアクセス許可を削除します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2926">Removes any queue permissions you have appended to the default list.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-2927"><xref:System.Messaging.MessageQueue.ResetPermissions%2A>を呼び出すと、アクセス許可リストが既定値に戻ります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2927">When you call <xref:System.Messaging.MessageQueue.ResetPermissions%2A>, you return the permission list to its default values.</span></span> <span data-ttu-id="f3a8c-2928">一般に、キュー作成者にはすべてのアクセス許可が付与され、グループには次の権限が付与されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2928">Generally, this grants the queue creator all permissions, and gives the group Everyone the following rights:</span></span>  
  
-   <span data-ttu-id="f3a8c-2929">キューのプロパティを取得します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2929">Get the properties of the queue.</span></span>  
  
-   <span data-ttu-id="f3a8c-2930">キューのアクセス許可を取得します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2930">Get queue permissions.</span></span>  
  
-   <span data-ttu-id="f3a8c-2931">キューに書き込みます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2931">Write to the queue.</span></span>  
  
 <span data-ttu-id="f3a8c-2932">次の表に、この方法をさまざまなワークグループモードで使用できるかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2932">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-2933">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2933">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-2934">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2934">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-2935">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2935">Local computer</span></span>|<span data-ttu-id="f3a8c-2936">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2936">Yes</span></span>|  
|<span data-ttu-id="f3a8c-2937">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2937">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-2938">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2938">Yes</span></span>|  
|<span data-ttu-id="f3a8c-2939">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2939">Remote computer</span></span>|<span data-ttu-id="f3a8c-2940">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2940">No</span></span>|  
|<span data-ttu-id="f3a8c-2941">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2941">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-2942">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2942">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-2943">次のコード例は、<xref:System.Messaging.MessageQueue.ResetPermissions%2A> の使用方法を示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2943">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.ResetPermissions%2A>.</span></span>  
  
 [!code-cpp[MessageQueue2#27](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#27)]
 [!code-csharp[MessageQueue2#27](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#27)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="f3a8c-2944">メッセージ キューのメソッドにアクセスしたときにエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2944">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="M:System.Messaging.MessageQueue.SetPermissions(System.String,System.Messaging.MessageQueueAccessRights)" />
      </Docs>
    </Member>
    <MemberGroup MemberName="Send">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="f3a8c-2945">キューにオブジェクトを送信します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2945">Sends an object to a queue.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="Send">
      <MemberSignature Language="C#" Value="public void Send (object obj);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void Send(object obj) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Send(System.Object)" />
      <MemberSignature Language="VB.NET" Value="Public Sub Send (obj As Object)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void Send(System::Object ^ obj);" />
      <MemberSignature Language="F#" Value="member this.Send : obj -&gt; unit" Usage="messageQueue.Send obj" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="obj" Type="System.Object" />
      </Parameters>
      <Docs>
        <param name="obj"><span data-ttu-id="f3a8c-2946">キューに送信するオブジェクト。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2946">The object to send to the queue.</span></span></param>
        <summary><span data-ttu-id="f3a8c-2947">この <see cref="T:System.Messaging.MessageQueue" /> で参照される非トランザクション キューにオブジェクトを送信します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2947">Sends an object to non-transactional queue referenced by this <see cref="T:System.Messaging.MessageQueue" />.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-2948">このオーバーロードを使用して、<xref:System.Messaging.MessageQueue>によって参照されるキューに `obj` パラメーターを含むメッセージを送信します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2948">Use this overload to send a message that contains the `obj` parameter to the queue referenced by the <xref:System.Messaging.MessageQueue>.</span></span> <span data-ttu-id="f3a8c-2949">キューに送信するオブジェクトは、<xref:System.Messaging.Message> または任意のマネージオブジェクトにすることができます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2949">The object you send to the queue can be a <xref:System.Messaging.Message> or any managed object.</span></span> <span data-ttu-id="f3a8c-2950"><xref:System.Messaging.Message>以外のオブジェクトを送信すると、オブジェクトがシリアル化され、メッセージの本文に挿入されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2950">If you send any object other than a <xref:System.Messaging.Message>, the object is serialized and inserted into the body of the message.</span></span>  
  
 <span data-ttu-id="f3a8c-2951">このオーバーロードを使用してトランザクションキューにメッセージを送信すると、メッセージは配信不能キューに送信されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2951">If you use this overload to send a message to a transactional queue, the message will be sent to the dead-letter queue.</span></span> <span data-ttu-id="f3a8c-2952">メッセージを他のメッセージを含むトランザクションの一部にする場合は、パラメーターとして <xref:System.Messaging.MessageQueueTransaction> または <xref:System.Messaging.MessageQueueTransactionType> を受け取るオーバーロードを使用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2952">If you want the message to be part of a transaction that contains other messages, use an overload that takes a <xref:System.Messaging.MessageQueueTransaction> or <xref:System.Messaging.MessageQueueTransactionType> as a parameter.</span></span>  
  
 <span data-ttu-id="f3a8c-2953"><xref:System.Messaging.MessageQueue.Send%28System.Object%29>を呼び出す前に <xref:System.Messaging.MessageQueue.Formatter%2A> プロパティを設定しなかった場合、フォーマッタは既定で <xref:System.Messaging.XmlMessageFormatter>に設定されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2953">If you do not set the <xref:System.Messaging.MessageQueue.Formatter%2A> property before calling <xref:System.Messaging.MessageQueue.Send%28System.Object%29>, the formatter defaults to the <xref:System.Messaging.XmlMessageFormatter>.</span></span>  
  
 <span data-ttu-id="f3a8c-2954"><xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> プロパティは、<xref:System.Messaging.Message>以外のすべてのオブジェクトに適用されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2954">The <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> property applies to any object other than a <xref:System.Messaging.Message>.</span></span> <span data-ttu-id="f3a8c-2955">たとえば、<xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> メンバーを使用してラベルや優先順位を指定した場合、これらの値は、アプリケーションからキューに送信されるときに <xref:System.Messaging.Message> 型ではないオブジェクトを含むすべてのメッセージに適用されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2955">If you specify, for example, a label or a priority using the <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> member, these values apply to any message that contains an object that is not of type <xref:System.Messaging.Message> when your application sends it to the queue.</span></span> <span data-ttu-id="f3a8c-2956"><xref:System.Messaging.Message>を送信する場合、<xref:System.Messaging.Message> に設定されているプロパティ値が <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> より優先され、メッセージの <xref:System.Messaging.Message.Formatter%2A?displayProperty=nameWithType> プロパティはキューの <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> プロパティよりも優先されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2956">When sending a <xref:System.Messaging.Message>, the property values set for the <xref:System.Messaging.Message> take precedence over <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> and the message's <xref:System.Messaging.Message.Formatter%2A?displayProperty=nameWithType> property takes precedence over the queue's <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> property.</span></span>  
  
 <span data-ttu-id="f3a8c-2957">次の表に、この方法をさまざまなワークグループモードで使用できるかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2957">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-2958">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2958">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-2959">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2959">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-2960">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2960">Local computer</span></span>|<span data-ttu-id="f3a8c-2961">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2961">Yes</span></span>|  
|<span data-ttu-id="f3a8c-2962">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2962">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-2963">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2963">Yes</span></span>|  
|<span data-ttu-id="f3a8c-2964">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2964">Remote computer</span></span>|<span data-ttu-id="f3a8c-2965">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2965">No</span></span>|  
|<span data-ttu-id="f3a8c-2966">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2966">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-2967">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2967">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-2968">次のコード例では、メッセージキューに接続し、メッセージをキューに送信します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2968">The following code example connects to a message queue and sends a message to the queue.</span></span>  
  
 [!code-cpp[MessageQueue.Send_obj#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Send_obj/CPP/mqsend_generic.cpp#1)]
 [!code-csharp[MessageQueue.Send_obj#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Send_obj/CS/mqsend_generic.cs#1)]
 [!code-vb[MessageQueue.Send_obj#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Send_obj/VB/mqsend_generic.vb#1)]  
  
 <span data-ttu-id="f3a8c-2969">次のコード例では、アプリケーションによって定義された `Order` クラスをキューに送信し、そのキューからメッセージを受信します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2969">The following code example sends an application-defined `Order` class to a queue and then receives a message from that queue.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="f3a8c-2970"><see cref="P:System.Messaging.MessageQueue.Path" /> プロパティが設定されていません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2970">The <see cref="P:System.Messaging.MessageQueue.Path" /> property has not been set.</span></span>  
  
<span data-ttu-id="f3a8c-2971">- または -</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2971">-or-</span></span> 
<span data-ttu-id="f3a8c-2972">メッセージ キューのメソッドにアクセスしたときにエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2972">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.DefaultPropertiesToSend" />
        <altmember cref="T:System.Messaging.Message" />
        <altmember cref="P:System.Messaging.MessageQueue.Path" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="Send">
      <MemberSignature Language="C#" Value="public void Send (object obj, System.Messaging.MessageQueueTransaction transaction);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void Send(object obj, class System.Messaging.MessageQueueTransaction transaction) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Send(System.Object,System.Messaging.MessageQueueTransaction)" />
      <MemberSignature Language="VB.NET" Value="Public Sub Send (obj As Object, transaction As MessageQueueTransaction)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void Send(System::Object ^ obj, System::Messaging::MessageQueueTransaction ^ transaction);" />
      <MemberSignature Language="F#" Value="member this.Send : obj * System.Messaging.MessageQueueTransaction -&gt; unit" Usage="messageQueue.Send (obj, transaction)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="obj" Type="System.Object" />
        <Parameter Name="transaction" Type="System.Messaging.MessageQueueTransaction" />
      </Parameters>
      <Docs>
        <param name="obj"><span data-ttu-id="f3a8c-2973">キューに送信するオブジェクト。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2973">The object to send to the queue.</span></span></param>
        <param name="transaction"><span data-ttu-id="f3a8c-2974"><see cref="T:System.Messaging.MessageQueueTransaction" /> オブジェクト。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2974">The <see cref="T:System.Messaging.MessageQueueTransaction" /> object.</span></span></param>
        <summary><span data-ttu-id="f3a8c-2975">この <see cref="T:System.Messaging.MessageQueue" /> で参照されるトランザクション キューにオブジェクトを送信します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2975">Sends an object to the transactional queue referenced by this <see cref="T:System.Messaging.MessageQueue" />.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-2976">このオーバーロードを使用して、`transaction` パラメーターで定義された内部トランザクションコンテキストを使用して、<xref:System.Messaging.MessageQueue>によって参照されるトランザクションキューに `obj` パラメーターを含むメッセージを送信します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2976">Use this overload to send a message that contains the `obj` parameter to the transactional queue referenced by the <xref:System.Messaging.MessageQueue>, using an internal transaction context defined by the `transaction` parameter.</span></span> <span data-ttu-id="f3a8c-2977">キューに送信するオブジェクトは、<xref:System.Messaging.Message> または任意のマネージオブジェクトにすることができます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2977">The object you send to the queue can be a <xref:System.Messaging.Message> or any managed object.</span></span> <span data-ttu-id="f3a8c-2978"><xref:System.Messaging.Message>以外のオブジェクトを送信すると、オブジェクトがシリアル化され、メッセージの本文に挿入されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2978">If you send any object other than a <xref:System.Messaging.Message>, the object is serialized and inserted into the body of the message.</span></span>  
  
 <span data-ttu-id="f3a8c-2979">このオーバーロードを使用して非トランザクションキューにメッセージを送信すると、例外をスローすることなく、メッセージが配信不能キューに送信される可能性があります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2979">If you use this overload to send a message to a non-transactional queue, the message might be sent to the dead-letter queue without throwing an exception.</span></span>  
  
 <span data-ttu-id="f3a8c-2980"><xref:System.Messaging.MessageQueue.Send%28System.Object%29>を呼び出す前に <xref:System.Messaging.MessageQueue.Formatter%2A> プロパティを設定しなかった場合、フォーマッタは既定で <xref:System.Messaging.XmlMessageFormatter>に設定されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2980">If you do not set the <xref:System.Messaging.MessageQueue.Formatter%2A> property before calling <xref:System.Messaging.MessageQueue.Send%28System.Object%29>, the formatter defaults to the <xref:System.Messaging.XmlMessageFormatter>.</span></span>  
  
 <span data-ttu-id="f3a8c-2981"><xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> プロパティは、<xref:System.Messaging.Message>以外のすべてのオブジェクトに適用されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2981">The <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> property applies to any object other than a <xref:System.Messaging.Message>.</span></span> <span data-ttu-id="f3a8c-2982">たとえば、<xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> メンバーを使用してラベルや優先順位を指定した場合、これらの値は、アプリケーションからキューに送信されるときに <xref:System.Messaging.Message> 型ではないオブジェクトを含むすべてのメッセージに適用されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2982">If you specify, for example, a label or a priority using the <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> member, these values apply to any message that contains an object that is not of type <xref:System.Messaging.Message> when your application sends it to the queue.</span></span> <span data-ttu-id="f3a8c-2983"><xref:System.Messaging.Message>を送信する場合、<xref:System.Messaging.Message> に設定されているプロパティ値が <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> より優先され、メッセージの <xref:System.Messaging.Message.Formatter%2A?displayProperty=nameWithType> プロパティはキューの <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> プロパティよりも優先されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2983">When sending a <xref:System.Messaging.Message>, the property values set for the <xref:System.Messaging.Message> take precedence over <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> and the message's <xref:System.Messaging.Message.Formatter%2A?displayProperty=nameWithType> property takes precedence over the queue's <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> property.</span></span>  
  
 <span data-ttu-id="f3a8c-2984"><xref:System.Messaging.MessageQueueTransaction> はスレッドアパートメントに対応しているため、アパートメント状態が `STA`場合は、複数のスレッドでトランザクションを使用することはできません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2984"><xref:System.Messaging.MessageQueueTransaction> is threading apartment aware, so if your apartment state is `STA`, you cannot use the transaction in multiple threads.</span></span> <span data-ttu-id="f3a8c-2985">Visual Basic は、メインスレッドの状態を `STA`に設定するため、<xref:System.MTAThreadAttribute> を `Main` サブルーチンに適用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2985">Visual Basic sets the state of the main thread to `STA`, so you must apply the <xref:System.MTAThreadAttribute> in the `Main` subroutine.</span></span> <span data-ttu-id="f3a8c-2986">適用しない場合、別のスレッドを使用してトランザクション メッセージを送信すると、<xref:System.Messaging.MessageQueueException> 例外がスローされます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2986">Otherwise, sending a transactional message using another thread throws a <xref:System.Messaging.MessageQueueException> exception.</span></span> <span data-ttu-id="f3a8c-2987">次のフラグメントを使用して、<xref:System.MTAThreadAttribute> を適用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2987">You apply the <xref:System.MTAThreadAttribute> by using the following fragment.</span></span>  
  
```vb  
<System.MTAThreadAttribute>  
 public sub Main()  
```  
  
 <span data-ttu-id="f3a8c-2988">次の表に、この方法をさまざまなワークグループモードで使用できるかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2988">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-2989">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2989">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-2990">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2990">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-2991">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2991">Local computer</span></span>|<span data-ttu-id="f3a8c-2992">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2992">Yes</span></span>|  
|<span data-ttu-id="f3a8c-2993">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2993">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-2994">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2994">Yes</span></span>|  
|<span data-ttu-id="f3a8c-2995">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2995">Remote computer</span></span>|<span data-ttu-id="f3a8c-2996">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2996">No</span></span>|  
|<span data-ttu-id="f3a8c-2997">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2997">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-2998">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2998">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-2999">次のコード例では、トランザクションキューに文字列を送信し、そのキューからメッセージを受信します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-2999">The following code example sends a string to a transactional queue and then receives a message from that queue.</span></span>  
  
 [!code-cpp[MessageQueue.Send_ObjectTransaction#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Send_ObjectTransaction/CPP/mqsend_objtransaction.cpp#1)]
 [!code-csharp[MessageQueue.Send_ObjectTransaction#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Send_ObjectTransaction/CS/mqsend_objtransaction.cs#1)]
 [!code-vb[MessageQueue.Send_ObjectTransaction#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Send_ObjectTransaction/VB/mqsend_objtransaction.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="f3a8c-3000"><paramref name="transaction" /> パラメーターが <see langword="null" /> です。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3000">The <paramref name="transaction" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="f3a8c-3001"><see cref="P:System.Messaging.MessageQueue.Path" /> プロパティが設定されていません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3001">The <see cref="P:System.Messaging.MessageQueue.Path" /> property has not been set.</span></span>  
  
<span data-ttu-id="f3a8c-3002">- または -</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3002">-or-</span></span> 
<span data-ttu-id="f3a8c-3003">メッセージ キュー アプリケーションが、トランザクションの使用が正しくないことを示しました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3003">The Message Queuing application indicated an incorrect transaction use.</span></span>  
  
<span data-ttu-id="f3a8c-3004">- または -</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3004">-or-</span></span> 
<span data-ttu-id="f3a8c-3005">メッセージ キューのメソッドにアクセスしたときにエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3005">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.DefaultPropertiesToSend" />
        <altmember cref="T:System.Messaging.Message" />
        <altmember cref="T:System.Messaging.MessageQueueTransaction" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="Send">
      <MemberSignature Language="C#" Value="public void Send (object obj, System.Messaging.MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void Send(object obj, valuetype System.Messaging.MessageQueueTransactionType transactionType) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Send(System.Object,System.Messaging.MessageQueueTransactionType)" />
      <MemberSignature Language="VB.NET" Value="Public Sub Send (obj As Object, transactionType As MessageQueueTransactionType)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void Send(System::Object ^ obj, System::Messaging::MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="F#" Value="member this.Send : obj * System.Messaging.MessageQueueTransactionType -&gt; unit" Usage="messageQueue.Send (obj, transactionType)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="obj" Type="System.Object" />
        <Parameter Name="transactionType" Type="System.Messaging.MessageQueueTransactionType" />
      </Parameters>
      <Docs>
        <param name="obj"><span data-ttu-id="f3a8c-3006">キューに送信するオブジェクト。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3006">The object to send to the queue.</span></span></param>
        <param name="transactionType"><span data-ttu-id="f3a8c-3007">メッセージと関連付けるトランザクション コンテキストの種類を示す、<see cref="T:System.Messaging.MessageQueueTransactionType" /> 値の 1 つ。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3007">One of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> values, describing the type of transaction context to associate with the message.</span></span></param>
        <summary><span data-ttu-id="f3a8c-3008">この <see cref="T:System.Messaging.MessageQueue" /> で参照されるキューにオブジェクトを送信します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3008">Sends an object to the queue referenced by this <see cref="T:System.Messaging.MessageQueue" />.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-3009">このオーバーロードを使用して、`transactionType` パラメーターで定義されているトランザクションコンテキストを使用し、<xref:System.Messaging.MessageQueue>によって参照されるキューに `obj` パラメーターを含むメッセージを送信します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3009">Use this overload to send a message that contains the `obj` parameter to the queue referenced by the <xref:System.Messaging.MessageQueue>, using a transaction context defined by the `transactionType` parameter.</span></span> <span data-ttu-id="f3a8c-3010">メッセージの送信に使用するスレッドに既に外部トランザクションコンテキストがアタッチされている場合は、`transactionType` パラメーターに `Automatic` を指定します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3010">Specify `Automatic` for the `transactionType` parameter if there is already an external transaction context attached to the thread that you want to use to send the message.</span></span> <span data-ttu-id="f3a8c-3011">メッセージを1つの内部トランザクションとして送信する場合は、`Single` を指定します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3011">Specify `Single` if you want to send the message as a single internal transaction.</span></span> <span data-ttu-id="f3a8c-3012">トランザクションメッセージを非トランザクションスレッドに送信する場合は、`None` を指定できます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3012">You can specify `None` if you want to send a transactional message to a non-transactional thread.</span></span>  
  
 <span data-ttu-id="f3a8c-3013">キューに送信するオブジェクトは、<xref:System.Messaging.Message> または任意のマネージオブジェクトにすることができます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3013">The object you send to the queue can be a <xref:System.Messaging.Message> or any managed object.</span></span> <span data-ttu-id="f3a8c-3014"><xref:System.Messaging.Message>以外のオブジェクトを送信すると、オブジェクトがシリアル化され、メッセージの本文に挿入されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3014">If you send any object other than a <xref:System.Messaging.Message>, the object is serialized and inserted into the body of the message.</span></span>  
  
 <span data-ttu-id="f3a8c-3015"><xref:System.Messaging.MessageQueue.Send%28System.Object%29>を呼び出す前に <xref:System.Messaging.MessageQueue.Formatter%2A> プロパティを設定しなかった場合、フォーマッタは既定で <xref:System.Messaging.XmlMessageFormatter>に設定されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3015">If you do not set the <xref:System.Messaging.MessageQueue.Formatter%2A> property before calling <xref:System.Messaging.MessageQueue.Send%28System.Object%29>, the formatter defaults to the <xref:System.Messaging.XmlMessageFormatter>.</span></span>  
  
 <span data-ttu-id="f3a8c-3016"><xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> プロパティは、<xref:System.Messaging.Message>以外のすべてのオブジェクトに適用されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3016">The <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> property applies to any object other than a <xref:System.Messaging.Message>.</span></span> <span data-ttu-id="f3a8c-3017">たとえば、<xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> メンバーを使用してラベルや優先順位を指定した場合、これらの値は、アプリケーションからキューに送信されるときに <xref:System.Messaging.Message> 型ではないオブジェクトを含むすべてのメッセージに適用されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3017">If you specify, for example, a label or a priority using the <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> member, these values apply to any message that contains an object that is not of type <xref:System.Messaging.Message> when your application sends it to the queue.</span></span> <span data-ttu-id="f3a8c-3018"><xref:System.Messaging.Message>を送信する場合、<xref:System.Messaging.Message> に設定されているプロパティ値が <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> より優先され、メッセージの <xref:System.Messaging.Message.Formatter%2A?displayProperty=nameWithType> プロパティはキューの <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> プロパティよりも優先されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3018">When sending a <xref:System.Messaging.Message>, the property values set for the <xref:System.Messaging.Message> take precedence over <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> and the message's <xref:System.Messaging.Message.Formatter%2A?displayProperty=nameWithType> property takes precedence over the queue's <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> property.</span></span>  
  
 <span data-ttu-id="f3a8c-3019">次の表に、この方法をさまざまなワークグループモードで使用できるかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3019">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-3020">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3020">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-3021">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3021">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-3022">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3022">Local computer</span></span>|<span data-ttu-id="f3a8c-3023">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3023">Yes</span></span>|  
|<span data-ttu-id="f3a8c-3024">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3024">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-3025">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3025">Yes</span></span>|  
|<span data-ttu-id="f3a8c-3026">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3026">Remote computer</span></span>|<span data-ttu-id="f3a8c-3027">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3027">No</span></span>|  
|<span data-ttu-id="f3a8c-3028">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3028">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-3029">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3029">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-3030">次のコード例は、<xref:System.Messaging.MessageQueue.Send%28System.Object%2CSystem.Messaging.MessageQueueTransactionType%29> の使用方法を示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3030">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.Send%28System.Object%2CSystem.Messaging.MessageQueueTransactionType%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#2](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#2)]
 [!code-csharp[MessageQueue2#2](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#2)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException"><span data-ttu-id="f3a8c-3031"><paramref name="transactionType" /> パラメーターが、<see cref="T:System.Messaging.MessageQueueTransactionType" /> メンバーの 1 つではありません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3031">The <paramref name="transactionType" /> parameter is not one of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> members.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="f3a8c-3032"><see cref="P:System.Messaging.MessageQueue.Path" /> プロパティが設定されていません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3032">The <see cref="P:System.Messaging.MessageQueue.Path" /> property has not been set.</span></span>  
  
<span data-ttu-id="f3a8c-3033">- または -</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3033">-or-</span></span> 
<span data-ttu-id="f3a8c-3034">メッセージ キューのメソッドにアクセスしたときにエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3034">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="T:System.Messaging.MessageQueueTransactionType" />
        <altmember cref="P:System.Messaging.MessageQueue.DefaultPropertiesToSend" />
        <altmember cref="T:System.Messaging.Message" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="Send">
      <MemberSignature Language="C#" Value="public void Send (object obj, string label);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void Send(object obj, string label) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Send(System.Object,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Sub Send (obj As Object, label As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void Send(System::Object ^ obj, System::String ^ label);" />
      <MemberSignature Language="F#" Value="member this.Send : obj * string -&gt; unit" Usage="messageQueue.Send (obj, label)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="obj" Type="System.Object" />
        <Parameter Name="label" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="obj"><span data-ttu-id="f3a8c-3035">キューに送信するオブジェクト。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3035">The object to send to the queue.</span></span></param>
        <param name="label"><span data-ttu-id="f3a8c-3036">メッセージのラベル。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3036">The label of the message.</span></span></param>
        <summary><span data-ttu-id="f3a8c-3037">この <see cref="T:System.Messaging.MessageQueue" /> で参照される非トランザクション キューにオブジェクトを送信し、メッセージのラベルを指定します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3037">Sends an object to the non-transactional queue referenced by this <see cref="T:System.Messaging.MessageQueue" /> and specifies a label for the message.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-3038">このオーバーロードを使用して、<xref:System.Messaging.MessageQueue>によって参照されるキューに `obj` パラメーターを含むメッセージを送信します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3038">Use this overload to send a message that contains the `obj` parameter to the queue referenced by the <xref:System.Messaging.MessageQueue>.</span></span> <span data-ttu-id="f3a8c-3039">このオーバーロードを使用すると、メッセージを識別する文字列ラベルを指定できます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3039">With this overload, you can specify the string label that identifies the message.</span></span> <span data-ttu-id="f3a8c-3040">キューに送信するオブジェクトには、<xref:System.Messaging.Message>、構造体、データオブジェクト、または任意のマネージオブジェクトを指定できます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3040">The object you send to the queue can be a <xref:System.Messaging.Message>, a structure, a data object, or any managed object.</span></span> <span data-ttu-id="f3a8c-3041"><xref:System.Messaging.Message>以外のオブジェクトを送信すると、オブジェクトがシリアル化され、メッセージの本文に挿入されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3041">If you send any object other than a <xref:System.Messaging.Message>, the object is serialized and inserted into the body of the message.</span></span>  
  
 <span data-ttu-id="f3a8c-3042">メッセージラベルは、メッセージキューのラベルとは異なりますが、どちらもアプリケーションに依存し、メッセージキューに対しては意味を継承しません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3042">The message label is distinct from the message queue label, but both are application-dependent and have no inherit meaning to Message Queuing.</span></span>  
  
 <span data-ttu-id="f3a8c-3043">このオーバーロードを使用してトランザクションキューにメッセージを送信すると、メッセージは配信不能キューに送信されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3043">If you use this overload to send a message to a transactional queue, the message will be sent to the dead-letter queue.</span></span> <span data-ttu-id="f3a8c-3044">メッセージを他のメッセージを含むトランザクションの一部にする場合は、パラメーターとして <xref:System.Messaging.MessageQueueTransaction> または <xref:System.Messaging.MessageQueueTransactionType> を受け取るオーバーロードを使用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3044">If you want the message to be part of a transaction that contains other messages, use an overload that takes a <xref:System.Messaging.MessageQueueTransaction> or <xref:System.Messaging.MessageQueueTransactionType> as a parameter.</span></span>  
  
 <span data-ttu-id="f3a8c-3045">メッセージを送信する前に、この <xref:System.Messaging.MessageQueue> インスタンスの <xref:System.Messaging.MessageQueue.Path%2A> プロパティを指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3045">The <xref:System.Messaging.MessageQueue.Path%2A> property for this <xref:System.Messaging.MessageQueue> instance must be specified before you send the message.</span></span> <span data-ttu-id="f3a8c-3046"><xref:System.Messaging.MessageQueue.Send%28System.Object%29>を呼び出す前に <xref:System.Messaging.MessageQueue.Formatter%2A> プロパティを設定しなかった場合、フォーマッタは既定で <xref:System.Messaging.XmlMessageFormatter>に設定されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3046">If you do not set the <xref:System.Messaging.MessageQueue.Formatter%2A> property before calling <xref:System.Messaging.MessageQueue.Send%28System.Object%29>, the formatter defaults to the <xref:System.Messaging.XmlMessageFormatter>.</span></span>  
  
 <span data-ttu-id="f3a8c-3047"><xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> プロパティは、<xref:System.Messaging.Message>以外のすべてのオブジェクトに適用されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3047">The <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> property applies to any object other than a <xref:System.Messaging.Message>.</span></span> <span data-ttu-id="f3a8c-3048">たとえば、<xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> メンバーを使用してラベルや優先順位を指定した場合、これらの値は、アプリケーションからキューに送信されるときに <xref:System.Messaging.Message> 型ではないオブジェクトを含むすべてのメッセージに適用されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3048">If you specify, for example, a label or a priority using the <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> member, these values apply to any message that contains an object that is not of type <xref:System.Messaging.Message> when your application sends it to the queue.</span></span> <span data-ttu-id="f3a8c-3049"><xref:System.Messaging.Message>を送信する場合、<xref:System.Messaging.Message> に設定されているプロパティ値が <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> より優先され、メッセージの <xref:System.Messaging.Message.Formatter%2A?displayProperty=nameWithType> プロパティはキューの <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> プロパティよりも優先されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3049">When sending a <xref:System.Messaging.Message>, the property values set for the <xref:System.Messaging.Message> take precedence over <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> and the message's <xref:System.Messaging.Message.Formatter%2A?displayProperty=nameWithType> property takes precedence over the queue's <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> property.</span></span>  
  
 <span data-ttu-id="f3a8c-3050">次の表に、この方法をさまざまなワークグループモードで使用できるかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3050">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-3051">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3051">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-3052">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3052">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-3053">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3053">Local computer</span></span>|<span data-ttu-id="f3a8c-3054">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3054">Yes</span></span>|  
|<span data-ttu-id="f3a8c-3055">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3055">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-3056">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3056">Yes</span></span>|  
|<span data-ttu-id="f3a8c-3057">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3057">Remote computer</span></span>|<span data-ttu-id="f3a8c-3058">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3058">No</span></span>|  
|<span data-ttu-id="f3a8c-3059">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3059">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-3060">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3060">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-3061">次のコード例は、<xref:System.Messaging.MessageQueue.Send%28System.Object%2CSystem.String%29> の使用方法を示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3061">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.Send%28System.Object%2CSystem.String%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#1)]
 [!code-csharp[MessageQueue2#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="f3a8c-3062"><paramref name="label" /> パラメーターが <see langword="null" /> です。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3062">The <paramref name="label" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="f3a8c-3063"><see cref="P:System.Messaging.MessageQueue.Path" /> プロパティが設定されていません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3063">The <see cref="P:System.Messaging.MessageQueue.Path" /> property has not been set.</span></span>  
  
<span data-ttu-id="f3a8c-3064">- または -</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3064">-or-</span></span> 
<span data-ttu-id="f3a8c-3065">メッセージ キューのメソッドにアクセスしたときにエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3065">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.DefaultPropertiesToSend" />
        <altmember cref="T:System.Messaging.Message" />
        <altmember cref="P:System.Messaging.MessageQueue.Label" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="Send">
      <MemberSignature Language="C#" Value="public void Send (object obj, string label, System.Messaging.MessageQueueTransaction transaction);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void Send(object obj, string label, class System.Messaging.MessageQueueTransaction transaction) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Send(System.Object,System.String,System.Messaging.MessageQueueTransaction)" />
      <MemberSignature Language="VB.NET" Value="Public Sub Send (obj As Object, label As String, transaction As MessageQueueTransaction)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void Send(System::Object ^ obj, System::String ^ label, System::Messaging::MessageQueueTransaction ^ transaction);" />
      <MemberSignature Language="F#" Value="member this.Send : obj * string * System.Messaging.MessageQueueTransaction -&gt; unit" Usage="messageQueue.Send (obj, label, transaction)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="obj" Type="System.Object" />
        <Parameter Name="label" Type="System.String" />
        <Parameter Name="transaction" Type="System.Messaging.MessageQueueTransaction" />
      </Parameters>
      <Docs>
        <param name="obj"><span data-ttu-id="f3a8c-3066">キューに送信するオブジェクト。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3066">The object to send to the queue.</span></span></param>
        <param name="label"><span data-ttu-id="f3a8c-3067">メッセージのラベル。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3067">The label of the message.</span></span></param>
        <param name="transaction"><span data-ttu-id="f3a8c-3068"><see cref="T:System.Messaging.MessageQueueTransaction" /> オブジェクト。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3068">The <see cref="T:System.Messaging.MessageQueueTransaction" /> object.</span></span></param>
        <summary><span data-ttu-id="f3a8c-3069">この <see cref="T:System.Messaging.MessageQueue" /> で参照されるトランザクション キューにオブジェクトを送信し、メッセージのラベルを指定します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3069">Sends an object to the transactional queue referenced by this <see cref="T:System.Messaging.MessageQueue" /> and specifies a label for the message.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-3070">このオーバーロードを使用して、`transaction` パラメーターで定義された内部トランザクションコンテキストを使用して、<xref:System.Messaging.MessageQueue>によって参照されるトランザクションキューに `obj` パラメーターを含むメッセージを送信します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3070">Use this overload to send a message that contains the `obj` parameter to the transactional queue referenced by the <xref:System.Messaging.MessageQueue>, using an internal transaction context defined by the `transaction` parameter.</span></span> <span data-ttu-id="f3a8c-3071">このオーバーロードを使用すると、メッセージを識別する文字列ラベルを指定できます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3071">With this overload, you can specify the string label that identifies the message.</span></span> <span data-ttu-id="f3a8c-3072">キューに送信するオブジェクトには、<xref:System.Messaging.Message>、構造体、データオブジェクト、または任意のマネージオブジェクトを指定できます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3072">The object you send to the queue can be a <xref:System.Messaging.Message>, a structure, a data object, or any managed object.</span></span> <span data-ttu-id="f3a8c-3073"><xref:System.Messaging.Message>以外のオブジェクトを送信すると、オブジェクトがシリアル化され、メッセージの本文に挿入されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3073">If you send any object other than a <xref:System.Messaging.Message>, the object is serialized and inserted into the body of the message.</span></span>  
  
 <span data-ttu-id="f3a8c-3074">メッセージラベルは、メッセージキューのラベルとは異なりますが、どちらもアプリケーションに依存し、メッセージキューに対しては意味を継承しません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3074">The message label is distinct from the message queue label, but both are application-dependent and have no inherit meaning to Message Queuing.</span></span>  
  
 <span data-ttu-id="f3a8c-3075">このオーバーロードを使用して非トランザクションキューにメッセージを送信すると、例外をスローすることなく、メッセージが配信不能キューに送信される可能性があります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3075">If you use this overload to send a message to a non-transactional queue, the message might be sent to the dead-letter queue without throwing an exception.</span></span>  
  
 <span data-ttu-id="f3a8c-3076"><xref:System.Messaging.MessageQueue.Send%28System.Object%29>を呼び出す前に <xref:System.Messaging.MessageQueue.Formatter%2A> プロパティを設定しなかった場合、フォーマッタは既定で <xref:System.Messaging.XmlMessageFormatter>に設定されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3076">If you do not set the <xref:System.Messaging.MessageQueue.Formatter%2A> property before calling <xref:System.Messaging.MessageQueue.Send%28System.Object%29>, the formatter defaults to the <xref:System.Messaging.XmlMessageFormatter>.</span></span>  
  
 <span data-ttu-id="f3a8c-3077"><xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> プロパティは、<xref:System.Messaging.Message>以外のすべてのオブジェクトに適用されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3077">The <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> property applies to any object other than a <xref:System.Messaging.Message>.</span></span> <span data-ttu-id="f3a8c-3078">たとえば、<xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> メンバーを使用してラベルや優先順位を指定した場合、これらの値は、アプリケーションからキューに送信されるときに <xref:System.Messaging.Message> 型ではないオブジェクトを含むすべてのメッセージに適用されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3078">If you specify, for example, a label or a priority using the <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> member, these values apply to any message that contains an object that is not of type <xref:System.Messaging.Message> when your application sends it to the queue.</span></span> <span data-ttu-id="f3a8c-3079"><xref:System.Messaging.Message>を送信する場合、<xref:System.Messaging.Message> に設定されているプロパティ値が <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> より優先され、メッセージの <xref:System.Messaging.Message.Formatter%2A?displayProperty=nameWithType> プロパティはキューの <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> プロパティよりも優先されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3079">When sending a <xref:System.Messaging.Message>, the property values set for the <xref:System.Messaging.Message> take precedence over <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> and the message's <xref:System.Messaging.Message.Formatter%2A?displayProperty=nameWithType> property takes precedence over the queue's <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> property</span></span>  
  
 <span data-ttu-id="f3a8c-3080"><xref:System.Messaging.MessageQueueTransaction> はスレッドアパートメントに対応しているため、アパートメント状態が `STA`場合は、複数のスレッドでトランザクションを使用することはできません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3080"><xref:System.Messaging.MessageQueueTransaction> is threading apartment aware, so if your apartment state is `STA`, you cannot use the transaction in multiple threads.</span></span> <span data-ttu-id="f3a8c-3081">Visual Basic は、メインスレッドの状態を `STA`に設定するため、<xref:System.MTAThreadAttribute> を `Main` サブルーチンに適用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3081">Visual Basic sets the state of the main thread to `STA`, so you must apply the <xref:System.MTAThreadAttribute> in the `Main` subroutine.</span></span> <span data-ttu-id="f3a8c-3082">適用しない場合、別のスレッドを使用してトランザクション メッセージを送信すると、<xref:System.Messaging.MessageQueueException> 例外がスローされます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3082">Otherwise, sending a transactional message using another thread throws a <xref:System.Messaging.MessageQueueException> exception.</span></span> <span data-ttu-id="f3a8c-3083">次のフラグメントを使用して、<xref:System.MTAThreadAttribute> を適用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3083">You apply the <xref:System.MTAThreadAttribute> by using the following fragment.</span></span>  
  
```vb  
<System.MTAThreadAttribute>  
 public sub Main()  
```  
  
 <span data-ttu-id="f3a8c-3084">次の表に、この方法をさまざまなワークグループモードで使用できるかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3084">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-3085">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3085">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-3086">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3086">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-3087">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3087">Local computer</span></span>|<span data-ttu-id="f3a8c-3088">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3088">Yes</span></span>|  
|<span data-ttu-id="f3a8c-3089">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3089">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-3090">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3090">Yes</span></span>|  
|<span data-ttu-id="f3a8c-3091">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3091">Remote computer</span></span>|<span data-ttu-id="f3a8c-3092">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3092">No</span></span>|  
|<span data-ttu-id="f3a8c-3093">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3093">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-3094">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3094">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-3095">次のコード例は、<xref:System.Messaging.MessageQueue.Send%28System.Object%2CSystem.String%2CSystem.Messaging.MessageQueueTransaction%29> の使用方法を示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3095">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.Send%28System.Object%2CSystem.String%2CSystem.Messaging.MessageQueueTransaction%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#4](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#4)]
 [!code-csharp[MessageQueue2#4](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#4)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="f3a8c-3096"><paramref name="label" /> パラメーターが <see langword="null" /> です。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3096">The <paramref name="label" /> parameter is <see langword="null" />.</span></span>  
  
<span data-ttu-id="f3a8c-3097">- または -</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3097">-or-</span></span> 
<span data-ttu-id="f3a8c-3098"><paramref name="transaction" /> パラメーターが <see langword="null" /> です。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3098">The <paramref name="transaction" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="f3a8c-3099"><see cref="P:System.Messaging.MessageQueue.Path" /> プロパティが設定されていません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3099">The <see cref="P:System.Messaging.MessageQueue.Path" /> property has not been set.</span></span>  
  
<span data-ttu-id="f3a8c-3100">- または -</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3100">-or-</span></span> 
<span data-ttu-id="f3a8c-3101">メッセージ キュー アプリケーションが、トランザクションの使用方法が間違っていることを示しました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3101">The Message Queuing application indicated an incorrect transaction usage.</span></span>  
  
<span data-ttu-id="f3a8c-3102">- または -</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3102">-or-</span></span> 
<span data-ttu-id="f3a8c-3103">メッセージ キューのメソッドにアクセスしたときにエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3103">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.DefaultPropertiesToSend" />
        <altmember cref="T:System.Messaging.Message" />
        <altmember cref="T:System.Messaging.MessageQueueTransaction" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="P:System.Messaging.MessageQueue.Label" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="Send">
      <MemberSignature Language="C#" Value="public void Send (object obj, string label, System.Messaging.MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void Send(object obj, string label, valuetype System.Messaging.MessageQueueTransactionType transactionType) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Send(System.Object,System.String,System.Messaging.MessageQueueTransactionType)" />
      <MemberSignature Language="VB.NET" Value="Public Sub Send (obj As Object, label As String, transactionType As MessageQueueTransactionType)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void Send(System::Object ^ obj, System::String ^ label, System::Messaging::MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="F#" Value="member this.Send : obj * string * System.Messaging.MessageQueueTransactionType -&gt; unit" Usage="messageQueue.Send (obj, label, transactionType)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="obj" Type="System.Object" />
        <Parameter Name="label" Type="System.String" />
        <Parameter Name="transactionType" Type="System.Messaging.MessageQueueTransactionType" />
      </Parameters>
      <Docs>
        <param name="obj"><span data-ttu-id="f3a8c-3104">キューに送信するオブジェクト。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3104">The object to send to the queue.</span></span></param>
        <param name="label"><span data-ttu-id="f3a8c-3105">メッセージのラベル。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3105">The label of the message.</span></span></param>
        <param name="transactionType"><span data-ttu-id="f3a8c-3106">メッセージと関連付けるトランザクション コンテキストの種類を示す、<see cref="T:System.Messaging.MessageQueueTransactionType" /> 値の 1 つ。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3106">One of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> values, describing the type of transaction context to associate with the message.</span></span></param>
        <summary><span data-ttu-id="f3a8c-3107">この <see cref="T:System.Messaging.MessageQueue" /> で参照されるキューにオブジェクトを送信し、メッセージのラベルを指定します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3107">Sends an object to the queue referenced by this <see cref="T:System.Messaging.MessageQueue" /> and specifies a label for the message.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-3108">このオーバーロードを使用して、`transactionType` パラメーターで定義されているトランザクションコンテキストを使用し、<xref:System.Messaging.MessageQueue>によって参照されるキューに `obj` パラメーターを含むメッセージを送信します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3108">Use this overload to send a message that contains the `obj` parameter to the queue referenced by the <xref:System.Messaging.MessageQueue>, using a transaction context defined by the `transactionType` parameter.</span></span> <span data-ttu-id="f3a8c-3109">メッセージの送信に使用するスレッドに既に外部トランザクションコンテキストがアタッチされている場合は、`transactionType` パラメーターに `Automatic` を指定します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3109">Specify `Automatic` for the `transactionType` parameter if there is already an external transaction context attached to the thread that you want to use to send the message.</span></span> <span data-ttu-id="f3a8c-3110">メッセージを1つの内部トランザクションとして送信する場合は、`Single` を指定します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3110">Specify `Single` if you want to send the message as a single internal transaction.</span></span> <span data-ttu-id="f3a8c-3111">トランザクションメッセージを非トランザクションスレッドに送信する場合は、`None` を指定できます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3111">You can specify `None` if you want to send a transactional message to a non-transactional thread.</span></span>  
  
 <span data-ttu-id="f3a8c-3112">キューに送信するオブジェクトは、<xref:System.Messaging.Message> または任意のマネージオブジェクトにすることができます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3112">The object you send to the queue can be a <xref:System.Messaging.Message> or any managed object.</span></span> <span data-ttu-id="f3a8c-3113"><xref:System.Messaging.Message>以外のオブジェクトを送信すると、オブジェクトがシリアル化され、メッセージの本文に挿入されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3113">If you send any object other than a <xref:System.Messaging.Message>, the object is serialized and inserted into the body of the message.</span></span> <span data-ttu-id="f3a8c-3114">このオーバーロードを使用すると、メッセージを識別する文字列ラベルを指定できます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3114">With this overload, you can specify the string label that identifies the message.</span></span>  
  
 <span data-ttu-id="f3a8c-3115">メッセージラベルは、メッセージキューのラベルとは異なりますが、どちらもアプリケーションに依存し、メッセージキューに対しては意味を継承しません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3115">The message label is distinct from the message queue label, but both are application-dependent and have no inherit meaning to Message Queuing.</span></span>  
  
 <span data-ttu-id="f3a8c-3116"><xref:System.Messaging.MessageQueue.Send%28System.Object%29>を呼び出す前に <xref:System.Messaging.MessageQueue.Formatter%2A> プロパティを設定しなかった場合、フォーマッタは既定で <xref:System.Messaging.XmlMessageFormatter>に設定されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3116">If you do not set the <xref:System.Messaging.MessageQueue.Formatter%2A> property before calling <xref:System.Messaging.MessageQueue.Send%28System.Object%29>, the formatter defaults to the <xref:System.Messaging.XmlMessageFormatter>.</span></span>  
  
 <span data-ttu-id="f3a8c-3117"><xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> プロパティは、<xref:System.Messaging.Message>以外のすべてのオブジェクトに適用されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3117">The <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> property applies to any object other than a <xref:System.Messaging.Message>.</span></span> <span data-ttu-id="f3a8c-3118">たとえば、<xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> メンバーを使用してラベルや優先順位を指定した場合、これらの値は、アプリケーションからキューに送信されるときに <xref:System.Messaging.Message> 型ではないオブジェクトを含むすべてのメッセージに適用されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3118">If you specify, for example, a label or a priority using the <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> member, these values apply to any message that contains an object that is not of type <xref:System.Messaging.Message> when your application sends it to the queue.</span></span> <span data-ttu-id="f3a8c-3119"><xref:System.Messaging.Message>を送信する場合、<xref:System.Messaging.Message> に設定されているプロパティ値は <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A>より優先され、メッセージの <xref:System.Messaging.Message.Formatter%2A?displayProperty=nameWithType> プロパティはキューの <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> プロパティよりも優先されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3119">When sending a <xref:System.Messaging.Message>, the property values set for the <xref:System.Messaging.Message> take precedence over <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A>, and the message's <xref:System.Messaging.Message.Formatter%2A?displayProperty=nameWithType> property takes precedence over the queue's <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> property.</span></span>  
  
 <span data-ttu-id="f3a8c-3120">次の表に、この方法をさまざまなワークグループモードで使用できるかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3120">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-3121">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3121">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-3122">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3122">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-3123">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3123">Local computer</span></span>|<span data-ttu-id="f3a8c-3124">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3124">Yes</span></span>|  
|<span data-ttu-id="f3a8c-3125">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3125">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-3126">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3126">Yes</span></span>|  
|<span data-ttu-id="f3a8c-3127">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3127">Remote computer</span></span>|<span data-ttu-id="f3a8c-3128">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3128">No</span></span>|  
|<span data-ttu-id="f3a8c-3129">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3129">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-3130">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3130">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-3131">次のコード例は、<xref:System.Messaging.MessageQueue.Send%28System.Object%2CSystem.String%2CSystem.Messaging.MessageQueueTransactionType%29> の使用方法を示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3131">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.Send%28System.Object%2CSystem.String%2CSystem.Messaging.MessageQueueTransactionType%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#3](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#3)]
 [!code-csharp[MessageQueue2#3](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#3)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="f3a8c-3132"><paramref name="label" /> パラメーターが <see langword="null" /> です。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3132">The <paramref name="label" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueTransaction"><span data-ttu-id="f3a8c-3133">メッセージ キュー アプリケーションが、トランザクションの使用方法が間違っていることを示しました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3133">The Message Queuing application indicated an incorrect transaction usage.</span></span></exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException"><span data-ttu-id="f3a8c-3134"><paramref name="transactionType" /> パラメーターが、<see cref="T:System.Messaging.MessageQueueTransactionType" /> メンバーの 1 つではありません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3134">The <paramref name="transactionType" /> parameter is not one of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> members.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="f3a8c-3135"><see cref="P:System.Messaging.MessageQueue.Path" /> プロパティが設定されていません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3135">The <see cref="P:System.Messaging.MessageQueue.Path" /> property has not been set.</span></span>  
  
<span data-ttu-id="f3a8c-3136">- または -</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3136">-or-</span></span> 
<span data-ttu-id="f3a8c-3137">メッセージ キューのメソッドにアクセスしたときにエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3137">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="T:System.Messaging.MessageQueueTransactionType" />
        <altmember cref="P:System.Messaging.MessageQueue.DefaultPropertiesToSend" />
        <altmember cref="T:System.Messaging.Message" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="P:System.Messaging.MessageQueue.Label" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <MemberGroup MemberName="SetPermissions">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="f3a8c-3138">現在のセットにアクセス許可を追加します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3138">Adds permissions to the current set.</span></span> <span data-ttu-id="f3a8c-3139">キューのプロパティとキューのメッセージにアクセスできるユーザーを制御します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3139">This controls who has access rights to queue properties and messages in the queue.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="SetPermissions">
      <MemberSignature Language="C#" Value="public void SetPermissions (System.Messaging.AccessControlList dacl);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void SetPermissions(class System.Messaging.AccessControlList dacl) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.SetPermissions(System.Messaging.AccessControlList)" />
      <MemberSignature Language="VB.NET" Value="Public Sub SetPermissions (dacl As AccessControlList)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void SetPermissions(System::Messaging::AccessControlList ^ dacl);" />
      <MemberSignature Language="F#" Value="member this.SetPermissions : System.Messaging.AccessControlList -&gt; unit" Usage="messageQueue.SetPermissions dacl" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="dacl" Type="System.Messaging.AccessControlList" />
      </Parameters>
      <Docs>
        <param name="dacl"><span data-ttu-id="f3a8c-3140">トラスティと付与するアクセス許可を指定する 1 つ以上のアクセス制御エントリを含む <see cref="T:System.Messaging.AccessControlList" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3140">A <see cref="T:System.Messaging.AccessControlList" /> that contains one or more access control entries that specify the trustees and the permissions to grant.</span></span></param>
        <summary><span data-ttu-id="f3a8c-3141">アクセス制御リストの内容に基づいてアクセス権をキューに割り当てます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3141">Assigns access rights to the queue based on the contents of an access control list.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-3142">権限の許可、拒否、または取り消しを行うには、このオーバーロードを使用して、トラスティおよびアクセス許可情報を指定するアクセス制御エントリのコレクションを使用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3142">Use this overload to grant, deny, or revoke rights by using a collection of access control entries to specify trustee and permissions information.</span></span> <span data-ttu-id="f3a8c-3143">これは、たとえば、複数のユーザーに同時にアクセス許可を付与するために使用されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3143">This is used, for example, to grant permissions to multiple users at the same time.</span></span>  
  
 <span data-ttu-id="f3a8c-3144">`ace` パラメーターを構築するときに指定するトラスティは、個々のユーザー、ユーザーのグループ、またはコンピューターです。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3144">The trustee you specify when you construct the `ace` parameter can be an individual user, a group of users, or a computer.</span></span> <span data-ttu-id="f3a8c-3145">トラスティが個人の場合は、`DOMAIN`\\`user`の形式を使用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3145">If the trustee is an individual, use the format `DOMAIN`\\`user`.</span></span> <span data-ttu-id="f3a8c-3146">トラスティがローカルコンピューターを示す場合は、"." を指定できます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3146">You can specify "." for the trustee to indicate the local computer.</span></span>  
  
 <span data-ttu-id="f3a8c-3147">によって割り当てられたアクセス許可 <xref:System.Messaging.MessageQueue.SetPermissions%2A> 既存の一覧に権限を追加します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3147">The permissions you assign through <xref:System.Messaging.MessageQueue.SetPermissions%2A> add rights to the existing list.</span></span> <span data-ttu-id="f3a8c-3148">既定では、パブリックキューまたは専用キューの作成者にはフルコントロールがあり、ドメイングループのすべてのユーザーは、キュープロパティの取得、アクセス許可の取得、およびキューへの書き込みを行う権限を持っています。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3148">By default, the creator of a public or private queue has full control, and the domain group Everyone has permission to get queue properties, get permissions, and write to the queue.</span></span> <span data-ttu-id="f3a8c-3149"><xref:System.Messaging.MessageQueue.SetPermissions%2A>を呼び出すと、ユーザーと権限の情報が既存のリストの下部に追加されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3149">When you call <xref:System.Messaging.MessageQueue.SetPermissions%2A>, the user and permissions information is appended to the bottom of the existing list.</span></span>  
  
 <span data-ttu-id="f3a8c-3150">システムは、次のいずれかのイベントが発生するまで、各 <xref:System.Messaging.AccessControlEntry> を順番に検証します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3150">The system examines each <xref:System.Messaging.AccessControlEntry> in sequence until one of the following events occurs:</span></span>  
  
-   <span data-ttu-id="f3a8c-3151">アクセス拒否 <xref:System.Messaging.AccessControlEntry> は、スレッドのアクセストークンに示されているいずれかのトラスティに対して、要求されたアクセス権を明示的に拒否します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3151">An access-denied <xref:System.Messaging.AccessControlEntry> explicitly denies any of the requested access rights to one of the trustees listed in the thread's access token.</span></span>  
  
-   <span data-ttu-id="f3a8c-3152">スレッドのアクセストークンに一覧表示されているトラスティの <xref:System.Messaging.AccessControlEntry> 項目1つ以上に、要求されたすべてのアクセス権が明示的に付与されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3152">One or more access-allowed <xref:System.Messaging.AccessControlEntry> items for trustees listed in the thread's access token explicitly grant all the requested access rights.</span></span>  
  
-   <span data-ttu-id="f3a8c-3153">すべての <xref:System.Messaging.AccessControlEntry> 項目がチェックされ、明示的に許可されていないアクセス権が少なくとも1つ存在します。この場合、アクセスは暗黙的に拒否されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3153">All <xref:System.Messaging.AccessControlEntry> items have been checked and there is still at least one requested access right that has not been explicitly allowed, in which case, access is implicitly denied.</span></span>  
  
 <span data-ttu-id="f3a8c-3154">`dacl` パラメーターを構築する場合は、<xref:System.Messaging.AccessControlEntry> インスタンスを <xref:System.Messaging.AccessControlList> コレクションに追加します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3154">When you construct the `dacl` parameter, you add <xref:System.Messaging.AccessControlEntry> instances to your <xref:System.Messaging.AccessControlList> collection.</span></span> <span data-ttu-id="f3a8c-3155">各アクセス制御エントリを作成するときに、汎用または標準のアクセス権を指定できます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3155">When you construct each access control entry, you can specify generic or standard access rights.</span></span> <span data-ttu-id="f3a8c-3156">キューに対する権限は、次の任意の組み合わせにすることができます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3156">The rights to a queue can be any combination of the following:</span></span>  
  
-   <span data-ttu-id="f3a8c-3157">削除</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3157">Delete</span></span>  
  
-   <span data-ttu-id="f3a8c-3158">セキュリティの読み取り</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3158">Read Security</span></span>  
  
-   <span data-ttu-id="f3a8c-3159">書き込みセキュリティ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3159">Write Security</span></span>  
  
-   <span data-ttu-id="f3a8c-3160">同期</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3160">Synchronize</span></span>  
  
-   <span data-ttu-id="f3a8c-3161">所有者の変更</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3161">Modify Owner</span></span>  
  
-   <span data-ttu-id="f3a8c-3162">読み取り</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3162">Read</span></span>  
  
-   <span data-ttu-id="f3a8c-3163">Write</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3163">Write</span></span>  
  
-   <span data-ttu-id="f3a8c-3164">実行</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3164">Execute</span></span>  
  
-   <span data-ttu-id="f3a8c-3165">必須</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3165">Required</span></span>  
  
-   <span data-ttu-id="f3a8c-3166">すべて</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3166">All</span></span>  
  
-   <span data-ttu-id="f3a8c-3167">None</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3167">None</span></span>  
  
 <span data-ttu-id="f3a8c-3168">これらの権限は、ビットフラグのセットであり、またはビットごとの演算子を使用して組み合わせることができます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3168">These rights are a set of bit flags that you can combine using the OR bitwise operator.</span></span>  
  
-   <span data-ttu-id="f3a8c-3169">フル コントロール</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3169">Full Control</span></span>  
  
-   <span data-ttu-id="f3a8c-3170">メッセージの削除</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3170">Delete Message</span></span>  
  
-   <span data-ttu-id="f3a8c-3171">メッセージの受信</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3171">Receive Message</span></span>  
  
-   <span data-ttu-id="f3a8c-3172">メッセージのピーク</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3172">Peek Message</span></span>  
  
-   <span data-ttu-id="f3a8c-3173">ジャーナルメッセージの受信</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3173">Receive Journal Message</span></span>  
  
-   <span data-ttu-id="f3a8c-3174">キューのプロパティを取得する</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3174">Get Queue Properties</span></span>  
  
-   <span data-ttu-id="f3a8c-3175">キューのプロパティの設定</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3175">Set Queue Properties</span></span>  
  
-   <span data-ttu-id="f3a8c-3176">アクセス許可の取得</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3176">Get Permissions</span></span>  
  
-   <span data-ttu-id="f3a8c-3177">アクセス許可を設定する</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3177">Set Permissions</span></span>  
  
-   <span data-ttu-id="f3a8c-3178">キューの所有権を取得する</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3178">Take Queue Ownership</span></span>  
  
-   <span data-ttu-id="f3a8c-3179">メッセージの書き込み</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3179">Write Message</span></span>  
  
 <span data-ttu-id="f3a8c-3180">次の表に、この方法をさまざまなワークグループモードで使用できるかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3180">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-3181">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3181">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-3182">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3182">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-3183">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3183">Local computer</span></span>|<span data-ttu-id="f3a8c-3184">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3184">Yes</span></span>|  
|<span data-ttu-id="f3a8c-3185">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3185">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-3186">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3186">Yes</span></span>|  
|<span data-ttu-id="f3a8c-3187">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3187">Remote computer</span></span>|<span data-ttu-id="f3a8c-3188">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3188">No</span></span>|  
|<span data-ttu-id="f3a8c-3189">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3189">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-3190">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3190">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-3191">次のコード例は、<xref:System.Messaging.MessageQueue.SetPermissions%28System.Messaging.AccessControlList%29> の使用方法を示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3191">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.SetPermissions%28System.Messaging.AccessControlList%29>.</span></span>      
  
 [!code-cpp[MessageQueue2#26](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#26)]
 [!code-csharp[MessageQueue2#26](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#26)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="f3a8c-3192">メッセージ キューのメソッドにアクセスしたときにエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3192">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="M:System.Messaging.MessageQueue.ResetPermissions" />
        <altmember cref="T:System.Messaging.Trustee" />
        <altmember cref="T:System.Messaging.AccessControlList" />
      </Docs>
    </Member>
    <Member MemberName="SetPermissions">
      <MemberSignature Language="C#" Value="public void SetPermissions (System.Messaging.MessageQueueAccessControlEntry ace);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void SetPermissions(class System.Messaging.MessageQueueAccessControlEntry ace) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.SetPermissions(System.Messaging.MessageQueueAccessControlEntry)" />
      <MemberSignature Language="VB.NET" Value="Public Sub SetPermissions (ace As MessageQueueAccessControlEntry)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void SetPermissions(System::Messaging::MessageQueueAccessControlEntry ^ ace);" />
      <MemberSignature Language="F#" Value="member this.SetPermissions : System.Messaging.MessageQueueAccessControlEntry -&gt; unit" Usage="messageQueue.SetPermissions ace" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="ace" Type="System.Messaging.MessageQueueAccessControlEntry" />
      </Parameters>
      <Docs>
        <param name="ace"><span data-ttu-id="f3a8c-3193">ユーザー、アクセスの種類、およびアクセス許可の種類を指定する <see cref="T:System.Messaging.MessageQueueAccessControlEntry" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3193">A <see cref="T:System.Messaging.MessageQueueAccessControlEntry" /> that specifies a user, an access type, and a permission type.</span></span></param>
        <summary><span data-ttu-id="f3a8c-3194">アクセス制御エントリの内容に基づいてアクセス権をキューに割り当てます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3194">Assigns access rights to the queue based on the contents of an access control entry.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-3195">権限を許可、拒否、または取り消すには、アクセス制御エントリを使用してトラスティと権限情報を指定します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3195">Use this overload to grant, deny, or revoke rights by using an access control entry to specify trustee and rights information.</span></span>  
  
 <span data-ttu-id="f3a8c-3196">`ace` パラメーターを構築するときに指定するトラスティは、個々のユーザー、ユーザーのグループ、またはコンピューターです。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3196">The trustee you specify when you construct the `ace` parameter can be an individual user, a group of users, or a computer.</span></span> <span data-ttu-id="f3a8c-3197">トラスティが個人の場合は、`DOMAIN`\\`user`の形式を使用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3197">If the trustee is an individual, use the format `DOMAIN`\\`user`.</span></span> <span data-ttu-id="f3a8c-3198">トラスティがローカルコンピューターを示す場合は、"." を指定できます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3198">You can specify "." for the trustee to indicate the local computer.</span></span>  
  
 <span data-ttu-id="f3a8c-3199">によって割り当てられたアクセス許可 <xref:System.Messaging.MessageQueue.SetPermissions%2A> 既存の一覧に権限を追加します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3199">The permissions you assign through <xref:System.Messaging.MessageQueue.SetPermissions%2A> add rights to the existing list.</span></span> <span data-ttu-id="f3a8c-3200">既定では、パブリックキューまたは専用キューの作成者にはフルコントロールがあり、ドメイングループのすべてのユーザーは、キュープロパティの取得、アクセス許可の取得、およびキューへの書き込みを行う権限を持っています。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3200">By default, the creator of a public or private queue has full control, and the domain group Everyone has permission to get queue properties, get permissions, and write to the queue.</span></span> <span data-ttu-id="f3a8c-3201"><xref:System.Messaging.MessageQueue.SetPermissions%2A>を呼び出すと、ユーザーと権限の情報が既存のリストの下部に追加されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3201">When you call <xref:System.Messaging.MessageQueue.SetPermissions%2A>, the user and permissions information is appended to the bottom of the existing list.</span></span>  
  
 <span data-ttu-id="f3a8c-3202">システムは、次のいずれかのイベントが発生するまで、各 <xref:System.Messaging.AccessControlEntry> を順番に検証します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3202">The system examines each <xref:System.Messaging.AccessControlEntry> in sequence until one of the following events occurs:</span></span>  
  
-   <span data-ttu-id="f3a8c-3203">アクセス拒否 <xref:System.Messaging.AccessControlEntry> は、スレッドのアクセストークンに示されているいずれかのトラスティに対して、要求されたアクセス権を明示的に拒否します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3203">An access-denied <xref:System.Messaging.AccessControlEntry> explicitly denies any of the requested access rights to one of the trustees listed in the thread's access token.</span></span>  
  
-   <span data-ttu-id="f3a8c-3204">スレッドのアクセストークンに一覧表示されているトラスティの <xref:System.Messaging.AccessControlEntry> 項目1つ以上に、要求されたすべてのアクセス権が明示的に付与されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3204">One or more access-allowed <xref:System.Messaging.AccessControlEntry> items for trustees listed in the thread's access token explicitly grant all the requested access rights.</span></span>  
  
-   <span data-ttu-id="f3a8c-3205">すべての <xref:System.Messaging.AccessControlEntry> 項目がチェックされ、明示的に許可されていないアクセス権が少なくとも1つ存在します。この場合、アクセスは暗黙的に拒否されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3205">All <xref:System.Messaging.AccessControlEntry> items have been checked and there is still at least one requested access right that has not been explicitly allowed, in which case, access is implicitly denied.</span></span>  
  
 <span data-ttu-id="f3a8c-3206"><xref:System.Messaging.MessageQueueAccessControlEntry>を構築するときに `rights` パラメーターで指定するキューに対する権限は、次の任意の組み合わせにすることができます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3206">The rights to a queue, which you specify in the `rights` parameter when you construct your <xref:System.Messaging.MessageQueueAccessControlEntry>, can be any combination of the following:</span></span>  
  
-   <span data-ttu-id="f3a8c-3207">フル コントロール</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3207">Full Control</span></span>  
  
-   <span data-ttu-id="f3a8c-3208">メッセージの削除</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3208">Delete Message</span></span>  
  
-   <span data-ttu-id="f3a8c-3209">メッセージの受信</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3209">Receive Message</span></span>  
  
-   <span data-ttu-id="f3a8c-3210">メッセージのピーク</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3210">Peek Message</span></span>  
  
-   <span data-ttu-id="f3a8c-3211">ジャーナルメッセージの受信</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3211">Receive Journal Message</span></span>  
  
-   <span data-ttu-id="f3a8c-3212">キューのプロパティを取得する</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3212">Get Queue Properties</span></span>  
  
-   <span data-ttu-id="f3a8c-3213">キューのプロパティの設定</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3213">Set Queue Properties</span></span>  
  
-   <span data-ttu-id="f3a8c-3214">アクセス許可の取得</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3214">Get Permissions</span></span>  
  
-   <span data-ttu-id="f3a8c-3215">アクセス許可を設定する</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3215">Set Permissions</span></span>  
  
-   <span data-ttu-id="f3a8c-3216">キューの所有権を取得する</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3216">Take Queue Ownership</span></span>  
  
-   <span data-ttu-id="f3a8c-3217">メッセージの書き込み</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3217">Write Message</span></span>  
  
 <span data-ttu-id="f3a8c-3218">`ace` パラメーターのコンストラクターで指定する `rights` パラメーターは <xref:System.Messaging.MessageQueueAccessRights> 列挙型のフラグです。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3218">The `rights` parameter you specify in the constructor for the `ace` parameter is a flag of the <xref:System.Messaging.MessageQueueAccessRights> enumeration.</span></span> <span data-ttu-id="f3a8c-3219">ビットフラグのセットを表します。これは、ビットごとの演算子を使用して、または `rights` パラメーターを作成するときに組み合わせることができます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3219">It represents a set of bit flags that you can combine using the bitwise operator OR when you build the `rights` parameter.</span></span>  
  
 <span data-ttu-id="f3a8c-3220">次の表に、この方法をさまざまなワークグループモードで使用できるかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3220">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-3221">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3221">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-3222">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3222">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-3223">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3223">Local computer</span></span>|<span data-ttu-id="f3a8c-3224">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3224">Yes</span></span>|  
|<span data-ttu-id="f3a8c-3225">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3225">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-3226">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3226">Yes</span></span>|  
|<span data-ttu-id="f3a8c-3227">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3227">Remote computer</span></span>|<span data-ttu-id="f3a8c-3228">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3228">No</span></span>|  
|<span data-ttu-id="f3a8c-3229">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3229">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-3230">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3230">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-3231">次のコード例は、<xref:System.Messaging.MessageQueue.SetPermissions%28System.Messaging.MessageQueueAccessControlEntry%29> の使用方法を示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3231">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.SetPermissions%28System.Messaging.MessageQueueAccessControlEntry%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#24](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#24)]
 [!code-csharp[MessageQueue2#24](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#24)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="f3a8c-3232">メッセージ キューのメソッドにアクセスしたときにエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3232">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="M:System.Messaging.MessageQueue.ResetPermissions" />
        <altmember cref="T:System.Messaging.Trustee" />
        <altmember cref="T:System.Messaging.MessageQueueAccessRights" />
        <altmember cref="T:System.Messaging.MessageQueueAccessControlEntry" />
      </Docs>
    </Member>
    <Member MemberName="SetPermissions">
      <MemberSignature Language="C#" Value="public void SetPermissions (string user, System.Messaging.MessageQueueAccessRights rights);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void SetPermissions(string user, valuetype System.Messaging.MessageQueueAccessRights rights) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.SetPermissions(System.String,System.Messaging.MessageQueueAccessRights)" />
      <MemberSignature Language="VB.NET" Value="Public Sub SetPermissions (user As String, rights As MessageQueueAccessRights)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void SetPermissions(System::String ^ user, System::Messaging::MessageQueueAccessRights rights);" />
      <MemberSignature Language="F#" Value="member this.SetPermissions : string * System.Messaging.MessageQueueAccessRights -&gt; unit" Usage="messageQueue.SetPermissions (user, rights)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="user" Type="System.String" />
        <Parameter Name="rights" Type="System.Messaging.MessageQueueAccessRights" />
      </Parameters>
      <Docs>
        <param name="user"><span data-ttu-id="f3a8c-3233">キューに対する追加のアクセス権を取得するそれぞれのユーザー、グループ、またはコンピューター。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3233">The individual, group, or computer that gets additional rights to the queue.</span></span></param>
        <param name="rights"><span data-ttu-id="f3a8c-3234">メッセージ キューが <paramref name="user" /> に割り当てるキューに対するアクセス権のセットを示す <see cref="T:System.Messaging.MessageQueueAccessRights" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3234">A <see cref="T:System.Messaging.MessageQueueAccessRights" /> that indicates the set of rights to the queue that Message Queuing assigns to the <paramref name="user" /> passed in.</span></span></param>
        <summary><span data-ttu-id="f3a8c-3235">コンピューター、グループ、またはユーザーに指定したアクセス権を与えます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3235">Gives a computer, group, or user the specified access rights.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-3236">このオーバーロードを使用して、指定した権限を個々のユーザーに付与します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3236">Use this overload to grant specified rights to an individual user.</span></span> <span data-ttu-id="f3a8c-3237">ユーザーは、個々のユーザー、ユーザーグループ、またはコンピューターを含む任意の有効なトラスティにすることができます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3237">The user can be any valid trustee, which includes individual users, groups of users, or a computer.</span></span> <span data-ttu-id="f3a8c-3238">ユーザーが個人の場合は、`user` パラメーターに `user` `DOMAIN`\\の形式を使用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3238">If the user is an individual, use the format `DOMAIN`\\`user` for the `user` parameter.</span></span> <span data-ttu-id="f3a8c-3239">`user` パラメーターに "." を指定すると、ローカルコンピューターを示すことができます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3239">You can specify "." for the `user` parameter to indicate the local computer.</span></span>  
  
 <span data-ttu-id="f3a8c-3240">によって割り当てられたアクセス許可 <xref:System.Messaging.MessageQueue.SetPermissions%2A> 既存の一覧に権限を追加します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3240">The permissions you assign through <xref:System.Messaging.MessageQueue.SetPermissions%2A> add rights to the existing list.</span></span> <span data-ttu-id="f3a8c-3241">既定では、パブリックキューまたは専用キューの作成者にはフルコントロールがあり、ドメイングループのすべてのユーザーは、キュープロパティの取得、アクセス許可の取得、およびキューへの書き込みを行う権限を持っています。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3241">By default, the creator of a public or private queue has full control, and the domain group Everyone has permission to get queue properties, get permissions, and write to the queue.</span></span> <span data-ttu-id="f3a8c-3242"><xref:System.Messaging.MessageQueue.SetPermissions%2A>を呼び出すと、ユーザーと権限の情報が既存のリストの下部に追加されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3242">When you call <xref:System.Messaging.MessageQueue.SetPermissions%2A>, the user and permissions information is appended to the bottom of the existing list.</span></span>  
  
 <span data-ttu-id="f3a8c-3243">システムは、次のいずれかのイベントが発生するまで、各 <xref:System.Messaging.AccessControlEntry> を順番に検証します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3243">The system examines each <xref:System.Messaging.AccessControlEntry> in sequence until one of the following events occurs:</span></span>  
  
-   <span data-ttu-id="f3a8c-3244">アクセス拒否 <xref:System.Messaging.AccessControlEntry> は、スレッドのアクセストークンに示されているいずれかのトラスティに対して、要求されたアクセス権を明示的に拒否します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3244">An access-denied <xref:System.Messaging.AccessControlEntry> explicitly denies any of the requested access rights to one of the trustees listed in the thread's access token.</span></span>  
  
-   <span data-ttu-id="f3a8c-3245">スレッドのアクセストークンに一覧表示されているトラスティの <xref:System.Messaging.AccessControlEntry> 項目1つ以上に、要求されたすべてのアクセス権が明示的に付与されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3245">One or more access-allowed <xref:System.Messaging.AccessControlEntry> items for trustees listed in the thread's access token explicitly grant all the requested access rights.</span></span>  
  
-   <span data-ttu-id="f3a8c-3246">すべての <xref:System.Messaging.AccessControlEntry> 項目がチェックされ、明示的に許可されていないアクセス権が少なくとも1つ存在します。この場合、アクセスは暗黙的に拒否されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3246">All <xref:System.Messaging.AccessControlEntry> items have been checked and there is still at least one requested access right that has not been explicitly allowed, in which case, access is implicitly denied.</span></span>  
  
 <span data-ttu-id="f3a8c-3247">`rights` パラメーターで指定するキューに対する権限は、次の任意の組み合わせにすることができます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3247">The rights to a queue, specified in the `rights` parameter, can be any combination of the following:</span></span>  
  
-   <span data-ttu-id="f3a8c-3248">フル コントロール</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3248">Full Control</span></span>  
  
-   <span data-ttu-id="f3a8c-3249">メッセージの削除</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3249">Delete Message</span></span>  
  
-   <span data-ttu-id="f3a8c-3250">メッセージの受信</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3250">Receive Message</span></span>  
  
-   <span data-ttu-id="f3a8c-3251">メッセージのピーク</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3251">Peek Message</span></span>  
  
-   <span data-ttu-id="f3a8c-3252">ジャーナルメッセージの受信</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3252">Receive Journal Message</span></span>  
  
-   <span data-ttu-id="f3a8c-3253">キューのプロパティを取得する</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3253">Get Queue Properties</span></span>  
  
-   <span data-ttu-id="f3a8c-3254">キューのプロパティの設定</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3254">Set Queue Properties</span></span>  
  
-   <span data-ttu-id="f3a8c-3255">アクセス許可の取得</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3255">Get Permissions</span></span>  
  
-   <span data-ttu-id="f3a8c-3256">アクセス許可を設定する</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3256">Set Permissions</span></span>  
  
-   <span data-ttu-id="f3a8c-3257">キューの所有権を取得する</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3257">Take Queue Ownership</span></span>  
  
-   <span data-ttu-id="f3a8c-3258">メッセージの書き込み</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3258">Write Message</span></span>  
  
 <span data-ttu-id="f3a8c-3259"><xref:System.Messaging.MessageQueueAccessRights> 列挙体はビットフラグのセットを表します。ビットフラグは、ビットごとの演算子を使用して組み合わせることも、`rights` パラメーターを構築することもできます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3259">The <xref:System.Messaging.MessageQueueAccessRights> enumeration represents a set of bit flags that you can combine using the bitwise operator OR to build the `rights` parameter.</span></span>  
  
 <span data-ttu-id="f3a8c-3260">このオーバーロードでは、アクセス許可のみを付与できます。これらのユーザーは、取り消したり拒否したりすることはできません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3260">With this overload, you can only grant permissions; you cannot revoke or deny them.</span></span> <span data-ttu-id="f3a8c-3261">`Allow`以外の <xref:System.Messaging.AccessControlEntryType> を明示的に付与するには、別のオーバーロードを使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3261">You must use a different overload to explicitly grant any <xref:System.Messaging.AccessControlEntryType> other than `Allow`.</span></span>  
  
 <span data-ttu-id="f3a8c-3262">次の表に、この方法をさまざまなワークグループモードで使用できるかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3262">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-3263">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3263">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-3264">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3264">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-3265">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3265">Local computer</span></span>|<span data-ttu-id="f3a8c-3266">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3266">Yes</span></span>|  
|<span data-ttu-id="f3a8c-3267">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3267">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-3268">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3268">Yes</span></span>|  
|<span data-ttu-id="f3a8c-3269">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3269">Remote computer</span></span>|<span data-ttu-id="f3a8c-3270">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3270">No</span></span>|  
|<span data-ttu-id="f3a8c-3271">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3271">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-3272">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3272">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-3273">次のコード例は、<xref:System.Messaging.MessageQueue.SetPermissions%28System.String%2CSystem.Messaging.MessageQueueAccessRights%29> の使用方法を示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3273">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.SetPermissions%28System.String%2CSystem.Messaging.MessageQueueAccessRights%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#23](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#23)]
 [!code-csharp[MessageQueue2#23](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#23)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="f3a8c-3274"><paramref name="user" /> が <see langword="null" /> です。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3274">The <paramref name="user" /> is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="f3a8c-3275">メッセージ キューのメソッドにアクセスしたときにエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3275">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="M:System.Messaging.MessageQueue.ResetPermissions" />
        <altmember cref="T:System.Messaging.Trustee" />
        <altmember cref="T:System.Messaging.MessageQueueAccessRights" />
      </Docs>
    </Member>
    <Member MemberName="SetPermissions">
      <MemberSignature Language="C#" Value="public void SetPermissions (string user, System.Messaging.MessageQueueAccessRights rights, System.Messaging.AccessControlEntryType entryType);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void SetPermissions(string user, valuetype System.Messaging.MessageQueueAccessRights rights, valuetype System.Messaging.AccessControlEntryType entryType) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.SetPermissions(System.String,System.Messaging.MessageQueueAccessRights,System.Messaging.AccessControlEntryType)" />
      <MemberSignature Language="VB.NET" Value="Public Sub SetPermissions (user As String, rights As MessageQueueAccessRights, entryType As AccessControlEntryType)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void SetPermissions(System::String ^ user, System::Messaging::MessageQueueAccessRights rights, System::Messaging::AccessControlEntryType entryType);" />
      <MemberSignature Language="F#" Value="member this.SetPermissions : string * System.Messaging.MessageQueueAccessRights * System.Messaging.AccessControlEntryType -&gt; unit" Usage="messageQueue.SetPermissions (user, rights, entryType)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="user" Type="System.String" />
        <Parameter Name="rights" Type="System.Messaging.MessageQueueAccessRights" />
        <Parameter Name="entryType" Type="System.Messaging.AccessControlEntryType" />
      </Parameters>
      <Docs>
        <param name="user"><span data-ttu-id="f3a8c-3276">キューに対する追加のアクセス権を取得するそれぞれのユーザー、グループ、またはコンピューター。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3276">The individual, group, or computer that gets additional rights to the queue.</span></span></param>
        <param name="rights"><span data-ttu-id="f3a8c-3277">メッセージ キューが <paramref name="user" /> に割り当てるキューに対するアクセス権のセットを示す <see cref="T:System.Messaging.MessageQueueAccessRights" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3277">A <see cref="T:System.Messaging.MessageQueueAccessRights" /> that indicates the set of rights to the queue that Message Queuing assigns to the <paramref name="user" /> passed in.</span></span></param>
        <param name="entryType"><span data-ttu-id="f3a8c-3278"><paramref name="rights" /> パラメーターで指定したアクセス許可で、付与、拒否、取り消しのどの操作を実行するかを指定する <see cref="T:System.Messaging.AccessControlEntryType" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3278">A <see cref="T:System.Messaging.AccessControlEntryType" /> that specifies whether to grant, deny, or revoke the permissions specified by the <paramref name="rights" /> parameter.</span></span></param>
        <summary><span data-ttu-id="f3a8c-3279">アクセス制御の種類 (許可、拒否、取り消し、またはセット) からいずれかを指定して、コンピューター、グループ、またはユーザーに指定したアクセス権を付与します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3279">Gives a computer, group, or user the specified access rights, with the specified access control type (allow, deny, revoke, or set).</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-3280">このオーバーロードを使用して、個々のユーザーに対して指定された権限を許可、拒否、または取り消すことができます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3280">Use this overload to grant, deny, or revoke specified rights for an individual user.</span></span> <span data-ttu-id="f3a8c-3281">ユーザーは、個々のユーザー、ユーザーグループ、またはコンピューターを含む任意の有効なトラスティにすることができます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3281">The user can be any valid trustee, which includes individual users, groups of users, or a computer.</span></span> <span data-ttu-id="f3a8c-3282">ユーザーが個人の場合は、`user` パラメーターに `user` `DOMAIN`\\の形式を使用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3282">If the user is an individual, use the format `DOMAIN`\\`user` for the `user` parameter.</span></span> <span data-ttu-id="f3a8c-3283">`user` パラメーターに "." を指定すると、ローカルコンピューターを示すことができます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3283">You can specify "." for the `user` parameter to indicate the local computer.</span></span>  
  
 <span data-ttu-id="f3a8c-3284">によって割り当てられたアクセス許可 <xref:System.Messaging.MessageQueue.SetPermissions%2A> 既存の一覧に権限を追加します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3284">The permissions you assign through <xref:System.Messaging.MessageQueue.SetPermissions%2A> add rights to the existing list.</span></span> <span data-ttu-id="f3a8c-3285">既定では、パブリックキューまたは専用キューの作成者にはフルコントロールがあり、ドメイングループのすべてのユーザーは、キュープロパティの取得、アクセス許可の取得、およびキューへの書き込みを行う権限を持っています。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3285">By default, the creator of a public or private queue has full control, and the domain group Everyone has permission to get queue properties, get permissions, and write to the queue.</span></span> <span data-ttu-id="f3a8c-3286"><xref:System.Messaging.MessageQueue.SetPermissions%2A>を呼び出すと、ユーザーと権限の情報が既存のリストの下部に追加されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3286">When you call <xref:System.Messaging.MessageQueue.SetPermissions%2A>, the user and permissions information is appended to the bottom of the existing list.</span></span>  
  
 <span data-ttu-id="f3a8c-3287">システムは、次のいずれかのイベントが発生するまで、各 <xref:System.Messaging.AccessControlEntry> を順番に検証します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3287">The system examines each <xref:System.Messaging.AccessControlEntry> in sequence until one of the following events occurs:</span></span>  
  
-   <span data-ttu-id="f3a8c-3288">アクセス拒否 <xref:System.Messaging.AccessControlEntry> は、スレッドのアクセストークンに示されているいずれかのトラスティに対して、要求されたアクセス権を明示的に拒否します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3288">An access-denied <xref:System.Messaging.AccessControlEntry> explicitly denies any of the requested access rights to one of the trustees listed in the thread's access token.</span></span>  
  
-   <span data-ttu-id="f3a8c-3289">スレッドのアクセストークンに一覧表示されているトラスティの <xref:System.Messaging.AccessControlEntry> 項目1つ以上に、要求されたすべてのアクセス権が明示的に付与されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3289">One or more access-allowed <xref:System.Messaging.AccessControlEntry> items for trustees listed in the thread's access token explicitly grant all the requested access rights.</span></span>  
  
-   <span data-ttu-id="f3a8c-3290">すべての <xref:System.Messaging.AccessControlEntry> 項目がチェックされ、明示的に許可されていないアクセス権が少なくとも1つ存在します。この場合、アクセスは暗黙的に拒否されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3290">All <xref:System.Messaging.AccessControlEntry> items have been checked and there is still at least one requested access right that has not been explicitly allowed, in which case, access is implicitly denied.</span></span>  
  
 <span data-ttu-id="f3a8c-3291">`rights` パラメーターで指定するキューに対する権限は、次の任意の組み合わせにすることができます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3291">The rights to a queue, specified in the `rights` parameter, can be any combination of the following:</span></span>  
  
-   <span data-ttu-id="f3a8c-3292">フル コントロール</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3292">Full Control</span></span>  
  
-   <span data-ttu-id="f3a8c-3293">メッセージの削除</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3293">Delete Message</span></span>  
  
-   <span data-ttu-id="f3a8c-3294">メッセージの受信</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3294">Receive Message</span></span>  
  
-   <span data-ttu-id="f3a8c-3295">メッセージのピーク</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3295">Peek Message</span></span>  
  
-   <span data-ttu-id="f3a8c-3296">ジャーナルメッセージの受信</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3296">Receive Journal Message</span></span>  
  
-   <span data-ttu-id="f3a8c-3297">キューのプロパティを取得する</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3297">Get Queue Properties</span></span>  
  
-   <span data-ttu-id="f3a8c-3298">キューのプロパティの設定</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3298">Set Queue Properties</span></span>  
  
-   <span data-ttu-id="f3a8c-3299">アクセス許可の取得</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3299">Get Permissions</span></span>  
  
-   <span data-ttu-id="f3a8c-3300">アクセス許可を設定する</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3300">Set Permissions</span></span>  
  
-   <span data-ttu-id="f3a8c-3301">キューの所有権を取得する</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3301">Take Queue Ownership</span></span>  
  
-   <span data-ttu-id="f3a8c-3302">メッセージの書き込み</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3302">Write Message</span></span>  
  
 <span data-ttu-id="f3a8c-3303"><xref:System.Messaging.MessageQueueAccessRights> 列挙体はビットフラグのセットを表します。ビットフラグは、ビットごとの演算子を使用して組み合わせることも、`rights` パラメーターを構築することもできます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3303">The <xref:System.Messaging.MessageQueueAccessRights> enumeration represents a set of bit flags that you can combine using the bitwise operator OR to build the `rights` parameter.</span></span>  
  
 <span data-ttu-id="f3a8c-3304">次の表に、この方法をさまざまなワークグループモードで使用できるかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3304">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-3305">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3305">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-3306">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3306">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-3307">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3307">Local computer</span></span>|<span data-ttu-id="f3a8c-3308">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3308">Yes</span></span>|  
|<span data-ttu-id="f3a8c-3309">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3309">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-3310">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3310">Yes</span></span>|  
|<span data-ttu-id="f3a8c-3311">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3311">Remote computer</span></span>|<span data-ttu-id="f3a8c-3312">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3312">No</span></span>|  
|<span data-ttu-id="f3a8c-3313">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3313">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-3314">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3314">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-3315">次のコード例は、<xref:System.Messaging.MessageQueue.SetPermissions%28System.String%2CSystem.Messaging.MessageQueueAccessRights%2CSystem.Messaging.AccessControlEntryType%29> の使用方法を示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3315">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.SetPermissions%28System.String%2CSystem.Messaging.MessageQueueAccessRights%2CSystem.Messaging.AccessControlEntryType%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#25](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#25)]
 [!code-csharp[MessageQueue2#25](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#25)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="f3a8c-3316">メッセージ キューのメソッドにアクセスしたときにエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3316">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="M:System.Messaging.MessageQueue.ResetPermissions" />
        <altmember cref="T:System.Messaging.Trustee" />
        <altmember cref="T:System.Messaging.MessageQueueAccessRights" />
        <altmember cref="T:System.Messaging.AccessControlEntry" />
      </Docs>
    </Member>
    <Member MemberName="SynchronizingObject">
      <MemberSignature Language="C#" Value="public System.ComponentModel.ISynchronizeInvoke SynchronizingObject { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class System.ComponentModel.ISynchronizeInvoke SynchronizingObject" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.SynchronizingObject" />
      <MemberSignature Language="VB.NET" Value="Public Property SynchronizingObject As ISynchronizeInvoke" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::ComponentModel::ISynchronizeInvoke ^ SynchronizingObject { System::ComponentModel::ISynchronizeInvoke ^ get(); void set(System::ComponentModel::ISynchronizeInvoke ^ value); };" />
      <MemberSignature Language="F#" Value="member this.SynchronizingObject : System.ComponentModel.ISynchronizeInvoke with get, set" Usage="System.Messaging.MessageQueue.SynchronizingObject" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.DefaultValue(null)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_SynchronizingObject")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.ComponentModel.ISynchronizeInvoke</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="f3a8c-3317"><see cref="E:System.Messaging.MessageQueue.ReceiveCompleted" /> イベントまたは <see cref="E:System.Messaging.MessageQueue.PeekCompleted" /> イベントによって発生したイベント ハンドラー呼び出しをマーシャリングするオブジェクトを取得または設定します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3317">Gets or sets the object that marshals the event-handler call resulting from a <see cref="E:System.Messaging.MessageQueue.ReceiveCompleted" /> or <see cref="E:System.Messaging.MessageQueue.PeekCompleted" /> event.</span></span></summary>
        <value><span data-ttu-id="f3a8c-3318"><see cref="T:System.ComponentModel.ISynchronizeInvoke" /> イベントまたは <see cref="E:System.Messaging.MessageQueue.ReceiveCompleted" /> イベントによって発生したイベント ハンドラー呼び出しをマーシャリングするオブジェクトを表す <see cref="E:System.Messaging.MessageQueue.PeekCompleted" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3318">A <see cref="T:System.ComponentModel.ISynchronizeInvoke" />, which represents the object that marshals the event-handler call resulting from a <see cref="E:System.Messaging.MessageQueue.ReceiveCompleted" /> or <see cref="E:System.Messaging.MessageQueue.PeekCompleted" /> event.</span></span> <span data-ttu-id="f3a8c-3319">既定値は、<see langword="null" /> です。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3319">The default is <see langword="null" />.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-3320"><xref:System.Messaging.MessageQueue.ReceiveCompleted> または <xref:System.Messaging.MessageQueue.PeekCompleted> イベントは、それぞれ <xref:System.Messaging.MessageQueue.BeginReceive%2A> または <xref:System.Messaging.MessageQueue.BeginPeek%2A> の要求から特定のスレッドに発生します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3320">A <xref:System.Messaging.MessageQueue.ReceiveCompleted> or <xref:System.Messaging.MessageQueue.PeekCompleted> event results from a <xref:System.Messaging.MessageQueue.BeginReceive%2A> or <xref:System.Messaging.MessageQueue.BeginPeek%2A> request, respectively, to a specific thread.</span></span> <span data-ttu-id="f3a8c-3321">通常、<xref:System.Messaging.MessageQueue.SynchronizingObject%2A> は、関連するコンポーネントがコントロールまたはフォーム内に配置されている場合に設定されます。これは、これらのコンポーネントが特定のスレッドにバインドされるためです。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3321">Typically, the <xref:System.Messaging.MessageQueue.SynchronizingObject%2A> is set when its related component is placed inside a control or a form, because those components are bound to a specific thread.</span></span>  
  
 <span data-ttu-id="f3a8c-3322">通常、同期オブジェクトは、メソッド呼び出しを1つのスレッドにマーシャリングします。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3322">Typically, the synchronizing object marshals a method call into a single thread.</span></span>  
  
 ]]></format>
        </remarks>
        <altmember cref="E:System.Messaging.MessageQueue.PeekCompleted" />
        <altmember cref="E:System.Messaging.MessageQueue.ReceiveCompleted" />
      </Docs>
    </Member>
    <Member MemberName="Transactional">
      <MemberSignature Language="C#" Value="public bool Transactional { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool Transactional" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.Transactional" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property Transactional As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property bool Transactional { bool get(); };" />
      <MemberSignature Language="F#" Value="member this.Transactional : bool" Usage="System.Messaging.MessageQueue.Transactional" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_Transactional")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="f3a8c-3323">キューがトランザクションだけを受け入れるかどうかを示す値を取得します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3323">Gets a value that indicates whether the queue accepts only transactions.</span></span></summary>
        <value><span data-ttu-id="f3a8c-3324">キューがトランザクションの一部として送信されるメッセージだけを受け入れる場合は <see langword="true" />。それ以外の場合は <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3324"><see langword="true" /> if the queue accepts only messages sent as part of a transaction; otherwise, <see langword="false" />.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-3325">トランザクションメッセージングとは、複数の関連するメッセージを1つのトランザクションに結合したものです。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3325">Transactional messaging refers to the coupling of several related messages into a single transaction.</span></span> <span data-ttu-id="f3a8c-3326">トランザクションの一部としてメッセージを送信すると、メッセージが順番に配信され、1回だけ配信され、送信先キューから正常に取得されるようになります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3326">Sending messages as part of a transaction ensures that the messages are delivered in order, delivered only once, and successfully retrieved from their destination queue.</span></span>  
  
 <span data-ttu-id="f3a8c-3327">キューがトランザクションである場合は、トランザクションの一部として送信されたメッセージのみが受け入れられます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3327">If a queue is transactional, it accepts only messages that are sent as part of a transaction.</span></span> <span data-ttu-id="f3a8c-3328">ただし、トランザクション <xref:System.Messaging.MessageQueueTransaction.Begin%2A>、<xref:System.Messaging.MessageQueueTransaction.Commit%2A>、および <xref:System.Messaging.MessageQueueTransaction.Abort%2A> 構文を明示的に使用せずに、ローカルトランザクションキューから非トランザクションメッセージを送受信できます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3328">However, a non-transactional message can be sent or received from a local transaction queue without explicitly using transactional <xref:System.Messaging.MessageQueueTransaction.Begin%2A>, <xref:System.Messaging.MessageQueueTransaction.Commit%2A>, and <xref:System.Messaging.MessageQueueTransaction.Abort%2A> syntax.</span></span> <span data-ttu-id="f3a8c-3329">トランザクションキューに非トランザクションメッセージが送信された場合、このコンポーネントは、直接形式名を使用してリモートコンピューター上のキューを参照する場合を除いて、そのメッセージの単一メッセージトランザクションを作成します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3329">If a non-transactional message is sent to a transactional queue, this component creates a single-message transaction for it, except in the case of referencing a queue on a remote computer using a direct format name.</span></span> <span data-ttu-id="f3a8c-3330">この場合、メッセージの送信時にトランザクションコンテキストを指定しないと、メッセージは作成されず、メッセージは配信不能キューに送信されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3330">In this situation, if you do not specify a transaction context when sending a message, one is not created for you and the message will be sent to the dead-letter queue.</span></span>  
  
 <span data-ttu-id="f3a8c-3331">トランザクションキューに非トランザクションメッセージを送信すると、例外が発生した場合にメッセージをロールバックすることはできません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3331">If you send a non-transactional message to a transactional queue, you will not be able to roll back the message in the event of an exception.</span></span>  
  
 <span data-ttu-id="f3a8c-3332"><xref:System.Messaging.MessageQueueTransaction> はスレッドアパートメントに対応しているため、アパートメント状態が `STA`場合は、複数のスレッドでトランザクションを使用することはできません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3332"><xref:System.Messaging.MessageQueueTransaction> is threading apartment aware, so if your apartment state is `STA`, you cannot use the transaction in multiple threads.</span></span> <span data-ttu-id="f3a8c-3333">Visual Basic は、メインスレッドの状態を `STA`に設定するため、<xref:System.MTAThreadAttribute> を `Main` サブルーチンに適用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3333">Visual Basic sets the state of the main thread to `STA`, so you must apply the <xref:System.MTAThreadAttribute> in the `Main` subroutine.</span></span> <span data-ttu-id="f3a8c-3334">適用しない場合、別のスレッドを使用してトランザクション メッセージを送信すると、<xref:System.Messaging.MessageQueueException> 例外がスローされます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3334">Otherwise, sending a transactional message using another thread throws a <xref:System.Messaging.MessageQueueException> exception.</span></span> <span data-ttu-id="f3a8c-3335">次のフラグメントを使用して、<xref:System.MTAThreadAttribute> を適用します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3335">You apply the <xref:System.MTAThreadAttribute> by using the following fragment.</span></span>  
  
```vb  
<System.MTAThreadAttribute>  
 public sub Main()  
```  
  
 <span data-ttu-id="f3a8c-3336">次の表は、このプロパティがさまざまなワークグループモードで使用できるかどうかを示しています。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3336">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-3337">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3337">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-3338">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3338">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-3339">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3339">Local computer</span></span>|<span data-ttu-id="f3a8c-3340">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3340">Yes</span></span>|  
|<span data-ttu-id="f3a8c-3341">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3341">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-3342">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3342">Yes</span></span>|  
|<span data-ttu-id="f3a8c-3343">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3343">Remote computer</span></span>|<span data-ttu-id="f3a8c-3344">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3344">No</span></span>|  
|<span data-ttu-id="f3a8c-3345">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3345">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-3346">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3346">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-3347">次のコード例では、メッセージキューの <xref:System.Messaging.MessageQueue.Transactional%2A> プロパティの値を表示します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3347">The following code example displays the value of a message queue's <xref:System.Messaging.MessageQueue.Transactional%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#27](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#27)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="f3a8c-3348">メッセージ キューのメソッドにアクセスしたときにエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3348">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="M:System.Messaging.MessageQueueTransaction.Begin" />
        <altmember cref="M:System.Messaging.MessageQueueTransaction.Commit" />
        <altmember cref="M:System.Messaging.MessageQueueTransaction.Abort" />
        <altmember cref="P:System.Messaging.Message.TransactionId" />
        <altmember cref="P:System.Messaging.Message.IsFirstInTransaction" />
        <altmember cref="P:System.Messaging.Message.IsLastInTransaction" />
      </Docs>
    </Member>
    <Member MemberName="UseJournalQueue">
      <MemberSignature Language="C#" Value="public bool UseJournalQueue { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool UseJournalQueue" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.UseJournalQueue" />
      <MemberSignature Language="VB.NET" Value="Public Property UseJournalQueue As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property bool UseJournalQueue { bool get(); void set(bool value); };" />
      <MemberSignature Language="F#" Value="member this.UseJournalQueue : bool with get, set" Usage="System.Messaging.MessageQueue.UseJournalQueue" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.Messaging.MessagingDescription("MQ_WriteHandle")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_UseJournalQueue")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="f3a8c-3349">受信したメッセージを履歴キューにコピーするかどうかを示す値を取得または設定します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3349">Gets or sets a value that indicates whether received messages are copied to the journal queue.</span></span></summary>
        <value><span data-ttu-id="f3a8c-3350">キューから受信したメッセージを履歴キューにコピーする場合は <see langword="true" />。それ以外の場合は <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3350"><see langword="true" /> if messages received from the queue are copied to its journal queue; otherwise, <see langword="false" />.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-3351">メッセージキューアプリケーションは、新しいアプリケーションキューを作成するときに、関連付けられたジャーナルキューを同じ場所に自動的に作成します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3351">When the Message Queuing application creates a new application queue, it automatically creates an associated journal queue in the same location.</span></span> <span data-ttu-id="f3a8c-3352">ジャーナルキューは、キューから削除されたメッセージを追跡するために使用されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3352">The journal queue is used to track the messages removed from a queue.</span></span> <span data-ttu-id="f3a8c-3353">このプロパティを設定すると、メッセージキューのキューが変更されます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3353">Setting this property modifies the Message Queuing queue.</span></span> <span data-ttu-id="f3a8c-3354">そのため、その他の <xref:System.Messaging.MessageQueue> インスタンスは変更の影響を受けます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3354">Therefore, any other <xref:System.Messaging.MessageQueue> instances are affected by the change.</span></span>  
  
 <span data-ttu-id="f3a8c-3355">ジャーナルキューは、キューから削除されたメッセージを追跡しません。これは、メッセージキューディレクトリサービス (インフォメーションストアまたは Active Directory) を使用して、キューから削除されたメッセージを追跡しないためです。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3355">The journal queue does not track messages removed from the queue because their time-to-be-received timer expired, nor does it track messages purged from the queue by using a Message Queuing directory service (Information Store or Active Directory).</span></span>  
  
 <span data-ttu-id="f3a8c-3356">アプリケーションは、ジャーナルキューにメッセージを送信できません。これらのキューの読み取り専用アクセスに制限されています。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3356">Applications cannot send messages to journal queues; they are limited to read-only access of these queues.</span></span> <span data-ttu-id="f3a8c-3357">さらに、メッセージキューは、ジャーナルキューからメッセージを削除しません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3357">Furthermore, Message Queuing never removes messages from journal queues.</span></span> <span data-ttu-id="f3a8c-3358">キューを使用するアプリケーションでは、メッセージを受信するか、キューを削除することによって、これらのメッセージをクリアする必要があります。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3358">The application using the queue must clear these messages either by receiving them or by purging the queue.</span></span>  
  
 <span data-ttu-id="f3a8c-3359">次の表は、このプロパティがさまざまなワークグループモードで使用できるかどうかを示しています。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3359">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-3360">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3360">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-3361">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3361">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-3362">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3362">Local computer</span></span>|<span data-ttu-id="f3a8c-3363">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3363">Yes</span></span>|  
|<span data-ttu-id="f3a8c-3364">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3364">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-3365">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3365">Yes</span></span>|  
|<span data-ttu-id="f3a8c-3366">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3366">Remote computer</span></span>|<span data-ttu-id="f3a8c-3367">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3367">No</span></span>|  
|<span data-ttu-id="f3a8c-3368">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3368">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-3369">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3369">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="f3a8c-3370">次のコード例では、メッセージキューの <xref:System.Messaging.MessageQueue.UseJournalQueue%2A> プロパティの値を取得して設定します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3370">The following code example gets and sets the value of a message queue's <xref:System.Messaging.MessageQueue.UseJournalQueue%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#28](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#28)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="f3a8c-3371">メッセージ キューのメソッドにアクセスしたときにエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3371">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.MaximumJournalSize" />
      </Docs>
    </Member>
    <Member MemberName="WriteHandle">
      <MemberSignature Language="C#" Value="public IntPtr WriteHandle { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance native int WriteHandle" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.WriteHandle" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property WriteHandle As IntPtr" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property IntPtr WriteHandle { IntPtr get(); };" />
      <MemberSignature Language="F#" Value="member this.WriteHandle : nativeint" Usage="System.Messaging.MessageQueue.WriteHandle" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_WriteHandle")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.IntPtr</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="f3a8c-3372">メッセージ キューにメッセージを送信するときに使用するネイティブ ハンドルを取得します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3372">Gets the native handle used to send messages to the message queue.</span></span></summary>
        <value><span data-ttu-id="f3a8c-3373">キューにメッセージを送信するときに使用するネイティブ キューオブジェクトへのハンドル。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3373">A handle to the native queue object that you use for sending messages to the queue.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f3a8c-3374"><xref:System.Messaging.MessageQueue.WriteHandle%2A> は、キューにメッセージを送信するために使用されるメッセージキューオブジェクトへのネイティブ Windows ハンドルを提供します。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3374">The <xref:System.Messaging.MessageQueue.WriteHandle%2A> provides a native Windows handle to the message queue object that is used for sending messages to the queue.</span></span> <span data-ttu-id="f3a8c-3375">キューのパスを変更すると、ハンドルは閉じられ、新しい値で再び開かれます。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3375">If you change the path of the queue, the handle is closed and reopened with a new value.</span></span>  
  
 <span data-ttu-id="f3a8c-3376">次の表は、このプロパティがさまざまなワークグループモードで使用できるかどうかを示しています。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3376">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="f3a8c-3377">ワークグループモード</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3377">Workgroup mode</span></span>|<span data-ttu-id="f3a8c-3378">使用可能</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3378">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="f3a8c-3379">ローカル コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3379">Local computer</span></span>|<span data-ttu-id="f3a8c-3380">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3380">Yes</span></span>|  
|<span data-ttu-id="f3a8c-3381">ローカルコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3381">Local computer and direct format name</span></span>|<span data-ttu-id="f3a8c-3382">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3382">Yes</span></span>|  
|<span data-ttu-id="f3a8c-3383">リモート コンピューター</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3383">Remote computer</span></span>|<span data-ttu-id="f3a8c-3384">いいえ</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3384">No</span></span>|  
|<span data-ttu-id="f3a8c-3385">リモートコンピューターと直接形式名</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3385">Remote computer and direct format name</span></span>|<span data-ttu-id="f3a8c-3386">はい</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3386">Yes</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="f3a8c-3387">このメッセージ キューには書き込みができません。</span><span class="sxs-lookup"><span data-stu-id="f3a8c-3387">The message queue is not available for writing.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.CanWrite" />
        <altmember cref="P:System.Messaging.MessageQueue.ReadHandle" />
      </Docs>
    </Member>
  </Members>
</Type>
