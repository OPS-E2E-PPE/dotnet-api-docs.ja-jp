<Type Name="Registry" FullName="Microsoft.Win32.Registry">
  <Metadata><Meta Name="ms.openlocfilehash" Value="fe0d686a8fac42aba60eddeda0c5b141caa07a35" /><Meta Name="ms.sourcegitcommit" Value="8ae9a18b248625c8e1851e607c00346a64849587" /><Meta Name="ms.translationtype" Value="MT" /><Meta Name="ms.contentlocale" Value="ja-JP" /><Meta Name="ms.lasthandoff" Value="12/17/2019" /><Meta Name="ms.locfileid" Value="75154033" /></Metadata><TypeSignature Language="C#" Value="public static class Registry" />
  <TypeSignature Language="ILAsm" Value=".class public auto ansi abstract sealed beforefieldinit Registry extends System.Object" />
  <TypeSignature Language="DocId" Value="T:Microsoft.Win32.Registry" />
  <TypeSignature Language="VB.NET" Value="Public Class Registry" />
  <TypeSignature Language="C++ CLI" Value="public ref class Registry abstract sealed" />
  <TypeSignature Language="F#" Value="type Registry = class" />
  <AssemblyInfo>
    <AssemblyName>Microsoft.Win32.Registry</AssemblyName>
    <AssemblyVersion>4.0.0.0</AssemblyVersion>
    <AssemblyVersion>4.0.1.0</AssemblyVersion>
    <AssemblyVersion>4.1.0.0</AssemblyVersion>
    <AssemblyVersion>4.1.1.0</AssemblyVersion>
    <AssemblyVersion>4.1.2.0</AssemblyVersion>
    <AssemblyVersion>4.1.3.0</AssemblyVersion>
  </AssemblyInfo>
  <AssemblyInfo>
    <AssemblyName>mscorlib</AssemblyName>
    <AssemblyVersion>1.0.5000.0</AssemblyVersion>
    <AssemblyVersion>2.0.0.0</AssemblyVersion>
    <AssemblyVersion>2.0.5.0</AssemblyVersion>
    <AssemblyVersion>4.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <Base>
    <BaseTypeName>System.Object</BaseTypeName>
  </Base>
  <Interfaces />
  <Attributes>
    <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinandroid-7.1;xamarinios-10.8;xamarinmac-3.0;netframework-4.8">
      <AttributeName>System.Runtime.InteropServices.ComVisible(true)</AttributeName>
    </Attribute>
  </Attributes>
  <Docs>
    <summary><span data-ttu-id="92e23-101">Windows レジストリのルート キーを表す <see cref="T:Microsoft.Win32.RegistryKey" /> オブジェクト、およびキー/値ペアにアクセスするための <see langword="static" /> メソッドを提供します。</span><span class="sxs-lookup"><span data-stu-id="92e23-101">Provides <see cref="T:Microsoft.Win32.RegistryKey" /> objects that represent the root keys in the Windows registry, and <see langword="static" /> methods to access key/value pairs.</span></span></summary>
    <remarks>
      <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="92e23-102">このクラスは、Windows を実行しているコンピューターのレジストリに存在する標準のルートキーのセットを提供します。</span><span class="sxs-lookup"><span data-stu-id="92e23-102">This class provides the set of standard root keys found in the registry on machines running Windows.</span></span> <span data-ttu-id="92e23-103">レジストリは、アプリケーション、ユーザー、および既定のシステム設定に関する情報を格納するための記憶域機能です。</span><span class="sxs-lookup"><span data-stu-id="92e23-103">The registry is a storage facility for information about applications, users, and default system settings.</span></span> <span data-ttu-id="92e23-104">たとえば、アプリケーションは、アプリケーションの終了後に保存する必要がある情報を格納するためにレジストリを使用し、アプリケーションの再読み込み時に同じ情報にアクセスすることができます。</span><span class="sxs-lookup"><span data-stu-id="92e23-104">For example, applications can use the registry for storing information that needs to be preserved after the application is closed, and access that same information when the application is reloaded.</span></span> <span data-ttu-id="92e23-105">たとえば、色の設定、画面の位置、またはウィンドウのサイズを格納できます。</span><span class="sxs-lookup"><span data-stu-id="92e23-105">For instance, you can store color preferences, screen locations, or the size of the window.</span></span> <span data-ttu-id="92e23-106">レジストリの別の場所に情報を保存することで、ユーザーごとにこのデータを制御できます。</span><span class="sxs-lookup"><span data-stu-id="92e23-106">You can control this data for each user by storing the information in a different location in the registry.</span></span>  
  
 <span data-ttu-id="92e23-107">`Registry` クラスによって公開される基本またはルート <xref:Microsoft.Win32.RegistryKey> インスタンスは、レジストリ内のサブキーと値の基本的なストレージ機構を表します。</span><span class="sxs-lookup"><span data-stu-id="92e23-107">The base, or root <xref:Microsoft.Win32.RegistryKey> instances that are exposed by the `Registry` class delineate the basic storage mechanism for subkeys and values in the registry.</span></span> <span data-ttu-id="92e23-108">レジストリはその存在に依存しているため、すべてのキーが読み取り専用です。</span><span class="sxs-lookup"><span data-stu-id="92e23-108">All keys are read-only because the registry depends on their existence.</span></span> <span data-ttu-id="92e23-109">`Registry` によって公開されるキーは次のとおりです。</span><span class="sxs-lookup"><span data-stu-id="92e23-109">The keys exposed by `Registry` are:</span></span>  
  
 <xref:Microsoft.Win32.Registry.CurrentUser>  
 <span data-ttu-id="92e23-110">ユーザー設定に関する情報を格納します。</span><span class="sxs-lookup"><span data-stu-id="92e23-110">Stores information about user preferences.</span></span>  
  
 <xref:Microsoft.Win32.Registry.LocalMachine>  
 <span data-ttu-id="92e23-111">ローカルコンピューターの構成情報を格納します。</span><span class="sxs-lookup"><span data-stu-id="92e23-111">Stores configuration information for the local machine.</span></span>  
  
 <xref:Microsoft.Win32.Registry.ClassesRoot>  
 <span data-ttu-id="92e23-112">型 (およびクラス) とそのプロパティに関する情報を格納します。</span><span class="sxs-lookup"><span data-stu-id="92e23-112">Stores information about types (and classes) and their properties.</span></span>  
  
 <xref:Microsoft.Win32.Registry.Users>  
 <span data-ttu-id="92e23-113">既定のユーザー構成に関する情報を格納します。</span><span class="sxs-lookup"><span data-stu-id="92e23-113">Stores information about the default user configuration.</span></span>  
  
 <xref:Microsoft.Win32.Registry.PerformanceData>  
 <span data-ttu-id="92e23-114">ソフトウェアコンポーネントのパフォーマンス情報を格納します。</span><span class="sxs-lookup"><span data-stu-id="92e23-114">Stores performance information for software components.</span></span>  
  
 <xref:Microsoft.Win32.Registry.CurrentConfig>  
 <span data-ttu-id="92e23-115">では、ユーザー固有ではないハードウェア情報が保存されます。</span><span class="sxs-lookup"><span data-stu-id="92e23-115">Stores non-user-specific hardware information.</span></span>  
  
 <xref:Microsoft.Win32.Registry.DynData>  
 <span data-ttu-id="92e23-116">動的データを格納します。</span><span class="sxs-lookup"><span data-stu-id="92e23-116">Stores dynamic data.</span></span>  
  
 <span data-ttu-id="92e23-117">レジストリから情報を格納または取得するルートキーを特定したら、<xref:Microsoft.Win32.RegistryKey> クラスを使用して、サブキーを追加または削除したり、特定のキーの値を操作したりすることができます。</span><span class="sxs-lookup"><span data-stu-id="92e23-117">Once you have identified the root key under which you want to store/retrieve information from the registry, you can use the <xref:Microsoft.Win32.RegistryKey> class to add or remove subkeys, and manipulate the values for a given key.</span></span>  
  
 <span data-ttu-id="92e23-118">ハードウェアデバイスは、プラグアンドプレイインターフェイスを使用して、レジストリに情報を自動的に配置できます。</span><span class="sxs-lookup"><span data-stu-id="92e23-118">Hardware devices can place information in the registry automatically using the Plug and Play interface.</span></span> <span data-ttu-id="92e23-119">デバイスドライバーをインストールするためのソフトウェアでは、標準 Api に書き込むことによってレジストリに情報を配置できます。</span><span class="sxs-lookup"><span data-stu-id="92e23-119">Software for installing device drivers can place information in the registry by writing to standard APIs.</span></span>  
  
## <a name="static-methods-for-getting-and-setting-values"></a><span data-ttu-id="92e23-120">値を取得および設定するための静的メソッド</span><span class="sxs-lookup"><span data-stu-id="92e23-120">Static Methods for Getting and Setting Values</span></span>  
 <span data-ttu-id="92e23-121">.NET Framework バージョン2.0 では、<xref:Microsoft.Win32.Registry> クラスには、レジストリキーから値を設定および取得するための `static`<xref:Microsoft.Win32.Registry.GetValue%2A> および <xref:Microsoft.Win32.Registry.SetValue%2A> メソッドも含まれています。</span><span class="sxs-lookup"><span data-stu-id="92e23-121">In the .NET Framework version 2.0, the <xref:Microsoft.Win32.Registry> class also contains `static`<xref:Microsoft.Win32.Registry.GetValue%2A> and <xref:Microsoft.Win32.Registry.SetValue%2A> methods for setting and retrieving values from registry keys.</span></span> <span data-ttu-id="92e23-122">これらのメソッドは、使用されるたびにレジストリキーを開いて閉じます。そのため、多数の値にアクセスするときに、これらのメソッドは、<xref:Microsoft.Win32.RegistryKey> クラスの同様のメソッドを実行しません。</span><span class="sxs-lookup"><span data-stu-id="92e23-122">These methods open and close registry keys each time they are used, so they do not perform as well as analogous methods in the <xref:Microsoft.Win32.RegistryKey> class, when you access a large number of values.</span></span>  
  
 <span data-ttu-id="92e23-123"><xref:Microsoft.Win32.RegistryKey> クラスには、レジストリキーの Windows アクセス制御セキュリティを設定したり、値のデータ型を取得する前にテストしたり、キーを削除したりできるメソッドも用意されています。</span><span class="sxs-lookup"><span data-stu-id="92e23-123">The <xref:Microsoft.Win32.RegistryKey> class also provides methods that allow you to set Windows access control security for registry keys, to test the data type of a value before retrieving it, and to delete keys.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="92e23-124">このセクションには、2 つのコード例が含まれています。</span><span class="sxs-lookup"><span data-stu-id="92e23-124">This section contains two code examples.</span></span> <span data-ttu-id="92e23-125">最初の例は、ルートキーを示しています。2番目の例では、`static`<xref:Microsoft.Win32.Registry.GetValue%2A> メソッドと <xref:Microsoft.Win32.Registry.SetValue%2A> メソッドを示しています。</span><span class="sxs-lookup"><span data-stu-id="92e23-125">The first example demonstrates root keys, and the second example demonstrates the `static`<xref:Microsoft.Win32.Registry.GetValue%2A> and <xref:Microsoft.Win32.Registry.SetValue%2A> methods.</span></span>  
  
 <span data-ttu-id="92e23-126">例 1</span><span class="sxs-lookup"><span data-stu-id="92e23-126">Example 1</span></span>  
  
 <span data-ttu-id="92e23-127">次のコード例は、HKEY_USERS キーのサブキーを取得し、その名前を画面に出力する方法を示しています。</span><span class="sxs-lookup"><span data-stu-id="92e23-127">The following code example demonstrates how to retrieve the subkeys of the HKEY_USERS key, and print their names to the screen.</span></span> <span data-ttu-id="92e23-128"><xref:Microsoft.Win32.RegistryKey.OpenSubKey%2A> メソッドを使用して、対象となる特定のサブキーのインスタンスを作成します。</span><span class="sxs-lookup"><span data-stu-id="92e23-128">Use the <xref:Microsoft.Win32.RegistryKey.OpenSubKey%2A> method to create an instance of the particular subkey of interest.</span></span> <span data-ttu-id="92e23-129">その後、`RegistryKey` で他の操作を使用してそのキーを操作できます。</span><span class="sxs-lookup"><span data-stu-id="92e23-129">You can then use other operations in `RegistryKey` to manipulate that key.</span></span>  
  
 [!code-cpp[Classic Registry.Users Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic Registry.Users Example/CPP/source.cpp#1)]
 [!code-csharp[Classic Registry.Users Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic Registry.Users Example/CS/source.cs#1)]
 [!code-vb[Classic Registry.Users Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic Registry.Users Example/VB/source.vb#1)]  
  
 <span data-ttu-id="92e23-130">例 2</span><span class="sxs-lookup"><span data-stu-id="92e23-130">Example 2</span></span>  
  
 <span data-ttu-id="92e23-131">次のコード例では、複数のデータ型の値を例のキーに格納し、そのようなキーを作成して、値を取得して表示します。</span><span class="sxs-lookup"><span data-stu-id="92e23-131">The following code example stores values of several data types in an example key, creating the key as it does so, and then retrieves and displays the values.</span></span> <span data-ttu-id="92e23-132">この例では、既定の (名前のない) 名前と値のペアを格納して取得する方法と、名前と値のペアが存在しない場合に `defaultValue` を使用する方法を示します。</span><span class="sxs-lookup"><span data-stu-id="92e23-132">The example demonstrates storing and retrieving the default (nameless) name/value pair, and the use of `defaultValue` when a name/value pair does not exist.</span></span>  
  
 [!code-cpp[Microsoft.Win32.Registry.GetSet#1](~/samples/snippets/cpp/VS_Snippets_CLR/Microsoft.Win32.Registry.GetSet/CPP/source.cpp#1)]
 [!code-csharp[Microsoft.Win32.Registry.GetSet#1](~/samples/snippets/csharp/VS_Snippets_CLR/Microsoft.Win32.Registry.GetSet/CS/source.cs#1)]
 [!code-vb[Microsoft.Win32.Registry.GetSet#1](~/samples/snippets/visualbasic/VS_Snippets_CLR/Microsoft.Win32.Registry.GetSet/VB/source.vb#1)]  
  
 ]]></format>
    </remarks>
    <altmember cref="T:Microsoft.Win32.RegistryHive" />
    <altmember cref="T:Microsoft.Win32.RegistryKey" />
  </Docs>
  <Members>
    <Member MemberName="ClassesRoot">
      <MemberSignature Language="C#" Value="public static readonly Microsoft.Win32.RegistryKey ClassesRoot;" />
      <MemberSignature Language="ILAsm" Value=".field public static initonly class Microsoft.Win32.RegistryKey ClassesRoot" />
      <MemberSignature Language="DocId" Value="F:Microsoft.Win32.Registry.ClassesRoot" />
      <MemberSignature Language="VB.NET" Value="Public Shared ReadOnly ClassesRoot As RegistryKey " />
      <MemberSignature Language="C++ CLI" Value="public: static initonly Microsoft::Win32::RegistryKey ^ ClassesRoot;" />
      <MemberSignature Language="F#" Value=" staticval mutable ClassesRoot : Microsoft.Win32.RegistryKey" Usage="Microsoft.Win32.Registry.ClassesRoot" />
      <MemberType>Field</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.Win32.Registry</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.1.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.1.0</AssemblyVersion>
        <AssemblyVersion>4.1.2.0</AssemblyVersion>
        <AssemblyVersion>4.1.3.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>mscorlib</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>Microsoft.Win32.RegistryKey</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="92e23-133">ドキュメントの型 (またはクラス) と、これらの型に関連付けられるプロパティを定義します。</span><span class="sxs-lookup"><span data-stu-id="92e23-133">Defines the types (or classes) of documents and the properties associated with those types.</span></span> <span data-ttu-id="92e23-134">このフィールドには、Windows レジストリの基本キー HKEY_CLASSES_ROOT が読み込まれます。</span><span class="sxs-lookup"><span data-stu-id="92e23-134">This field reads the Windows registry base key HKEY_CLASSES_ROOT.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="92e23-135">従来のアプリケーションと OLE アプリケーションは、このキーの下に格納されているデータを使用します。</span><span class="sxs-lookup"><span data-stu-id="92e23-135">Both conventional applications and OLE applications use data that is stored under this key.</span></span> <span data-ttu-id="92e23-136">このキーは、DDE および OLE サポートの情報を格納することで、Windows 3.1 登録データベースとの下位互換性も提供します。</span><span class="sxs-lookup"><span data-stu-id="92e23-136">This key also provides backward compatibility with the Windows 3.1 registration database by storing information for DDE and OLE support.</span></span> <span data-ttu-id="92e23-137">ファイルビューアーとユーザーインターフェイス拡張では、OLE クラス識別子がこのキーに格納され、処理サーバーはこのキーに登録されます。</span><span class="sxs-lookup"><span data-stu-id="92e23-137">File viewers and user interface extensions store their OLE class identifiers in this key, and processing servers are registered in this key.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="92e23-138">次の例は、このキーのサブキーを取得し、その名前を画面に出力する方法を示しています。</span><span class="sxs-lookup"><span data-stu-id="92e23-138">The following example demonstrates how to retrieve the subkeys of this key, and prints their names to the screen.</span></span> <span data-ttu-id="92e23-139"><xref:Microsoft.Win32.RegistryKey.OpenSubKey%2A> メソッドを使用して、対象となる特定のサブキーのインスタンスを作成します。</span><span class="sxs-lookup"><span data-stu-id="92e23-139">Use the <xref:Microsoft.Win32.RegistryKey.OpenSubKey%2A> method to create an instance of the particular subkey of interest.</span></span> <span data-ttu-id="92e23-140">その後、<xref:Microsoft.Win32.RegistryKey> で他の操作を使用してそのキーを操作できます。</span><span class="sxs-lookup"><span data-stu-id="92e23-140">You can then use other operations in <xref:Microsoft.Win32.RegistryKey> to manipulate that key.</span></span>  
  
 [!code-cpp[Classic Registry.ClassesRoot Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic Registry.ClassesRoot Example/CPP/source.cpp#1)]
 [!code-csharp[Classic Registry.ClassesRoot Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic Registry.ClassesRoot Example/CS/source.cs#1)]
 [!code-vb[Classic Registry.ClassesRoot Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic Registry.ClassesRoot Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="CurrentConfig">
      <MemberSignature Language="C#" Value="public static readonly Microsoft.Win32.RegistryKey CurrentConfig;" />
      <MemberSignature Language="ILAsm" Value=".field public static initonly class Microsoft.Win32.RegistryKey CurrentConfig" />
      <MemberSignature Language="DocId" Value="F:Microsoft.Win32.Registry.CurrentConfig" />
      <MemberSignature Language="VB.NET" Value="Public Shared ReadOnly CurrentConfig As RegistryKey " />
      <MemberSignature Language="C++ CLI" Value="public: static initonly Microsoft::Win32::RegistryKey ^ CurrentConfig;" />
      <MemberSignature Language="F#" Value=" staticval mutable CurrentConfig : Microsoft.Win32.RegistryKey" Usage="Microsoft.Win32.Registry.CurrentConfig" />
      <MemberType>Field</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.Win32.Registry</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.1.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.1.0</AssemblyVersion>
        <AssemblyVersion>4.1.2.0</AssemblyVersion>
        <AssemblyVersion>4.1.3.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>mscorlib</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>Microsoft.Win32.RegistryKey</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="92e23-141">各ユーザーに共通のハードウェアに関する構成情報を格納します。</span><span class="sxs-lookup"><span data-stu-id="92e23-141">Contains configuration information pertaining to the hardware that is not specific to the user.</span></span> <span data-ttu-id="92e23-142">このフィールドには、Windows レジストリの基本キー HKEY_CURRENT_CONFIG が読み込まれます。</span><span class="sxs-lookup"><span data-stu-id="92e23-142">This field reads the Windows registry base key HKEY_CURRENT_CONFIG.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="92e23-143">このメンバーは <xref:Microsoft.Win32.Registry.LocalMachine>内のサブキーにマップされます。</span><span class="sxs-lookup"><span data-stu-id="92e23-143">This member is mapped to a subkey within <xref:Microsoft.Win32.Registry.LocalMachine>.</span></span>  
  
 <span data-ttu-id="92e23-144">このメンバーを使用する例として、システムがネットワークに接続されているかどうかによって、データに異なるサーバー名を格納するアプリケーションがあります。</span><span class="sxs-lookup"><span data-stu-id="92e23-144">An example of using this member is an application that stores a different server name for its data depending on whether the system is attached to a network.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="92e23-145">次の例は、このキーのサブキーを取得し、その名前を画面に出力する方法を示しています。</span><span class="sxs-lookup"><span data-stu-id="92e23-145">The following example demonstrates how to retrieve the subkeys of this key, and prints their names to the screen.</span></span> <span data-ttu-id="92e23-146"><xref:Microsoft.Win32.RegistryKey.OpenSubKey%2A> メソッドを使用して、対象となる特定のサブキーのインスタンスを作成します。</span><span class="sxs-lookup"><span data-stu-id="92e23-146">Use the <xref:Microsoft.Win32.RegistryKey.OpenSubKey%2A> method to create an instance of the particular subkey of interest.</span></span> <span data-ttu-id="92e23-147">その後、<xref:Microsoft.Win32.RegistryKey> で他の操作を使用してそのキーを操作できます。</span><span class="sxs-lookup"><span data-stu-id="92e23-147">You can then use other operations in <xref:Microsoft.Win32.RegistryKey> to manipulate that key.</span></span>  
  
 [!code-cpp[Classic Registry.CurrentConfig Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic Registry.CurrentConfig Example/CPP/source.cpp#1)]
 [!code-csharp[Classic Registry.CurrentConfig Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic Registry.CurrentConfig Example/CS/source.cs#1)]
 [!code-vb[Classic Registry.CurrentConfig Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic Registry.CurrentConfig Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="CurrentUser">
      <MemberSignature Language="C#" Value="public static readonly Microsoft.Win32.RegistryKey CurrentUser;" />
      <MemberSignature Language="ILAsm" Value=".field public static initonly class Microsoft.Win32.RegistryKey CurrentUser" />
      <MemberSignature Language="DocId" Value="F:Microsoft.Win32.Registry.CurrentUser" />
      <MemberSignature Language="VB.NET" Value="Public Shared ReadOnly CurrentUser As RegistryKey " />
      <MemberSignature Language="C++ CLI" Value="public: static initonly Microsoft::Win32::RegistryKey ^ CurrentUser;" />
      <MemberSignature Language="F#" Value=" staticval mutable CurrentUser : Microsoft.Win32.RegistryKey" Usage="Microsoft.Win32.Registry.CurrentUser" />
      <MemberType>Field</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.Win32.Registry</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.1.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.1.0</AssemblyVersion>
        <AssemblyVersion>4.1.2.0</AssemblyVersion>
        <AssemblyVersion>4.1.3.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>mscorlib</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>Microsoft.Win32.RegistryKey</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="92e23-148">現在のユーザー設定に関する情報が格納されます。</span><span class="sxs-lookup"><span data-stu-id="92e23-148">Contains information about the current user preferences.</span></span> <span data-ttu-id="92e23-149">このフィールドには、Windows レジストリの基本キー HKEY_CURRENT_USER が読み込まれます。</span><span class="sxs-lookup"><span data-stu-id="92e23-149">This field reads the Windows registry base key HKEY_CURRENT_USER.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="92e23-150">このキーに格納される情報には、環境変数の設定と、プログラムグループ、色、プリンター、ネットワーク接続、およびアプリケーションの設定に関するデータが含まれます。</span><span class="sxs-lookup"><span data-stu-id="92e23-150">Information stored in this key includes the settings of environment variables and data about program groups, colors, printers, network connections, and application preferences.</span></span> <span data-ttu-id="92e23-151">このキーを使用すると、現在のユーザーの設定を簡単に設定できます。</span><span class="sxs-lookup"><span data-stu-id="92e23-151">This key makes it easier to establish the current user's settings.</span></span> <span data-ttu-id="92e23-152">このキーでは、ソフトウェアベンダーは、アプリケーション内で使用される現在のユーザー固有の設定を格納します。</span><span class="sxs-lookup"><span data-stu-id="92e23-152">In this key, software vendors store the current user-specific preferences to be used within their applications.</span></span> <span data-ttu-id="92e23-153">たとえば、microsoft では、アプリケーションが使用するアプリケーションの HKEY_CURRENT_USER \Software\Microsoft キーを作成し、各アプリケーションで Microsoft キーの下に独自のサブキーを作成します。</span><span class="sxs-lookup"><span data-stu-id="92e23-153">Microsoft, for example, creates the HKEY_CURRENT_USER\Software\Microsoft key for its applications to use, with each application creating its own subkey under the Microsoft key.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="92e23-154">次の例は、このキーのサブキーを取得し、その名前を画面に出力する方法を示しています。</span><span class="sxs-lookup"><span data-stu-id="92e23-154">The following example demonstrates how to retrieve the subkeys of this key, and prints their names to the screen.</span></span> <span data-ttu-id="92e23-155"><xref:Microsoft.Win32.RegistryKey.OpenSubKey%2A> メソッドを使用して、対象となる特定のサブキーのインスタンスを作成します。</span><span class="sxs-lookup"><span data-stu-id="92e23-155">Use the <xref:Microsoft.Win32.RegistryKey.OpenSubKey%2A> method to create an instance of the particular subkey of interest.</span></span> <span data-ttu-id="92e23-156">その後、<xref:Microsoft.Win32.RegistryKey> で他の操作を使用してそのキーを操作できます。</span><span class="sxs-lookup"><span data-stu-id="92e23-156">You can then use other operations in <xref:Microsoft.Win32.RegistryKey> to manipulate that key.</span></span>  
  
 [!code-cpp[Classic Registry.CurrentUser Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic Registry.CurrentUser Example/CPP/source.cpp#1)]
 [!code-csharp[Classic Registry.CurrentUser Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic Registry.CurrentUser Example/CS/source.cs#1)]
 [!code-vb[Classic Registry.CurrentUser Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic Registry.CurrentUser Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="DynData">
      <MemberSignature Language="C#" Value="public static readonly Microsoft.Win32.RegistryKey DynData;" />
      <MemberSignature Language="ILAsm" Value=".field public static initonly class Microsoft.Win32.RegistryKey DynData" />
      <MemberSignature Language="DocId" Value="F:Microsoft.Win32.Registry.DynData" />
      <MemberSignature Language="VB.NET" Value="Public Shared ReadOnly DynData As RegistryKey " />
      <MemberSignature Language="C++ CLI" Value="public: static initonly Microsoft::Win32::RegistryKey ^ DynData;" />
      <MemberSignature Language="F#" Value=" staticval mutable DynData : Microsoft.Win32.RegistryKey" Usage="Microsoft.Win32.Registry.DynData" />
      <MemberType>Field</MemberType>
      <AssemblyInfo>
        <AssemblyName>mscorlib</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.Win32.Registry</AssemblyName>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="xamarinandroid-7.1;xamarinios-10.8;xamarinmac-3.0">
          <AttributeName>System.Obsolete("Use PerformanceData instead")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.Obsolete("The DynData registry key only works on Win9x, which is no longer supported by the CLR.  On NT-based operating systems, use the PerformanceData registry key instead.")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>Microsoft.Win32.RegistryKey</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="92e23-157">動的レジストリ データを格納します。</span><span class="sxs-lookup"><span data-stu-id="92e23-157">Contains dynamic registry data.</span></span> <span data-ttu-id="92e23-158">このフィールドには、Windows レジストリの基本キー HKEY_DYN_DATA が読み込まれます。</span><span class="sxs-lookup"><span data-stu-id="92e23-158">This field reads the Windows registry base key HKEY_DYN_DATA.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="92e23-159">Windows 98/Windows Me レジストリは、(レジストリのディスクに格納されている) 静的データと動的データ (パフォーマンス統計などの頻繁な変更) の両方をサポートしています。</span><span class="sxs-lookup"><span data-stu-id="92e23-159">The Windows 98/Windows Me registry supports both static data (which is stored on disk in the registry) and dynamic data (which changes frequently, such as performance statistics).</span></span> <span data-ttu-id="92e23-160">この動的データ領域は、仮想デバイスドライバー (Vxd) が、リモートおよびローカルで実行できる Win32 アプリケーションにリアルタイムのデータを提供できるようにするメカニズムです。</span><span class="sxs-lookup"><span data-stu-id="92e23-160">This dynamic data area is the mechanism that allows Virtual Device Drivers (VxDs) to provide real-time data to Win32 applications that can run remotely as well as locally.</span></span> <span data-ttu-id="92e23-161">また、システムモニターは、リモートの Windows 98/Windows Me システムに関するパフォーマンスの統計情報を提供することもできます。</span><span class="sxs-lookup"><span data-stu-id="92e23-161">It also allows the system monitor to provide performance statistics on remote Windows 98/Windows Me systems.</span></span>  
  
 <span data-ttu-id="92e23-162">Vxd は、パフォーマンスデータに限定されません。</span><span class="sxs-lookup"><span data-stu-id="92e23-162">VxDs are not limited to performance data.</span></span> <span data-ttu-id="92e23-163">CPU を占有することなく、リング0からリング3に効率的に渡す必要があるすべてのデータを提供できます。</span><span class="sxs-lookup"><span data-stu-id="92e23-163">They can provide any data they want to pass from Ring 0 to Ring 3 efficiently without monopolizing the CPU.</span></span> <span data-ttu-id="92e23-164">レジストリは、値 (または多くの値) を返す関数へのポインターを格納することによって、動的データをサポートします。</span><span class="sxs-lookup"><span data-stu-id="92e23-164">The registry supports dynamic data by storing a pointer to a function that returns a value (or many values).</span></span> <span data-ttu-id="92e23-165">レジストリ呼び出しによって動的キーに関連付けられた値が照会されると、その関数が呼び出され、目的の値が返されます。</span><span class="sxs-lookup"><span data-stu-id="92e23-165">When a Registry call queries values associated with a dynamic key, that function is called to return the desired value or values.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="92e23-166">動的キーは、動的なレジストリデータを処理するために Microsoft Windows 95 で導入されました。</span><span class="sxs-lookup"><span data-stu-id="92e23-166">Dynamic keys were introduced in Microsoft Windows 95 to handle dynamic Registry data.</span></span> <span data-ttu-id="92e23-167">Windows 98/Windows Me でのみサポートされています。</span><span class="sxs-lookup"><span data-stu-id="92e23-167">They are supported only in Windows 98/Windows Me.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="92e23-168">次の例は、このキーのサブキーを取得し、その名前を画面に出力する方法を示しています。</span><span class="sxs-lookup"><span data-stu-id="92e23-168">The following example demonstrates how to retrieve the subkeys of this key, and prints their names to the screen.</span></span> <span data-ttu-id="92e23-169"><xref:Microsoft.Win32.RegistryKey.OpenSubKey%2A> メソッドを使用して、対象となる特定のサブキーのインスタンスを作成します。</span><span class="sxs-lookup"><span data-stu-id="92e23-169">Use the <xref:Microsoft.Win32.RegistryKey.OpenSubKey%2A> method to create an instance of the particular subkey of interest.</span></span> <span data-ttu-id="92e23-170">その後、<xref:Microsoft.Win32.RegistryKey> で他の操作を使用してそのキーを操作できます。</span><span class="sxs-lookup"><span data-stu-id="92e23-170">You can then use other operations in <xref:Microsoft.Win32.RegistryKey> to manipulate that key.</span></span> <span data-ttu-id="92e23-171">この例では、動的データが使用できない可能性があるため、または Windows 98/ME を実行していない可能性があるため、結果が返されないことに注意してください。</span><span class="sxs-lookup"><span data-stu-id="92e23-171">Note that this example can return no results, since there might not be dynamic data available, or you might not be running Windows 98/ME.</span></span> <span data-ttu-id="92e23-172">このキーを使用すると、他のシステムでエラーが発生する可能性があります。</span><span class="sxs-lookup"><span data-stu-id="92e23-172">Using this key may cause an error on other systems.</span></span>  
  
 [!code-cpp[Classic Registry.DynData Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic Registry.DynData Example/CPP/source.cpp#1)]
 [!code-csharp[Classic Registry.DynData Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic Registry.DynData Example/CS/source.cs#1)]
 [!code-vb[Classic Registry.DynData Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic Registry.DynData Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ObjectDisposedException"><span data-ttu-id="92e23-173">そのオペレーティング システムは動的データをサポートしていません。つまり、それは Windows 98、Windows 98 Second Edition、または Windows Millennium Edition (Windows Me) ではありません。</span><span class="sxs-lookup"><span data-stu-id="92e23-173">The operating system does not support dynamic data; that is, it is not Windows 98, Windows 98 Second Edition, or Windows Millennium Edition (Windows Me).</span></span></exception>
      </Docs>
    </Member>
    <Member MemberName="GetValue">
      <MemberSignature Language="C#" Value="public static object GetValue (string keyName, string valueName, object defaultValue);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig object GetValue(string keyName, string valueName, object defaultValue) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.Win32.Registry.GetValue(System.String,System.String,System.Object)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetValue (keyName As String, valueName As String, defaultValue As Object) As Object" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::Object ^ GetValue(System::String ^ keyName, System::String ^ valueName, System::Object ^ defaultValue);" />
      <MemberSignature Language="F#" Value="static member GetValue : string * string * obj -&gt; obj" Usage="Microsoft.Win32.Registry.GetValue (keyName, valueName, defaultValue)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.Win32.Registry</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.1.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.1.0</AssemblyVersion>
        <AssemblyVersion>4.1.2.0</AssemblyVersion>
        <AssemblyVersion>4.1.3.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>mscorlib</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.Security.SecuritySafeCritical</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Object</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="keyName" Type="System.String" Index="0" FrameworkAlternate="dotnet-plat-ext-2.1;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0;dotnet-plat-ext-3.1;netcore-1.0;netcore-1.1;netcore-3.0;netcore-3.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8;xamarinandroid-7.1;xamarinios-10.8;xamarinmac-3.0" />
        <Parameter Name="valueName" Type="System.String" Index="1" FrameworkAlternate="dotnet-plat-ext-2.1;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0;dotnet-plat-ext-3.1;netcore-1.0;netcore-1.1;netcore-3.0;netcore-3.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8;xamarinandroid-7.1;xamarinios-10.8;xamarinmac-3.0" />
        <Parameter Name="defaultValue" Type="System.Object" Index="2" FrameworkAlternate="dotnet-plat-ext-2.1;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0;dotnet-plat-ext-3.1;netcore-1.0;netcore-1.1;netcore-3.0;netcore-3.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8;xamarinandroid-7.1;xamarinios-10.8;xamarinmac-3.0" />
      </Parameters>
      <Docs>
        <param name="keyName"><span data-ttu-id="92e23-174">有効なレジストリ ルート ("HKEY_CURRENT_USER" など) から始まるキーの完全なレジストリ パス。</span><span class="sxs-lookup"><span data-stu-id="92e23-174">The full registry path of the key, beginning with a valid registry root, such as "HKEY_CURRENT_USER".</span></span></param>
        <param name="valueName"><span data-ttu-id="92e23-175">名前/値ペアの名前。</span><span class="sxs-lookup"><span data-stu-id="92e23-175">The name of the name/value pair.</span></span></param>
        <param name="defaultValue"><span data-ttu-id="92e23-176"><paramref name="valueName" /> が存在しない場合に返す値。</span><span class="sxs-lookup"><span data-stu-id="92e23-176">The value to return if <paramref name="valueName" /> does not exist.</span></span></param>
        <summary><span data-ttu-id="92e23-177">指定したレジストリ キーに含まれる、指定した名前に関連付けられた値を取得します。</span><span class="sxs-lookup"><span data-stu-id="92e23-177">Retrieves the value associated with the specified name, in the specified registry key.</span></span> <span data-ttu-id="92e23-178">指定したキーに該当する名前が見つからない場合は、設定している既定値が返されます。指定したキーが存在しない場合は、<see langword="null" /> が返されます。</span><span class="sxs-lookup"><span data-stu-id="92e23-178">If the name is not found in the specified key, returns a default value that you provide, or <see langword="null" /> if the specified key does not exist.</span></span></summary>
        <returns><span data-ttu-id="92e23-179"><see langword="null" /> で指定したサブキーが存在しない場合は、<paramref name="keyName" />。それ以外の場合は、<paramref name="valueName" /> に関連付けられた値。<paramref name="defaultValue" /> が見つからない場合は、<paramref name="valueName" />。</span><span class="sxs-lookup"><span data-stu-id="92e23-179"><see langword="null" /> if the subkey specified by <paramref name="keyName" /> does not exist; otherwise, the value associated with <paramref name="valueName" />, or <paramref name="defaultValue" /> if <paramref name="valueName" /> is not found.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="92e23-180">文字列 `valueName` では、大文字と小文字は区別されません。</span><span class="sxs-lookup"><span data-stu-id="92e23-180">The string `valueName` is not case-sensitive.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="92e23-181">レジストリキーには、どの名前にも関連付けられていない1つの値を含めることができます。</span><span class="sxs-lookup"><span data-stu-id="92e23-181">A registry key can contain one value that is not associated with any name.</span></span> <span data-ttu-id="92e23-182">この名前のない値がレジストリエディターに表示されると、名前の代わりに "(既定値)" という文字列が表示されます。</span><span class="sxs-lookup"><span data-stu-id="92e23-182">When this unnamed value is displayed in the registry editor, the string "(Default)" appears instead of a name.</span></span> <span data-ttu-id="92e23-183">この名前のない値を取得するには、`valueName`に `null` または空の文字列 ("") を指定します。</span><span class="sxs-lookup"><span data-stu-id="92e23-183">To retrieve this unnamed value, specify either `null` or the empty string ("") for `valueName`.</span></span>  
  
 <span data-ttu-id="92e23-184">有効なルート名は、HKEY_CURRENT_USER、HKEY_LOCAL_MACHINE、HKEY_CLASSES_ROOT、HKEY_USERS、HKEY_PERFORMANCE_DATA、HKEY_CURRENT_CONFIG、および HKEY_DYN_DATA です。</span><span class="sxs-lookup"><span data-stu-id="92e23-184">Valid root names are HKEY_CURRENT_USER, HKEY_LOCAL_MACHINE, HKEY_CLASSES_ROOT, HKEY_USERS, HKEY_PERFORMANCE_DATA, HKEY_CURRENT_CONFIG, and HKEY_DYN_DATA.</span></span> <span data-ttu-id="92e23-185">たとえば Visual Basic 文字列 "HKEY_CURRENT_USER \MyTestKey" は、HKEY_CURRENT_USER ルート内のサブキー "MyTestKey" のキーと値のペアにアクセスします。</span><span class="sxs-lookup"><span data-stu-id="92e23-185">For example, in Visual Basic the string "HKEY_CURRENT_USER\MyTestKey" accesses key/value pairs for the subkey "MyTestKey" in the HKEY_CURRENT_USER root.</span></span>  
  
 <span data-ttu-id="92e23-186"><xref:Microsoft.Win32.RegistryKey.GetValue%2A> メソッドが展開可能な文字列値 (<xref:Microsoft.Win32.RegistryValueKind.ExpandString?displayProperty=nameWithType>) を取得すると、ローカル環境のデータを使用して環境文字列が拡張されます。</span><span class="sxs-lookup"><span data-stu-id="92e23-186">When the <xref:Microsoft.Win32.RegistryKey.GetValue%2A> method retrieves expandable string values (<xref:Microsoft.Win32.RegistryValueKind.ExpandString?displayProperty=nameWithType>), it expands environment strings using data from the local environment.</span></span> <span data-ttu-id="92e23-187">展開可能な文字列 (<xref:Microsoft.Win32.RegistryValueKind.ExpandString?displayProperty=nameWithType>) ではなく、環境変数への展開可能な参照を含む値が文字列 (<xref:Microsoft.Win32.RegistryValueKind.String?displayProperty=nameWithType>) として格納されている場合、<xref:Microsoft.Win32.RegistryKey.GetValue%2A> では展開されません。</span><span class="sxs-lookup"><span data-stu-id="92e23-187">If a value containing expandable references to environment variables has been stored as a string (<xref:Microsoft.Win32.RegistryValueKind.String?displayProperty=nameWithType>), rather than as an expandable string (<xref:Microsoft.Win32.RegistryValueKind.ExpandString?displayProperty=nameWithType>), <xref:Microsoft.Win32.RegistryKey.GetValue%2A> does not expand it.</span></span> <span data-ttu-id="92e23-188"><xref:System.Environment.ExpandEnvironmentVariables%2A?displayProperty=nameWithType> メソッドを呼び出すことによって、このような文字列を取得した後に展開できます。</span><span class="sxs-lookup"><span data-stu-id="92e23-188">You can expand such a string after it has been retrieved by calling the <xref:System.Environment.ExpandEnvironmentVariables%2A?displayProperty=nameWithType> method.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="92e23-189">HKEY_PERFORMANCE_DATA からデータを取得するには、<xref:Microsoft.Win32.RegistryKey.GetValue%2A?displayProperty=nameWithType> メソッドではなく <xref:System.Diagnostics.PerformanceCounter> クラスを使用することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="92e23-189">The recommended way to retrieve data from HKEY_PERFORMANCE_DATA is to use the <xref:System.Diagnostics.PerformanceCounter> class rather than the <xref:Microsoft.Win32.RegistryKey.GetValue%2A?displayProperty=nameWithType> method.</span></span>  
  
 <span data-ttu-id="92e23-190"><xref:Microsoft.Win32.Registry.GetValue%2A> メソッドと <xref:Microsoft.Win32.Registry.SetValue%2A> メソッドは、使用されるたびにレジストリキーを開いて閉じます。そのため、多数の値にアクセスした場合は、<xref:Microsoft.Win32.RegistryKey> クラスのメソッドと同様に実行されません。</span><span class="sxs-lookup"><span data-stu-id="92e23-190">The <xref:Microsoft.Win32.Registry.GetValue%2A> and <xref:Microsoft.Win32.Registry.SetValue%2A> methods open and close registry keys each time they are used, so they do not perform as well as the methods of the <xref:Microsoft.Win32.RegistryKey> class if you access a large number of values.</span></span>  
  
 <span data-ttu-id="92e23-191">また <xref:Microsoft.Win32.RegistryKey> には、レジストリキーにアクセス制御リスト (ACL) を追加したり、値のデータ型を取得する前にテストしたり、キーを削除したりできるメソッドも用意されています。</span><span class="sxs-lookup"><span data-stu-id="92e23-191"><xref:Microsoft.Win32.RegistryKey> also provides methods that allow you to add an access control list (ACL) to a registry key, to test the data type of a value before retrieving it, and to delete keys.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="92e23-192">次のコード例では、複数のデータ型の値を例のキーに格納し、そのようなキーを作成して、値を取得して表示します。</span><span class="sxs-lookup"><span data-stu-id="92e23-192">The following code example stores values of several data types in an example key, creating the key as it does so, and then retrieves and displays the values.</span></span> <span data-ttu-id="92e23-193">この例では、既定の (名前のない) 名前と値のペアを格納して取得する方法と、名前と値のペアが存在しない場合に `defaultValue` を使用する方法を示します。</span><span class="sxs-lookup"><span data-stu-id="92e23-193">The example demonstrates storing and retrieving the default (nameless) name/value pair, and the use of `defaultValue` when a name/value pair does not exist.</span></span>  
  
 [!code-cpp[Microsoft.Win32.Registry.GetSet#1](~/samples/snippets/cpp/VS_Snippets_CLR/Microsoft.Win32.Registry.GetSet/CPP/source.cpp#1)]
 [!code-csharp[Microsoft.Win32.Registry.GetSet#1](~/samples/snippets/csharp/VS_Snippets_CLR/Microsoft.Win32.Registry.GetSet/CS/source.cs#1)]
 [!code-vb[Microsoft.Win32.Registry.GetSet#1](~/samples/snippets/visualbasic/VS_Snippets_CLR/Microsoft.Win32.Registry.GetSet/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="92e23-194">ユーザーに、レジストリ キーからの読み取りに必要なアクセス許可がありません。</span><span class="sxs-lookup"><span data-stu-id="92e23-194">The user does not have the permissions required to read from the registry key.</span></span></exception>
        <exception cref="T:System.IO.IOException"><span data-ttu-id="92e23-195">指定された値を格納する <see cref="T:Microsoft.Win32.RegistryKey" /> は、削除対象としてマークされています。</span><span class="sxs-lookup"><span data-stu-id="92e23-195">The <see cref="T:Microsoft.Win32.RegistryKey" /> that contains the specified value has been marked for deletion.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="92e23-196"><paramref name="keyName" /> が有効なレジストリ ルートから始まっていません。</span><span class="sxs-lookup"><span data-stu-id="92e23-196"><paramref name="keyName" /> does not begin with a valid registry root.</span></span></exception>
        <permission cref="T:System.Security.Permissions.RegistryPermission"><span data-ttu-id="92e23-197">レジストリから読み取ります。</span><span class="sxs-lookup"><span data-stu-id="92e23-197">to read from the registry.</span></span> <span data-ttu-id="92e23-198">関連付けられた列挙型: <see cref="F:System.Security.Permissions.RegistryPermissionAccess.Read" /></span><span class="sxs-lookup"><span data-stu-id="92e23-198">Associated enumeration: <see cref="F:System.Security.Permissions.RegistryPermissionAccess.Read" /></span></span></permission>
        <permission cref="T:System.Security.Permissions.EnvironmentPermission"><span data-ttu-id="92e23-199">REG_EXPAND_SZ 型のレジストリキーを読み取るには</span><span class="sxs-lookup"><span data-stu-id="92e23-199">to read a registry key of type REG_EXPAND_SZ.</span></span> <span data-ttu-id="92e23-200">関連付けられた列挙型: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" /></span><span class="sxs-lookup"><span data-stu-id="92e23-200">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" /></span></span></permission>
      </Docs>
    </Member>
    <Member MemberName="LocalMachine">
      <MemberSignature Language="C#" Value="public static readonly Microsoft.Win32.RegistryKey LocalMachine;" />
      <MemberSignature Language="ILAsm" Value=".field public static initonly class Microsoft.Win32.RegistryKey LocalMachine" />
      <MemberSignature Language="DocId" Value="F:Microsoft.Win32.Registry.LocalMachine" />
      <MemberSignature Language="VB.NET" Value="Public Shared ReadOnly LocalMachine As RegistryKey " />
      <MemberSignature Language="C++ CLI" Value="public: static initonly Microsoft::Win32::RegistryKey ^ LocalMachine;" />
      <MemberSignature Language="F#" Value=" staticval mutable LocalMachine : Microsoft.Win32.RegistryKey" Usage="Microsoft.Win32.Registry.LocalMachine" />
      <MemberType>Field</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.Win32.Registry</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.1.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.1.0</AssemblyVersion>
        <AssemblyVersion>4.1.2.0</AssemblyVersion>
        <AssemblyVersion>4.1.3.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>mscorlib</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>Microsoft.Win32.RegistryKey</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="92e23-201">ローカル コンピューターの構成データが格納されます。</span><span class="sxs-lookup"><span data-stu-id="92e23-201">Contains the configuration data for the local machine.</span></span> <span data-ttu-id="92e23-202">このフィールドには、Windows レジストリの基本キー HKEY_LOCAL_MACHINE が読み込まれます。</span><span class="sxs-lookup"><span data-stu-id="92e23-202">This field reads the Windows registry base key HKEY_LOCAL_MACHINE.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="92e23-203">`LocalMachine` には、次の5つのキーが含まれます。</span><span class="sxs-lookup"><span data-stu-id="92e23-203">`LocalMachine` contains five keys:</span></span>  
  
 <span data-ttu-id="92e23-204">ハードウェア</span><span class="sxs-lookup"><span data-stu-id="92e23-204">Hardware</span></span>  
 <span data-ttu-id="92e23-205">コンピューターの物理ハードウェア、デバイスドライバーがそのハードウェアを使用する方法、およびカーネルモードドライバーとユーザーモードコードをリンクするマッピングと関連データについて説明します。</span><span class="sxs-lookup"><span data-stu-id="92e23-205">Describes the physical hardware in the computer, the way device drivers use that hardware, and mappings and related data that link kernel-mode drivers with user-mode code.</span></span> <span data-ttu-id="92e23-206">このキーのすべてのデータは、システムが起動されるたびに再作成されます。</span><span class="sxs-lookup"><span data-stu-id="92e23-206">All data in this key is recreated each time the system is started.</span></span> <span data-ttu-id="92e23-207">Description サブキーには、実際のコンピューターハードウェアが記述されています。</span><span class="sxs-lookup"><span data-stu-id="92e23-207">The Description subkey describes the actual computer hardware.</span></span> <span data-ttu-id="92e23-208">DeviceMap サブキーには、特定のクラスのドライバーに固有の形式のその他のデータが含まれています。</span><span class="sxs-lookup"><span data-stu-id="92e23-208">The DeviceMap subkey contains miscellaneous data in formats specific to particular classes of drivers.</span></span> <span data-ttu-id="92e23-209">ResourceMap サブキーは、どのデバイスドライバがどのハードウェアリソースを要求するかを示します。</span><span class="sxs-lookup"><span data-stu-id="92e23-209">The ResourceMap subkey describes which device drivers claim which hardware resources.</span></span> <span data-ttu-id="92e23-210">Windows NT 診断プログラム (Winmsdp .exe) は、読みやすい形式でコンテンツを報告できます。</span><span class="sxs-lookup"><span data-stu-id="92e23-210">The Windows NT Diagnostics program (Winmsdp.exe) can report on its contents in an easy-to-read form.</span></span>  
  
 <span data-ttu-id="92e23-211">SAM</span><span class="sxs-lookup"><span data-stu-id="92e23-211">SAM</span></span>  
 <span data-ttu-id="92e23-212">ユーザーアカウントとグループアカウントのセキュリティ情報のディレクトリサービスデータベース、および Windows 2000 Server のドメイン (SAM は、ディレクトリサービスデータベースと呼ばれるセキュリティアカウントマネージャー) です。</span><span class="sxs-lookup"><span data-stu-id="92e23-212">The directory services database of security information for user and group accounts, and for the domains in Windows 2000 Server (SAM is the Security Account Manager, known as the directory services database).</span></span>  
  
 <span data-ttu-id="92e23-213">セキュリティ</span><span class="sxs-lookup"><span data-stu-id="92e23-213">Security</span></span>  
 <span data-ttu-id="92e23-214">特定のユーザー権限などのローカルセキュリティポリシーが含まれます。</span><span class="sxs-lookup"><span data-stu-id="92e23-214">Contains the local security policy, such as specific user rights.</span></span> <span data-ttu-id="92e23-215">このキーは、Windows 2000 セキュリティサブシステムでのみ使用されます。</span><span class="sxs-lookup"><span data-stu-id="92e23-215">This key is used only by the Windows 2000 security subsystem.</span></span>  
  
 <span data-ttu-id="92e23-216">ソフトウェア</span><span class="sxs-lookup"><span data-stu-id="92e23-216">Software</span></span>  
 <span data-ttu-id="92e23-217">コンピューターごとのソフトウェアデータベース。</span><span class="sxs-lookup"><span data-stu-id="92e23-217">The per-computer software database.</span></span> <span data-ttu-id="92e23-218">このキーには、ローカルコンピューターにインストールされているソフトウェアに関するデータと、その他の構成データのさまざまな項目が含まれます。</span><span class="sxs-lookup"><span data-stu-id="92e23-218">This key contains data about software installed on the local computer, along with various items of miscellaneous configuration data.</span></span>  
  
 <span data-ttu-id="92e23-219">System</span><span class="sxs-lookup"><span data-stu-id="92e23-219">System</span></span>  
 <span data-ttu-id="92e23-220">システムのスタートアップ、デバイスドライバーの読み込み、Windows 2000 サービス、およびオペレーティングシステムの動作を制御します。</span><span class="sxs-lookup"><span data-stu-id="92e23-220">Controls system startup, device driver loading, Windows 2000 services, and operating system behavior.</span></span>  
  
 <span data-ttu-id="92e23-221">規則により、<xref:Microsoft.Win32.Registry.CurrentUser> の下に類似データが存在し、<xref:Microsoft.Win32.Registry.LocalMachine>の下にある場合、<xref:Microsoft.Win32.Registry.CurrentUser> 内のデータが優先されます。</span><span class="sxs-lookup"><span data-stu-id="92e23-221">By convention, if similar data exists under <xref:Microsoft.Win32.Registry.CurrentUser> and under <xref:Microsoft.Win32.Registry.LocalMachine>, the data in <xref:Microsoft.Win32.Registry.CurrentUser> takes precedence.</span></span> <span data-ttu-id="92e23-222">ただし、このキーの値は、レジストリ内のデータを (置き換えるのではなく) 拡張することもできます。</span><span class="sxs-lookup"><span data-stu-id="92e23-222">However, values in this key can also extend (rather than replace) data in Registry.LocalMachine.</span></span> <span data-ttu-id="92e23-223">また、一部の項目 (デバイスドライバーの読み込みエントリなど) は、レジストリの外部で発生した場合は無意味です。</span><span class="sxs-lookup"><span data-stu-id="92e23-223">Also, some items (such as device driver loading entries) are meaningless if they occur outside of Registry.LocalMachine.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="92e23-224">次の例は、このキーのサブキーを取得し、その名前を画面に出力する方法を示しています。</span><span class="sxs-lookup"><span data-stu-id="92e23-224">The following example demonstrates how to retrieve the subkeys of this key, and prints their names to the screen.</span></span> <span data-ttu-id="92e23-225"><xref:Microsoft.Win32.RegistryKey.OpenSubKey%2A> メソッドを使用して、対象となる特定のサブキーのインスタンスを作成します。</span><span class="sxs-lookup"><span data-stu-id="92e23-225">Use the <xref:Microsoft.Win32.RegistryKey.OpenSubKey%2A> method to create an instance of the particular subkey of interest.</span></span> <span data-ttu-id="92e23-226">その後、<xref:Microsoft.Win32.RegistryKey> で他の操作を使用してそのキーを操作できます。</span><span class="sxs-lookup"><span data-stu-id="92e23-226">You can then use other operations in <xref:Microsoft.Win32.RegistryKey> to manipulate that key.</span></span>  
  
 [!code-cpp[Classic Registry.LocalMachine Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic Registry.LocalMachine Example/CPP/source.cpp#1)]
 [!code-csharp[Classic Registry.LocalMachine Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic Registry.LocalMachine Example/CS/source.cs#1)]
 [!code-vb[Classic Registry.LocalMachine Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic Registry.LocalMachine Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="PerformanceData">
      <MemberSignature Language="C#" Value="public static readonly Microsoft.Win32.RegistryKey PerformanceData;" />
      <MemberSignature Language="ILAsm" Value=".field public static initonly class Microsoft.Win32.RegistryKey PerformanceData" />
      <MemberSignature Language="DocId" Value="F:Microsoft.Win32.Registry.PerformanceData" />
      <MemberSignature Language="VB.NET" Value="Public Shared ReadOnly PerformanceData As RegistryKey " />
      <MemberSignature Language="C++ CLI" Value="public: static initonly Microsoft::Win32::RegistryKey ^ PerformanceData;" />
      <MemberSignature Language="F#" Value=" staticval mutable PerformanceData : Microsoft.Win32.RegistryKey" Usage="Microsoft.Win32.Registry.PerformanceData" />
      <MemberType>Field</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.Win32.Registry</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.1.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.1.0</AssemblyVersion>
        <AssemblyVersion>4.1.2.0</AssemblyVersion>
        <AssemblyVersion>4.1.3.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>mscorlib</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>Microsoft.Win32.RegistryKey</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="92e23-227">ソフトウェア コンポーネントのパフォーマンス情報が含まれます。</span><span class="sxs-lookup"><span data-stu-id="92e23-227">Contains performance information for software components.</span></span> <span data-ttu-id="92e23-228">このフィールドには、Windows レジストリの基本キー HKEY_PERFORMANCE_DATA が読み込まれます。</span><span class="sxs-lookup"><span data-stu-id="92e23-228">This field reads the Windows registry base key HKEY_PERFORMANCE_DATA.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="92e23-229">各ソフトウェアコンポーネントは、オブジェクトのキー、インストールされたカウンターを作成し、実行中にカウンターデータを書き込みます。</span><span class="sxs-lookup"><span data-stu-id="92e23-229">Each software component creates keys for its objects, counters when it is installed, and writes counter data while it is executing.</span></span> <span data-ttu-id="92e23-230"><xref:Microsoft.Win32.RegistryKey> 関数を使用して、他のレジストリデータにアクセスする場合と同様に、このデータにアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="92e23-230">You can access this data as you would access any other registry data, using the <xref:Microsoft.Win32.RegistryKey> functions.</span></span>  
  
 <span data-ttu-id="92e23-231">レジストリを使用してパフォーマンスデータを収集する場合でも、データはレジストリデータベースに格納されません。</span><span class="sxs-lookup"><span data-stu-id="92e23-231">Although you use the registry to collect performance data, the data is not stored in the registry database.</span></span> <span data-ttu-id="92e23-232">代わりに、このキーを使用してレジストリにアクセスすると、システムによって、適切なシステムオブジェクトマネージャーからデータが収集されます。</span><span class="sxs-lookup"><span data-stu-id="92e23-232">Instead, accessing the registry with this key causes the system to collect the data from the appropriate system object managers.</span></span>  
  
 <span data-ttu-id="92e23-233">ローカルシステムからパフォーマンスデータを取得するには、<xref:Microsoft.Win32.RegistryKey.GetValue%2A> メソッドを使用して、レジストリの... を使用します。</span><span class="sxs-lookup"><span data-stu-id="92e23-233">To obtain performance data from the local system, use the <xref:Microsoft.Win32.RegistryKey.GetValue%2A> method, with the Registry.PerformanceData key.</span></span> <span data-ttu-id="92e23-234">最初の呼び出しでは、キーが開きます (最初にキーを明示的に開く必要はありません)。</span><span class="sxs-lookup"><span data-stu-id="92e23-234">The first call opens the key (you do not need to explicitly open the key first).</span></span> <span data-ttu-id="92e23-235">ただし、パフォーマンスデータの取得が完了したら、<xref:Microsoft.Win32.RegistryKey.Close%2A> メソッドを使用してキーへのハンドルを閉じるようにしてください。</span><span class="sxs-lookup"><span data-stu-id="92e23-235">However, be sure to use the <xref:Microsoft.Win32.RegistryKey.Close%2A> method to close the handle to the key when you are finished obtaining performance data.</span></span> <span data-ttu-id="92e23-236">ユーザーは、パフォーマンスデータの使用中にソフトウェアコンポーネントをインストールまたは削除することはできません。</span><span class="sxs-lookup"><span data-stu-id="92e23-236">The user cannot install or remove a software component while its performance data is in use.</span></span>  
  
 <span data-ttu-id="92e23-237">リモートシステムからパフォーマンスデータを取得するには、<xref:Microsoft.Win32.RegistryKey.OpenRemoteBaseKey%2A> メソッドを使用する必要があります。この方法では、リモートシステムのコンピューター名と、を使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="92e23-237">To obtain performance data from a remote system, you must use the <xref:Microsoft.Win32.RegistryKey.OpenRemoteBaseKey%2A> method, with the computer name of the remote system and the Registry.PerformanceData key.</span></span> <span data-ttu-id="92e23-238">この呼び出しは、リモートシステムのパフォーマンスデータを表すキーを取得します。</span><span class="sxs-lookup"><span data-stu-id="92e23-238">This call retrieves a key representing the performance data for the remote system.</span></span> <span data-ttu-id="92e23-239">データを取得するには、このキーを使用して <xref:Microsoft.Win32.RegistryKey.GetValue%2A> を呼び出します。このキーは、レジストリの.......</span><span class="sxs-lookup"><span data-stu-id="92e23-239">To retrieve the data, call <xref:Microsoft.Win32.RegistryKey.GetValue%2A> using this key, rather than the Registry.PerformanceData key.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="92e23-240">Windows Server 2003 では、ユーザーがこの基本キーのサブキーにアクセスするには、少なくとも Performance Monitor Users グループに属している必要があります。</span><span class="sxs-lookup"><span data-stu-id="92e23-240">On Windows Server 2003, a user must at least belong to the Performance Monitor Users group in order to access subkeys of this base key.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="92e23-241">次の例は、このキーのサブキーを取得し、その名前を画面に出力する方法を示しています。</span><span class="sxs-lookup"><span data-stu-id="92e23-241">The following example demonstrates how to retrieve the subkeys of this key, and prints their names to the screen.</span></span> <span data-ttu-id="92e23-242"><xref:Microsoft.Win32.RegistryKey.OpenSubKey%2A> メソッドを使用して、対象となる特定のサブキーのインスタンスを作成します。</span><span class="sxs-lookup"><span data-stu-id="92e23-242">Use the <xref:Microsoft.Win32.RegistryKey.OpenSubKey%2A> method to create an instance of the particular subkey of interest.</span></span> <span data-ttu-id="92e23-243">その後、<xref:Microsoft.Win32.RegistryKey> で他の操作を使用してそのキーを操作できます。</span><span class="sxs-lookup"><span data-stu-id="92e23-243">You can then use other operations in <xref:Microsoft.Win32.RegistryKey> to manipulate that key.</span></span> <span data-ttu-id="92e23-244">この例では、パフォーマンスデータが存在しない可能性があるため、多くの場合、結果が返されないことに注意してください。</span><span class="sxs-lookup"><span data-stu-id="92e23-244">Note that this example can often return no results, since there might be no performance data.</span></span>  
  
 [!code-cpp[Classic Registry.PerformanceData Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic Registry.PerformanceData Example/CPP/source.cpp#1)]
 [!code-csharp[Classic Registry.PerformanceData Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic Registry.PerformanceData Example/CS/source.cs#1)]
 [!code-vb[Classic Registry.PerformanceData Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic Registry.PerformanceData Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <MemberGroup MemberName="SetValue">
      <AssemblyInfo>
        <AssemblyName>Microsoft.Win32.Registry</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="92e23-245">レジストリ キーに名前/値ペアの値を設定します。</span><span class="sxs-lookup"><span data-stu-id="92e23-245">Sets the value of a name/value pair in a registry key.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Examples  
 <span data-ttu-id="92e23-246">次のコード例では、複数のデータ型の値を例のキーに格納し、そのようなキーを作成して、値を取得して表示します。</span><span class="sxs-lookup"><span data-stu-id="92e23-246">The following code example stores values of several data types in an example key, creating the key as it does so, and then retrieves and displays the values.</span></span> <span data-ttu-id="92e23-247">この例では、既定の (名前のない) 名前と値のペアを格納して取得する方法と、名前と値のペアが存在しない場合に `defaultValue` を使用する方法を示します。</span><span class="sxs-lookup"><span data-stu-id="92e23-247">The example demonstrates storing and retrieving the default (nameless) name/value pair, and the use of `defaultValue` when a name/value pair does not exist.</span></span>  
  
 [!code-cpp[Microsoft.Win32.Registry.GetSet#1](~/samples/snippets/cpp/VS_Snippets_CLR/Microsoft.Win32.Registry.GetSet/CPP/source.cpp#1)]
 [!code-csharp[Microsoft.Win32.Registry.GetSet#1](~/samples/snippets/csharp/VS_Snippets_CLR/Microsoft.Win32.Registry.GetSet/CS/source.cs#1)]
 [!code-vb[Microsoft.Win32.Registry.GetSet#1](~/samples/snippets/visualbasic/VS_Snippets_CLR/Microsoft.Win32.Registry.GetSet/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </MemberGroup>
    <Member MemberName="SetValue">
      <MemberSignature Language="C#" Value="public static void SetValue (string keyName, string valueName, object value);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void SetValue(string keyName, string valueName, object value) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.Win32.Registry.SetValue(System.String,System.String,System.Object)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub SetValue (keyName As String, valueName As String, value As Object)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void SetValue(System::String ^ keyName, System::String ^ valueName, System::Object ^ value);" />
      <MemberSignature Language="F#" Value="static member SetValue : string * string * obj -&gt; unit" Usage="Microsoft.Win32.Registry.SetValue (keyName, valueName, value)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.Win32.Registry</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.1.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.1.0</AssemblyVersion>
        <AssemblyVersion>4.1.2.0</AssemblyVersion>
        <AssemblyVersion>4.1.3.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>mscorlib</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Security.SecuritySafeCritical</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="keyName" Type="System.String" Index="0" FrameworkAlternate="dotnet-plat-ext-2.1;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0;dotnet-plat-ext-3.1;netcore-1.0;netcore-1.1;netcore-3.0;netcore-3.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8;xamarinandroid-7.1;xamarinios-10.8;xamarinmac-3.0" />
        <Parameter Name="valueName" Type="System.String" Index="1" FrameworkAlternate="dotnet-plat-ext-2.1;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0;dotnet-plat-ext-3.1;netcore-1.0;netcore-1.1;netcore-3.0;netcore-3.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8;xamarinandroid-7.1;xamarinios-10.8;xamarinmac-3.0" />
        <Parameter Name="value" Type="System.Object" Index="2" FrameworkAlternate="dotnet-plat-ext-2.1;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0;dotnet-plat-ext-3.1;netcore-1.0;netcore-1.1;netcore-3.0;netcore-3.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8;xamarinandroid-7.1;xamarinios-10.8;xamarinmac-3.0" />
      </Parameters>
      <Docs>
        <param name="keyName"><span data-ttu-id="92e23-248">有効なレジストリ ルート ("HKEY_CURRENT_USER" など) から始まるキーの完全なレジストリ パス。</span><span class="sxs-lookup"><span data-stu-id="92e23-248">The full registry path of the key, beginning with a valid registry root, such as "HKEY_CURRENT_USER".</span></span></param>
        <param name="valueName"><span data-ttu-id="92e23-249">名前/値ペアの名前。</span><span class="sxs-lookup"><span data-stu-id="92e23-249">The name of the name/value pair.</span></span></param>
        <param name="value"><span data-ttu-id="92e23-250">格納される値。</span><span class="sxs-lookup"><span data-stu-id="92e23-250">The value to be stored.</span></span></param>
        <summary><span data-ttu-id="92e23-251">指定したレジストリ キーに、指定した名前/値ペアを設定します。</span><span class="sxs-lookup"><span data-stu-id="92e23-251">Sets the specified name/value pair on the specified registry key.</span></span> <span data-ttu-id="92e23-252">指定したキーが存在しない場合は、キーが作成されます。</span><span class="sxs-lookup"><span data-stu-id="92e23-252">If the specified key does not exist, it is created.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="92e23-253">[!INCLUDE[net_v40_long](~/includes/net-v40-long-md.md)]以降では、`valueName` パラメーターは最大255文字に制限されなくなりました。ただし、`keyName` パラメーターには引き続き255文字の制限があります。</span><span class="sxs-lookup"><span data-stu-id="92e23-253">Starting with the [!INCLUDE[net_v40_long](~/includes/net-v40-long-md.md)], the `valueName` parameter is no longer restricted to a maximum of 255 characters; however, the `keyName` parameter continues to have the 255-character restriction.</span></span>  
  
 <span data-ttu-id="92e23-254">レジストリ内の各キーには多くの値を格納できるため、`valueName` パラメーターを使用して、設定する特定の値を指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="92e23-254">Because many values can be stored in each key in the registry, you must use the `valueName` parameter to specify the particular value you want to set.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="92e23-255">レジストリキーには、どの名前にも関連付けられていない1つの値を含めることができます。</span><span class="sxs-lookup"><span data-stu-id="92e23-255">A registry key can contain one value that is not associated with any name.</span></span> <span data-ttu-id="92e23-256">この名前のない値がレジストリエディターに表示されると、名前の代わりに "(既定値)" という文字列が表示されます。</span><span class="sxs-lookup"><span data-stu-id="92e23-256">When this unnamed value is displayed in the registry editor, the string "(Default)" appears instead of a name.</span></span> <span data-ttu-id="92e23-257">この名前のない値を設定するには、`valueName`に `null` または空の文字列 ("") を指定します。</span><span class="sxs-lookup"><span data-stu-id="92e23-257">To set this unnamed value, specify either `null` or the empty string ("") for `valueName`.</span></span>  
  
 <span data-ttu-id="92e23-258">キーに `valueName` が存在しない場合は、作成され、関連付けられている値は `value`に設定されます。</span><span class="sxs-lookup"><span data-stu-id="92e23-258">If `valueName` does not exist in the key, it is created and the associated value is set to `value`.</span></span>  
  
 <span data-ttu-id="92e23-259">`keyName` が存在しないサブキーを指定した場合は、指定されたルートにサブキーが作成されます。</span><span class="sxs-lookup"><span data-stu-id="92e23-259">If `keyName` specifies a subkey that does not exist, the subkey is created in the specified root.</span></span> <span data-ttu-id="92e23-260">たとえば Visual Basic 文字列 "HKEY_CURRENT_USER \MyTestKey" では、HKEY_CURRENT_USER ルートにサブキー "MyTestKey" が作成されます。</span><span class="sxs-lookup"><span data-stu-id="92e23-260">For example, in Visual Basic the string "HKEY_CURRENT_USER\MyTestKey" creates the subkey "MyTestKey" in the HKEY_CURRENT_USER root.</span></span> <span data-ttu-id="92e23-261">"HKEY_CURRENT_USER \MyTestKey\Key2\Key3" という文字列は、入れ子になったサブキー "MyTestKey"、"MyTestKey\Key2"、および "MyTestKey\Key2\Key3" を作成します。</span><span class="sxs-lookup"><span data-stu-id="92e23-261">The string "HKEY_CURRENT_USER\MyTestKey\Key2\Key3" creates the nested subkeys "MyTestKey", "MyTestKey\Key2", and "MyTestKey\Key2\Key3".</span></span>  
  
 <span data-ttu-id="92e23-262">有効なルート名には、HKEY_CURRENT_USER、HKEY_LOCAL_MACHINE、HKEY_CLASSES_ROOT、HKEY_USERS、HKEY_PERFORMANCE_DATA、HKEY_CURRENT_CONFIG、HKEY_DYN_DATA があります。</span><span class="sxs-lookup"><span data-stu-id="92e23-262">Valid root names include HKEY_CURRENT_USER, HKEY_LOCAL_MACHINE, HKEY_CLASSES_ROOT, HKEY_USERS, HKEY_PERFORMANCE_DATA, HKEY_CURRENT_CONFIG, and HKEY_DYN_DATA.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="92e23-263"><xref:Microsoft.Win32.Registry.SetValue%2A> メソッドは、レジストリキーを開き、値を設定して、呼び出されるたびにキーを閉じます。</span><span class="sxs-lookup"><span data-stu-id="92e23-263">The <xref:Microsoft.Win32.Registry.SetValue%2A> method opens a registry key, sets the value, and closes the key each time it is called.</span></span> <span data-ttu-id="92e23-264">多くの値を変更する必要がある場合は、<xref:Microsoft.Win32.RegistryKey.SetValue%2A?displayProperty=nameWithType> 方法でパフォーマンスが向上する可能性があります。</span><span class="sxs-lookup"><span data-stu-id="92e23-264">If you need to modify a large number of values, the <xref:Microsoft.Win32.RegistryKey.SetValue%2A?displayProperty=nameWithType> method might provide better performance.</span></span> <span data-ttu-id="92e23-265"><xref:Microsoft.Win32.RegistryKey> クラスには、レジストリキーにアクセス制御リスト (ACL) を追加したり、値のデータ型を取得する前にテストしたり、キーを削除したりできるメソッドも用意されています。</span><span class="sxs-lookup"><span data-stu-id="92e23-265">The <xref:Microsoft.Win32.RegistryKey> class also provides methods that allow you to add an access control list (ACL) to a registry key, to test the data type of a value before retrieving it, and to delete keys.</span></span>  
  
 <span data-ttu-id="92e23-266">この <xref:Microsoft.Win32.Registry.SetValue%2A> のオーバーロードでは、64ビットの整数が文字列 (<xref:Microsoft.Win32.RegistryValueKind.String?displayProperty=nameWithType>) として格納されます。</span><span class="sxs-lookup"><span data-stu-id="92e23-266">This overload of <xref:Microsoft.Win32.Registry.SetValue%2A> stores 64-bit integers as strings (<xref:Microsoft.Win32.RegistryValueKind.String?displayProperty=nameWithType>).</span></span> <span data-ttu-id="92e23-267"><xref:Microsoft.Win32.RegistryValueKind.QWord?displayProperty=nameWithType> 値として64ビット数値を格納するには、<xref:Microsoft.Win32.Registry.SetValue%28System.String%2CSystem.String%2CSystem.Object%2CMicrosoft.Win32.RegistryValueKind%29> メソッドオーバーロードを使用します。</span><span class="sxs-lookup"><span data-stu-id="92e23-267">To store 64-bit numbers as <xref:Microsoft.Win32.RegistryValueKind.QWord?displayProperty=nameWithType> values, use the <xref:Microsoft.Win32.Registry.SetValue%28System.String%2CSystem.String%2CSystem.Object%2CMicrosoft.Win32.RegistryValueKind%29> method overload.</span></span>  
  
 <span data-ttu-id="92e23-268"><xref:Microsoft.Win32.Registry.SetValue%2A> のこのオーバーロードは、環境変数への展開可能な参照が含まれている場合でも、すべての文字列値を <xref:Microsoft.Win32.RegistryValueKind.String?displayProperty=nameWithType> オブジェクトとして格納します。</span><span class="sxs-lookup"><span data-stu-id="92e23-268">This overload of <xref:Microsoft.Win32.Registry.SetValue%2A> stores all string values as <xref:Microsoft.Win32.RegistryValueKind.String?displayProperty=nameWithType> objects, even if they contain expandable references to environment variables.</span></span> <span data-ttu-id="92e23-269">文字列値を展開可能な文字列 (<xref:Microsoft.Win32.RegistryValueKind.ExpandString?displayProperty=nameWithType>) として保存するには、<xref:Microsoft.Win32.Registry.SetValue%28System.String%2CSystem.String%2CSystem.Object%2CMicrosoft.Win32.RegistryValueKind%29> メソッドオーバーロードを使用します。</span><span class="sxs-lookup"><span data-stu-id="92e23-269">To save string values as expandable strings (<xref:Microsoft.Win32.RegistryValueKind.ExpandString?displayProperty=nameWithType>), use the <xref:Microsoft.Win32.Registry.SetValue%28System.String%2CSystem.String%2CSystem.Object%2CMicrosoft.Win32.RegistryValueKind%29> method overload.</span></span>  
  
 <span data-ttu-id="92e23-270">このオーバーロードは、<xref:Microsoft.Win32.RegistryValueKind.Unknown?displayProperty=nameWithType>を使用して <xref:Microsoft.Win32.Registry.SetValue%28System.String%2CSystem.String%2CSystem.Object%2CMicrosoft.Win32.RegistryValueKind%29> メソッドのオーバーロードを呼び出すことと同じです。</span><span class="sxs-lookup"><span data-stu-id="92e23-270">This overload is equivalent to calling the <xref:Microsoft.Win32.Registry.SetValue%28System.String%2CSystem.String%2CSystem.Object%2CMicrosoft.Win32.RegistryValueKind%29> method overload with <xref:Microsoft.Win32.RegistryValueKind.Unknown?displayProperty=nameWithType>.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="92e23-271">Windows 98 および Windows Millennium Edition (Windows Me) では、レジストリは Unicode ではなく、すべての Unicode 文字がすべてのコードページで有効であるとは限りません。</span><span class="sxs-lookup"><span data-stu-id="92e23-271">On Windows 98 and Windows Millennium Edition (Windows Me), the registry is not Unicode, and not all Unicode characters are valid for all code pages.</span></span> <span data-ttu-id="92e23-272">現在のコードページに対して無効な Unicode 文字が、使用できる最適な一致に置き換えられます。</span><span class="sxs-lookup"><span data-stu-id="92e23-272">A Unicode character that is invalid for the current code page is replaced by the best available match.</span></span> <span data-ttu-id="92e23-273">例外をスローすることはありません。</span><span class="sxs-lookup"><span data-stu-id="92e23-273">No exception is thrown.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="92e23-274">次のコード例では、複数のデータ型の値を例のキーに格納し、そのようなキーを作成して、値を取得して表示します。</span><span class="sxs-lookup"><span data-stu-id="92e23-274">The following code example stores values of several data types in an example key, creating the key as it does so, and then retrieves and displays the values.</span></span> <span data-ttu-id="92e23-275">この例では、既定の (名前のない) 名前と値のペアを格納して取得する方法と、名前と値のペアが存在しない場合に `defaultValue` を使用する方法を示します。</span><span class="sxs-lookup"><span data-stu-id="92e23-275">The example demonstrates storing and retrieving the default (nameless) name/value pair, and the use of `defaultValue` when a name/value pair does not exist.</span></span>  
  
 [!code-cpp[Microsoft.Win32.Registry.GetSet#1](~/samples/snippets/cpp/VS_Snippets_CLR/Microsoft.Win32.Registry.GetSet/CPP/source.cpp#1)]
 [!code-csharp[Microsoft.Win32.Registry.GetSet#1](~/samples/snippets/csharp/VS_Snippets_CLR/Microsoft.Win32.Registry.GetSet/CS/source.cs#1)]
 [!code-vb[Microsoft.Win32.Registry.GetSet#1](~/samples/snippets/visualbasic/VS_Snippets_CLR/Microsoft.Win32.Registry.GetSet/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="92e23-276"><paramref name="value" /> は <see langword="null" /> です。</span><span class="sxs-lookup"><span data-stu-id="92e23-276"><paramref name="value" /> is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="92e23-277"><paramref name="keyName" /> が有効なレジストリ ルートから始まっていません。</span><span class="sxs-lookup"><span data-stu-id="92e23-277"><paramref name="keyName" /> does not begin with a valid registry root.</span></span>  
  
<span data-ttu-id="92e23-278">または</span><span class="sxs-lookup"><span data-stu-id="92e23-278">-or-</span></span> 
 <span data-ttu-id="92e23-279"><paramref name="keyName" /> が許容される最大長 (255 文字) を超えています。</span><span class="sxs-lookup"><span data-stu-id="92e23-279"><paramref name="keyName" /> is longer than the maximum length allowed (255 characters).</span></span></exception>
        <exception cref="T:System.UnauthorizedAccessException"><span data-ttu-id="92e23-280"><see cref="T:Microsoft.Win32.RegistryKey" /> が読み取り専用であるため、このキーに書き込むことはできません。たとえば、ルートレベル ノードの場合などです。</span><span class="sxs-lookup"><span data-stu-id="92e23-280">The <see cref="T:Microsoft.Win32.RegistryKey" /> is read-only, and thus cannot be written to; for example, it is a root-level node.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="92e23-281">ユーザーに、レジストリ キーの作成または変更に必要なアクセス許可がありません。</span><span class="sxs-lookup"><span data-stu-id="92e23-281">The user does not have the permissions required to create or modify registry keys.</span></span></exception>
        <permission cref="T:System.Security.Permissions.RegistryPermission"><span data-ttu-id="92e23-282">指定したレジストリキーが存在する場合にそのキーを変更する場合は。存在しない場合はレジストリキーを作成する場合は。</span><span class="sxs-lookup"><span data-stu-id="92e23-282">to modify the specified registry key if it exists, or to create the registry key if it does not already exist.</span></span> <span data-ttu-id="92e23-283">関連付けられた列挙型: <see cref="F:System.Security.Permissions.RegistryPermissionAccess.Write" />、<see cref="F:System.Security.Permissions.RegistryPermissionAccess.Create" /></span><span class="sxs-lookup"><span data-stu-id="92e23-283">Associated enumerations: <see cref="F:System.Security.Permissions.RegistryPermissionAccess.Write" />, <see cref="F:System.Security.Permissions.RegistryPermissionAccess.Create" /></span></span></permission>
      </Docs>
    </Member>
    <Member MemberName="SetValue">
      <MemberSignature Language="C#" Value="public static void SetValue (string keyName, string valueName, object value, Microsoft.Win32.RegistryValueKind valueKind);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void SetValue(string keyName, string valueName, object value, valuetype Microsoft.Win32.RegistryValueKind valueKind) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.Win32.Registry.SetValue(System.String,System.String,System.Object,Microsoft.Win32.RegistryValueKind)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub SetValue (keyName As String, valueName As String, value As Object, valueKind As RegistryValueKind)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void SetValue(System::String ^ keyName, System::String ^ valueName, System::Object ^ value, Microsoft::Win32::RegistryValueKind valueKind);" />
      <MemberSignature Language="F#" Value="static member SetValue : string * string * obj * Microsoft.Win32.RegistryValueKind -&gt; unit" Usage="Microsoft.Win32.Registry.SetValue (keyName, valueName, value, valueKind)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.Win32.Registry</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.1.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.1.0</AssemblyVersion>
        <AssemblyVersion>4.1.2.0</AssemblyVersion>
        <AssemblyVersion>4.1.3.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>mscorlib</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.Security.SecuritySafeCritical</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="keyName" Type="System.String" Index="0" FrameworkAlternate="dotnet-plat-ext-2.1;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0;dotnet-plat-ext-3.1;netcore-1.0;netcore-1.1;netcore-3.0;netcore-3.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8;xamarinandroid-7.1;xamarinios-10.8;xamarinmac-3.0" />
        <Parameter Name="valueName" Type="System.String" Index="1" FrameworkAlternate="dotnet-plat-ext-2.1;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0;dotnet-plat-ext-3.1;netcore-1.0;netcore-1.1;netcore-3.0;netcore-3.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8;xamarinandroid-7.1;xamarinios-10.8;xamarinmac-3.0" />
        <Parameter Name="value" Type="System.Object" Index="2" FrameworkAlternate="dotnet-plat-ext-2.1;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0;dotnet-plat-ext-3.1;netcore-1.0;netcore-1.1;netcore-3.0;netcore-3.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8;xamarinandroid-7.1;xamarinios-10.8;xamarinmac-3.0" />
        <Parameter Name="valueKind" Type="Microsoft.Win32.RegistryValueKind" Index="3" FrameworkAlternate="dotnet-plat-ext-2.1;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0;dotnet-plat-ext-3.1;netcore-1.0;netcore-1.1;netcore-3.0;netcore-3.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8;xamarinandroid-7.1;xamarinios-10.8;xamarinmac-3.0" />
      </Parameters>
      <Docs>
        <param name="keyName"><span data-ttu-id="92e23-284">有効なレジストリ ルート ("HKEY_CURRENT_USER" など) から始まるキーの完全なレジストリ パス。</span><span class="sxs-lookup"><span data-stu-id="92e23-284">The full registry path of the key, beginning with a valid registry root, such as "HKEY_CURRENT_USER".</span></span></param>
        <param name="valueName"><span data-ttu-id="92e23-285">名前/値ペアの名前。</span><span class="sxs-lookup"><span data-stu-id="92e23-285">The name of the name/value pair.</span></span></param>
        <param name="value"><span data-ttu-id="92e23-286">格納される値。</span><span class="sxs-lookup"><span data-stu-id="92e23-286">The value to be stored.</span></span></param>
        <param name="valueKind"><span data-ttu-id="92e23-287">データを格納する際に使用するレジストリ データ型。</span><span class="sxs-lookup"><span data-stu-id="92e23-287">The registry data type to use when storing the data.</span></span></param>
        <summary><span data-ttu-id="92e23-288">指定したレジストリ データ型を使用して、指定したレジストリ キーに名前/値ペアを設定します。</span><span class="sxs-lookup"><span data-stu-id="92e23-288">Sets the name/value pair on the specified registry key, using the specified registry data type.</span></span> <span data-ttu-id="92e23-289">指定したキーが存在しない場合は、キーが作成されます。</span><span class="sxs-lookup"><span data-stu-id="92e23-289">If the specified key does not exist, it is created.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="92e23-290">[!INCLUDE[net_v40_long](~/includes/net-v40-long-md.md)]以降では、`valueName` パラメーターは最大255文字に制限されなくなりました。ただし、`keyName` パラメーターには255文字の制限があります。</span><span class="sxs-lookup"><span data-stu-id="92e23-290">Starting with the [!INCLUDE[net_v40_long](~/includes/net-v40-long-md.md)], the `valueName` parameter is no longer restricted to a maximum of 255 characters; however, the `keyName` parameter continues have the 255-character restriction.</span></span>  
  
 <span data-ttu-id="92e23-291">レジストリ内の各キーには多くの値を格納できるため、`valueName` パラメーターを使用して、設定する特定の値を指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="92e23-291">Because many values can be stored in each key in the registry, you must use the `valueName` parameter to specify the particular value you want to set.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="92e23-292">レジストリキーには、どの名前にも関連付けられていない1つの値を含めることができます。</span><span class="sxs-lookup"><span data-stu-id="92e23-292">A registry key can contain one value that is not associated with any name.</span></span> <span data-ttu-id="92e23-293">この名前のない値がレジストリエディターに表示されると、名前の代わりに "(既定値)" という文字列が表示されます。</span><span class="sxs-lookup"><span data-stu-id="92e23-293">When this unnamed value is displayed in the registry editor, the string "(Default)" appears instead of a name.</span></span> <span data-ttu-id="92e23-294">この名前のない値を設定するには、`valueName`に `null` または空の文字列 ("") を指定します。</span><span class="sxs-lookup"><span data-stu-id="92e23-294">To set this unnamed value, specify either `null` or the empty string ("") for `valueName`.</span></span>  
  
 <span data-ttu-id="92e23-295">キーに `valueName` が存在しない場合は、作成され、関連付けられている値は `value`に設定されます。</span><span class="sxs-lookup"><span data-stu-id="92e23-295">If `valueName` does not exist in the key, it is created and the associated value is set to `value`.</span></span>  
  
 <span data-ttu-id="92e23-296">`keyName` が存在しないサブキーを指定した場合は、指定されたルートにサブキーが作成されます。</span><span class="sxs-lookup"><span data-stu-id="92e23-296">If `keyName` specifies a subkey that does not exist, the subkey is created in the specified root.</span></span> <span data-ttu-id="92e23-297">たとえば Visual Basic 文字列 "HKEY_CURRENT_USER \MyTestKey" では、HKEY_CURRENT_USER ルートにサブキー "MyTestKey" が作成されます。</span><span class="sxs-lookup"><span data-stu-id="92e23-297">For example, in Visual Basic the string "HKEY_CURRENT_USER\MyTestKey" creates the subkey "MyTestKey" in the HKEY_CURRENT_USER root.</span></span> <span data-ttu-id="92e23-298">"HKEY_CURRENT_USER \MyTestKey\Key2\Key3" という文字列は、入れ子になったサブキー "MyTestKey"、"MyTestKey\Key2"、および "MyTestKey\Key2\Key3" を作成します。</span><span class="sxs-lookup"><span data-stu-id="92e23-298">The string "HKEY_CURRENT_USER\MyTestKey\Key2\Key3" creates the nested subkeys "MyTestKey", "MyTestKey\Key2", and "MyTestKey\Key2\Key3".</span></span>  
  
 <span data-ttu-id="92e23-299">有効なルート名には、HKEY_CURRENT_USER、HKEY_LOCAL_MACHINE、HKEY_CLASSES_ROOT、HKEY_USERS、HKEY_PERFORMANCE_DATA、HKEY_CURRENT_CONFIG、HKEY_DYN_DATA があります。</span><span class="sxs-lookup"><span data-stu-id="92e23-299">Valid root names include HKEY_CURRENT_USER, HKEY_LOCAL_MACHINE, HKEY_CLASSES_ROOT, HKEY_USERS, HKEY_PERFORMANCE_DATA, HKEY_CURRENT_CONFIG, and HKEY_DYN_DATA.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="92e23-300"><xref:Microsoft.Win32.Registry.SetValue%2A> メソッドは、レジストリキーを開き、値を設定して、呼び出されるたびにキーを閉じます。</span><span class="sxs-lookup"><span data-stu-id="92e23-300">The <xref:Microsoft.Win32.Registry.SetValue%2A> method opens a registry key, sets the value, and closes the key each time it is called.</span></span> <span data-ttu-id="92e23-301">多くの値を変更する必要がある場合は、<xref:Microsoft.Win32.RegistryKey.SetValue%2A?displayProperty=nameWithType> 方法でパフォーマンスが向上する可能性があります。</span><span class="sxs-lookup"><span data-stu-id="92e23-301">If you need to modify a large number of values, the <xref:Microsoft.Win32.RegistryKey.SetValue%2A?displayProperty=nameWithType> method might provide better performance.</span></span> <span data-ttu-id="92e23-302"><xref:Microsoft.Win32.RegistryKey> クラスには、レジストリキーにアクセス制御リスト (ACL) を追加したり、値のデータ型を取得する前にテストしたり、キーを削除したりできるメソッドも用意されています。</span><span class="sxs-lookup"><span data-stu-id="92e23-302">The <xref:Microsoft.Win32.RegistryKey> class also provides methods that allow you to add an access control list (ACL) to a registry key, to test the data type of a value before retrieving it, and to delete keys.</span></span>  
  
 <span data-ttu-id="92e23-303">指定した `value` の型が指定した `valueKind`と一致せず、データを変換できない場合は <xref:System.ArgumentException> がスローされます。</span><span class="sxs-lookup"><span data-stu-id="92e23-303">If the type of the specified `value` does not match the specified `valueKind`, and the data cannot be converted, <xref:System.ArgumentException> is thrown.</span></span> <span data-ttu-id="92e23-304">たとえば、<xref:System.Int64?displayProperty=nameWithType> を <xref:Microsoft.Win32.RegistryValueKind.DWord?displayProperty=nameWithType>として格納することができますが、その値が <xref:System.Int32?displayProperty=nameWithType>の最大値よりも小さい場合に限られます。</span><span class="sxs-lookup"><span data-stu-id="92e23-304">For example, you can store a <xref:System.Int64?displayProperty=nameWithType> as a <xref:Microsoft.Win32.RegistryValueKind.DWord?displayProperty=nameWithType>, but only if its value is less than the maximum value of a <xref:System.Int32?displayProperty=nameWithType>.</span></span> <span data-ttu-id="92e23-305">1つの文字列値を <xref:Microsoft.Win32.RegistryValueKind.MultiString?displayProperty=nameWithType>として格納することはできません。</span><span class="sxs-lookup"><span data-stu-id="92e23-305">You cannot store a single string value as a <xref:Microsoft.Win32.RegistryValueKind.MultiString?displayProperty=nameWithType>.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="92e23-306"><xref:Microsoft.Win32.RegistryValueKind.DWord?displayProperty=nameWithType> または <xref:Microsoft.Win32.RegistryValueKind.QWord?displayProperty=nameWithType>にボックス化された値が渡された場合、変換はインバリアントカルチャを使用して行われます。</span><span class="sxs-lookup"><span data-stu-id="92e23-306">If boxed values are passed for <xref:Microsoft.Win32.RegistryValueKind.DWord?displayProperty=nameWithType> or <xref:Microsoft.Win32.RegistryValueKind.QWord?displayProperty=nameWithType>, the conversion is done using the invariant culture.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="92e23-307">Windows 98 および Windows Millennium Edition (Windows Me) では、レジストリは Unicode ではなく、すべての Unicode 文字がすべてのコードページで有効であるとは限りません。</span><span class="sxs-lookup"><span data-stu-id="92e23-307">On Windows 98 and Windows Millennium Edition (Windows Me), the registry is not Unicode, and not all Unicode characters are valid for all code pages.</span></span> <span data-ttu-id="92e23-308">現在のコードページに対して無効な Unicode 文字が、使用できる最適な一致に置き換えられます。</span><span class="sxs-lookup"><span data-stu-id="92e23-308">A Unicode character that is invalid for the current code page is replaced by the best available match.</span></span> <span data-ttu-id="92e23-309">例外をスローすることはありません。</span><span class="sxs-lookup"><span data-stu-id="92e23-309">No exception is thrown.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="92e23-310">次のコード例では、複数のデータ型の値を例のキーに格納し、そのようなキーを作成して、値を取得して表示します。</span><span class="sxs-lookup"><span data-stu-id="92e23-310">The following code example stores values of several data types in an example key, creating the key as it does so, and then retrieves and displays the values.</span></span> <span data-ttu-id="92e23-311">この例では、既定の (名前のない) 名前と値のペアを格納して取得する方法と、名前と値のペアが存在しない場合に `defaultValue` を使用する方法を示します。</span><span class="sxs-lookup"><span data-stu-id="92e23-311">The example demonstrates storing and retrieving the default (nameless) name/value pair, and the use of `defaultValue` when a name/value pair does not exist.</span></span>  
  
 [!code-cpp[Microsoft.Win32.Registry.GetSet#1](~/samples/snippets/cpp/VS_Snippets_CLR/Microsoft.Win32.Registry.GetSet/CPP/source.cpp#1)]
 [!code-csharp[Microsoft.Win32.Registry.GetSet#1](~/samples/snippets/csharp/VS_Snippets_CLR/Microsoft.Win32.Registry.GetSet/CS/source.cs#1)]
 [!code-vb[Microsoft.Win32.Registry.GetSet#1](~/samples/snippets/visualbasic/VS_Snippets_CLR/Microsoft.Win32.Registry.GetSet/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="92e23-312"><paramref name="value" /> は <see langword="null" /> です。</span><span class="sxs-lookup"><span data-stu-id="92e23-312"><paramref name="value" /> is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="92e23-313"><paramref name="keyName" /> が有効なレジストリ ルートから始まっていません。</span><span class="sxs-lookup"><span data-stu-id="92e23-313"><paramref name="keyName" /> does not begin with a valid registry root.</span></span>  
  
<span data-ttu-id="92e23-314">または</span><span class="sxs-lookup"><span data-stu-id="92e23-314">-or-</span></span> 
 <span data-ttu-id="92e23-315"><paramref name="keyName" /> が許容される最大長 (255 文字) を超えています。</span><span class="sxs-lookup"><span data-stu-id="92e23-315"><paramref name="keyName" /> is longer than the maximum length allowed (255 characters).</span></span>  
  
<span data-ttu-id="92e23-316">または</span><span class="sxs-lookup"><span data-stu-id="92e23-316">-or-</span></span> 
<span data-ttu-id="92e23-317"><paramref name="value" /> の型が <paramref name="valueKind" /> で指定したレジストリ データ型と一致しなかったため、データを適切に変換できませんでした。</span><span class="sxs-lookup"><span data-stu-id="92e23-317">The type of <paramref name="value" /> did not match the registry data type specified by <paramref name="valueKind" />, therefore the data could not be converted properly.</span></span></exception>
        <exception cref="T:System.UnauthorizedAccessException"><span data-ttu-id="92e23-318"><see cref="T:Microsoft.Win32.RegistryKey" /> が読み取り専用であるため、このキーに書き込むことはできません。ルートレベル ノードの場合や、書き込みアクセスが設定された状態でキーが開かれていない場合などです。</span><span class="sxs-lookup"><span data-stu-id="92e23-318">The <see cref="T:Microsoft.Win32.RegistryKey" /> is read-only, and thus cannot be written to; for example, it is a root-level node, or the key has not been opened with write access.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="92e23-319">ユーザーに、レジストリ キーの作成または変更に必要なアクセス許可がありません。</span><span class="sxs-lookup"><span data-stu-id="92e23-319">The user does not have the permissions required to create or modify registry keys.</span></span></exception>
        <permission cref="T:System.Security.Permissions.RegistryPermission"><span data-ttu-id="92e23-320">指定したレジストリキーが存在する場合にそのキーを変更する場合は。存在しない場合はレジストリキーを作成する場合は。</span><span class="sxs-lookup"><span data-stu-id="92e23-320">to modify the specified registry key if it exists, or to create the registry key if it does not already exist.</span></span> <span data-ttu-id="92e23-321">関連付けられた列挙型: <see cref="F:System.Security.Permissions.RegistryPermissionAccess.Write" />、<see cref="F:System.Security.Permissions.RegistryPermissionAccess.Create" /></span><span class="sxs-lookup"><span data-stu-id="92e23-321">Associated enumerations: <see cref="F:System.Security.Permissions.RegistryPermissionAccess.Write" />, <see cref="F:System.Security.Permissions.RegistryPermissionAccess.Create" /></span></span></permission>
      </Docs>
    </Member>
    <Member MemberName="Users">
      <MemberSignature Language="C#" Value="public static readonly Microsoft.Win32.RegistryKey Users;" />
      <MemberSignature Language="ILAsm" Value=".field public static initonly class Microsoft.Win32.RegistryKey Users" />
      <MemberSignature Language="DocId" Value="F:Microsoft.Win32.Registry.Users" />
      <MemberSignature Language="VB.NET" Value="Public Shared ReadOnly Users As RegistryKey " />
      <MemberSignature Language="C++ CLI" Value="public: static initonly Microsoft::Win32::RegistryKey ^ Users;" />
      <MemberSignature Language="F#" Value=" staticval mutable Users : Microsoft.Win32.RegistryKey" Usage="Microsoft.Win32.Registry.Users" />
      <MemberType>Field</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.Win32.Registry</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.1.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.1.0</AssemblyVersion>
        <AssemblyVersion>4.1.2.0</AssemblyVersion>
        <AssemblyVersion>4.1.3.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>mscorlib</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>Microsoft.Win32.RegistryKey</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="92e23-322">既定のユーザー構成に関する情報を格納します。</span><span class="sxs-lookup"><span data-stu-id="92e23-322">Contains information about the default user configuration.</span></span> <span data-ttu-id="92e23-323">このフィールドには、Windows レジストリの基本キー HKEY_USERS が読み込まれます。</span><span class="sxs-lookup"><span data-stu-id="92e23-323">This field reads the Windows registry base key HKEY_USERS.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="92e23-324">このキーには、コンピューターの各ユーザーのブランチが含まれています。</span><span class="sxs-lookup"><span data-stu-id="92e23-324">This key contains a branch for each user of the computer.</span></span> <span data-ttu-id="92e23-325">既定の構成は、ローカルコンピューターの新しいユーザーに対して指定され、ユーザーが設定を変更していない場合は、既定の現在のユーザーに対して指定されます。</span><span class="sxs-lookup"><span data-stu-id="92e23-325">The default configuration is supplied for new users on the local computer and for the default current user if the user has not changed preferences.</span></span> <span data-ttu-id="92e23-326">Windows 98/ME ではレジストリもサポートされているため、アプリケーションは Windows 2000 の場合と同じ方法でユーザー固有の情報にアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="92e23-326">Because Windows 98/ME also supports Registry.Users, applications can access the user-specific information the same way they do under Windows 2000.</span></span> <span data-ttu-id="92e23-327">各ユーザーの情報は別のファイルに格納され、ローカルまたはネットワークサーバーに保存できます。</span><span class="sxs-lookup"><span data-stu-id="92e23-327">Each user's information is stored in a separate file, which can be stored locally or on a network server.</span></span> <span data-ttu-id="92e23-328">Windows 98/ME では、このファイルをユーザーの現在のシステムにコピーして、設定がユーザーとの間でコンピューター間を移動できるようにすることができます。</span><span class="sxs-lookup"><span data-stu-id="92e23-328">Windows 98/ME can copy this file to the user's current system so that settings can move from one computer to another with the user.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="92e23-329">次の例は、このキーのサブキーを取得し、その名前を画面に出力する方法を示しています。</span><span class="sxs-lookup"><span data-stu-id="92e23-329">The following example demonstrates how to retrieve the subkeys of this key, and prints their names to the screen.</span></span> <span data-ttu-id="92e23-330"><xref:Microsoft.Win32.RegistryKey.OpenSubKey%2A> メソッドを使用して、対象となる特定のサブキーのインスタンスを作成します。</span><span class="sxs-lookup"><span data-stu-id="92e23-330">Use the <xref:Microsoft.Win32.RegistryKey.OpenSubKey%2A> method to create an instance of the particular subkey of interest.</span></span> <span data-ttu-id="92e23-331">その後、<xref:Microsoft.Win32.RegistryKey> で他の操作を使用してそのキーを操作できます。</span><span class="sxs-lookup"><span data-stu-id="92e23-331">You can then use other operations in <xref:Microsoft.Win32.RegistryKey> to manipulate that key.</span></span>  
  
 [!code-cpp[Classic Registry.Users Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic Registry.Users Example/CPP/source.cpp#1)]
 [!code-csharp[Classic Registry.Users Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic Registry.Users Example/CS/source.cs#1)]
 [!code-vb[Classic Registry.Users Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic Registry.Users Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
  </Members>
</Type>
